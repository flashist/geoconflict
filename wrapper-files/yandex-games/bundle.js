(()=>{var e={7:(e,t,i)=>{"use strict";i.d(t,{L:()=>s});var n=i(198);class s{constructor(){this.uid=(0,n.L)("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.gcTick=0}reset(){this.instructionSize=0}destroy(){this.instructions.length=0,this.renderables.length=0,this.renderPipes=null,this.gcTick=0}add(e){this.instructions[this.instructionSize++]=e}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}},198:(e,t,i)=>{"use strict";i.d(t,{L:()=>s});const n={default:-1};function s(e="default"){return void 0===n[e]&&(n[e]=-1),++n[e]}},228:e=>{"use strict";var t=Object.prototype.hasOwnProperty,i="~";function n(){}function s(e,t,i){this.fn=e,this.context=t,this.once=i||!1}function r(e,t,n,r,a){if("function"!=typeof n)throw new TypeError("The listener must be a function");var o=new s(n,r||e,a),l=i?i+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],o]:e._events[l].push(o):(e._events[l]=o,e._eventsCount++),e}function a(e,t){0===--e._eventsCount?e._events=new n:delete e._events[t]}function o(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(i=!1)),o.prototype.eventNames=function(){var e,n,s=[];if(0===this._eventsCount)return s;for(n in e=this._events)t.call(e,n)&&s.push(i?n.slice(1):n);return Object.getOwnPropertySymbols?s.concat(Object.getOwnPropertySymbols(e)):s},o.prototype.listeners=function(e){var t=i?i+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var s=0,r=n.length,a=new Array(r);s<r;s++)a[s]=n[s].fn;return a},o.prototype.listenerCount=function(e){var t=i?i+e:e,n=this._events[t];return n?n.fn?1:n.length:0},o.prototype.emit=function(e,t,n,s,r,a){var o=i?i+e:e;if(!this._events[o])return!1;var l,h,u=this._events[o],c=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),c){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,n),!0;case 4:return u.fn.call(u.context,t,n,s),!0;case 5:return u.fn.call(u.context,t,n,s,r),!0;case 6:return u.fn.call(u.context,t,n,s,r,a),!0}for(h=1,l=new Array(c-1);h<c;h++)l[h-1]=arguments[h];u.fn.apply(u.context,l)}else{var d,p=u.length;for(h=0;h<p;h++)switch(u[h].once&&this.removeListener(e,u[h].fn,void 0,!0),c){case 1:u[h].fn.call(u[h].context);break;case 2:u[h].fn.call(u[h].context,t);break;case 3:u[h].fn.call(u[h].context,t,n);break;case 4:u[h].fn.call(u[h].context,t,n,s);break;default:if(!l)for(d=1,l=new Array(c-1);d<c;d++)l[d-1]=arguments[d];u[h].fn.apply(u[h].context,l)}}return!0},o.prototype.on=function(e,t,i){return r(this,e,t,i,!1)},o.prototype.once=function(e,t,i){return r(this,e,t,i,!0)},o.prototype.removeListener=function(e,t,n,s){var r=i?i+e:e;if(!this._events[r])return this;if(!t)return a(this,r),this;var o=this._events[r];if(o.fn)o.fn!==t||s&&!o.once||n&&o.context!==n||a(this,r);else{for(var l=0,h=[],u=o.length;l<u;l++)(o[l].fn!==t||s&&!o[l].once||n&&o[l].context!==n)&&h.push(o[l]);h.length?this._events[r]=1===h.length?h[0]:h:a(this,r)}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=i?i+e:e,this._events[t]&&a(this,t)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=i,o.EventEmitter=o,e.exports=o},358:(e,t,i)=>{"use strict";i.d(t,{b:()=>n,m:()=>s});const n={name:"round-pixels-bit",vertex:{header:"\n            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32>\n            {\n                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;\n            }\n        "}},s={name:"round-pixels-bit",vertex:{header:"\n            vec2 roundPixels(vec2 position, vec2 targetSize)\n            {\n                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;\n            }\n        "}}},379:(e,t,i)=>{"use strict";i.d(t,{R:()=>a});var n=i(3377);class s{constructor(e,t=null,i=0,n=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=e,this._context=t,this.priority=i,this._once=n}match(e,t=null){return this._fn===e&&this._context===t}emit(e){this._fn&&(this._context?this._fn.call(this._context,e):this._fn(e));const t=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),t}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const t=this.next;return this.next=e?null:t,this.previous=null,t}}const r=class e{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new s(null,null,1/0),this.deltaMS=1/e.targetFPMS,this.elapsedMS=1/e.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&null===this._requestId&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,t,i=n.d.NORMAL){return this._addListener(new s(e,t,i))}addOnce(e,t,i=n.d.NORMAL){return this._addListener(new s(e,t,i,!0))}_addListener(e){let t=this._head.next,i=this._head;if(t){for(;t;){if(e.priority>t.priority){e.connect(i);break}i=t,t=t.next}e.previous||e.connect(i)}else e.connect(i);return this._startIfPossible(),this}remove(e,t){let i=this._head.next;for(;i;)i=i.match(e,t)?i.destroy():i.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,t=this._head;for(;t=t.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let i;if(t>this.lastTime){if(i=this.elapsedMS=t-this.lastTime,i>this._maxElapsedMS&&(i=this._maxElapsedMS),i*=this.speed,this._minElapsedMS){const e=t-this._lastFrame|0;if(e<this._minElapsedMS)return;this._lastFrame=t-e%this._minElapsedMS}this.deltaMS=i,this.deltaTime=this.deltaMS*e.targetFPMS;const n=this._head;let s=n.next;for(;s;)s=s.emit(this);n.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const i=Math.min(this.maxFPS,t),n=Math.min(Math.max(0,i)/1e3,e.targetFPMS);this._maxElapsedMS=1/n}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(0===e)this._minElapsedMS=0;else{const t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!e._shared){const t=e._shared=new e;t.autoStart=!0,t._protected=!0}return e._shared}static get system(){if(!e._system){const t=e._system=new e;t.autoStart=!0,t._protected=!0}return e._system}};r.targetFPMS=.06;let a=r},563:(e,t,i)=>{"use strict";i.d(t,{q:()=>r});var n=i(9731),s=i(8605);function r(e,t){for(const i in e.attributes){const s=e.attributes[i],r=t[i];r?(s.format??(s.format=r.format),s.offset??(s.offset=r.offset),s.instance??(s.instance=r.instance)):(0,n.R)(`Attribute ${i} is not present in the shader, but is present in the geometry. Unable to infer attribute details.`)}!function(e){const{buffers:t,attributes:i}=e,n={},r={};for(const e in t){const i=t[e];n[i.uid]=0,r[i.uid]=0}for(const e in i){const t=i[e];n[t.buffer.uid]+=(0,s.m)(t.format).stride}for(const e in i){const t=i[e];t.stride??(t.stride=n[t.buffer.uid]),t.start??(t.start=r[t.buffer.uid]),r[t.buffer.uid]+=(0,s.m)(t.format).stride}}(e)}},577:(e,t,i)=>{"use strict";i.d(t,{$:()=>n});const n=[{type:"mat3x3<f32>",test:e=>void 0!==e.value.a,ubo:"\n            var matrix = uv[name].toArray(true);\n            data[offset] = matrix[0];\n            data[offset + 1] = matrix[1];\n            data[offset + 2] = matrix[2];\n            data[offset + 4] = matrix[3];\n            data[offset + 5] = matrix[4];\n            data[offset + 6] = matrix[5];\n            data[offset + 8] = matrix[6];\n            data[offset + 9] = matrix[7];\n            data[offset + 10] = matrix[8];\n        ",uniform:"\n            gl.uniformMatrix3fv(ud[name].location, false, uv[name].toArray(true));\n        "},{type:"vec4<f32>",test:e=>"vec4<f32>"===e.type&&1===e.size&&void 0!==e.value.width,ubo:"\n            v = uv[name];\n            data[offset] = v.x;\n            data[offset + 1] = v.y;\n            data[offset + 2] = v.width;\n            data[offset + 3] = v.height;\n        ",uniform:"\n            cv = ud[name].value;\n            v = uv[name];\n            if (cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height) {\n                cv[0] = v.x;\n                cv[1] = v.y;\n                cv[2] = v.width;\n                cv[3] = v.height;\n                gl.uniform4f(ud[name].location, v.x, v.y, v.width, v.height);\n            }\n        "},{type:"vec2<f32>",test:e=>"vec2<f32>"===e.type&&1===e.size&&void 0!==e.value.x,ubo:"\n            v = uv[name];\n            data[offset] = v.x;\n            data[offset + 1] = v.y;\n        ",uniform:"\n            cv = ud[name].value;\n            v = uv[name];\n            if (cv[0] !== v.x || cv[1] !== v.y) {\n                cv[0] = v.x;\n                cv[1] = v.y;\n                gl.uniform2f(ud[name].location, v.x, v.y);\n            }\n        "},{type:"vec4<f32>",test:e=>"vec4<f32>"===e.type&&1===e.size&&void 0!==e.value.red,ubo:"\n            v = uv[name];\n            data[offset] = v.red;\n            data[offset + 1] = v.green;\n            data[offset + 2] = v.blue;\n            data[offset + 3] = v.alpha;\n        ",uniform:"\n            cv = ud[name].value;\n            v = uv[name];\n            if (cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha) {\n                cv[0] = v.red;\n                cv[1] = v.green;\n                cv[2] = v.blue;\n                cv[3] = v.alpha;\n                gl.uniform4f(ud[name].location, v.red, v.green, v.blue, v.alpha);\n            }\n        "},{type:"vec3<f32>",test:e=>"vec3<f32>"===e.type&&1===e.size&&void 0!==e.value.red,ubo:"\n            v = uv[name];\n            data[offset] = v.red;\n            data[offset + 1] = v.green;\n            data[offset + 2] = v.blue;\n        ",uniform:"\n            cv = ud[name].value;\n            v = uv[name];\n            if (cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue) {\n                cv[0] = v.red;\n                cv[1] = v.green;\n                cv[2] = v.blue;\n                gl.uniform3f(ud[name].location, v.red, v.green, v.blue);\n            }\n        "}]},594:(e,t,i)=>{"use strict";function n(e,t,i,n){const s={width:0,height:0,offsetY:0,scale:t.fontSize/i.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};s.offsetY=i.baseLineOffset;let r=s.lines[0],a=null,o=!0;const l={spaceWord:!1,width:0,start:0,index:0,positions:[],chars:[]},h=i.baseMeasurementFontSize/t.fontSize,u=t.letterSpacing*h,c=t.wordWrapWidth*h,d=t.lineHeight?t.lineHeight*h:i.lineHeight,p=t.wordWrap&&t.breakWords,f=e=>{const t=r.width;for(let i=0;i<l.index;i++){const n=e.positions[i];r.chars.push(e.chars[i]),r.charPositions.push(n+t)}r.width+=e.width,o=!1,l.width=0,l.index=0,l.chars.length=0},g=()=>{let e=r.chars.length-1;if(n){let t=r.chars[e];for(;" "===t;)r.width-=i.chars[t].xAdvance,t=r.chars[--e]}s.width=Math.max(s.width,r.width),r={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},o=!0,s.lines.push(r),s.height+=d},m=e=>e-u>c;for(let n=0;n<e.length+1;n++){let s;const h=n===e.length;h||(s=e[n]);const c=i.chars[s]||i.chars[" "];if(/(?:\s)/.test(s)||"\r"===s||"\n"===s||h){if(!o&&t.wordWrap&&m(r.width+l.width)?(g(),f(l),h||r.charPositions.push(0)):(l.start=r.width,f(l),h||r.charPositions.push(0)),"\r"===s||"\n"===s)g();else if(!h){const e=c.xAdvance+(c.kerning[a]||0)+u;r.width+=e,r.spaceWidth=e,r.spacesIndex.push(r.charPositions.length),r.chars.push(s)}}else{const e=c.kerning[a]||0,t=c.xAdvance+e+u;p&&m(r.width+l.width+t)&&(f(l),g()),l.positions[l.index++]=l.width+e,l.chars.push(s),l.width+=t}a=s}return g(),"center"===t.align?function(e){for(let t=0;t<e.lines.length;t++){const i=e.lines[t],n=e.width/2-i.width/2;for(let e=0;e<i.charPositions.length;e++)i.charPositions[e]+=n}}(s):"right"===t.align?function(e){for(let t=0;t<e.lines.length;t++){const i=e.lines[t],n=e.width-i.width;for(let e=0;e<i.charPositions.length;e++)i.charPositions[e]+=n}}(s):"justify"===t.align&&function(e){const t=e.width;for(let i=0;i<e.lines.length;i++){const n=e.lines[i];let s=0,r=n.spacesIndex[s++],a=0;const o=n.spacesIndex.length,l=(t-n.width)/o;for(let e=0;e<n.charPositions.length;e++)e===r&&(r=n.spacesIndex[s++],a+=l),n.charPositions[e]+=a}}(s),s}i.d(t,{Z:()=>n})},822:(e,t,i)=>{"use strict";i.d(t,{l:()=>r});var n=i(3289),s=i(3079);class r extends s.mc{constructor(e){super(e),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=-1,this._gpuData=Object.create(null),this._bounds=new n.c(0,1,0,0),this._boundsDirty=!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(e){this._roundPixels=e?1:0}containsPoint(e){const t=this.bounds,{x:i,y:n}=e;return i>=t.minX&&i<=t.maxX&&n>=t.minY&&n<=t.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const e=this.renderGroup||this.parentRenderGroup;e&&e.onChildViewUpdate(this)}destroy(e){super.destroy(e),this._bounds=null;for(const e in this._gpuData)this._gpuData[e].destroy?.();this._gpuData=null}collectRenderablesSimple(e,t,i){const{renderPipes:n}=t;n.blendMode.pushBlendMode(this,this.groupBlendMode,e);n[this.renderPipeId].addRenderable(this,e),this.didViewUpdate=!1;const s=this.children,r=s.length;for(let n=0;n<r;n++)s[n].collectRenderables(e,t,i);n.blendMode.popBlendMode(e)}}},878:(e,t,i)=>{"use strict";i.d(t,{p:()=>a});var n=i(5553);const s="http://www.w3.org/2000/svg",r="http://www.w3.org/1999/xhtml";class a{constructor(){this.svgRoot=document.createElementNS(s,"svg"),this.foreignObject=document.createElementNS(s,"foreignObject"),this.domElement=document.createElementNS(r,"div"),this.styleElement=document.createElementNS(r,"style");const{foreignObject:e,svgRoot:t,styleElement:i,domElement:a}=this;e.setAttribute("width","10000"),e.setAttribute("height","10000"),e.style.overflow="hidden",t.appendChild(e),e.appendChild(i),e.appendChild(a),this.image=n.e.get().createImage()}destroy(){this.svgRoot.remove(),this.foreignObject.remove(),this.styleElement.remove(),this.domElement.remove(),this.image.src="",this.image.remove(),this.svgRoot=null,this.foreignObject=null,this.styleElement=null,this.domElement=null,this.image=null,this.canvasAndContext=null}}},969:(e,t,i)=>{"use strict";i.d(t,{C:()=>r});var n=i(5553);let s;async function r(){return s??(s=(async()=>{const e=n.e.get().createCanvas(1,1).getContext("webgl");if(!e)return"premultiply-alpha-on-upload";const t=await new Promise(e=>{const t=document.createElement("video");t.onloadeddata=()=>e(t),t.onerror=()=>e(null),t.autoplay=!1,t.crossOrigin="anonymous",t.preload="auto",t.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",t.load()});if(!t)return"premultiply-alpha-on-upload";const i=e.createTexture();e.bindTexture(e.TEXTURE_2D,i);const s=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,s),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,i,0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t);const r=new Uint8Array(4);return e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,r),e.deleteFramebuffer(s),e.deleteTexture(i),e.getExtension("WEBGL_lose_context")?.loseContext(),r[0]<=r[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),s}},997:(e,t,i)=>{"use strict";var n=i(8602),s=i(8192),r=i(9111),a=i(3065);class o extends a.K{constructor(e){super(),this.generatingTexture=!1,this.currentKey="--",this._renderer=e,e.runners.resolutionChange.add(this)}resolutionChange(){const e=this.renderable;e._autoResolution&&e.onViewUpdate()}destroy(){const{htmlText:e}=this._renderer;null===e.getReferenceCount(this.currentKey)?e.returnTexturePromise(this.texturePromise):e.decreaseReferenceCount(this.currentKey),this._renderer.runners.resolutionChange.remove(this),this.texturePromise=null,this._renderer=null}}class l{constructor(e){this._renderer=e}validateRenderable(e){const t=this._getGpuText(e),i=e.styleKey;return t.currentKey!==i}addRenderable(e,t){const i=this._getGpuText(e);if(e._didTextUpdate){const t=e._autoResolution?this._renderer.resolution:e.resolution;i.currentKey===e.styleKey&&e.resolution===t||this._updateGpuText(e).catch(e=>{console.error(e)}),e._didTextUpdate=!1,(0,r.s)(i,e)}this._renderer.renderPipes.batch.addToBatch(i,t)}updateRenderable(e){const t=this._getGpuText(e);t._batcher.updateElement(t)}async _updateGpuText(e){e._didTextUpdate=!1;const t=this._getGpuText(e);if(t.generatingTexture)return;const i=t.texturePromise;t.texturePromise=null,t.generatingTexture=!0,e._resolution=e._autoResolution?this._renderer.resolution:e.resolution;let n=this._renderer.htmlText.getTexturePromise(e);i&&(n=n.finally(()=>{this._renderer.htmlText.decreaseReferenceCount(t.currentKey),this._renderer.htmlText.returnTexturePromise(i)})),t.texturePromise=n,t.currentKey=e.styleKey,t.texture=await n;const s=e.renderGroup||e.parentRenderGroup;s&&(s.structureDidChange=!0),t.generatingTexture=!1,(0,r.s)(t,e)}_getGpuText(e){return e._gpuData[this._renderer.uid]||this.initGpuText(e)}initGpuText(e){const t=new o(this._renderer);return t.renderable=e,t.transform=e.groupTransform,t.texture=s.g.EMPTY,t.bounds={minX:0,maxX:1,minY:0,maxY:0},t.roundPixels=this._renderer._roundPixels|e._roundPixels,e._resolution=e._autoResolution?this._renderer.resolution:e.resolution,e._gpuData[this._renderer.uid]=t,t}destroy(){this._renderer=null}}l.extension={type:[n.Ag.WebGLPipes,n.Ag.WebGPUPipes,n.Ag.CanvasPipes],name:"htmlText"};var h=i(4057),u=i(1862),c=i(9998),d=i(5553);var p=i(9731),f=i(5148),g=i(4377),m=i(878);var _=i(4068);async function v(e,t){const i=await async function(e){const t=await d.e.get().fetch(e),i=await t.blob(),n=new FileReader;return await new Promise((e,t)=>{n.onloadend=()=>e(n.result),n.onerror=t,n.readAsDataURL(i)})}(t);return`@font-face {\n        font-family: "${e.fontFamily}";\n        font-weight: ${e.fontWeight};\n        font-style: ${e.fontStyle};\n        src: url('${i}');\n    }`}const y=new Map;var b=i(8132);class x{constructor(e){this._activeTextures={},this._renderer=e,this._createCanvas=e.type===c.W.WEBGPU}getTexture(e){return this.getTexturePromise(e)}getManagedTexture(e){const t=e.styleKey;if(this._activeTextures[t])return this._increaseReferenceCount(t),this._activeTextures[t].promise;const i=this._buildTexturePromise(e).then(e=>(this._activeTextures[t].texture=e,e));return this._activeTextures[t]={texture:null,promise:i,usageCount:1},i}getReferenceCount(e){return this._activeTextures[e]?.usageCount??null}_increaseReferenceCount(e){this._activeTextures[e].usageCount++}decreaseReferenceCount(e){const t=this._activeTextures[e];t&&(t.usageCount--,0===t.usageCount&&(t.texture?this._cleanUp(t.texture):t.promise.then(e=>{t.texture=e,this._cleanUp(t.texture)}).catch(()=>{(0,p.R)("HTMLTextSystem: Failed to clean texture")}),this._activeTextures[e]=null))}getTexturePromise(e){return this._buildTexturePromise(e)}async _buildTexturePromise(e){const{text:t,style:i,resolution:n,textureStyle:s}=e,r=f.Z.get(m.p),a=function(e,t){const i=t.fontFamily,n=[],s={},r=e.match(/font-family:([^;"\s]+)/g);function a(e){s[e]||(n.push(e),s[e]=!0)}if(Array.isArray(i))for(let e=0;e<i.length;e++)a(i[e]);else a(i);r&&r.forEach(e=>{a(e.split(":")[1].trim())});for(const e in t.tagStyles)a(t.tagStyles[e].fontFamily);return n}(t,i),o=await async function(e){const t=e.filter(e=>_.l.has(`${e}-and-url`)).map(e=>{if(!y.has(e)){const{entries:t}=_.l.get(`${e}-and-url`),i=[];t.forEach(t=>{const n=t.url,s=t.faces.map(e=>({weight:e.weight,style:e.style}));i.push(...s.map(t=>v({fontWeight:t.weight,fontStyle:t.style,fontFamily:e},n)))}),y.set(e,Promise.all(i).then(e=>e.join("\n")))}return y.get(e)});return(await Promise.all(t)).join("\n")}(a),l=(0,b.r)(t,i,o,r),u=Math.ceil(Math.ceil(Math.max(1,l.width)+2*i.padding)*n),c=Math.ceil(Math.ceil(Math.max(1,l.height)+2*i.padding)*n),p=r.image;p.width=2+(0|u),p.height=2+(0|c);const x=function(e,t,i,n,s){const{domElement:r,styleElement:a,svgRoot:o}=s;r.innerHTML=`<style>${t.cssStyle}</style><div style='padding:0;'>${e}</div>`,r.setAttribute("style",`transform: scale(${i});transform-origin: top left; display: inline-block`),a.textContent=n;const{width:l,height:h}=s.image;return o.setAttribute("width",l.toString()),o.setAttribute("height",h.toString()),(new XMLSerializer).serializeToString(o)}(t,i,n,o,r);await function(e,t,i){return new Promise(async n=>{i&&await new Promise(e=>setTimeout(e,100)),e.onload=()=>{n()},e.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(t)}`,e.crossOrigin="anonymous"})}(p,x,function(){const{userAgent:e}=d.e.get().getNavigator();return/^((?!chrome|android).)*safari/i.test(e)}()&&a.length>0);const T=p;let S;this._createCanvas&&(S=function(e,t){const i=h.N.getOptimalCanvasAndContext(e.width,e.height,t),{context:n}=i;return n.clearRect(0,0,e.width,e.height),n.drawImage(e,0,0),i}(p,n));const A=(0,g.M)(S?S.canvas:T,p.width-2,p.height-2,n);return s&&(A.source.style=s),this._createCanvas&&(this._renderer.texture.initSource(A.source),h.N.returnCanvasAndContext(S)),f.Z.return(r),A}returnTexturePromise(e){e.then(e=>{this._cleanUp(e)}).catch(()=>{(0,p.R)("HTMLTextSystem: Failed to clean texture")})}_cleanUp(e){u.W.returnTexture(e,!0),e.source.resource=null,e.source.uploadMethodId="unknown"}destroy(){this._renderer=null;for(const e in this._activeTextures)this._activeTextures[e]&&this.returnTexturePromise(this._activeTextures[e].promise);this._activeTextures=null}}x.extension={type:[n.Ag.WebGLSystem,n.Ag.WebGPUSystem,n.Ag.CanvasSystem],name:"htmlText"},n.XO.add(x),n.XO.add(l)},1002:(e,t,i)=>{"use strict";i.d(t,{T:()=>n});var n=(e=>(e[e.Low=0]="Low",e[e.Normal=1]="Normal",e[e.High=2]="High",e))(n||{})},1017:(e,t,i)=>{"use strict";function n(e,t){return`\n        for (let i = 0; i < ${e*t}; i++) {\n            data[offset + (((i / ${e})|0) * 4) + (i % ${e})] = v[i];\n        }\n    `}i.d(t,{_:()=>r,g:()=>s});const s={f32:"\n        data[offset] = v;",i32:"\n        dataInt32[offset] = v;","vec2<f32>":"\n        data[offset] = v[0];\n        data[offset + 1] = v[1];","vec3<f32>":"\n        data[offset] = v[0];\n        data[offset + 1] = v[1];\n        data[offset + 2] = v[2];","vec4<f32>":"\n        data[offset] = v[0];\n        data[offset + 1] = v[1];\n        data[offset + 2] = v[2];\n        data[offset + 3] = v[3];","vec2<i32>":"\n        dataInt32[offset] = v[0];\n        dataInt32[offset + 1] = v[1];","vec3<i32>":"\n        dataInt32[offset] = v[0];\n        dataInt32[offset + 1] = v[1];\n        dataInt32[offset + 2] = v[2];","vec4<i32>":"\n        dataInt32[offset] = v[0];\n        dataInt32[offset + 1] = v[1];\n        dataInt32[offset + 2] = v[2];\n        dataInt32[offset + 3] = v[3];","mat2x2<f32>":"\n        data[offset] = v[0];\n        data[offset + 1] = v[1];\n        data[offset + 4] = v[2];\n        data[offset + 5] = v[3];","mat3x3<f32>":"\n        data[offset] = v[0];\n        data[offset + 1] = v[1];\n        data[offset + 2] = v[2];\n        data[offset + 4] = v[3];\n        data[offset + 5] = v[4];\n        data[offset + 6] = v[5];\n        data[offset + 8] = v[6];\n        data[offset + 9] = v[7];\n        data[offset + 10] = v[8];","mat4x4<f32>":"\n        for (let i = 0; i < 16; i++) {\n            data[offset + i] = v[i];\n        }","mat3x2<f32>":n(3,2),"mat4x2<f32>":n(4,2),"mat2x3<f32>":n(2,3),"mat4x3<f32>":n(4,3),"mat2x4<f32>":n(2,4),"mat3x4<f32>":n(3,4)},r={...s,"mat2x2<f32>":"\n        data[offset] = v[0];\n        data[offset + 1] = v[1];\n        data[offset + 2] = v[2];\n        data[offset + 3] = v[3];\n    "}},1047:(e,t,i)=>{"use strict";i.d(t,{u:()=>l});var n=i(5662),s=i(2409),r=i(5178),a=i(4303);const o=class e extends r.V{constructor(...t){let i=t[0]??{};i instanceof Float32Array&&((0,a.t6)(a.lj,"use new MeshGeometry({ positions, uvs, indices }) instead"),i={positions:i,uvs:t[1],indices:t[2]}),i={...e.defaultOptions,...i};const r=i.positions||new Float32Array([0,0,1,0,1,1,0,1]);let o=i.uvs;o||(o=i.positions?new Float32Array(r.length):new Float32Array([0,0,1,0,1,1,0,1]));const l=i.indices||new Uint32Array([0,1,2,0,2,3]),h=i.shrinkBuffersToFit;super({attributes:{aPosition:{buffer:new n.h({data:r,label:"attribute-mesh-positions",shrinkToFit:h,usage:s.S.VERTEX|s.S.COPY_DST}),format:"float32x2",stride:8,offset:0},aUV:{buffer:new n.h({data:o,label:"attribute-mesh-uvs",shrinkToFit:h,usage:s.S.VERTEX|s.S.COPY_DST}),format:"float32x2",stride:8,offset:0}},indexBuffer:new n.h({data:l,label:"index-mesh-buffer",shrinkToFit:h,usage:s.S.INDEX|s.S.COPY_DST}),topology:i.topology}),this.batchMode="auto"}get positions(){return this.attributes.aPosition.buffer.data}set positions(e){this.attributes.aPosition.buffer.data=e}get uvs(){return this.attributes.aUV.buffer.data}set uvs(e){this.attributes.aUV.buffer.data=e}get indices(){return this.indexBuffer.data}set indices(e){this.indexBuffer.data=e}};o.defaultOptions={topology:"triangle-list",shrinkBuffersToFit:!1};let l=o},1675:(e,t,i)=>{"use strict";i.d(t,{o:()=>o,u:()=>a});var n=i(6680),s=i(5148),r=i(3289);const a=s.Z.getPool(n.u),o=s.Z.getPool(r.c)},1819:(e,t,i)=>{"use strict";i.d(t,{n:()=>l});var n=i(2551),s=i(198),r=i(4303);const a=Object.create(null);const o=class e extends n.A{constructor(t={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,t={...e.defaultOptions,...t},this.addressMode=t.addressMode,this.addressModeU=t.addressModeU??this.addressModeU,this.addressModeV=t.addressModeV??this.addressModeV,this.addressModeW=t.addressModeW??this.addressModeW,this.scaleMode=t.scaleMode,this.magFilter=t.magFilter??this.magFilter,this.minFilter=t.minFilter??this.minFilter,this.mipmapFilter=t.mipmapFilter??this.mipmapFilter,this.lodMinClamp=t.lodMinClamp,this.lodMaxClamp=t.lodMaxClamp,this.compare=t.compare,this.maxAnisotropy=t.maxAnisotropy??1}set addressMode(e){this.addressModeU=e,this.addressModeV=e,this.addressModeW=e}get addressMode(){return this.addressModeU}set wrapMode(e){(0,r.t6)(r.lj,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=e}get wrapMode(){return this.addressMode}set scaleMode(e){this.magFilter=e,this.minFilter=e,this.mipmapFilter=e}get scaleMode(){return this.magFilter}set maxAnisotropy(e){this._maxAnisotropy=Math.min(e,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const e=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=function(e){const t=a[e];return void 0===t&&(a[e]=(0,s.L)("resource")),t}(e),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};o.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let l=o},1828:(e,t,i)=>{"use strict";i.d(t,{b:()=>n});class n{constructor(e=0,t=0){this.x=0,this.y=0,this.x=e,this.y=t}clone(){return new n(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,t=e){return this.x=e,this.y=t,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return s.x=0,s.y=0,s}}const s=new n},1851:(e,t,i)=>{"use strict";i.d(t,{TO:()=>n,Td:()=>r,bO:()=>s});const n=2*Math.PI,s=180/Math.PI,r=Math.PI/180},1862:(e,t,i)=>{"use strict";i.d(t,{W:()=>h});var n=i(9550),s=i(9298),r=i(5884),a=i(8192),o=i(1819);let l=0;const h=new class{constructor(e){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this.textureStyle=new o.n(this.textureOptions)}createTexture(e,t,i){const n=new r.v({...this.textureOptions,width:e,height:t,resolution:1,antialias:i,autoGarbageCollect:!1});return new a.g({source:n,label:"texturePool_"+l++})}getOptimalTexture(e,t,i=1,s){let r=Math.ceil(e*i-1e-6),a=Math.ceil(t*i-1e-6);r=(0,n.U5)(r),a=(0,n.U5)(a);const o=(r<<17)+(a<<1)+(s?1:0);this._texturePool[o]||(this._texturePool[o]=[]);let l=this._texturePool[o].pop();return l||(l=this.createTexture(r,a,s)),l.source._resolution=i,l.source.width=r/i,l.source.height=a/i,l.source.pixelWidth=r,l.source.pixelHeight=a,l.frame.x=0,l.frame.y=0,l.frame.width=e,l.frame.height=t,l.updateUvs(),this._poolKeyHash[l.uid]=o,l}getSameSizeTexture(e,t=!1){const i=e.source;return this.getOptimalTexture(e.width,e.height,i._resolution,t)}returnTexture(e,t=!1){const i=this._poolKeyHash[e.uid];t&&(e.source.style=this.textureStyle),this._texturePool[i].push(e)}clear(e){if(e=!1!==e)for(const e in this._texturePool){const t=this._texturePool[e];if(t)for(let e=0;e<t.length;e++)t[e].destroy(!0)}this._texturePool={}}};s.L.register(h)},1891:(e,t,i)=>{"use strict";i.d(t,{x:()=>h});var n=i(9731),s=i(7384),r=i(3865);function a(e,t,i,n,s){const r=t[i];for(let o=0;o<r.length;o++){const l=r[o];i<t.length-1?a(e.replace(n[i],l),t,i+1,n,s):s.push(e.replace(n[i],l))}}function o(e){const t=e.match(/\{(.*?)\}/g),i=[];if(t){const n=[];t.forEach(e=>{const t=e.substring(1,e.length-1).split(",");n.push(t)}),a(e,n,0,t,i)}else i.push(e);return i}var l=i(5984);class h{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,t)=>`${e}${this._bundleIdConnector}${t}`,extractAssetIdFromBundle:(e,t)=>t.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,"bar"!==this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar")))throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){if("string"==typeof e)this._defaultSearchParams=e;else{const t=e;this._defaultSearchParams=Object.keys(t).map(e=>`${encodeURIComponent(e)}=${encodeURIComponent(t[e])}`).join("&")}}getAlias(e){const{alias:t,src:i}=e;return(0,r.z)(t||i,e=>"string"==typeof e?e:Array.isArray(e)?e.map(e=>e?.src??e):e?.src?e.src:e,!0)}addManifest(e){this._manifest&&(0,n.R)("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(e,t){const i=[];let n=t;Array.isArray(t)||(n=Object.entries(t).map(([e,t])=>"string"==typeof t||Array.isArray(t)?{alias:e,src:t}:{alias:e,...t})),n.forEach(t=>{const n=t.src,s=t.alias;let r;if("string"==typeof s){const t=this._createBundleAssetId(e,s);i.push(t),r=[s,t]}else{const t=s.map(t=>this._createBundleAssetId(e,t));i.push(...t),r=[...s,...t]}this.add({...t,alias:r,src:n})}),this._bundles[e]=i}add(e){const t=[];let i;Array.isArray(e)?t.push(...e):t.push(e),i=e=>{this.hasKey(e)&&(0,n.R)(`[Resolver] already has key: ${e} overwriting`)};(0,r.z)(t).forEach(e=>{const{src:t}=e;let{data:n,format:s,loadParser:a,parser:l}=e;const h=(0,r.z)(t).map(e=>"string"==typeof e?o(e):Array.isArray(e)?e:[e]),u=this.getAlias(e);Array.isArray(u)?u.forEach(i):i(u);const c=[];h.forEach(e=>{e.forEach(e=>{let t={};if("object"!=typeof e){t.src=e;for(let i=0;i<this._parsers.length;i++){const n=this._parsers[i];if(n.test(e)){t=n.parse(e);break}}}else n=e.data??n,s=e.format??s,(e.loadParser||e.parser)&&(a=e.loadParser??a,l=e.parser??l),t={...t,...e};if(!u)throw new Error(`[Resolver] alias is undefined for this asset: ${t.src}`);t=this._buildResolvedAsset(t,{aliases:u,data:n,format:s,loadParser:a,parser:l}),c.push(t)})}),u.forEach(e=>{this._assetMap[e]=c})})}resolveBundle(e){const t=(0,l.a)(e);e=(0,r.z)(e);const i={};return e.forEach(e=>{const t=this._bundles[e];if(t){const n=this.resolve(t),s={};for(const t in n){const i=n[t];s[this._extractAssetIdFromBundle(e,t)]=i}i[e]=s}}),t?i[e[0]]:i}resolveUrl(e){const t=this.resolve(e);if("string"!=typeof e){const e={};for(const i in t)e[i]=t[i].src;return e}return t.src}resolve(e){const t=(0,l.a)(e);e=(0,r.z)(e);const i={};return e.forEach(e=>{if(!this._resolverHash[e])if(this._assetMap[e]){let t=this._assetMap[e];const i=this._getPreferredOrder(t);i?.priority.forEach(e=>{i.params[e].forEach(i=>{const n=t.filter(t=>!!t[e]&&t[e]===i);n.length&&(t=n)})}),this._resolverHash[e]=t[0]}else this._resolverHash[e]=this._buildResolvedAsset({alias:[e],src:e},{});i[e]=this._resolverHash[e]}),t?i[e[0]]:i}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let t=0;t<e.length;t++){const i=e[t],n=this._preferredOrder.find(e=>e.params.format.includes(i.format));if(n)return n}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;return`${e}${/\?/.test(e)?"&":"?"}${this._defaultSearchParams}`}_buildResolvedAsset(e,t){const{aliases:i,data:n,loadParser:r,parser:a,format:o}=t;return(this._basePath||this._rootPath)&&(e.src=s.A.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=i??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...n||{},...e.data},e.loadParser=r??e.loadParser,e.parser=a??e.parser,e.format=o??e.format??e.src.split(".").pop().split("?").shift().split("#").shift(),e}}h.RETINA_PREFIX=/@([0-9\.]+)x/},1947:(e,t,i)=>{"use strict";var n=i(8602),s=i(9111),r=i(3065);class a extends r.K{constructor(e){super(),this._renderer=e,e.runners.resolutionChange.add(this)}resolutionChange(){const e=this.renderable;e._autoResolution&&e.onViewUpdate()}destroy(){const{canvasText:e}=this._renderer;e.getReferenceCount(this.currentKey)>0?e.decreaseReferenceCount(this.currentKey):this.texture&&e.returnTexture(this.texture),this._renderer.runners.resolutionChange.remove(this),this._renderer=null}}class o{constructor(e){this._renderer=e}validateRenderable(e){const t=this._getGpuText(e),i=e.styleKey;return t.currentKey!==i||e._didTextUpdate}addRenderable(e,t){const i=this._getGpuText(e);if(e._didTextUpdate){const t=e._autoResolution?this._renderer.resolution:e.resolution;i.currentKey===e.styleKey&&e.resolution===t||this._updateGpuText(e),e._didTextUpdate=!1}this._renderer.renderPipes.batch.addToBatch(i,t)}updateRenderable(e){const t=this._getGpuText(e);t._batcher.updateElement(t)}_updateGpuText(e){const t=this._getGpuText(e);t.texture&&this._renderer.canvasText.decreaseReferenceCount(t.currentKey),e._resolution=e._autoResolution?this._renderer.resolution:e.resolution,t.texture=this._renderer.canvasText.getManagedTexture(e),t.currentKey=e.styleKey,(0,s.s)(t,e)}_getGpuText(e){return e._gpuData[this._renderer.uid]||this.initGpuText(e)}initGpuText(e){const t=new a(this._renderer);return t.currentKey="--",t.renderable=e,t.transform=e.groupTransform,t.bounds={minX:0,maxX:1,minY:0,maxY:0},t.roundPixels=this._renderer._roundPixels|e._roundPixels,e._gpuData[this._renderer.uid]=t,t}destroy(){this._renderer=null}}o.extension={type:[n.Ag.WebGLPipes,n.Ag.WebGPUPipes,n.Ag.CanvasPipes],name:"text"};var l=i(1862),h=i(1819),u=i(4303),c=i(4984),d=i(4377),p=i(4214);class f{constructor(e){this._activeTextures={},this._renderer=e}getTexture(e,t,i,n){"string"==typeof e&&((0,u.t6)("8.0.0","CanvasTextSystem.getTexture: Use object TextOptions instead of separate arguments"),e={text:e,style:i,resolution:t}),e.style instanceof c.x||(e.style=new c.x(e.style)),e.textureStyle instanceof h.n||(e.textureStyle=new h.n(e.textureStyle)),"string"!=typeof e.text&&(e.text=e.text.toString());const{text:s,style:r,textureStyle:a}=e,o=e.resolution??this._renderer.resolution,{frame:l,canvasAndContext:f}=p.v.getCanvasAndContext({text:s,style:r,resolution:o}),g=(0,d.M)(f.canvas,l.width,l.height,o);if(a&&(g.source.style=a),r.trim&&(l.pad(r.padding),g.frame.copyFrom(l),g.frame.scale(1/o),g.updateUvs()),r.filters){const e=this._applyFilters(g,r.filters);return this.returnTexture(g),p.v.returnCanvasAndContext(f),e}return this._renderer.texture.initSource(g._source),p.v.returnCanvasAndContext(f),g}returnTexture(e){const t=e.source;t.resource=null,t.uploadMethodId="unknown",t.alphaMode="no-premultiply-alpha",l.W.returnTexture(e,!0)}renderTextToCanvas(){(0,u.t6)("8.10.0","CanvasTextSystem.renderTextToCanvas: no longer supported, use CanvasTextSystem.getTexture instead")}getManagedTexture(e){e._resolution=e._autoResolution?this._renderer.resolution:e.resolution;const t=e.styleKey;if(this._activeTextures[t])return this._increaseReferenceCount(t),this._activeTextures[t].texture;const i=this.getTexture({text:e.text,style:e.style,resolution:e._resolution,textureStyle:e.textureStyle});return this._activeTextures[t]={texture:i,usageCount:1},i}decreaseReferenceCount(e){const t=this._activeTextures[e];t.usageCount--,0===t.usageCount&&(this.returnTexture(t.texture),this._activeTextures[e]=null)}getReferenceCount(e){return this._activeTextures[e]?.usageCount??0}_increaseReferenceCount(e){this._activeTextures[e].usageCount++}_applyFilters(e,t){const i=this._renderer.renderTarget.renderTarget,n=this._renderer.filter.generateFilteredTexture({texture:e,filters:t});return this._renderer.renderTarget.bind(i,!1),n}destroy(){this._renderer=null;for(const e in this._activeTextures)this._activeTextures[e]&&this.returnTexture(this._activeTextures[e].texture);this._activeTextures=null}}f.extension={type:[n.Ag.WebGLSystem,n.Ag.WebGPUSystem,n.Ag.CanvasSystem],name:"canvasText"},n.XO.add(f),n.XO.add(o)},1965:(e,t,i)=>{"use strict";function n(e,t,i){const n=(e>>24&255)/255;t[i++]=(255&e)/255*n,t[i++]=(e>>8&255)/255*n,t[i++]=(e>>16&255)/255*n,t[i++]=n}i.d(t,{V:()=>n})},1980:(e,t,i)=>{"use strict";i.d(t,{B:()=>h});var n=i(2349),s=i(8605);const r={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function a(e){const t=/@group\((\d+)\)/,i=/@binding\((\d+)\)/,n=/var(<[^>]+>)? (\w+)/,s=/:\s*(\w+)/,r=/(\w+)\s*:\s*([\w\<\>]+)/g,a=/struct\s+(\w+)/,o=e.match(/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g)?.map(e=>({group:parseInt(e.match(t)[1],10),binding:parseInt(e.match(i)[1],10),name:e.match(n)[2],isUniform:"<uniform>"===e.match(n)[1],type:e.match(s)[1]}));if(!o)return{groups:[],structs:[]};const l=e.match(/struct\s+(\w+)\s*{([^}]+)}/g)?.map(e=>{const t=e.match(a)[1],i=e.match(r).reduce((e,t)=>{const[i,n]=t.split(":");return e[i.trim()]=n.trim(),e},{});return i?{name:t,members:i}:null}).filter(({name:e})=>o.some(t=>t.type===e))??[];return{groups:o,structs:l}}var o=(e=>(e[e.VERTEX=1]="VERTEX",e[e.FRAGMENT=2]="FRAGMENT",e[e.COMPUTE=4]="COMPUTE",e))(o||{});const l=Object.create(null);class h{constructor(e){this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:t,vertex:i,layout:n,gpuLayout:s,name:r}=e;if(this.name=r,this.fragment=t,this.vertex=i,t.source===i.source){const e=a(t.source);this.structsAndGroups=e}else{const e=a(i.source),n=a(t.source);this.structsAndGroups=function(e,t){const i=new Set,n=new Set;return{structs:[...e.structs,...t.structs].filter(e=>!i.has(e.name)&&(i.add(e.name),!0)),groups:[...e.groups,...t.groups].filter(e=>{const t=`${e.name}-${e.binding}`;return!n.has(t)&&(n.add(t),!0)})}}(e,n)}this.layout=n??function({groups:e}){const t=[];for(let i=0;i<e.length;i++){const n=e[i];t[n.group]||(t[n.group]={}),t[n.group][n.name]=n.binding}return t}(this.structsAndGroups),this.gpuLayout=s??function({groups:e}){const t=[];for(let i=0;i<e.length;i++){const n=e[i];t[n.group]||(t[n.group]=[]),n.isUniform?t[n.group].push({binding:n.binding,visibility:o.VERTEX|o.FRAGMENT,buffer:{type:"uniform"}}):"sampler"===n.type?t[n.group].push({binding:n.binding,visibility:o.FRAGMENT,sampler:{type:"filtering"}}):"texture_2d"===n.type&&t[n.group].push({binding:n.binding,visibility:o.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return t}(this.structsAndGroups),this.autoAssignGlobalUniforms=!(void 0===this.layout[0]?.globalUniforms),this.autoAssignLocalUniforms=!(void 0===this.layout[1]?.localUniforms),this._generateProgramKey()}_generateProgramKey(){const{vertex:e,fragment:t}=this,i=e.source+t.source+e.entryPoint+t.entryPoint;this._layoutKey=(0,n.X)(i,"program")}get attributeData(){return this._attributeData??(this._attributeData=function({source:e,entryPoint:t}){const i={},n=e.indexOf(`fn ${t}`);if(-1!==n){const t=e.indexOf("->",n);if(-1!==t){const a=e.substring(n,t),o=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let l;for(;null!==(l=o.exec(a));){const e=r[l[3]]??"float32";i[l[2]]={location:parseInt(l[1],10),format:e,stride:(0,s.m)(e).stride,offset:0,instance:!1,start:0}}}}return i}(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null,l[this._cacheKey]=null}static from(e){const t=`${e.vertex.source}:${e.fragment.source}:${e.fragment.entryPoint}:${e.vertex.entryPoint}`;return l[t]||(l[t]=new h(e),l[t]._cacheKey=t),l[t]}}},2207:(e,t,i)=>{"use strict";i.d(t,{M:()=>r});var n=i(1828);const s=[new n.b,new n.b,new n.b,new n.b];class r{constructor(e=0,t=0,i=0,n=0){this.type="rectangle",this.x=Number(e),this.y=Number(t),this.width=Number(i),this.height=Number(n)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new r(0,0,0,0)}clone(){return new r(this.x,this.y,this.width,this.height)}copyFromBounds(e){return this.x=e.minX,this.y=e.minY,this.width=e.maxX-e.minX,this.height=e.maxY-e.minY,this}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,t){return!(this.width<=0||this.height<=0)&&(e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height)}strokeContains(e,t,i,n=.5){const{width:s,height:r}=this;if(s<=0||r<=0)return!1;const a=this.x,o=this.y,l=i*(1-n),h=i-l;return e>=a-l&&e<=a+s+l&&t>=o-l&&t<=o+r+l&&!(e>a+h&&e<a+s-h&&t>o+h&&t<o+r-h)}intersects(e,t){if(!t){const t=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=t)return!1;const i=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>i}const i=this.left,n=this.right,r=this.top,a=this.bottom;if(n<=i||a<=r)return!1;const o=s[0].set(e.left,e.top),l=s[1].set(e.left,e.bottom),h=s[2].set(e.right,e.top),u=s[3].set(e.right,e.bottom);if(h.x<=o.x||l.y<=o.y)return!1;const c=Math.sign(t.a*t.d-t.b*t.c);if(0===c)return!1;if(t.apply(o,o),t.apply(l,l),t.apply(h,h),t.apply(u,u),Math.max(o.x,l.x,h.x,u.x)<=i||Math.min(o.x,l.x,h.x,u.x)>=n||Math.max(o.y,l.y,h.y,u.y)<=r||Math.min(o.y,l.y,h.y,u.y)>=a)return!1;const d=c*(l.y-o.y),p=c*(o.x-l.x),f=d*i+p*r,g=d*n+p*r,m=d*i+p*a,_=d*n+p*a;if(Math.max(f,g,m,_)<=d*o.x+p*o.y||Math.min(f,g,m,_)>=d*u.x+p*u.y)return!1;const v=c*(o.y-h.y),y=c*(h.x-o.x),b=v*i+y*r,x=v*n+y*r,T=v*i+y*a,S=v*n+y*a;return!(Math.max(b,x,T,S)<=v*o.x+y*o.y||Math.min(b,x,T,S)>=v*u.x+y*u.y)}pad(e=0,t=e){return this.x-=e,this.y-=t,this.width+=2*e,this.height+=2*t,this}fit(e){const t=Math.max(this.x,e.x),i=Math.min(this.x+this.width,e.x+e.width),n=Math.max(this.y,e.y),s=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(i-t,0),this.y=n,this.height=Math.max(s-n,0),this}ceil(e=1,t=.001){const i=Math.ceil((this.x+this.width-t)*e)/e,n=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=i-this.x,this.height=n-this.y,this}scale(e,t=e){return this.x*=e,this.y*=t,this.width*=e,this.height*=t,this}enlarge(e){const t=Math.min(this.x,e.x),i=Math.max(this.x+this.width,e.x+e.width),n=Math.min(this.y,e.y),s=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=i-t,this.y=n,this.height=s-n,this}getBounds(e){return e||(e=new r),e.copyFrom(this),e}containsRect(e){if(this.width<=0||this.height<=0)return!1;const t=e.x,i=e.y,n=e.x+e.width,s=e.y+e.height;return t>=this.x&&t<this.x+this.width&&i>=this.y&&i<this.y+this.height&&n>=this.x&&n<this.x+this.width&&s>=this.y&&s<this.y+this.height}set(e,t,i,n){return this.x=e,this.y=t,this.width=i,this.height=n,this}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}},2245:(e,t,i)=>{"use strict";i.d(t,{d:()=>l});var n=i(3381),s=i(1980),r=i(9232),a=i(4060);const o=class e extends r.M{constructor(t){super(t={...e.defaultOptions,...t}),this.enabled=!0,this._state=a.U.for2d(),this.blendMode=t.blendMode,this.padding=t.padding,"boolean"==typeof t.antialias?this.antialias=t.antialias?"on":"off":this.antialias=t.antialias,this.resolution=t.resolution,this.blendRequired=t.blendRequired,this.clipToViewport=t.clipToViewport,this.addResource("uTexture",0,1)}apply(e,t,i,n){e.applyFilter(this,t,i,n)}get blendMode(){return this._state.blendMode}set blendMode(e){this._state.blendMode=e}static from(t){const{gpu:i,gl:r,...a}=t;let o,l;return i&&(o=s.B.from(i)),r&&(l=n.M.from(r)),new e({gpuProgram:o,glProgram:l,...a})}};o.defaultOptions={blendMode:"normal",resolution:1,padding:0,antialias:"off",blendRequired:!1,clipToViewport:!0};let l=o},2276:(e,t,i)=>{"use strict";i.d(t,{n:()=>r});var n=i(6680),s=i(1675);function r(e,t,i){return t.clear(),i||(i=n.u.IDENTITY),a(e,t,i,e,!0),t.isValid||t.set(0,0,0,0),t}function a(e,t,i,r,o){let l;if(o)l=s.u.get(),l=i.copyTo(l);else{if(!e.visible||!e.measurable)return;e.updateLocalTransform();const t=e.localTransform;l=s.u.get(),l.appendFrom(t,i)}const h=t,u=!!e.effects.length;if(u&&(t=s.o.get().clear()),e.boundsArea)t.addRect(e.boundsArea,l);else{e.renderPipeId&&(t.matrix=l,t.addBounds(e.bounds));const i=e.children;for(let e=0;e<i.length;e++)a(i[e],t,l,r,!1)}if(u){for(let i=0;i<e.effects.length;i++)e.effects[i].addLocalBounds?.(t,r);h.addBounds(t,n.u.IDENTITY),s.o.return(t)}s.u.return(l)}},2291:(e,t)=>{"use strict";t.__esModule=!0;var i=/iPhone/i,n=/iPod/i,s=/iPad/i,r=/\biOS-universal(?:.+)Mac\b/i,a=/\bAndroid(?:.+)Mobile\b/i,o=/Android/i,l=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,h=/Silk/i,u=/Windows Phone/i,c=/\bWindows(?:.+)ARM\b/i,d=/BlackBerry/i,p=/BB10/i,f=/Opera Mini/i,g=/\b(CriOS|Chrome)(?:.+)Mobile/i,m=/Mobile(?:.+)Firefox\b/i,_=function(e){return void 0!==e&&"MacIntel"===e.platform&&"number"==typeof e.maxTouchPoints&&e.maxTouchPoints>1&&"undefined"==typeof MSStream};t.default=function(e){var t={userAgent:"",platform:"",maxTouchPoints:0};e||"undefined"==typeof navigator?"string"==typeof e?t.userAgent=e:e&&e.userAgent&&(t={userAgent:e.userAgent,platform:e.platform,maxTouchPoints:e.maxTouchPoints||0}):t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var v=t.userAgent,y=v.split("[FBAN");void 0!==y[1]&&(v=y[0]),void 0!==(y=v.split("Twitter"))[1]&&(v=y[0]);var b=function(e){return function(t){return t.test(e)}}(v),x={apple:{phone:b(i)&&!b(u),ipod:b(n),tablet:!b(i)&&(b(s)||_(t))&&!b(u),universal:b(r),device:(b(i)||b(n)||b(s)||b(r)||_(t))&&!b(u)},amazon:{phone:b(l),tablet:!b(l)&&b(h),device:b(l)||b(h)},android:{phone:!b(u)&&b(l)||!b(u)&&b(a),tablet:!b(u)&&!b(l)&&!b(a)&&(b(h)||b(o)),device:!b(u)&&(b(l)||b(h)||b(a)||b(o))||b(/\bokhttp\b/i)},windows:{phone:b(u),tablet:b(c),device:b(u)||b(c)},other:{blackberry:b(d),blackberry10:b(p),opera:b(f),firefox:b(m),chrome:b(g),device:b(d)||b(p)||b(f)||b(m)||b(g)},any:!1,phone:!1,tablet:!1};return x.any=x.apple.device||x.android.device||x.windows.device||x.other.device,x.phone=x.apple.phone||x.android.phone||x.windows.phone,x.tablet=x.apple.tablet||x.android.tablet||x.windows.tablet,x}},2349:(e,t,i)=>{"use strict";i.d(t,{X:()=>r});const n=Object.create(null),s=Object.create(null);function r(e,t){let i=s[e];return void 0===i&&(void 0===n[t]&&(n[t]=1),s[e]=i=n[t]++),i}},2409:(e,t,i)=>{"use strict";i.d(t,{S:()=>n});var n=(e=>(e[e.MAP_READ=1]="MAP_READ",e[e.MAP_WRITE=2]="MAP_WRITE",e[e.COPY_SRC=4]="COPY_SRC",e[e.COPY_DST=8]="COPY_DST",e[e.INDEX=16]="INDEX",e[e.VERTEX=32]="VERTEX",e[e.UNIFORM=64]="UNIFORM",e[e.STORAGE=128]="STORAGE",e[e.INDIRECT=256]="INDIRECT",e[e.QUERY_RESOLVE=512]="QUERY_RESOLVE",e[e.STATIC=1024]="STATIC",e))(n||{})},2551:(e,t,i)=>{"use strict";i.d(t,{A:()=>r,b:()=>s.a});var n=i(228),s=i.n(n);const r=s()},2556:function(e,t){!function(e){"use strict";function t(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function i(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var n,s,r,a,o,l,h,u,c,d,p,f,g,m,_,v,y,b={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},x={duration:.5,overwrite:!1,delay:0},T=1e8,S=1/T,A=2*Math.PI,E=A/4,C=0,w=Math.sqrt,P=Math.cos,I=Math.sin,M=function(e){return"string"==typeof e},R=function(e){return"function"==typeof e},L=function(e){return"number"==typeof e},k=function(e){return void 0===e},D=function(e){return"object"==typeof e},O=function(e){return!1!==e},B=function(){return"undefined"!=typeof window},G=function(e){return R(e)||M(e)},F="function"==typeof ArrayBuffer&&ArrayBuffer.isView||function(){},U=Array.isArray,N=/(?:-?\.?\d|\.)+/gi,z=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,H=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,V=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,W=/[+-]=-?[.\d]+/,j=/[^,'"\[\]\s]+/gi,X=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,Y={},K={},q=function(e){return(K=Ce(e,Y))&&Wi},$=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},Q=function(e,t){return!t&&console.warn(e)},Z=function(e,t){return e&&(Y[e]=t)&&K&&(K[e]=t)||Y},J=function(){return 0},ee={suppressEvents:!0,isStart:!0,kill:!1},te={suppressEvents:!0,kill:!1},ie={suppressEvents:!0},ne={},se=[],re={},ae={},oe={},le=30,he=[],ue="",ce=function(e){var t,i,n=e[0];if(D(n)||R(n)||(e=[e]),!(t=(n._gsap||{}).harness)){for(i=he.length;i--&&!he[i].targetTest(n););t=he[i]}for(i=e.length;i--;)e[i]&&(e[i]._gsap||(e[i]._gsap=new ei(e[i],t)))||e.splice(i,1);return e},de=function(e){return e._gsap||ce(ht(e))[0]._gsap},pe=function(e,t,i){return(i=e[t])&&R(i)?e[t]():k(i)&&e.getAttribute&&e.getAttribute(t)||i},fe=function(e,t){return(e=e.split(",")).forEach(t)||e},ge=function(e){return Math.round(1e5*e)/1e5||0},me=function(e){return Math.round(1e7*e)/1e7||0},_e=function(e,t){var i=t.charAt(0),n=parseFloat(t.substr(2));return e=parseFloat(e),"+"===i?e+n:"-"===i?e-n:"*"===i?e*n:e/n},ve=function(e,t){for(var i=t.length,n=0;e.indexOf(t[n])<0&&++n<i;);return n<i},ye=function(){var e,t,i=se.length,n=se.slice(0);for(re={},se.length=0,e=0;e<i;e++)(t=n[e])&&t._lazy&&(t.render(t._lazy[0],t._lazy[1],!0)._lazy=0)},be=function(e){return!!(e._initted||e._startAt||e.add)},xe=function(e,t,i,n){se.length&&!s&&ye(),e.render(t,i,n||!!(s&&t<0&&be(e))),se.length&&!s&&ye()},Te=function(e){var t=parseFloat(e);return(t||0===t)&&(e+"").match(j).length<2?t:M(e)?e.trim():e},Se=function(e){return e},Ae=function(e,t){for(var i in t)i in e||(e[i]=t[i]);return e},Ee=function(e){return function(t,i){for(var n in i)n in t||"duration"===n&&e||"ease"===n||(t[n]=i[n])}},Ce=function(e,t){for(var i in t)e[i]=t[i];return e},we=function e(t,i){for(var n in i)"__proto__"!==n&&"constructor"!==n&&"prototype"!==n&&(t[n]=D(i[n])?e(t[n]||(t[n]={}),i[n]):i[n]);return t},Pe=function(e,t){var i,n={};for(i in e)i in t||(n[i]=e[i]);return n},Ie=function(e){var t=e.parent||a,i=e.keyframes?Ee(U(e.keyframes)):Ae;if(O(e.inherit))for(;t;)i(e,t.vars.defaults),t=t.parent||t._dp;return e},Me=function(e,t){for(var i=e.length,n=i===t.length;n&&i--&&e[i]===t[i];);return i<0},Re=function(e,t,i,n,s){void 0===i&&(i="_first"),void 0===n&&(n="_last");var r,a=e[n];if(s)for(r=t[s];a&&a[s]>r;)a=a._prev;return a?(t._next=a._next,a._next=t):(t._next=e[i],e[i]=t),t._next?t._next._prev=t:e[n]=t,t._prev=a,t.parent=t._dp=e,t},Le=function(e,t,i,n){void 0===i&&(i="_first"),void 0===n&&(n="_last");var s=t._prev,r=t._next;s?s._next=r:e[i]===t&&(e[i]=r),r?r._prev=s:e[n]===t&&(e[n]=s),t._next=t._prev=t.parent=null},ke=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},De=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var i=e;i;)i._dirty=1,i=i.parent;return e},Oe=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},Be=function(e,t,i,n){return e._startAt&&(s?e._startAt.revert(te):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,n))},Ge=function e(t){return!t||t._ts&&e(t.parent)},Fe=function(e){return e._repeat?Ue(e._tTime,e=e.duration()+e._rDelay)*e:0},Ue=function(e,t){var i=Math.floor(e=me(e/t));return e&&i===e?i-1:i},Ne=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},ze=function(e){return e._end=me(e._start+(e._tDur/Math.abs(e._ts||e._rts||S)||0))},He=function(e,t){var i=e._dp;return i&&i.smoothChildTiming&&e._ts&&(e._start=me(i._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),ze(e),i._dirty||De(i,e)),e},Ve=function(e,t){var i;if((t._time||!t._dur&&t._initted||t._start<e._time&&(t._dur||!t.add))&&(i=Ne(e.rawTime(),t),(!t._dur||nt(0,t.totalDuration(),i)-t._tTime>S)&&t.render(i,!0)),De(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(i=e;i._dp;)i.rawTime()>=0&&i.totalTime(i._tTime),i=i._dp;e._zTime=-S}},We=function(e,t,i,n){return t.parent&&ke(t),t._start=me((L(i)?i:i||e!==a?et(e,i,t):e._time)+t._delay),t._end=me(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),Re(e,t,"_first","_last",e._sort?"_start":0),Ke(t)||(e._recent=t),n||Ve(e,t),e._ts<0&&He(e,e._tTime),e},je=function(e,t){return(Y.ScrollTrigger||$("scrollTrigger",t))&&Y.ScrollTrigger.create(t,e)},Xe=function(e,t,i,n,r){return hi(e,t,r),e._initted?!i&&e._pt&&!s&&(e._dur&&!1!==e.vars.lazy||!e._dur&&e.vars.lazy)&&c!==Ut.frame?(se.push(e),e._lazy=[r,n],1):void 0:1},Ye=function e(t){var i=t.parent;return i&&i._ts&&i._initted&&!i._lock&&(i.rawTime()<0||e(i))},Ke=function(e){var t=e.data;return"isFromStart"===t||"isStart"===t},qe=function(e,t,i,n){var r,a,o,l=e.ratio,h=t<0||!t&&(!e._start&&Ye(e)&&(e._initted||!Ke(e))||(e._ts<0||e._dp._ts<0)&&!Ke(e))?0:1,u=e._rDelay,c=0;if(u&&e._repeat&&(c=nt(0,e._tDur,t),a=Ue(c,u),e._yoyo&&1&a&&(h=1-h),a!==Ue(e._tTime,u)&&(l=1-h,e.vars.repeatRefresh&&e._initted&&e.invalidate())),h!==l||s||n||e._zTime===S||!t&&e._zTime){if(!e._initted&&Xe(e,t,n,i,c))return;for(o=e._zTime,e._zTime=t||(i?S:0),i||(i=t&&!o),e.ratio=h,e._from&&(h=1-h),e._time=0,e._tTime=c,r=e._pt;r;)r.r(h,r.d),r=r._next;t<0&&Be(e,t,i,!0),e._onUpdate&&!i&&Ct(e,"onUpdate"),c&&e._repeat&&!i&&e.parent&&Ct(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===h&&(h&&ke(e,1),i||s||(Ct(e,h?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)},$e=function(e,t,i){var n;if(i>t)for(n=e._first;n&&n._start<=i;){if("isPause"===n.data&&n._start>t)return n;n=n._next}else for(n=e._last;n&&n._start>=i;){if("isPause"===n.data&&n._start<t)return n;n=n._prev}},Qe=function(e,t,i,n){var s=e._repeat,r=me(t)||0,a=e._tTime/e._tDur;return a&&!n&&(e._time*=r/e._dur),e._dur=r,e._tDur=s?s<0?1e10:me(r*(s+1)+e._rDelay*s):r,a>0&&!n&&He(e,e._tTime=e._tDur*a),e.parent&&ze(e),i||De(e.parent,e),e},Ze=function(e){return e instanceof ii?De(e):Qe(e,e._dur)},Je={_start:0,endTime:J,totalDuration:J},et=function e(t,i,n){var s,r,a,o=t.labels,l=t._recent||Je,h=t.duration()>=T?l.endTime(!1):t._dur;return M(i)&&(isNaN(i)||i in o)?(r=i.charAt(0),a="%"===i.substr(-1),s=i.indexOf("="),"<"===r||">"===r?(s>=0&&(i=i.replace(/=/,"")),("<"===r?l._start:l.endTime(l._repeat>=0))+(parseFloat(i.substr(1))||0)*(a?(s<0?l:n).totalDuration()/100:1)):s<0?(i in o||(o[i]=h),o[i]):(r=parseFloat(i.charAt(s-1)+i.substr(s+1)),a&&n&&(r=r/100*(U(n)?n[0]:n).totalDuration()),s>1?e(t,i.substr(0,s-1),n)+r:h+r)):null==i?h:+i},tt=function(e,t,i){var n,s,r=L(t[1]),a=(r?2:1)+(e<2?0:1),o=t[a];if(r&&(o.duration=t[1]),o.parent=i,e){for(n=o,s=i;s&&!("immediateRender"in n);)n=s.vars.defaults||{},s=O(s.vars.inherit)&&s.parent;o.immediateRender=O(n.immediateRender),e<2?o.runBackwards=1:o.startAt=t[a-1]}return new mi(t[0],o,t[a+1])},it=function(e,t){return e||0===e?t(e):t},nt=function(e,t,i){return i<e?e:i>t?t:i},st=function(e,t){return M(e)&&(t=X.exec(e))?t[1]:""},rt=function(e,t,i){return it(i,function(i){return nt(e,t,i)})},at=[].slice,ot=function(e,t){return e&&D(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&D(e[0]))&&!e.nodeType&&e!==o},lt=function(e,t,i){return void 0===i&&(i=[]),e.forEach(function(e){var n;return M(e)&&!t||ot(e,1)?(n=i).push.apply(n,ht(e)):i.push(e)})||i},ht=function(e,t,i){return r&&!t&&r.selector?r.selector(e):!M(e)||i||!l&&Nt()?U(e)?lt(e,i):ot(e)?at.call(e,0):e?[e]:[]:at.call((t||h).querySelectorAll(e),0)},ut=function(e){return e=ht(e)[0]||Q("Invalid scope")||{},function(t){var i=e.current||e.nativeElement||e;return ht(t,i.querySelectorAll?i:i===e?Q("Invalid scope")||h.createElement("div"):e)}},ct=function(e){return e.sort(function(){return.5-Math.random()})},dt=function(e){if(R(e))return e;var t=D(e)?e:{each:e},i=qt(t.ease),n=t.from||0,s=parseFloat(t.base)||0,r={},a=n>0&&n<1,o=isNaN(n)||a,l=t.axis,h=n,u=n;return M(n)?h=u={center:.5,edges:.5,end:1}[n]||0:!a&&o&&(h=n[0],u=n[1]),function(e,a,c){var d,p,f,g,m,_,v,y,b,x=(c||t).length,S=r[x];if(!S){if(!(b="auto"===t.grid?0:(t.grid||[1,T])[1])){for(v=-T;v<(v=c[b++].getBoundingClientRect().left)&&b<x;);b<x&&b--}for(S=r[x]=[],d=o?Math.min(b,x)*h-.5:n%b,p=b===T?0:o?x*u/b-.5:n/b|0,v=0,y=T,_=0;_<x;_++)f=_%b-d,g=p-(_/b|0),S[_]=m=l?Math.abs("y"===l?g:f):w(f*f+g*g),m>v&&(v=m),m<y&&(y=m);"random"===n&&ct(S),S.max=v-y,S.min=y,S.v=x=(parseFloat(t.amount)||parseFloat(t.each)*(b>x?x-1:l?"y"===l?x/b:b:Math.max(b,x/b))||0)*("edges"===n?-1:1),S.b=x<0?s-x:s,S.u=st(t.amount||t.each)||0,i=i&&x<0?Yt(i):i}return x=(S[e]-S.min)/S.max||0,me(S.b+(i?i(x):x)*S.v)+S.u}},pt=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(i){var n=me(Math.round(parseFloat(i)/e)*e*t);return(n-n%1)/t+(L(i)?0:st(i))}},ft=function(e,t){var i,n,s=U(e);return!s&&D(e)&&(i=s=e.radius||T,e.values?(e=ht(e.values),(n=!L(e[0]))&&(i*=i)):e=pt(e.increment)),it(t,s?R(e)?function(t){return n=e(t),Math.abs(n-t)<=i?n:t}:function(t){for(var s,r,a=parseFloat(n?t.x:t),o=parseFloat(n?t.y:0),l=T,h=0,u=e.length;u--;)(s=n?(s=e[u].x-a)*s+(r=e[u].y-o)*r:Math.abs(e[u]-a))<l&&(l=s,h=u);return h=!i||l<=i?e[h]:t,n||h===t||L(t)?h:h+st(t)}:pt(e))},gt=function(e,t,i,n){return it(U(e)?!t:!0===i?!!(i=0):!n,function(){return U(e)?e[~~(Math.random()*e.length)]:(i=i||1e-5)&&(n=i<1?Math.pow(10,(i+"").length-2):1)&&Math.floor(Math.round((e-i/2+Math.random()*(t-e+.99*i))/i)*i*n)/n})},mt=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(e){return t.reduce(function(e,t){return t(e)},e)}},_t=function(e,t){return function(i){return e(parseFloat(i))+(t||st(i))}},vt=function(e,t,i){return St(e,t,0,1,i)},yt=function(e,t,i){return it(i,function(i){return e[~~t(i)]})},bt=function e(t,i,n){var s=i-t;return U(t)?yt(t,e(0,t.length),i):it(n,function(e){return(s+(e-t)%s)%s+t})},xt=function e(t,i,n){var s=i-t,r=2*s;return U(t)?yt(t,e(0,t.length-1),i):it(n,function(e){return t+((e=(r+(e-t)%r)%r||0)>s?r-e:e)})},Tt=function(e){for(var t,i,n,s,r=0,a="";~(t=e.indexOf("random(",r));)n=e.indexOf(")",t),s="["===e.charAt(t+7),i=e.substr(t+7,n-t-7).match(s?j:N),a+=e.substr(r,t-r)+gt(s?i:+i[0],s?0:+i[1],+i[2]||1e-5),r=n+1;return a+e.substr(r,e.length-r)},St=function(e,t,i,n,s){var r=t-e,a=n-i;return it(s,function(t){return i+((t-e)/r*a||0)})},At=function e(t,i,n,s){var r=isNaN(t+i)?0:function(e){return(1-e)*t+e*i};if(!r){var a,o,l,h,u,c=M(t),d={};if(!0===n&&(s=1)&&(n=null),c)t={p:t},i={p:i};else if(U(t)&&!U(i)){for(l=[],h=t.length,u=h-2,o=1;o<h;o++)l.push(e(t[o-1],t[o]));h--,r=function(e){e*=h;var t=Math.min(u,~~e);return l[t](e-t)},n=i}else s||(t=Ce(U(t)?[]:{},t));if(!l){for(a in i)ai.call(d,t,a,"get",i[a]);r=function(e){return Ei(e,d)||(c?t.p:t)}}}return it(n,r)},Et=function(e,t,i){var n,s,r,a=e.labels,o=T;for(n in a)(s=a[n]-t)<0==!!i&&s&&o>(s=Math.abs(s))&&(r=n,o=s);return r},Ct=function(e,t,i){var n,s,a,o=e.vars,l=o[t],h=r,u=e._ctx;if(l)return n=o[t+"Params"],s=o.callbackScope||e,i&&se.length&&ye(),u&&(r=u),a=n?l.apply(s,n):l.call(s),r=h,a},wt=function(e){return ke(e),e.scrollTrigger&&e.scrollTrigger.kill(!!s),e.progress()<1&&Ct(e,"onInterrupt"),e},Pt=[],It=function(e){if(e)if(e=!e.name&&e.default||e,B()||e.headless){var t=e.name,i=R(e),n=t&&!i&&e.init?function(){this._props=[]}:e,s={init:J,render:Ei,add:ai,kill:wi,modifier:Ci,rawVars:0},r={targetTest:0,get:0,getSetter:xi,aliases:{},register:0};if(Nt(),e!==n){if(ae[t])return;Ae(n,Ae(Pe(e,s),r)),Ce(n.prototype,Ce(s,Pe(e,r))),ae[n.prop=t]=n,e.targetTest&&(he.push(n),ne[t]=1),t=("css"===t?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}Z(t,n),e.register&&e.register(Wi,n,Mi)}else Pt.push(e)},Mt=255,Rt={aqua:[0,Mt,Mt],lime:[0,Mt,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,Mt],navy:[0,0,128],white:[Mt,Mt,Mt],olive:[128,128,0],yellow:[Mt,Mt,0],orange:[Mt,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[Mt,0,0],pink:[Mt,192,203],cyan:[0,Mt,Mt],transparent:[Mt,Mt,Mt,0]},Lt=function(e,t,i){return(6*(e+=e<0?1:e>1?-1:0)<1?t+(i-t)*e*6:e<.5?i:3*e<2?t+(i-t)*(2/3-e)*6:t)*Mt+.5|0},kt=function(e,t,i){var n,s,r,a,o,l,h,u,c,d,p=e?L(e)?[e>>16,e>>8&Mt,e&Mt]:0:Rt.black;if(!p){if(","===e.substr(-1)&&(e=e.substr(0,e.length-1)),Rt[e])p=Rt[e];else if("#"===e.charAt(0)){if(e.length<6&&(n=e.charAt(1),s=e.charAt(2),r=e.charAt(3),e="#"+n+n+s+s+r+r+(5===e.length?e.charAt(4)+e.charAt(4):"")),9===e.length)return[(p=parseInt(e.substr(1,6),16))>>16,p>>8&Mt,p&Mt,parseInt(e.substr(7),16)/255];p=[(e=parseInt(e.substr(1),16))>>16,e>>8&Mt,e&Mt]}else if("hsl"===e.substr(0,3))if(p=d=e.match(N),t){if(~e.indexOf("="))return p=e.match(z),i&&p.length<4&&(p[3]=1),p}else a=+p[0]%360/360,o=+p[1]/100,n=2*(l=+p[2]/100)-(s=l<=.5?l*(o+1):l+o-l*o),p.length>3&&(p[3]*=1),p[0]=Lt(a+1/3,n,s),p[1]=Lt(a,n,s),p[2]=Lt(a-1/3,n,s);else p=e.match(N)||Rt.transparent;p=p.map(Number)}return t&&!d&&(n=p[0]/Mt,s=p[1]/Mt,r=p[2]/Mt,l=((h=Math.max(n,s,r))+(u=Math.min(n,s,r)))/2,h===u?a=o=0:(c=h-u,o=l>.5?c/(2-h-u):c/(h+u),a=h===n?(s-r)/c+(s<r?6:0):h===s?(r-n)/c+2:(n-s)/c+4,a*=60),p[0]=~~(a+.5),p[1]=~~(100*o+.5),p[2]=~~(100*l+.5)),i&&p.length<4&&(p[3]=1),p},Dt=function(e){var t=[],i=[],n=-1;return e.split(Bt).forEach(function(e){var s=e.match(H)||[];t.push.apply(t,s),i.push(n+=s.length+1)}),t.c=i,t},Ot=function(e,t,i){var n,s,r,a,o="",l=(e+o).match(Bt),h=t?"hsla(":"rgba(",u=0;if(!l)return e;if(l=l.map(function(e){return(e=kt(e,t,1))&&h+(t?e[0]+","+e[1]+"%,"+e[2]+"%,"+e[3]:e.join(","))+")"}),i&&(r=Dt(e),(n=i.c).join(o)!==r.c.join(o)))for(a=(s=e.replace(Bt,"1").split(H)).length-1;u<a;u++)o+=s[u]+(~n.indexOf(u)?l.shift()||h+"0,0,0,0)":(r.length?r:l.length?l:i).shift());if(!s)for(a=(s=e.split(Bt)).length-1;u<a;u++)o+=s[u]+l[u];return o+s[a]},Bt=function(){var e,t="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b";for(e in Rt)t+="|"+e+"\\b";return new RegExp(t+")","gi")}(),Gt=/hsl[a]?\(/,Ft=function(e){var t,i=e.join(" ");if(Bt.lastIndex=0,Bt.test(i))return t=Gt.test(i),e[1]=Ot(e[1],t),e[0]=Ot(e[0],t,Dt(e[1])),!0},Ut=function(){var e,t,i,n,s,r,a=Date.now,c=500,d=33,f=a(),g=f,m=1e3/240,_=m,v=[],y=function i(o){var l,h,u,p,y=a()-g,b=!0===o;if((y>c||y<0)&&(f+=y-d),((l=(u=(g+=y)-f)-_)>0||b)&&(p=++n.frame,s=u-1e3*n.time,n.time=u/=1e3,_+=l+(l>=m?4:m-l),h=1),b||(e=t(i)),h)for(r=0;r<v.length;r++)v[r](u,s,p,o)};return n={time:0,frame:0,tick:function(){y(!0)},deltaRatio:function(e){return s/(1e3/(e||60))},wake:function(){u&&(!l&&B()&&(o=l=window,h=o.document||{},Y.gsap=Wi,(o.gsapVersions||(o.gsapVersions=[])).push(Wi.version),q(K||o.GreenSockGlobals||!o.gsap&&o||{}),Pt.forEach(It)),i="undefined"!=typeof requestAnimationFrame&&requestAnimationFrame,e&&n.sleep(),t=i||function(e){return setTimeout(e,_-1e3*n.time+1|0)},p=1,y(2))},sleep:function(){(i?cancelAnimationFrame:clearTimeout)(e),p=0,t=J},lagSmoothing:function(e,t){c=e||1/0,d=Math.min(t||33,c)},fps:function(e){m=1e3/(e||240),_=1e3*n.time+m},add:function(e,t,i){var s=t?function(t,i,r,a){e(t,i,r,a),n.remove(s)}:e;return n.remove(e),v[i?"unshift":"push"](s),Nt(),s},remove:function(e,t){~(t=v.indexOf(e))&&v.splice(t,1)&&r>=t&&r--},_listeners:v}}(),Nt=function(){return!p&&Ut.wake()},zt={},Ht=/^[\d.\-M][\d.\-,\s]/,Vt=/["']/g,Wt=function(e){for(var t,i,n,s={},r=e.substr(1,e.length-3).split(":"),a=r[0],o=1,l=r.length;o<l;o++)i=r[o],t=o!==l-1?i.lastIndexOf(","):i.length,n=i.substr(0,t),s[a]=isNaN(n)?n.replace(Vt,"").trim():+n,a=i.substr(t+1).trim();return s},jt=function(e){var t=e.indexOf("(")+1,i=e.indexOf(")"),n=e.indexOf("(",t);return e.substring(t,~n&&n<i?e.indexOf(")",i+1):i)},Xt=function(e){var t=(e+"").split("("),i=zt[t[0]];return i&&t.length>1&&i.config?i.config.apply(null,~e.indexOf("{")?[Wt(t[1])]:jt(e).split(",").map(Te)):zt._CE&&Ht.test(e)?zt._CE("",e):i},Yt=function(e){return function(t){return 1-e(1-t)}},Kt=function e(t,i){for(var n,s=t._first;s;)s instanceof ii?e(s,i):!s.vars.yoyoEase||s._yoyo&&s._repeat||s._yoyo===i||(s.timeline?e(s.timeline,i):(n=s._ease,s._ease=s._yEase,s._yEase=n,s._yoyo=i)),s=s._next},qt=function(e,t){return e&&(R(e)?e:zt[e]||Xt(e))||t},$t=function(e,t,i,n){void 0===i&&(i=function(e){return 1-t(1-e)}),void 0===n&&(n=function(e){return e<.5?t(2*e)/2:1-t(2*(1-e))/2});var s,r={easeIn:t,easeOut:i,easeInOut:n};return fe(e,function(e){for(var t in zt[e]=Y[e]=r,zt[s=e.toLowerCase()]=i,r)zt[s+("easeIn"===t?".in":"easeOut"===t?".out":".inOut")]=zt[e+"."+t]=r[t]}),r},Qt=function(e){return function(t){return t<.5?(1-e(1-2*t))/2:.5+e(2*(t-.5))/2}},Zt=function e(t,i,n){var s=i>=1?i:1,r=(n||(t?.3:.45))/(i<1?i:1),a=r/A*(Math.asin(1/s)||0),o=function(e){return 1===e?1:s*Math.pow(2,-10*e)*I((e-a)*r)+1},l="out"===t?o:"in"===t?function(e){return 1-o(1-e)}:Qt(o);return r=A/r,l.config=function(i,n){return e(t,i,n)},l},Jt=function e(t,i){void 0===i&&(i=1.70158);var n=function(e){return e?--e*e*((i+1)*e+i)+1:0},s="out"===t?n:"in"===t?function(e){return 1-n(1-e)}:Qt(n);return s.config=function(i){return e(t,i)},s};fe("Linear,Quad,Cubic,Quart,Quint,Strong",function(e,t){var i=t<5?t+1:t;$t(e+",Power"+(i-1),t?function(e){return Math.pow(e,i)}:function(e){return e},function(e){return 1-Math.pow(1-e,i)},function(e){return e<.5?Math.pow(2*e,i)/2:1-Math.pow(2*(1-e),i)/2})}),zt.Linear.easeNone=zt.none=zt.Linear.easeIn,$t("Elastic",Zt("in"),Zt("out"),Zt()),f=7.5625,_=2*(m=1/(g=2.75)),v=2.5*m,$t("Bounce",function(e){return 1-y(1-e)},y=function(e){return e<m?f*e*e:e<_?f*Math.pow(e-1.5/g,2)+.75:e<v?f*(e-=2.25/g)*e+.9375:f*Math.pow(e-2.625/g,2)+.984375}),$t("Expo",function(e){return Math.pow(2,10*(e-1))*e+e*e*e*e*e*e*(1-e)}),$t("Circ",function(e){return-(w(1-e*e)-1)}),$t("Sine",function(e){return 1===e?1:1-P(e*E)}),$t("Back",Jt("in"),Jt("out"),Jt()),zt.SteppedEase=zt.steps=Y.SteppedEase={config:function(e,t){void 0===e&&(e=1);var i=1/e,n=e+(t?0:1),s=t?1:0,r=1-S;return function(e){return((n*nt(0,r,e)|0)+s)*i}}},x.ease=zt["quad.out"],fe("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(e){return ue+=e+","+e+"Params,"});var ei=function(e,t){this.id=C++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:pe,this.set=t?t.getSetter:xi},ti=function(){function e(e){this.vars=e,this._delay=+e.delay||0,(this._repeat=e.repeat===1/0?-2:e.repeat||0)&&(this._rDelay=e.repeatDelay||0,this._yoyo=!!e.yoyo||!!e.yoyoEase),this._ts=1,Qe(this,+e.duration,1,1),this.data=e.data,r&&(this._ctx=r,r.data.push(this)),p||Ut.wake()}var t=e.prototype;return t.delay=function(e){return e||0===e?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+e-this._delay),this._delay=e,this):this._delay},t.duration=function(e){return arguments.length?this.totalDuration(this._repeat>0?e+(e+this._rDelay)*this._repeat:e):this.totalDuration()&&this._dur},t.totalDuration=function(e){return arguments.length?(this._dirty=0,Qe(this,this._repeat<0?e:(e-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},t.totalTime=function(e,t){if(Nt(),!arguments.length)return this._tTime;var i=this._dp;if(i&&i.smoothChildTiming&&this._ts){for(He(this,e),!i._dp||i.parent||Ve(i,this);i&&i.parent;)i.parent._time!==i._start+(i._ts>=0?i._tTime/i._ts:(i.totalDuration()-i._tTime)/-i._ts)&&i.totalTime(i._tTime,!0),i=i.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&e<this._tDur||this._ts<0&&e>0||!this._tDur&&!e)&&We(this._dp,this,this._start-this._delay)}return(this._tTime!==e||!this._dur&&!t||this._initted&&Math.abs(this._zTime)===S||!e&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=e),xe(this,e,t)),this},t.time=function(e,t){return arguments.length?this.totalTime(Math.min(this.totalDuration(),e+Fe(this))%(this._dur+this._rDelay)||(e?this._dur:0),t):this._time},t.totalProgress=function(e,t){return arguments.length?this.totalTime(this.totalDuration()*e,t):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>=0&&this._initted?1:0},t.progress=function(e,t){return arguments.length?this.totalTime(this.duration()*(!this._yoyo||1&this.iteration()?e:1-e)+Fe(this),t):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},t.iteration=function(e,t){var i=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(e-1)*i,t):this._repeat?Ue(this._tTime,i)+1:1},t.timeScale=function(e,t){if(!arguments.length)return this._rts===-S?0:this._rts;if(this._rts===e)return this;var i=this.parent&&this._ts?Ne(this.parent._time,this):this._tTime;return this._rts=+e||0,this._ts=this._ps||e===-S?0:this._rts,this.totalTime(nt(-Math.abs(this._delay),this.totalDuration(),i),!1!==t),ze(this),Oe(this)},t.paused=function(e){return arguments.length?(this._ps!==e&&(this._ps=e,e?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Nt(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,1===this.progress()&&Math.abs(this._zTime)!==S&&(this._tTime-=S)))),this):this._ps},t.startTime=function(e){if(arguments.length){this._start=e;var t=this.parent||this._dp;return t&&(t._sort||!this.parent)&&We(t,this,e-this._delay),this}return this._start},t.endTime=function(e){return this._start+(O(e)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},t.rawTime=function(e){var t=this.parent||this._dp;return t?e&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?Ne(t.rawTime(e),this):this._tTime:this._tTime},t.revert=function(e){void 0===e&&(e=ie);var t=s;return s=e,be(this)&&(this.timeline&&this.timeline.revert(e),this.totalTime(-.01,e.suppressEvents)),"nested"!==this.data&&!1!==e.kill&&this.kill(),s=t,this},t.globalTime=function(e){for(var t=this,i=arguments.length?e:t.rawTime();t;)i=t._start+i/(Math.abs(t._ts)||1),t=t._dp;return!this.parent&&this._sat?this._sat.globalTime(e):i},t.repeat=function(e){return arguments.length?(this._repeat=e===1/0?-2:e,Ze(this)):-2===this._repeat?1/0:this._repeat},t.repeatDelay=function(e){if(arguments.length){var t=this._time;return this._rDelay=e,Ze(this),t?this.time(t):this}return this._rDelay},t.yoyo=function(e){return arguments.length?(this._yoyo=e,this):this._yoyo},t.seek=function(e,t){return this.totalTime(et(this,e),O(t))},t.restart=function(e,t){return this.play().totalTime(e?-this._delay:0,O(t)),this._dur||(this._zTime=-S),this},t.play=function(e,t){return null!=e&&this.seek(e,t),this.reversed(!1).paused(!1)},t.reverse=function(e,t){return null!=e&&this.seek(e||this.totalDuration(),t),this.reversed(!0).paused(!1)},t.pause=function(e,t){return null!=e&&this.seek(e,t),this.paused(!0)},t.resume=function(){return this.paused(!1)},t.reversed=function(e){return arguments.length?(!!e!==this.reversed()&&this.timeScale(-this._rts||(e?-S:0)),this):this._rts<0},t.invalidate=function(){return this._initted=this._act=0,this._zTime=-S,this},t.isActive=function(){var e,t=this.parent||this._dp,i=this._start;return!(t&&!(this._ts&&this._initted&&t.isActive()&&(e=t.rawTime(!0))>=i&&e<this.endTime(!0)-S))},t.eventCallback=function(e,t,i){var n=this.vars;return arguments.length>1?(t?(n[e]=t,i&&(n[e+"Params"]=i),"onUpdate"===e&&(this._onUpdate=t)):delete n[e],this):n[e]},t.then=function(e){var t=this;return new Promise(function(i){var n=R(e)?e:Se,s=function(){var e=t.then;t.then=null,R(n)&&(n=n(t))&&(n.then||n===t)&&(t.then=e),i(n),t.then=e};t._initted&&1===t.totalProgress()&&t._ts>=0||!t._tTime&&t._ts<0?s():t._prom=s})},t.kill=function(){wt(this)},e}();Ae(ti.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-S,_prom:0,_ps:!1,_rts:1});var ii=function(e){function n(t,n){var s;return void 0===t&&(t={}),(s=e.call(this,t)||this).labels={},s.smoothChildTiming=!!t.smoothChildTiming,s.autoRemoveChildren=!!t.autoRemoveChildren,s._sort=O(t.sortChildren),a&&We(t.parent||a,i(s),n),t.reversed&&s.reverse(),t.paused&&s.paused(!0),t.scrollTrigger&&je(i(s),t.scrollTrigger),s}t(n,e);var r=n.prototype;return r.to=function(e,t,i){return tt(0,arguments,this),this},r.from=function(e,t,i){return tt(1,arguments,this),this},r.fromTo=function(e,t,i,n){return tt(2,arguments,this),this},r.set=function(e,t,i){return t.duration=0,t.parent=this,Ie(t).repeatDelay||(t.repeat=0),t.immediateRender=!!t.immediateRender,new mi(e,t,et(this,i),1),this},r.call=function(e,t,i){return We(this,mi.delayedCall(0,e,t),i)},r.staggerTo=function(e,t,i,n,s,r,a){return i.duration=t,i.stagger=i.stagger||n,i.onComplete=r,i.onCompleteParams=a,i.parent=this,new mi(e,i,et(this,s)),this},r.staggerFrom=function(e,t,i,n,s,r,a){return i.runBackwards=1,Ie(i).immediateRender=O(i.immediateRender),this.staggerTo(e,t,i,n,s,r,a)},r.staggerFromTo=function(e,t,i,n,s,r,a,o){return n.startAt=i,Ie(n).immediateRender=O(n.immediateRender),this.staggerTo(e,t,n,s,r,a,o)},r.render=function(e,t,i){var n,r,o,l,h,u,c,d,p,f,g,m,_=this._time,v=this._dirty?this.totalDuration():this._tDur,y=this._dur,b=e<=0?0:me(e),x=this._zTime<0!=e<0&&(this._initted||!y);if(this!==a&&b>v&&e>=0&&(b=v),b!==this._tTime||i||x){if(_!==this._time&&y&&(b+=this._time-_,e+=this._time-_),n=b,p=this._start,u=!(d=this._ts),x&&(y||(_=this._zTime),(e||!t)&&(this._zTime=e)),this._repeat){if(g=this._yoyo,h=y+this._rDelay,this._repeat<-1&&e<0)return this.totalTime(100*h+e,t,i);if(n=me(b%h),b===v?(l=this._repeat,n=y):((l=~~(f=me(b/h)))&&l===f&&(n=y,l--),n>y&&(n=y)),f=Ue(this._tTime,h),!_&&this._tTime&&f!==l&&this._tTime-f*h-this._dur<=0&&(f=l),g&&1&l&&(n=y-n,m=1),l!==f&&!this._lock){var T=g&&1&f,A=T===(g&&1&l);if(l<f&&(T=!T),_=T?0:b%y?y:b,this._lock=1,this.render(_||(m?0:me(l*h)),t,!y)._lock=0,this._tTime=b,!t&&this.parent&&Ct(this,"onRepeat"),this.vars.repeatRefresh&&!m&&(this.invalidate()._lock=1),_&&_!==this._time||u!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(y=this._dur,v=this._tDur,A&&(this._lock=2,_=T?y:-1e-4,this.render(_,!0),this.vars.repeatRefresh&&!m&&this.invalidate()),this._lock=0,!this._ts&&!u)return this;Kt(this,m)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(c=$e(this,me(_),me(n)))&&(b-=n-(n=c._start)),this._tTime=b,this._time=n,this._act=!d,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=e,_=0),!_&&b&&!t&&!f&&(Ct(this,"onStart"),this._tTime!==b))return this;if(n>=_&&e>=0)for(r=this._first;r;){if(o=r._next,(r._act||n>=r._start)&&r._ts&&c!==r){if(r.parent!==this)return this.render(e,t,i);if(r.render(r._ts>0?(n-r._start)*r._ts:(r._dirty?r.totalDuration():r._tDur)+(n-r._start)*r._ts,t,i),n!==this._time||!this._ts&&!u){c=0,o&&(b+=this._zTime=-S);break}}r=o}else{r=this._last;for(var E=e<0?e:n;r;){if(o=r._prev,(r._act||E<=r._end)&&r._ts&&c!==r){if(r.parent!==this)return this.render(e,t,i);if(r.render(r._ts>0?(E-r._start)*r._ts:(r._dirty?r.totalDuration():r._tDur)+(E-r._start)*r._ts,t,i||s&&be(r)),n!==this._time||!this._ts&&!u){c=0,o&&(b+=this._zTime=E?-S:S);break}}r=o}}if(c&&!t&&(this.pause(),c.render(n>=_?0:-S)._zTime=n>=_?1:-1,this._ts))return this._start=p,ze(this),this.render(e,t,i);this._onUpdate&&!t&&Ct(this,"onUpdate",!0),(b===v&&this._tTime>=this.totalDuration()||!b&&_)&&(p!==this._start&&Math.abs(d)===Math.abs(this._ts)||this._lock||((e||!y)&&(b===v&&this._ts>0||!b&&this._ts<0)&&ke(this,1),t||e<0&&!_||!b&&!_&&v||(Ct(this,b===v&&e>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(b<v&&this.timeScale()>0)&&this._prom())))}return this},r.add=function(e,t){var i=this;if(L(t)||(t=et(this,t,e)),!(e instanceof ti)){if(U(e))return e.forEach(function(e){return i.add(e,t)}),this;if(M(e))return this.addLabel(e,t);if(!R(e))return this;e=mi.delayedCall(0,e)}return this!==e?We(this,e,t):this},r.getChildren=function(e,t,i,n){void 0===e&&(e=!0),void 0===t&&(t=!0),void 0===i&&(i=!0),void 0===n&&(n=-T);for(var s=[],r=this._first;r;)r._start>=n&&(r instanceof mi?t&&s.push(r):(i&&s.push(r),e&&s.push.apply(s,r.getChildren(!0,t,i)))),r=r._next;return s},r.getById=function(e){for(var t=this.getChildren(1,1,1),i=t.length;i--;)if(t[i].vars.id===e)return t[i]},r.remove=function(e){return M(e)?this.removeLabel(e):R(e)?this.killTweensOf(e):(e.parent===this&&Le(this,e),e===this._recent&&(this._recent=this._last),De(this))},r.totalTime=function(t,i){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=me(Ut.time-(this._ts>0?t/this._ts:(this.totalDuration()-t)/-this._ts))),e.prototype.totalTime.call(this,t,i),this._forcing=0,this):this._tTime},r.addLabel=function(e,t){return this.labels[e]=et(this,t),this},r.removeLabel=function(e){return delete this.labels[e],this},r.addPause=function(e,t,i){var n=mi.delayedCall(0,t||J,i);return n.data="isPause",this._hasPause=1,We(this,n,et(this,e))},r.removePause=function(e){var t=this._first;for(e=et(this,e);t;)t._start===e&&"isPause"===t.data&&ke(t),t=t._next},r.killTweensOf=function(e,t,i){for(var n=this.getTweensOf(e,i),s=n.length;s--;)ni!==n[s]&&n[s].kill(e,t);return this},r.getTweensOf=function(e,t){for(var i,n=[],s=ht(e),r=this._first,a=L(t);r;)r instanceof mi?ve(r._targets,s)&&(a?(!ni||r._initted&&r._ts)&&r.globalTime(0)<=t&&r.globalTime(r.totalDuration())>t:!t||r.isActive())&&n.push(r):(i=r.getTweensOf(s,t)).length&&n.push.apply(n,i),r=r._next;return n},r.tweenTo=function(e,t){t=t||{};var i,n=this,s=et(n,e),r=t,a=r.startAt,o=r.onStart,l=r.onStartParams,h=r.immediateRender,u=mi.to(n,Ae({ease:t.ease||"none",lazy:!1,immediateRender:!1,time:s,overwrite:"auto",duration:t.duration||Math.abs((s-(a&&"time"in a?a.time:n._time))/n.timeScale())||S,onStart:function(){if(n.pause(),!i){var e=t.duration||Math.abs((s-(a&&"time"in a?a.time:n._time))/n.timeScale());u._dur!==e&&Qe(u,e,0,1).render(u._time,!0,!0),i=1}o&&o.apply(u,l||[])}},t));return h?u.render(0):u},r.tweenFromTo=function(e,t,i){return this.tweenTo(t,Ae({startAt:{time:et(this,e)}},i))},r.recent=function(){return this._recent},r.nextLabel=function(e){return void 0===e&&(e=this._time),Et(this,et(this,e))},r.previousLabel=function(e){return void 0===e&&(e=this._time),Et(this,et(this,e),1)},r.currentLabel=function(e){return arguments.length?this.seek(e,!0):this.previousLabel(this._time+S)},r.shiftChildren=function(e,t,i){void 0===i&&(i=0);for(var n,s=this._first,r=this.labels;s;)s._start>=i&&(s._start+=e,s._end+=e),s=s._next;if(t)for(n in r)r[n]>=i&&(r[n]+=e);return De(this)},r.invalidate=function(t){var i=this._first;for(this._lock=0;i;)i.invalidate(t),i=i._next;return e.prototype.invalidate.call(this,t)},r.clear=function(e){void 0===e&&(e=!0);for(var t,i=this._first;i;)t=i._next,this.remove(i),i=t;return this._dp&&(this._time=this._tTime=this._pTime=0),e&&(this.labels={}),De(this)},r.totalDuration=function(e){var t,i,n,s=0,r=this,o=r._last,l=T;if(arguments.length)return r.timeScale((r._repeat<0?r.duration():r.totalDuration())/(r.reversed()?-e:e));if(r._dirty){for(n=r.parent;o;)t=o._prev,o._dirty&&o.totalDuration(),(i=o._start)>l&&r._sort&&o._ts&&!r._lock?(r._lock=1,We(r,o,i-o._delay,1)._lock=0):l=i,i<0&&o._ts&&(s-=i,(!n&&!r._dp||n&&n.smoothChildTiming)&&(r._start+=i/r._ts,r._time-=i,r._tTime-=i),r.shiftChildren(-i,!1,-Infinity),l=0),o._end>s&&o._ts&&(s=o._end),o=t;Qe(r,r===a&&r._time>s?r._time:s,1,1),r._dirty=0}return r._tDur},n.updateRoot=function(e){if(a._ts&&(xe(a,Ne(e,a)),c=Ut.frame),Ut.frame>=le){le+=b.autoSleep||120;var t=a._first;if((!t||!t._ts)&&b.autoSleep&&Ut._listeners.length<2){for(;t&&!t._ts;)t=t._next;t||Ut.sleep()}}},n}(ti);Ae(ii.prototype,{_lock:0,_hasPause:0,_forcing:0});var ni,si,ri=function(e,t,i,n,s,r,a){var o,l,h,u,c,d,p,f,g=new Mi(this._pt,e,t,0,1,Ai,null,s),m=0,_=0;for(g.b=i,g.e=n,i+="",(p=~(n+="").indexOf("random("))&&(n=Tt(n)),r&&(r(f=[i,n],e,t),i=f[0],n=f[1]),l=i.match(V)||[];o=V.exec(n);)u=o[0],c=n.substring(m,o.index),h?h=(h+1)%5:"rgba("===c.substr(-5)&&(h=1),u!==l[_++]&&(d=parseFloat(l[_-1])||0,g._pt={_next:g._pt,p:c||1===_?c:",",s:d,c:"="===u.charAt(1)?_e(d,u)-d:parseFloat(u)-d,m:h&&h<4?Math.round:0},m=V.lastIndex);return g.c=m<n.length?n.substring(m,n.length):"",g.fp=a,(W.test(n)||p)&&(g.e=0),this._pt=g,g},ai=function(e,t,i,n,s,r,a,o,l,h){R(n)&&(n=n(s||0,e,r));var u,c=e[t],d="get"!==i?i:R(c)?l?e[t.indexOf("set")||!R(e["get"+t.substr(3)])?t:"get"+t.substr(3)](l):e[t]():c,p=R(c)?l?yi:vi:_i;if(M(n)&&(~n.indexOf("random(")&&(n=Tt(n)),"="===n.charAt(1)&&((u=_e(d,n)+(st(d)||0))||0===u)&&(n=u)),!h||d!==n||si)return isNaN(d*n)||""===n?(!c&&!(t in e)&&$(t,n),ri.call(this,e,t,d,n,p,o||b.stringFilter,l)):(u=new Mi(this._pt,e,t,+d||0,n-(d||0),"boolean"==typeof c?Si:Ti,0,p),l&&(u.fp=l),a&&u.modifier(a,this,e),this._pt=u)},oi=function(e,t,i,n,s){if(R(e)&&(e=pi(e,s,t,i,n)),!D(e)||e.style&&e.nodeType||U(e)||F(e))return M(e)?pi(e,s,t,i,n):e;var r,a={};for(r in e)a[r]=pi(e[r],s,t,i,n);return a},li=function(e,t,i,n,s,r){var a,o,l,h;if(ae[e]&&!1!==(a=new ae[e]).init(s,a.rawVars?t[e]:oi(t[e],n,s,r,i),i,n,r)&&(i._pt=o=new Mi(i._pt,s,e,0,1,a.render,a,0,a.priority),i!==d))for(l=i._ptLookup[i._targets.indexOf(s)],h=a._props.length;h--;)l[a._props[h]]=o;return a},hi=function e(t,i,r){var o,l,h,u,c,d,p,f,g,m,_,v,y,b=t.vars,A=b.ease,E=b.startAt,C=b.immediateRender,w=b.lazy,P=b.onUpdate,I=b.runBackwards,M=b.yoyoEase,R=b.keyframes,L=b.autoRevert,k=t._dur,D=t._startAt,B=t._targets,G=t.parent,F=G&&"nested"===G.data?G.vars.targets:B,U="auto"===t._overwrite&&!n,N=t.timeline;if(N&&(!R||!A)&&(A="none"),t._ease=qt(A,x.ease),t._yEase=M?Yt(qt(!0===M?A:M,x.ease)):0,M&&t._yoyo&&!t._repeat&&(M=t._yEase,t._yEase=t._ease,t._ease=M),t._from=!N&&!!b.runBackwards,!N||R&&!b.stagger){if(v=(f=B[0]?de(B[0]).harness:0)&&b[f.prop],o=Pe(b,ne),D&&(D._zTime<0&&D.progress(1),i<0&&I&&C&&!L?D.render(-1,!0):D.revert(I&&k?te:ee),D._lazy=0),E){if(ke(t._startAt=mi.set(B,Ae({data:"isStart",overwrite:!1,parent:G,immediateRender:!0,lazy:!D&&O(w),startAt:null,delay:0,onUpdate:P&&function(){return Ct(t,"onUpdate")},stagger:0},E))),t._startAt._dp=0,t._startAt._sat=t,i<0&&(s||!C&&!L)&&t._startAt.revert(te),C&&k&&i<=0&&r<=0)return void(i&&(t._zTime=i))}else if(I&&k&&!D)if(i&&(C=!1),h=Ae({overwrite:!1,data:"isFromStart",lazy:C&&!D&&O(w),immediateRender:C,stagger:0,parent:G},o),v&&(h[f.prop]=v),ke(t._startAt=mi.set(B,h)),t._startAt._dp=0,t._startAt._sat=t,i<0&&(s?t._startAt.revert(te):t._startAt.render(-1,!0)),t._zTime=i,C){if(!i)return}else e(t._startAt,S,S);for(t._pt=t._ptCache=0,w=k&&O(w)||w&&!k,l=0;l<B.length;l++){if(p=(c=B[l])._gsap||ce(B)[l]._gsap,t._ptLookup[l]=m={},re[p.id]&&se.length&&ye(),_=F===B?l:F.indexOf(c),f&&!1!==(g=new f).init(c,v||o,t,_,F)&&(t._pt=u=new Mi(t._pt,c,g.name,0,1,g.render,g,0,g.priority),g._props.forEach(function(e){m[e]=u}),g.priority&&(d=1)),!f||v)for(h in o)ae[h]&&(g=li(h,o,t,_,c,F))?g.priority&&(d=1):m[h]=u=ai.call(t,c,h,"get",o[h],_,F,0,b.stringFilter);t._op&&t._op[l]&&t.kill(c,t._op[l]),U&&t._pt&&(ni=t,a.killTweensOf(c,m,t.globalTime(i)),y=!t.parent,ni=0),t._pt&&w&&(re[p.id]=1)}d&&Ii(t),t._onInit&&t._onInit(t)}t._onUpdate=P,t._initted=(!t._op||t._pt)&&!y,R&&i<=0&&N.render(T,!0,!0)},ui=function(e,t,i,n,s,r,a,o){var l,h,u,c,d=(e._pt&&e._ptCache||(e._ptCache={}))[t];if(!d)for(d=e._ptCache[t]=[],u=e._ptLookup,c=e._targets.length;c--;){if((l=u[c][t])&&l.d&&l.d._pt)for(l=l.d._pt;l&&l.p!==t&&l.fp!==t;)l=l._next;if(!l)return si=1,e.vars[t]="+=0",hi(e,a),si=0,o?Q(t+" not eligible for reset"):1;d.push(l)}for(c=d.length;c--;)(l=(h=d[c])._pt||h).s=!n&&0!==n||s?l.s+(n||0)+r*l.c:n,l.c=i-l.s,h.e&&(h.e=ge(i)+st(h.e)),h.b&&(h.b=l.s+st(h.b))},ci=function(e,t){var i,n,s,r,a=e[0]?de(e[0]).harness:0,o=a&&a.aliases;if(!o)return t;for(n in i=Ce({},t),o)if(n in i)for(s=(r=o[n].split(",")).length;s--;)i[r[s]]=i[n];return i},di=function(e,t,i,n){var s,r,a=t.ease||n||"power1.inOut";if(U(t))r=i[e]||(i[e]=[]),t.forEach(function(e,i){return r.push({t:i/(t.length-1)*100,v:e,e:a})});else for(s in t)r=i[s]||(i[s]=[]),"ease"===s||r.push({t:parseFloat(e),v:t[s],e:a})},pi=function(e,t,i,n,s){return R(e)?e.call(t,i,n,s):M(e)&&~e.indexOf("random(")?Tt(e):e},fi=ue+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",gi={};fe(fi+",id,stagger,delay,duration,paused,scrollTrigger",function(e){return gi[e]=1});var mi=function(e){function r(t,s,r,o){var l;"number"==typeof s&&(r.duration=s,s=r,r=null);var h,u,c,d,p,f,g,m,_=(l=e.call(this,o?s:Ie(s))||this).vars,v=_.duration,y=_.delay,x=_.immediateRender,T=_.stagger,A=_.overwrite,E=_.keyframes,C=_.defaults,w=_.scrollTrigger,P=_.yoyoEase,I=s.parent||a,M=(U(t)||F(t)?L(t[0]):"length"in s)?[t]:ht(t);if(l._targets=M.length?ce(M):Q("GSAP target "+t+" not found. https://gsap.com",!b.nullTargetWarn)||[],l._ptLookup=[],l._overwrite=A,E||T||G(v)||G(y)){if(s=l.vars,(h=l.timeline=new ii({data:"nested",defaults:C||{},targets:I&&"nested"===I.data?I.vars.targets:M})).kill(),h.parent=h._dp=i(l),h._start=0,T||G(v)||G(y)){if(d=M.length,g=T&&dt(T),D(T))for(p in T)~fi.indexOf(p)&&(m||(m={}),m[p]=T[p]);for(u=0;u<d;u++)(c=Pe(s,gi)).stagger=0,P&&(c.yoyoEase=P),m&&Ce(c,m),f=M[u],c.duration=+pi(v,i(l),u,f,M),c.delay=(+pi(y,i(l),u,f,M)||0)-l._delay,!T&&1===d&&c.delay&&(l._delay=y=c.delay,l._start+=y,c.delay=0),h.to(f,c,g?g(u,f,M):0),h._ease=zt.none;h.duration()?v=y=0:l.timeline=0}else if(E){Ie(Ae(h.vars.defaults,{ease:"none"})),h._ease=qt(E.ease||s.ease||"none");var R,k,B,N=0;if(U(E))E.forEach(function(e){return h.to(M,e,">")}),h.duration();else{for(p in c={},E)"ease"===p||"easeEach"===p||di(p,E[p],c,E.easeEach);for(p in c)for(R=c[p].sort(function(e,t){return e.t-t.t}),N=0,u=0;u<R.length;u++)(B={ease:(k=R[u]).e,duration:(k.t-(u?R[u-1].t:0))/100*v})[p]=k.v,h.to(M,B,N),N+=B.duration;h.duration()<v&&h.to({},{duration:v-h.duration()})}}v||l.duration(v=h.duration())}else l.timeline=0;return!0!==A||n||(ni=i(l),a.killTweensOf(M),ni=0),We(I,i(l),r),s.reversed&&l.reverse(),s.paused&&l.paused(!0),(x||!v&&!E&&l._start===me(I._time)&&O(x)&&Ge(i(l))&&"nested"!==I.data)&&(l._tTime=-S,l.render(Math.max(0,-y)||0)),w&&je(i(l),w),l}t(r,e);var o=r.prototype;return o.render=function(e,t,i){var n,s,r,a,o,l,h,u,c,d=this._time,p=this._tDur,f=this._dur,g=e<0,m=e>p-S&&!g?p:e<S?0:e;if(f){if(m!==this._tTime||!e||i||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==g||this._lazy){if(n=m,u=this.timeline,this._repeat){if(a=f+this._rDelay,this._repeat<-1&&g)return this.totalTime(100*a+e,t,i);if(n=me(m%a),m===p?(r=this._repeat,n=f):(r=~~(o=me(m/a)))&&r===o?(n=f,r--):n>f&&(n=f),(l=this._yoyo&&1&r)&&(c=this._yEase,n=f-n),o=Ue(this._tTime,a),n===d&&!i&&this._initted&&r===o)return this._tTime=m,this;r!==o&&(u&&this._yEase&&Kt(u,l),this.vars.repeatRefresh&&!l&&!this._lock&&n!==a&&this._initted&&(this._lock=i=1,this.render(me(a*r),!0).invalidate()._lock=0))}if(!this._initted){if(Xe(this,g?e:n,i,t,m))return this._tTime=0,this;if(!(d===this._time||i&&this.vars.repeatRefresh&&r!==o))return this;if(f!==this._dur)return this.render(e,t,i)}if(this._tTime=m,this._time=n,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=h=(c||this._ease)(n/f),this._from&&(this.ratio=h=1-h),!d&&m&&!t&&!o&&(Ct(this,"onStart"),this._tTime!==m))return this;for(s=this._pt;s;)s.r(h,s.d),s=s._next;u&&u.render(e<0?e:u._dur*u._ease(n/this._dur),t,i)||this._startAt&&(this._zTime=e),this._onUpdate&&!t&&(g&&Be(this,e,t,i),Ct(this,"onUpdate")),this._repeat&&r!==o&&this.vars.onRepeat&&!t&&this.parent&&Ct(this,"onRepeat"),m!==this._tDur&&m||this._tTime!==m||(g&&!this._onUpdate&&Be(this,e,!0,!0),(e||!f)&&(m===this._tDur&&this._ts>0||!m&&this._ts<0)&&ke(this,1),t||g&&!d||!(m||d||l)||(Ct(this,m===p?"onComplete":"onReverseComplete",!0),this._prom&&!(m<p&&this.timeScale()>0)&&this._prom()))}}else qe(this,e,t,i);return this},o.targets=function(){return this._targets},o.invalidate=function(t){return(!t||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(t),e.prototype.invalidate.call(this,t)},o.resetTo=function(e,t,i,n,s){p||Ut.wake(),this._ts||this.play();var r,a=Math.min(this._dur,(this._dp._time-this._start)*this._ts);return this._initted||hi(this,a),r=this._ease(a/this._dur),ui(this,e,t,i,n,r,a,s)?this.resetTo(e,t,i,n,1):(He(this,0),this.parent||Re(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},o.kill=function(e,t){if(void 0===t&&(t="all"),!(e||t&&"all"!==t))return this._lazy=this._pt=0,this.parent?wt(this):this.scrollTrigger&&this.scrollTrigger.kill(!!s),this;if(this.timeline){var i=this.timeline.totalDuration();return this.timeline.killTweensOf(e,t,ni&&!0!==ni.vars.overwrite)._first||wt(this),this.parent&&i!==this.timeline.totalDuration()&&Qe(this,this._dur*this.timeline._tDur/i,0,1),this}var n,r,a,o,l,h,u,c=this._targets,d=e?ht(e):c,p=this._ptLookup,f=this._pt;if((!t||"all"===t)&&Me(c,d))return"all"===t&&(this._pt=0),wt(this);for(n=this._op=this._op||[],"all"!==t&&(M(t)&&(l={},fe(t,function(e){return l[e]=1}),t=l),t=ci(c,t)),u=c.length;u--;)if(~d.indexOf(c[u]))for(l in r=p[u],"all"===t?(n[u]=t,o=r,a={}):(a=n[u]=n[u]||{},o=t),o)(h=r&&r[l])&&("kill"in h.d&&!0!==h.d.kill(l)||Le(this,h,"_pt"),delete r[l]),"all"!==a&&(a[l]=1);return this._initted&&!this._pt&&f&&wt(this),this},r.to=function(e,t){return new r(e,t,arguments[2])},r.from=function(e,t){return tt(1,arguments)},r.delayedCall=function(e,t,i,n){return new r(t,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:e,onComplete:t,onReverseComplete:t,onCompleteParams:i,onReverseCompleteParams:i,callbackScope:n})},r.fromTo=function(e,t,i){return tt(2,arguments)},r.set=function(e,t){return t.duration=0,t.repeatDelay||(t.repeat=0),new r(e,t)},r.killTweensOf=function(e,t,i){return a.killTweensOf(e,t,i)},r}(ti);Ae(mi.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0}),fe("staggerTo,staggerFrom,staggerFromTo",function(e){mi[e]=function(){var t=new ii,i=at.call(arguments,0);return i.splice("staggerFromTo"===e?5:4,0,0),t[e].apply(t,i)}});var _i=function(e,t,i){return e[t]=i},vi=function(e,t,i){return e[t](i)},yi=function(e,t,i,n){return e[t](n.fp,i)},bi=function(e,t,i){return e.setAttribute(t,i)},xi=function(e,t){return R(e[t])?vi:k(e[t])&&e.setAttribute?bi:_i},Ti=function(e,t){return t.set(t.t,t.p,Math.round(1e6*(t.s+t.c*e))/1e6,t)},Si=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},Ai=function(e,t){var i=t._pt,n="";if(!e&&t.b)n=t.b;else if(1===e&&t.e)n=t.e;else{for(;i;)n=i.p+(i.m?i.m(i.s+i.c*e):Math.round(1e4*(i.s+i.c*e))/1e4)+n,i=i._next;n+=t.c}t.set(t.t,t.p,n,t)},Ei=function(e,t){for(var i=t._pt;i;)i.r(e,i.d),i=i._next},Ci=function(e,t,i,n){for(var s,r=this._pt;r;)s=r._next,r.p===n&&r.modifier(e,t,i),r=s},wi=function(e){for(var t,i,n=this._pt;n;)i=n._next,n.p===e&&!n.op||n.op===e?Le(this,n,"_pt"):n.dep||(t=1),n=i;return!t},Pi=function(e,t,i,n){n.mSet(e,t,n.m.call(n.tween,i,n.mt),n)},Ii=function(e){for(var t,i,n,s,r=e._pt;r;){for(t=r._next,i=n;i&&i.pr>r.pr;)i=i._next;(r._prev=i?i._prev:s)?r._prev._next=r:n=r,(r._next=i)?i._prev=r:s=r,r=t}e._pt=n},Mi=function(){function e(e,t,i,n,s,r,a,o,l){this.t=t,this.s=n,this.c=s,this.p=i,this.r=r||Ti,this.d=a||this,this.set=o||_i,this.pr=l||0,this._next=e,e&&(e._prev=this)}return e.prototype.modifier=function(e,t,i){this.mSet=this.mSet||this.set,this.set=Pi,this.m=e,this.mt=i,this.tween=t},e}();fe(ue+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(e){return ne[e]=1}),Y.TweenMax=Y.TweenLite=mi,Y.TimelineLite=Y.TimelineMax=ii,a=new ii({sortChildren:!1,defaults:x,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0}),b.stringFilter=Ft;var Ri=[],Li={},ki=[],Di=0,Oi=0,Bi=function(e){return(Li[e]||ki).map(function(e){return e()})},Gi=function(){var e=Date.now(),t=[];e-Di>2&&(Bi("matchMediaInit"),Ri.forEach(function(e){var i,n,s,r,a=e.queries,l=e.conditions;for(n in a)(i=o.matchMedia(a[n]).matches)&&(s=1),i!==l[n]&&(l[n]=i,r=1);r&&(e.revert(),s&&t.push(e))}),Bi("matchMediaRevert"),t.forEach(function(e){return e.onMatch(e,function(t){return e.add(null,t)})}),Di=e,Bi("matchMedia"))},Fi=function(){function e(e,t){this.selector=t&&ut(t),this.data=[],this._r=[],this.isReverted=!1,this.id=Oi++,e&&this.add(e)}var t=e.prototype;return t.add=function(e,t,i){R(e)&&(i=t,t=e,e=R);var n=this,s=function(){var e,s=r,a=n.selector;return s&&s!==n&&s.data.push(n),i&&(n.selector=ut(i)),r=n,e=t.apply(n,arguments),R(e)&&n._r.push(e),r=s,n.selector=a,n.isReverted=!1,e};return n.last=s,e===R?s(n,function(e){return n.add(null,e)}):e?n[e]=s:s},t.ignore=function(e){var t=r;r=null,e(this),r=t},t.getTweens=function(){var t=[];return this.data.forEach(function(i){return i instanceof e?t.push.apply(t,i.getTweens()):i instanceof mi&&!(i.parent&&"nested"===i.parent.data)&&t.push(i)}),t},t.clear=function(){this._r.length=this.data.length=0},t.kill=function(e,t){var i=this;if(e?function(){for(var t,n=i.getTweens(),s=i.data.length;s--;)"isFlip"===(t=i.data[s]).data&&(t.revert(),t.getChildren(!0,!0,!1).forEach(function(e){return n.splice(n.indexOf(e),1)}));for(n.map(function(e){return{g:e._dur||e._delay||e._sat&&!e._sat.vars.immediateRender?e.globalTime(0):-1/0,t:e}}).sort(function(e,t){return t.g-e.g||-1/0}).forEach(function(t){return t.t.revert(e)}),s=i.data.length;s--;)(t=i.data[s])instanceof ii?"nested"!==t.data&&(t.scrollTrigger&&t.scrollTrigger.revert(),t.kill()):!(t instanceof mi)&&t.revert&&t.revert(e);i._r.forEach(function(t){return t(e,i)}),i.isReverted=!0}():this.data.forEach(function(e){return e.kill&&e.kill()}),this.clear(),t)for(var n=Ri.length;n--;)Ri[n].id===this.id&&Ri.splice(n,1)},t.revert=function(e){this.kill(e||{})},e}(),Ui=function(){function e(e){this.contexts=[],this.scope=e,r&&r.data.push(this)}var t=e.prototype;return t.add=function(e,t,i){D(e)||(e={matches:e});var n,s,a,l=new Fi(0,i||this.scope),h=l.conditions={};for(s in r&&!l.selector&&(l.selector=r.selector),this.contexts.push(l),t=l.add("onMatch",t),l.queries=e,e)"all"===s?a=1:(n=o.matchMedia(e[s]))&&(Ri.indexOf(l)<0&&Ri.push(l),(h[s]=n.matches)&&(a=1),n.addListener?n.addListener(Gi):n.addEventListener("change",Gi));return a&&t(l,function(e){return l.add(null,e)}),this},t.revert=function(e){this.kill(e||{})},t.kill=function(e){this.contexts.forEach(function(t){return t.kill(e,!0)})},e}(),Ni={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t.forEach(function(e){return It(e)})},timeline:function(e){return new ii(e)},getTweensOf:function(e,t){return a.getTweensOf(e,t)},getProperty:function(e,t,i,n){M(e)&&(e=ht(e)[0]);var s=de(e||{}).get,r=i?Se:Te;return"native"===i&&(i=""),e?t?r((ae[t]&&ae[t].get||s)(e,t,i,n)):function(t,i,n){return r((ae[t]&&ae[t].get||s)(e,t,i,n))}:e},quickSetter:function(e,t,i){if((e=ht(e)).length>1){var n=e.map(function(e){return Wi.quickSetter(e,t,i)}),s=n.length;return function(e){for(var t=s;t--;)n[t](e)}}e=e[0]||{};var r=ae[t],a=de(e),o=a.harness&&(a.harness.aliases||{})[t]||t,l=r?function(t){var n=new r;d._pt=0,n.init(e,i?t+i:t,d,0,[e]),n.render(1,n),d._pt&&Ei(1,d)}:a.set(e,o);return r?l:function(t){return l(e,o,i?t+i:t,a,1)}},quickTo:function(e,t,i){var n,s=Wi.to(e,Ae(((n={})[t]="+=0.1",n.paused=!0,n.stagger=0,n),i||{})),r=function(e,i,n){return s.resetTo(t,e,i,n)};return r.tween=s,r},isTweening:function(e){return a.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=qt(e.ease,x.ease)),we(x,e||{})},config:function(e){return we(b,e||{})},registerEffect:function(e){var t=e.name,i=e.effect,n=e.plugins,s=e.defaults,r=e.extendTimeline;(n||"").split(",").forEach(function(e){return e&&!ae[e]&&!Y[e]&&Q(t+" effect requires "+e+" plugin.")}),oe[t]=function(e,t,n){return i(ht(e),Ae(t||{},s),n)},r&&(ii.prototype[t]=function(e,i,n){return this.add(oe[t](e,D(i)?i:(n=i)&&{},this),n)})},registerEase:function(e,t){zt[e]=qt(t)},parseEase:function(e,t){return arguments.length?qt(e,t):zt},getById:function(e){return a.getById(e)},exportRoot:function(e,t){void 0===e&&(e={});var i,n,s=new ii(e);for(s.smoothChildTiming=O(e.smoothChildTiming),a.remove(s),s._dp=0,s._time=s._tTime=a._time,i=a._first;i;)n=i._next,!t&&!i._dur&&i instanceof mi&&i.vars.onComplete===i._targets[0]||We(s,i,i._start-i._delay),i=n;return We(a,s,0),s},context:function(e,t){return e?new Fi(e,t):r},matchMedia:function(e){return new Ui(e)},matchMediaRefresh:function(){return Ri.forEach(function(e){var t,i,n=e.conditions;for(i in n)n[i]&&(n[i]=!1,t=1);t&&e.revert()})||Gi()},addEventListener:function(e,t){var i=Li[e]||(Li[e]=[]);~i.indexOf(t)||i.push(t)},removeEventListener:function(e,t){var i=Li[e],n=i&&i.indexOf(t);n>=0&&i.splice(n,1)},utils:{wrap:bt,wrapYoyo:xt,distribute:dt,random:gt,snap:ft,normalize:vt,getUnit:st,clamp:rt,splitColor:kt,toArray:ht,selector:ut,mapRange:St,pipe:mt,unitize:_t,interpolate:At,shuffle:ct},install:q,effects:oe,ticker:Ut,updateRoot:ii.updateRoot,plugins:ae,globalTimeline:a,core:{PropTween:Mi,globals:Z,Tween:mi,Timeline:ii,Animation:ti,getCache:de,_removeLinkedListItem:Le,reverting:function(){return s},context:function(e){return e&&r&&(r.data.push(e),e._ctx=r),r},suppressOverwrites:function(e){return n=e}}};fe("to,from,fromTo,delayedCall,set,killTweensOf",function(e){return Ni[e]=mi[e]}),Ut.add(ii.updateRoot),d=Ni.to({},{duration:0});var zi=function(e,t){for(var i=e._pt;i&&i.p!==t&&i.op!==t&&i.fp!==t;)i=i._next;return i},Hi=function(e,t){var i,n,s,r=e._targets;for(i in t)for(n=r.length;n--;)(s=e._ptLookup[n][i])&&(s=s.d)&&(s._pt&&(s=zi(s,i)),s&&s.modifier&&s.modifier(t[i],e,r[n],i))},Vi=function(e,t){return{name:e,headless:1,rawVars:1,init:function(e,i,n){n._onInit=function(e){var n,s;if(M(i)&&(n={},fe(i,function(e){return n[e]=1}),i=n),t){for(s in n={},i)n[s]=t(i[s]);i=n}Hi(e,i)}}}},Wi=Ni.registerPlugin({name:"attr",init:function(e,t,i,n,s){var r,a,o;for(r in this.tween=i,t)o=e.getAttribute(r)||"",(a=this.add(e,"setAttribute",(o||0)+"",t[r],n,s,0,0,r)).op=r,a.b=o,this._props.push(r)},render:function(e,t){for(var i=t._pt;i;)s?i.set(i.t,i.p,i.b,i):i.r(e,i.d),i=i._next}},{name:"endArray",headless:1,init:function(e,t){for(var i=t.length;i--;)this.add(e,i,e[i]||0,t[i],0,0,0,0,0,1)}},Vi("roundProps",pt),Vi("modifiers"),Vi("snap",ft))||Ni;mi.version=ii.version=Wi.version="3.13.0",u=1,B()&&Nt();var ji,Xi,Yi,Ki,qi,$i,Qi,Zi,Ji=zt.Power0,en=zt.Power1,tn=zt.Power2,nn=zt.Power3,sn=zt.Power4,rn=zt.Linear,an=zt.Quad,on=zt.Cubic,ln=zt.Quart,hn=zt.Quint,un=zt.Strong,cn=zt.Elastic,dn=zt.Back,pn=zt.SteppedEase,fn=zt.Bounce,gn=zt.Sine,mn=zt.Expo,_n=zt.Circ,vn=function(){return"undefined"!=typeof window},yn={},bn=180/Math.PI,xn=Math.PI/180,Tn=Math.atan2,Sn=1e8,An=/([A-Z])/g,En=/(left|right|width|margin|padding|x)/i,Cn=/[\s,\(]\S/,wn={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},Pn=function(e,t){return t.set(t.t,t.p,Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},In=function(e,t){return t.set(t.t,t.p,1===e?t.e:Math.round(1e4*(t.s+t.c*e))/1e4+t.u,t)},Mn=function(e,t){return t.set(t.t,t.p,e?Math.round(1e4*(t.s+t.c*e))/1e4+t.u:t.b,t)},Rn=function(e,t){var i=t.s+t.c*e;t.set(t.t,t.p,~~(i+(i<0?-.5:.5))+t.u,t)},Ln=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},kn=function(e,t){return t.set(t.t,t.p,1!==e?t.b:t.e,t)},Dn=function(e,t,i){return e.style[t]=i},On=function(e,t,i){return e.style.setProperty(t,i)},Bn=function(e,t,i){return e._gsap[t]=i},Gn=function(e,t,i){return e._gsap.scaleX=e._gsap.scaleY=i},Fn=function(e,t,i,n,s){var r=e._gsap;r.scaleX=r.scaleY=i,r.renderTransform(s,r)},Un=function(e,t,i,n,s){var r=e._gsap;r[t]=i,r.renderTransform(s,r)},Nn="transform",zn=Nn+"Origin",Hn=function e(t,i){var n=this,s=this.target,r=s.style,a=s._gsap;if(t in yn&&r){if(this.tfm=this.tfm||{},"transform"===t)return wn.transform.split(",").forEach(function(t){return e.call(n,t,i)});if(~(t=wn[t]||t).indexOf(",")?t.split(",").forEach(function(e){return n.tfm[e]=as(s,e)}):this.tfm[t]=a.x?a[t]:as(s,t),t===zn&&(this.tfm.zOrigin=a.zOrigin),this.props.indexOf(Nn)>=0)return;a.svg&&(this.svgo=s.getAttribute("data-svg-origin"),this.props.push(zn,i,"")),t=Nn}(r||i)&&this.props.push(t,i,r[t])},Vn=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},Wn=function(){var e,t,i=this.props,n=this.target,s=n.style,r=n._gsap;for(e=0;e<i.length;e+=3)i[e+1]?2===i[e+1]?n[i[e]](i[e+2]):n[i[e]]=i[e+2]:i[e+2]?s[i[e]]=i[e+2]:s.removeProperty("--"===i[e].substr(0,2)?i[e]:i[e].replace(An,"-$1").toLowerCase());if(this.tfm){for(t in this.tfm)r[t]=this.tfm[t];r.svg&&(r.renderTransform(),n.setAttribute("data-svg-origin",this.svgo||"")),(e=Qi())&&e.isStart||s[Nn]||(Vn(s),r.zOrigin&&s[zn]&&(s[zn]+=" "+r.zOrigin+"px",r.zOrigin=0,r.renderTransform()),r.uncache=1)}},jn=function(e,t){var i={target:e,props:[],revert:Wn,save:Hn};return e._gsap||Wi.core.getCache(e),t&&e.style&&e.nodeType&&t.split(",").forEach(function(e){return i.save(e)}),i},Xn=function(e,t){var i=Xi.createElementNS?Xi.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):Xi.createElement(e);return i&&i.style?i:Xi.createElement(e)},Yn=function e(t,i,n){var s=getComputedStyle(t);return s[i]||s.getPropertyValue(i.replace(An,"-$1").toLowerCase())||s.getPropertyValue(i)||!n&&e(t,qn(i)||i,1)||""},Kn="O,Moz,ms,Ms,Webkit".split(","),qn=function(e,t,i){var n=(t||qi).style,s=5;if(e in n&&!i)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);s--&&!(Kn[s]+e in n););return s<0?null:(3===s?"ms":s>=0?Kn[s]:"")+e},$n=function(){vn()&&window.document&&(ji=window,Xi=ji.document,Yi=Xi.documentElement,qi=Xn("div")||{style:{}},Xn("div"),Nn=qn(Nn),zn=Nn+"Origin",qi.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",Zi=!!qn("perspective"),Qi=Wi.core.reverting,Ki=1)},Qn=function(e){var t,i=e.ownerSVGElement,n=Xn("svg",i&&i.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),s=e.cloneNode(!0);s.style.display="block",n.appendChild(s),Yi.appendChild(n);try{t=s.getBBox()}catch(e){}return n.removeChild(s),Yi.removeChild(n),t},Zn=function(e,t){for(var i=t.length;i--;)if(e.hasAttribute(t[i]))return e.getAttribute(t[i])},Jn=function(e){var t,i;try{t=e.getBBox()}catch(n){t=Qn(e),i=1}return t&&(t.width||t.height)||i||(t=Qn(e)),!t||t.width||t.x||t.y?t:{x:+Zn(e,["x","cx","x1"])||0,y:+Zn(e,["y","cy","y1"])||0,width:0,height:0}},es=function(e){return!(!e.getCTM||e.parentNode&&!e.ownerSVGElement||!Jn(e))},ts=function(e,t){if(t){var i,n=e.style;t in yn&&t!==zn&&(t=Nn),n.removeProperty?("ms"!==(i=t.substr(0,2))&&"webkit"!==t.substr(0,6)||(t="-"+t),n.removeProperty("--"===i?t:t.replace(An,"-$1").toLowerCase())):n.removeAttribute(t)}},is=function(e,t,i,n,s,r){var a=new Mi(e._pt,t,i,0,1,r?kn:Ln);return e._pt=a,a.b=n,a.e=s,e._props.push(i),a},ns={deg:1,rad:1,turn:1},ss={grid:1,flex:1},rs=function e(t,i,n,s){var r,a,o,l,h=parseFloat(n)||0,u=(n+"").trim().substr((h+"").length)||"px",c=qi.style,d=En.test(i),p="svg"===t.tagName.toLowerCase(),f=(p?"client":"offset")+(d?"Width":"Height"),g=100,m="px"===s,_="%"===s;if(s===u||!h||ns[s]||ns[u])return h;if("px"!==u&&!m&&(h=e(t,i,n,"px")),l=t.getCTM&&es(t),(_||"%"===u)&&(yn[i]||~i.indexOf("adius")))return r=l?t.getBBox()[d?"width":"height"]:t[f],ge(_?h/r*g:h/100*r);if(c[d?"width":"height"]=g+(m?u:s),a="rem"!==s&&~i.indexOf("adius")||"em"===s&&t.appendChild&&!p?t:t.parentNode,l&&(a=(t.ownerSVGElement||{}).parentNode),a&&a!==Xi&&a.appendChild||(a=Xi.body),(o=a._gsap)&&_&&o.width&&d&&o.time===Ut.time&&!o.uncache)return ge(h/o.width*g);if(!_||"height"!==i&&"width"!==i)(_||"%"===u)&&!ss[Yn(a,"display")]&&(c.position=Yn(t,"position")),a===t&&(c.position="static"),a.appendChild(qi),r=qi[f],a.removeChild(qi),c.position="absolute";else{var v=t.style[i];t.style[i]=g+s,r=t[f],v?t.style[i]=v:ts(t,i)}return d&&_&&((o=de(a)).time=Ut.time,o.width=a[f]),ge(m?r*h/g:r&&h?g/r*h:0)},as=function(e,t,i,n){var s;return Ki||$n(),t in wn&&"transform"!==t&&~(t=wn[t]).indexOf(",")&&(t=t.split(",")[0]),yn[t]&&"transform"!==t?(s=vs(e,n),s="transformOrigin"!==t?s[t]:s.svg?s.origin:ys(Yn(e,zn))+" "+s.zOrigin+"px"):(!(s=e.style[t])||"auto"===s||n||~(s+"").indexOf("calc("))&&(s=cs[t]&&cs[t](e,t,i)||Yn(e,t)||pe(e,t)||("opacity"===t?1:0)),i&&!~(s+"").trim().indexOf(" ")?rs(e,t,s,i)+i:s},os=function(e,t,i,n){if(!i||"none"===i){var s=qn(t,e,1),r=s&&Yn(e,s,1);r&&r!==i?(t=s,i=r):"borderColor"===t&&(i=Yn(e,"borderTopColor"))}var a,o,l,h,u,c,d,p,f,g,m,_=new Mi(this._pt,e.style,t,0,1,Ai),v=0,y=0;if(_.b=i,_.e=n,i+="","var(--"===(n+="").substring(0,6)&&(n=Yn(e,n.substring(4,n.indexOf(")")))),"auto"===n&&(c=e.style[t],e.style[t]=n,n=Yn(e,t)||n,c?e.style[t]=c:ts(e,t)),Ft(a=[i,n]),i=a[0],n=a[1],l=i.match(H)||[],(n.match(H)||[]).length){for(;o=H.exec(n);)d=o[0],f=n.substring(v,o.index),u?u=(u+1)%5:"rgba("!==f.substr(-5)&&"hsla("!==f.substr(-5)||(u=1),d!==(c=l[y++]||"")&&(h=parseFloat(c)||0,m=c.substr((h+"").length),"="===d.charAt(1)&&(d=_e(h,d)+m),p=parseFloat(d),g=d.substr((p+"").length),v=H.lastIndex-g.length,g||(g=g||b.units[t]||m,v===n.length&&(n+=g,_.e+=g)),m!==g&&(h=rs(e,t,c,g)||0),_._pt={_next:_._pt,p:f||1===y?f:",",s:h,c:p-h,m:u&&u<4||"zIndex"===t?Math.round:0});_.c=v<n.length?n.substring(v,n.length):""}else _.r="display"===t&&"none"===n?kn:Ln;return W.test(n)&&(_.e=0),this._pt=_,_},ls={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},hs=function(e){var t=e.split(" "),i=t[0],n=t[1]||"50%";return"top"!==i&&"bottom"!==i&&"left"!==n&&"right"!==n||(e=i,i=n,n=e),t[0]=ls[i]||i,t[1]=ls[n]||n,t.join(" ")},us=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var i,n,s,r=t.t,a=r.style,o=t.u,l=r._gsap;if("all"===o||!0===o)a.cssText="",n=1;else for(s=(o=o.split(",")).length;--s>-1;)i=o[s],yn[i]&&(n=1,i="transformOrigin"===i?zn:Nn),ts(r,i);n&&(ts(r,Nn),l&&(l.svg&&r.removeAttribute("transform"),a.scale=a.rotate=a.translate="none",vs(r,1),l.uncache=1,Vn(a)))}},cs={clearProps:function(e,t,i,n,s){if("isFromStart"!==s.data){var r=e._pt=new Mi(e._pt,t,i,0,0,us);return r.u=n,r.pr=-10,r.tween=s,e._props.push(i),1}}},ds=[1,0,0,1,0,0],ps={},fs=function(e){return"matrix(1, 0, 0, 1, 0, 0)"===e||"none"===e||!e},gs=function(e){var t=Yn(e,Nn);return fs(t)?ds:t.substr(7).match(z).map(ge)},ms=function(e,t){var i,n,s,r,a=e._gsap||de(e),o=e.style,l=gs(e);return a.svg&&e.getAttribute("transform")?"1,0,0,1,0,0"===(l=[(s=e.transform.baseVal.consolidate().matrix).a,s.b,s.c,s.d,s.e,s.f]).join(",")?ds:l:(l!==ds||e.offsetParent||e===Yi||a.svg||(s=o.display,o.display="block",(i=e.parentNode)&&(e.offsetParent||e.getBoundingClientRect().width)||(r=1,n=e.nextElementSibling,Yi.appendChild(e)),l=gs(e),s?o.display=s:ts(e,"display"),r&&(n?i.insertBefore(e,n):i?i.appendChild(e):Yi.removeChild(e))),t&&l.length>6?[l[0],l[1],l[4],l[5],l[12],l[13]]:l)},_s=function(e,t,i,n,s,r){var a,o,l,h=e._gsap,u=s||ms(e,!0),c=h.xOrigin||0,d=h.yOrigin||0,p=h.xOffset||0,f=h.yOffset||0,g=u[0],m=u[1],_=u[2],v=u[3],y=u[4],b=u[5],x=t.split(" "),T=parseFloat(x[0])||0,S=parseFloat(x[1])||0;i?u!==ds&&(o=g*v-m*_)&&(l=T*(-m/o)+S*(g/o)-(g*b-m*y)/o,T=T*(v/o)+S*(-_/o)+(_*b-v*y)/o,S=l):(T=(a=Jn(e)).x+(~x[0].indexOf("%")?T/100*a.width:T),S=a.y+(~(x[1]||x[0]).indexOf("%")?S/100*a.height:S)),n||!1!==n&&h.smooth?(y=T-c,b=S-d,h.xOffset=p+(y*g+b*_)-y,h.yOffset=f+(y*m+b*v)-b):h.xOffset=h.yOffset=0,h.xOrigin=T,h.yOrigin=S,h.smooth=!!n,h.origin=t,h.originIsAbsolute=!!i,e.style[zn]="0px 0px",r&&(is(r,h,"xOrigin",c,T),is(r,h,"yOrigin",d,S),is(r,h,"xOffset",p,h.xOffset),is(r,h,"yOffset",f,h.yOffset)),e.setAttribute("data-svg-origin",T+" "+S)},vs=function(e,t){var i=e._gsap||new ei(e);if("x"in i&&!t&&!i.uncache)return i;var n,s,r,a,o,l,h,u,c,d,p,f,g,m,_,v,y,x,T,S,A,E,C,w,P,I,M,R,L,k,D,O,B=e.style,G=i.scaleX<0,F="px",U="deg",N=getComputedStyle(e),z=Yn(e,zn)||"0";return n=s=r=l=h=u=c=d=p=0,a=o=1,i.svg=!(!e.getCTM||!es(e)),N.translate&&("none"===N.translate&&"none"===N.scale&&"none"===N.rotate||(B[Nn]=("none"!==N.translate?"translate3d("+(N.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+("none"!==N.rotate?"rotate("+N.rotate+") ":"")+("none"!==N.scale?"scale("+N.scale.split(" ").join(",")+") ":"")+("none"!==N[Nn]?N[Nn]:"")),B.scale=B.rotate=B.translate="none"),m=ms(e,i.svg),i.svg&&(i.uncache?(P=e.getBBox(),z=i.xOrigin-P.x+"px "+(i.yOrigin-P.y)+"px",w=""):w=!t&&e.getAttribute("data-svg-origin"),_s(e,w||z,!!w||i.originIsAbsolute,!1!==i.smooth,m)),f=i.xOrigin||0,g=i.yOrigin||0,m!==ds&&(x=m[0],T=m[1],S=m[2],A=m[3],n=E=m[4],s=C=m[5],6===m.length?(a=Math.sqrt(x*x+T*T),o=Math.sqrt(A*A+S*S),l=x||T?Tn(T,x)*bn:0,(c=S||A?Tn(S,A)*bn+l:0)&&(o*=Math.abs(Math.cos(c*xn))),i.svg&&(n-=f-(f*x+g*S),s-=g-(f*T+g*A))):(O=m[6],k=m[7],M=m[8],R=m[9],L=m[10],D=m[11],n=m[12],s=m[13],r=m[14],h=(_=Tn(O,L))*bn,_&&(w=E*(v=Math.cos(-_))+M*(y=Math.sin(-_)),P=C*v+R*y,I=O*v+L*y,M=E*-y+M*v,R=C*-y+R*v,L=O*-y+L*v,D=k*-y+D*v,E=w,C=P,O=I),u=(_=Tn(-S,L))*bn,_&&(v=Math.cos(-_),D=A*(y=Math.sin(-_))+D*v,x=w=x*v-M*y,T=P=T*v-R*y,S=I=S*v-L*y),l=(_=Tn(T,x))*bn,_&&(w=x*(v=Math.cos(_))+T*(y=Math.sin(_)),P=E*v+C*y,T=T*v-x*y,C=C*v-E*y,x=w,E=P),h&&Math.abs(h)+Math.abs(l)>359.9&&(h=l=0,u=180-u),a=ge(Math.sqrt(x*x+T*T+S*S)),o=ge(Math.sqrt(C*C+O*O)),_=Tn(E,C),c=Math.abs(_)>2e-4?_*bn:0,p=D?1/(D<0?-D:D):0),i.svg&&(w=e.getAttribute("transform"),i.forceCSS=e.setAttribute("transform","")||!fs(Yn(e,Nn)),w&&e.setAttribute("transform",w))),Math.abs(c)>90&&Math.abs(c)<270&&(G?(a*=-1,c+=l<=0?180:-180,l+=l<=0?180:-180):(o*=-1,c+=c<=0?180:-180)),t=t||i.uncache,i.x=n-((i.xPercent=n&&(!t&&i.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-n)?-50:0)))?e.offsetWidth*i.xPercent/100:0)+F,i.y=s-((i.yPercent=s&&(!t&&i.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-s)?-50:0)))?e.offsetHeight*i.yPercent/100:0)+F,i.z=r+F,i.scaleX=ge(a),i.scaleY=ge(o),i.rotation=ge(l)+U,i.rotationX=ge(h)+U,i.rotationY=ge(u)+U,i.skewX=c+U,i.skewY=d+U,i.transformPerspective=p+F,(i.zOrigin=parseFloat(z.split(" ")[2])||!t&&i.zOrigin||0)&&(B[zn]=ys(z)),i.xOffset=i.yOffset=0,i.force3D=b.force3D,i.renderTransform=i.svg?Cs:Zi?Es:xs,i.uncache=0,i},ys=function(e){return(e=e.split(" "))[0]+" "+e[1]},bs=function(e,t,i){var n=st(t);return ge(parseFloat(t)+parseFloat(rs(e,"x",i+"px",n)))+n},xs=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,Es(e,t)},Ts="0deg",Ss="0px",As=") ",Es=function(e,t){var i=t||this,n=i.xPercent,s=i.yPercent,r=i.x,a=i.y,o=i.z,l=i.rotation,h=i.rotationY,u=i.rotationX,c=i.skewX,d=i.skewY,p=i.scaleX,f=i.scaleY,g=i.transformPerspective,m=i.force3D,_=i.target,v=i.zOrigin,y="",b="auto"===m&&e&&1!==e||!0===m;if(v&&(u!==Ts||h!==Ts)){var x,T=parseFloat(h)*xn,S=Math.sin(T),A=Math.cos(T);T=parseFloat(u)*xn,x=Math.cos(T),r=bs(_,r,S*x*-v),a=bs(_,a,-Math.sin(T)*-v),o=bs(_,o,A*x*-v+v)}g!==Ss&&(y+="perspective("+g+As),(n||s)&&(y+="translate("+n+"%, "+s+"%) "),(b||r!==Ss||a!==Ss||o!==Ss)&&(y+=o!==Ss||b?"translate3d("+r+", "+a+", "+o+") ":"translate("+r+", "+a+As),l!==Ts&&(y+="rotate("+l+As),h!==Ts&&(y+="rotateY("+h+As),u!==Ts&&(y+="rotateX("+u+As),c===Ts&&d===Ts||(y+="skew("+c+", "+d+As),1===p&&1===f||(y+="scale("+p+", "+f+As),_.style[Nn]=y||"translate(0, 0)"},Cs=function(e,t){var i,n,s,r,a,o=t||this,l=o.xPercent,h=o.yPercent,u=o.x,c=o.y,d=o.rotation,p=o.skewX,f=o.skewY,g=o.scaleX,m=o.scaleY,_=o.target,v=o.xOrigin,y=o.yOrigin,b=o.xOffset,x=o.yOffset,T=o.forceCSS,S=parseFloat(u),A=parseFloat(c);d=parseFloat(d),p=parseFloat(p),(f=parseFloat(f))&&(p+=f=parseFloat(f),d+=f),d||p?(d*=xn,p*=xn,i=Math.cos(d)*g,n=Math.sin(d)*g,s=Math.sin(d-p)*-m,r=Math.cos(d-p)*m,p&&(f*=xn,a=Math.tan(p-f),s*=a=Math.sqrt(1+a*a),r*=a,f&&(a=Math.tan(f),i*=a=Math.sqrt(1+a*a),n*=a)),i=ge(i),n=ge(n),s=ge(s),r=ge(r)):(i=g,r=m,n=s=0),(S&&!~(u+"").indexOf("px")||A&&!~(c+"").indexOf("px"))&&(S=rs(_,"x",u,"px"),A=rs(_,"y",c,"px")),(v||y||b||x)&&(S=ge(S+v-(v*i+y*s)+b),A=ge(A+y-(v*n+y*r)+x)),(l||h)&&(a=_.getBBox(),S=ge(S+l/100*a.width),A=ge(A+h/100*a.height)),a="matrix("+i+","+n+","+s+","+r+","+S+","+A+")",_.setAttribute("transform",a),T&&(_.style[Nn]=a)},ws=function(e,t,i,n,s){var r,a,o=360,l=M(s),h=parseFloat(s)*(l&&~s.indexOf("rad")?bn:1)-n,u=n+h+"deg";return l&&("short"===(r=s.split("_")[1])&&(h%=o)!==h%(o/2)&&(h+=h<0?o:-o),"cw"===r&&h<0?h=(h+o*Sn)%o-~~(h/o)*o:"ccw"===r&&h>0&&(h=(h-o*Sn)%o-~~(h/o)*o)),e._pt=a=new Mi(e._pt,t,i,n,h,In),a.e=u,a.u="deg",e._props.push(i),a},Ps=function(e,t){for(var i in t)e[i]=t[i];return e},Is=function(e,t,i){var n,s,r,a,o,l,h,u=Ps({},i._gsap),c="perspective,force3D,transformOrigin,svgOrigin",d=i.style;for(s in u.svg?(r=i.getAttribute("transform"),i.setAttribute("transform",""),d[Nn]=t,n=vs(i,1),ts(i,Nn),i.setAttribute("transform",r)):(r=getComputedStyle(i)[Nn],d[Nn]=t,n=vs(i,1),d[Nn]=r),yn)(r=u[s])!==(a=n[s])&&c.indexOf(s)<0&&(o=st(r)!==(h=st(a))?rs(i,s,r,h):parseFloat(r),l=parseFloat(a),e._pt=new Mi(e._pt,n,s,o,l-o,Pn),e._pt.u=h||0,e._props.push(s));Ps(n,u)};fe("padding,margin,Width,Radius",function(e,t){var i="Top",n="Right",s="Bottom",r="Left",a=(t<3?[i,n,s,r]:[i+r,i+n,s+n,s+r]).map(function(i){return t<2?e+i:"border"+i+e});cs[t>1?"border"+e:e]=function(e,t,i,n,s){var r,o;if(arguments.length<4)return r=a.map(function(t){return as(e,t,i)}),5===(o=r.join(" ")).split(r[0]).length?r[0]:o;r=(n+"").split(" "),o={},a.forEach(function(e,t){return o[e]=r[t]=r[t]||r[(t-1)/2|0]}),e.init(t,o,s)}});var Ms,Rs,Ls,ks,Ds={name:"css",register:$n,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,i,n,s){var r,a,o,l,h,u,c,d,p,f,g,m,_,v,y,x,T=this._props,S=e.style,A=i.vars.startAt;for(c in Ki||$n(),this.styles=this.styles||jn(e),x=this.styles.props,this.tween=i,t)if("autoRound"!==c&&(a=t[c],!ae[c]||!li(c,t,i,n,e,s)))if(h=typeof a,u=cs[c],"function"===h&&(h=typeof(a=a.call(i,n,e,s))),"string"===h&&~a.indexOf("random(")&&(a=Tt(a)),u)u(this,e,c,a,i)&&(y=1);else if("--"===c.substr(0,2))r=(getComputedStyle(e).getPropertyValue(c)+"").trim(),a+="",Bt.lastIndex=0,Bt.test(r)||(d=st(r),p=st(a)),p?d!==p&&(r=rs(e,c,r,p)+p):d&&(a+=d),this.add(S,"setProperty",r,a,n,s,0,0,c),T.push(c),x.push(c,0,S[c]);else if("undefined"!==h){if(A&&c in A?(r="function"==typeof A[c]?A[c].call(i,n,e,s):A[c],M(r)&&~r.indexOf("random(")&&(r=Tt(r)),st(r+"")||"auto"===r||(r+=b.units[c]||st(as(e,c))||""),"="===(r+"").charAt(1)&&(r=as(e,c))):r=as(e,c),l=parseFloat(r),(f="string"===h&&"="===a.charAt(1)&&a.substr(0,2))&&(a=a.substr(2)),o=parseFloat(a),c in wn&&("autoAlpha"===c&&(1===l&&"hidden"===as(e,"visibility")&&o&&(l=0),x.push("visibility",0,S.visibility),is(this,S,"visibility",l?"inherit":"hidden",o?"inherit":"hidden",!o)),"scale"!==c&&"transform"!==c&&~(c=wn[c]).indexOf(",")&&(c=c.split(",")[0])),g=c in yn)if(this.styles.save(c),"string"===h&&"var(--"===a.substring(0,6)&&(a=Yn(e,a.substring(4,a.indexOf(")"))),o=parseFloat(a)),m||((_=e._gsap).renderTransform&&!t.parseTransform||vs(e,t.parseTransform),v=!1!==t.smoothOrigin&&_.smooth,(m=this._pt=new Mi(this._pt,S,Nn,0,1,_.renderTransform,_,0,-1)).dep=1),"scale"===c)this._pt=new Mi(this._pt,_,"scaleY",_.scaleY,(f?_e(_.scaleY,f+o):o)-_.scaleY||0,Pn),this._pt.u=0,T.push("scaleY",c),c+="X";else{if("transformOrigin"===c){x.push(zn,0,S[zn]),a=hs(a),_.svg?_s(e,a,0,v,0,this):((p=parseFloat(a.split(" ")[2])||0)!==_.zOrigin&&is(this,_,"zOrigin",_.zOrigin,p),is(this,S,c,ys(r),ys(a)));continue}if("svgOrigin"===c){_s(e,a,1,v,0,this);continue}if(c in ps){ws(this,_,c,l,f?_e(l,f+a):a);continue}if("smoothOrigin"===c){is(this,_,"smooth",_.smooth,a);continue}if("force3D"===c){_[c]=a;continue}if("transform"===c){Is(this,a,e);continue}}else c in S||(c=qn(c)||c);if(g||(o||0===o)&&(l||0===l)&&!Cn.test(a)&&c in S)o||(o=0),(d=(r+"").substr((l+"").length))!==(p=st(a)||(c in b.units?b.units[c]:d))&&(l=rs(e,c,r,p)),this._pt=new Mi(this._pt,g?_:S,c,l,(f?_e(l,f+o):o)-l,g||"px"!==p&&"zIndex"!==c||!1===t.autoRound?Pn:Rn),this._pt.u=p||0,d!==p&&"%"!==p&&(this._pt.b=r,this._pt.r=Mn);else if(c in S)os.call(this,e,c,r,f?f+a:a);else if(c in e)this.add(e,c,r||e[c],f?f+a:a,n,s);else if("parseTransform"!==c){$(c,a);continue}g||(c in S?x.push(c,0,S[c]):"function"==typeof e[c]?x.push(c,2,e[c]()):x.push(c,1,r||e[c])),T.push(c)}y&&Ii(this)},render:function(e,t){if(t.tween._time||!Qi())for(var i=t._pt;i;)i.r(e,i.d),i=i._next;else t.styles.revert()},get:as,aliases:wn,getSetter:function(e,t,i){var n=wn[t];return n&&n.indexOf(",")<0&&(t=n),t in yn&&t!==zn&&(e._gsap.x||as(e,"x"))?i&&$i===i?"scale"===t?Gn:Bn:($i=i||{})&&("scale"===t?Fn:Un):e.style&&!k(e.style[t])?Dn:~t.indexOf("-")?On:xi(e,t)},core:{_removeProperty:ts,_getMatrix:ms}};Wi.utils.checkPrefix=qn,Wi.core.getStyleSaver=jn,Ls="0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY",ks=fe((Ms="x,y,z,scale,scaleX,scaleY,xPercent,yPercent")+","+(Rs="rotation,rotationX,rotationY,skewX,skewY")+",transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective",function(e){yn[e]=1}),fe(Rs,function(e){b.units[e]="deg",ps[e]=1}),wn[ks[13]]=Ms+","+Rs,fe(Ls,function(e){var t=e.split(":");wn[t[1]]=ks[t[0]]}),fe("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(e){b.units[e]="px"}),Wi.registerPlugin(Ds);var Os=Wi.registerPlugin(Ds)||Wi,Bs=Os.core.Tween;e.Back=dn,e.Bounce=fn,e.CSSPlugin=Ds,e.Circ=_n,e.Cubic=on,e.Elastic=cn,e.Expo=mn,e.Linear=rn,e.Power0=Ji,e.Power1=en,e.Power2=tn,e.Power3=nn,e.Power4=sn,e.Quad=an,e.Quart=ln,e.Quint=hn,e.Sine=gn,e.SteppedEase=pn,e.Strong=un,e.TimelineLite=ii,e.TimelineMax=ii,e.TweenLite=mi,e.TweenMax=Bs,e.default=Os,e.gsap=Os,"undefined"==typeof window||window!==e?Object.defineProperty(e,"__esModule",{value:!0}):delete window.default}(t)},2581:(e,t,i)=>{"use strict";i.d(t,{P:()=>h,_:()=>a});const n={};function s(e){const t=[];if(1===e)t.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),t.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let i=0;for(let n=0;n<e;n++)t.push(`@group(1) @binding(${i++}) var textureSource${n+1}: texture_2d<f32>;`),t.push(`@group(1) @binding(${i++}) var textureSampler${n+1}: sampler;`)}return t.join("\n")}function r(e){const t=[];if(1===e)t.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{t.push("switch vTextureId {");for(let i=0;i<e;i++)i===e-1?t.push("  default:{"):t.push(`  case ${i}:{`),t.push(`      outColor = textureSampleGrad(textureSource${i+1}, textureSampler${i+1}, vUV, uvDx, uvDy);`),t.push("      break;}");t.push("}")}return t.join("\n")}function a(e){return n[e]||(n[e]={name:"texture-batch-bit",vertex:{header:"\n                @in aTextureIdAndRound: vec2<u32>;\n                @out @interpolate(flat) vTextureId : u32;\n            ",main:"\n                vTextureId = aTextureIdAndRound.y;\n            ",end:"\n                if(aTextureIdAndRound.x == 1)\n                {\n                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);\n                }\n            "},fragment:{header:`\n                @in @interpolate(flat) vTextureId: u32;\n\n                ${s(e)}\n            `,main:`\n                var uvDx = dpdx(vUV);\n                var uvDy = dpdy(vUV);\n\n                ${r(e)}\n            `}}),n[e]}const o={};function l(e){const t=[];for(let i=0;i<e;i++)i>0&&t.push("else"),i<e-1&&t.push(`if(vTextureId < ${i}.5)`),t.push("{"),t.push(`\toutColor = texture(uTextures[${i}], vUV);`),t.push("}");return t.join("\n")}function h(e){return o[e]||(o[e]={name:"texture-batch-bit",vertex:{header:"\n                in vec2 aTextureIdAndRound;\n                out float vTextureId;\n\n            ",main:"\n                vTextureId = aTextureIdAndRound.y;\n            ",end:"\n                if(aTextureIdAndRound.x == 1.)\n                {\n                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);\n                }\n            "},fragment:{header:`\n                in float vTextureId;\n\n                uniform sampler2D uTextures[${e}];\n\n            `,main:`\n\n                ${l(e)}\n            `}}),o[e]}},2874:(e,t,i)=>{"use strict";i.d(t,{u:()=>n});var n=(e=>(e[e.NONE=0]="NONE",e[e.COLOR=16384]="COLOR",e[e.STENCIL=1024]="STENCIL",e[e.DEPTH=256]="DEPTH",e[e.COLOR_DEPTH=16640]="COLOR_DEPTH",e[e.COLOR_STENCIL=17408]="COLOR_STENCIL",e[e.DEPTH_STENCIL=1280]="DEPTH_STENCIL",e[e.ALL=17664]="ALL",e))(n||{})},2930:(e,t,i)=>{"use strict";i.d(t,{C:()=>n});class n{constructor(e){this.items=[],this._name=e}emit(e,t,i,n,s,r,a,o){const{name:l,items:h}=this;for(let u=0,c=h.length;u<c;u++)h[u][l](e,t,i,n,s,r,a,o);return this}add(e){return e[this._name]&&(this.remove(e),this.items.push(e)),this}remove(e){const t=this.items.indexOf(e);return-1!==t&&this.items.splice(t,1),this}contains(e){return-1!==this.items.indexOf(e)}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return 0===this.items.length}get name(){return this._name}}},3018:(e,t,i)=>{"use strict";i.d(t,{GH:()=>ce});var n=i(8602),s=i(7414),r=i(8741),a=i(7),o=i(4303),l=i(5148),h=i(6680),u=i(2207);function c(e,t,i,n,s){const r=t.a,a=t.b,o=t.c,l=t.d,h=t.tx,u=t.ty;i||(i=0),n||(n=2),s||(s=e.length/n-i);let c=i*n;for(let t=0;t<s;t++){const t=e[c],i=e[c+1];e[c]=r*t+o*i+h,e[c+1]=a*t+l*i+u,c+=n}}var d=i(8192),p=i(4255);const f={extension:{type:n.Ag.ShapeBuilder,name:"circle"},build(e,t){let i,n,s,r,a,o;if("circle"===e.type){const t=e;if(a=o=t.radius,a<=0)return!1;i=t.x,n=t.y,s=r=0}else if("ellipse"===e.type){const t=e;if(a=t.halfWidth,o=t.halfHeight,a<=0||o<=0)return!1;i=t.x,n=t.y,s=r=0}else{const t=e,l=t.width/2,h=t.height/2;i=t.x+l,n=t.y+h,a=o=Math.max(0,Math.min(t.radius,Math.min(l,h))),s=l-a,r=h-o}if(s<0||r<0)return!1;const l=Math.ceil(2.3*Math.sqrt(a+o)),h=8*l+(s?4:0)+(r?4:0);if(0===h)return!1;if(0===l)return t[0]=t[6]=i+s,t[1]=t[3]=n+r,t[2]=t[4]=i-s,t[5]=t[7]=n-r,!0;let u=0,c=4*l+(s?2:0)+2,d=c,p=h,f=s+a,g=r,m=i+f,_=i-f,v=n+g;if(t[u++]=m,t[u++]=v,t[--c]=v,t[--c]=_,r){const e=n-g;t[d++]=_,t[d++]=e,t[--p]=e,t[--p]=m}for(let e=1;e<l;e++){const h=Math.PI/2*(e/l),f=s+Math.cos(h)*a,g=r+Math.sin(h)*o,m=i+f,_=i-f,v=n+g,y=n-g;t[u++]=m,t[u++]=v,t[--c]=v,t[--c]=_,t[d++]=_,t[d++]=y,t[--p]=y,t[--p]=m}f=s,g=r+o,m=i+f,_=i-f,v=n+g;const y=n-g;return t[u++]=m,t[u++]=v,t[--p]=y,t[--p]=m,s&&(t[u++]=_,t[u++]=v,t[--p]=y,t[--p]=_),!0},triangulate(e,t,i,n,s,r){if(0===e.length)return;let a=0,o=0;for(let t=0;t<e.length;t+=2)a+=e[t],o+=e[t+1];a/=e.length/2,o/=e.length/2;let l=n;t[l*i]=a,t[l*i+1]=o;const h=l++;for(let n=0;n<e.length;n+=2)t[l*i]=e[n],t[l*i+1]=e[n+1],n>0&&(s[r++]=l,s[r++]=h,s[r++]=l-1),l++;s[r++]=h+1,s[r++]=h,s[r++]=l-1}},g={...f,extension:{...f.extension,name:"ellipse"}},m={...f,extension:{...f.extension,name:"roundedRectangle"}};var _=i(1828);const v=1e-4;function y(e,t,i,n,s,r,a,o){let l,h;a?(l=n,h=-i):(l=-n,h=i);const u=e-i*s+l,c=t-n*s+h,d=e+i*r+l,p=t+n*r+h;return o.push(u,c),o.push(d,p),2}function b(e,t,i,n,s,r,a,o){const l=i-e,h=n-t;let u=Math.atan2(l,h),c=Math.atan2(s-e,r-t);o&&u<c?u+=2*Math.PI:!o&&u>c&&(c+=2*Math.PI);let d=u;const p=c-u,f=Math.abs(p),g=Math.sqrt(l*l+h*h),m=1+(15*f*Math.sqrt(g)/Math.PI|0),_=p/m;if(d+=_,o){a.push(e,t),a.push(i,n);for(let i=1,n=d;i<m;i++,n+=_)a.push(e,t),a.push(e+Math.sin(n)*g,t+Math.cos(n)*g);a.push(e,t),a.push(s,r)}else{a.push(i,n),a.push(e,t);for(let i=1,n=d;i<m;i++,n+=_)a.push(e+Math.sin(n)*g,t+Math.cos(n)*g),a.push(e,t);a.push(s,r),a.push(e,t)}return 2*m}function x(e,t,i=2){const n=t&&t.length,s=n?t[0]*i:e.length;let r=T(e,0,s,i,!0);const a=[];if(!r||r.next===r.prev)return a;let o,l,h;if(n&&(r=function(e,t,i,n){const s=[];for(let i=0,r=t.length;i<r;i++){const a=T(e,t[i]*n,i<r-1?t[i+1]*n:e.length,n,!1);a===a.next&&(a.steiner=!0),s.push(k(a))}s.sort(I);for(let e=0;e<s.length;e++)i=M(s[e],i);return i}(e,t,r,i)),e.length>80*i){o=e[0],l=e[1];let t=o,n=l;for(let r=i;r<s;r+=i){const i=e[r],s=e[r+1];i<o&&(o=i),s<l&&(l=s),i>t&&(t=i),s>n&&(n=s)}h=Math.max(t-o,n-l),h=0!==h?32767/h:0}return A(r,a,i,o,l,h,0),a}function T(e,t,i,n,s){let r;if(s===Y(e,t,i,n)>0)for(let s=t;s<i;s+=n)r=W(s/n|0,e[s],e[s+1],r);else for(let s=i-n;s>=t;s-=n)r=W(s/n|0,e[s],e[s+1],r);return r&&F(r,r.next)&&(j(r),r=r.next),r}function S(e,t){if(!e)return e;t||(t=e);let i,n=e;do{if(i=!1,n.steiner||!F(n,n.next)&&0!==G(n.prev,n,n.next))n=n.next;else{if(j(n),n=t=n.prev,n===n.next)break;i=!0}}while(i||n!==t);return t}function A(e,t,i,n,s,r,a){if(!e)return;!a&&r&&function(e,t,i,n){let s=e;do{0===s.z&&(s.z=L(s.x,s.y,t,i,n)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next}while(s!==e);s.prevZ.nextZ=null,s.prevZ=null,function(e){let t,i=1;do{let n,s=e;e=null;let r=null;for(t=0;s;){t++;let a=s,o=0;for(let e=0;e<i&&(o++,a=a.nextZ,a);e++);let l=i;for(;o>0||l>0&&a;)0!==o&&(0===l||!a||s.z<=a.z)?(n=s,s=s.nextZ,o--):(n=a,a=a.nextZ,l--),r?r.nextZ=n:e=n,n.prevZ=r,r=n;s=a}r.nextZ=null,i*=2}while(t>1)}(s)}(e,n,s,r);let o=e;for(;e.prev!==e.next;){const l=e.prev,h=e.next;if(r?C(e,n,s,r):E(e))t.push(l.i,e.i,h.i),j(e),e=h.next,o=h.next;else if((e=h)===o){a?1===a?A(e=w(S(e),t),t,i,n,s,r,2):2===a&&P(e,t,i,n,s,r):A(S(e),t,i,n,s,r,1);break}}}function E(e){const t=e.prev,i=e,n=e.next;if(G(t,i,n)>=0)return!1;const s=t.x,r=i.x,a=n.x,o=t.y,l=i.y,h=n.y,u=Math.min(s,r,a),c=Math.min(o,l,h),d=Math.max(s,r,a),p=Math.max(o,l,h);let f=n.next;for(;f!==t;){if(f.x>=u&&f.x<=d&&f.y>=c&&f.y<=p&&O(s,o,r,l,a,h,f.x,f.y)&&G(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function C(e,t,i,n){const s=e.prev,r=e,a=e.next;if(G(s,r,a)>=0)return!1;const o=s.x,l=r.x,h=a.x,u=s.y,c=r.y,d=a.y,p=Math.min(o,l,h),f=Math.min(u,c,d),g=Math.max(o,l,h),m=Math.max(u,c,d),_=L(p,f,t,i,n),v=L(g,m,t,i,n);let y=e.prevZ,b=e.nextZ;for(;y&&y.z>=_&&b&&b.z<=v;){if(y.x>=p&&y.x<=g&&y.y>=f&&y.y<=m&&y!==s&&y!==a&&O(o,u,l,c,h,d,y.x,y.y)&&G(y.prev,y,y.next)>=0)return!1;if(y=y.prevZ,b.x>=p&&b.x<=g&&b.y>=f&&b.y<=m&&b!==s&&b!==a&&O(o,u,l,c,h,d,b.x,b.y)&&G(b.prev,b,b.next)>=0)return!1;b=b.nextZ}for(;y&&y.z>=_;){if(y.x>=p&&y.x<=g&&y.y>=f&&y.y<=m&&y!==s&&y!==a&&O(o,u,l,c,h,d,y.x,y.y)&&G(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;b&&b.z<=v;){if(b.x>=p&&b.x<=g&&b.y>=f&&b.y<=m&&b!==s&&b!==a&&O(o,u,l,c,h,d,b.x,b.y)&&G(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function w(e,t){let i=e;do{const n=i.prev,s=i.next.next;!F(n,s)&&U(n,i,i.next,s)&&H(n,s)&&H(s,n)&&(t.push(n.i,i.i,s.i),j(i),j(i.next),i=e=s),i=i.next}while(i!==e);return S(i)}function P(e,t,i,n,s,r){let a=e;do{let e=a.next.next;for(;e!==a.prev;){if(a.i!==e.i&&B(a,e)){let o=V(a,e);return a=S(a,a.next),o=S(o,o.next),A(a,t,i,n,s,r,0),void A(o,t,i,n,s,r,0)}e=e.next}a=a.next}while(a!==e)}function I(e,t){let i=e.x-t.x;if(0===i&&(i=e.y-t.y,0===i)){i=(e.next.y-e.y)/(e.next.x-e.x)-(t.next.y-t.y)/(t.next.x-t.x)}return i}function M(e,t){const i=function(e,t){let i=t;const n=e.x,s=e.y;let r,a=-1/0;if(F(e,i))return i;do{if(F(e,i.next))return i.next;if(s<=i.y&&s>=i.next.y&&i.next.y!==i.y){const e=i.x+(s-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(e<=n&&e>a&&(a=e,r=i.x<i.next.x?i:i.next,e===n))return r}i=i.next}while(i!==t);if(!r)return null;const o=r,l=r.x,h=r.y;let u=1/0;i=r;do{if(n>=i.x&&i.x>=l&&n!==i.x&&D(s<h?n:a,s,l,h,s<h?a:n,s,i.x,i.y)){const t=Math.abs(s-i.y)/(n-i.x);H(i,e)&&(t<u||t===u&&(i.x>r.x||i.x===r.x&&R(r,i)))&&(r=i,u=t)}i=i.next}while(i!==o);return r}(e,t);if(!i)return t;const n=V(i,e);return S(n,n.next),S(i,i.next)}function R(e,t){return G(e.prev,e,t.prev)<0&&G(t.next,e,e.next)<0}function L(e,t,i,n,s){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*s|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*s|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function k(e){let t=e,i=e;do{(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next}while(t!==e);return i}function D(e,t,i,n,s,r,a,o){return(s-a)*(t-o)>=(e-a)*(r-o)&&(e-a)*(n-o)>=(i-a)*(t-o)&&(i-a)*(r-o)>=(s-a)*(n-o)}function O(e,t,i,n,s,r,a,o){return!(e===a&&t===o)&&D(e,t,i,n,s,r,a,o)}function B(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){let i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&U(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}(e,t)&&(H(e,t)&&H(t,e)&&function(e,t){let i=e,n=!1;const s=(e.x+t.x)/2,r=(e.y+t.y)/2;do{i.y>r!=i.next.y>r&&i.next.y!==i.y&&s<(i.next.x-i.x)*(r-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==e);return n}(e,t)&&(G(e.prev,e,t.prev)||G(e,t.prev,t))||F(e,t)&&G(e.prev,e,e.next)>0&&G(t.prev,t,t.next)>0)}function G(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function F(e,t){return e.x===t.x&&e.y===t.y}function U(e,t,i,n){const s=z(G(e,t,i)),r=z(G(e,t,n)),a=z(G(i,n,e)),o=z(G(i,n,t));return s!==r&&a!==o||(!(0!==s||!N(e,i,t))||(!(0!==r||!N(e,n,t))||(!(0!==a||!N(i,e,n))||!(0!==o||!N(i,t,n)))))}function N(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function z(e){return e>0?1:e<0?-1:0}function H(e,t){return G(e.prev,e,e.next)<0?G(e,t,e.next)>=0&&G(e,e.prev,t)>=0:G(e,t,e.prev)<0||G(e,e.next,t)<0}function V(e,t){const i=X(e.i,e.x,e.y),n=X(t.i,t.x,t.y),s=e.next,r=t.prev;return e.next=t,t.prev=e,i.next=s,s.prev=i,n.next=i,i.prev=n,r.next=n,n.prev=r,n}function W(e,t,i,n){const s=X(e,t,i);return n?(s.next=n.next,s.prev=n,n.next.prev=s,n.next=s):(s.prev=s,s.next=s),s}function j(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function X(e,t,i){return{i:e,x:t,y:i,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Y(e,t,i,n){let s=0;for(let r=t,a=i-n;r<i;r+=n)s+=(e[a]-e[r])*(e[r+1]+e[a+1]),a=r;return s}i(2551);const K=x.default||x;function q(e,t,i,n,s,r,a){const o=K(e,t,2);if(!o)return;for(let e=0;e<o.length;e+=3)r[a++]=o[e]+s,r[a++]=o[e+1]+s,r[a++]=o[e+2]+s;let l=s*n;for(let t=0;t<e.length;t+=2)i[l]=e[t],i[l+1]=e[t+1],l+=n}const $=[],Q={extension:{type:n.Ag.ShapeBuilder,name:"polygon"},build(e,t){for(let i=0;i<e.points.length;i++)t[i]=e.points[i];return!0},triangulate(e,t,i,n,s,r){q(e,$,t,i,n,s,r)}},Z={extension:{type:n.Ag.ShapeBuilder,name:"rectangle"},build(e,t){const i=e,n=i.x,s=i.y,r=i.width,a=i.height;return r>0&&a>0&&(t[0]=n,t[1]=s,t[2]=n+r,t[3]=s,t[4]=n+r,t[5]=s+a,t[6]=n,t[7]=s+a,!0)},triangulate(e,t,i,n,s,r){let a=0;t[(n*=i)+a]=e[0],t[n+a+1]=e[1],a+=i,t[n+a]=e[2],t[n+a+1]=e[3],a+=i,t[n+a]=e[6],t[n+a+1]=e[7],a+=i,t[n+a]=e[4],t[n+a+1]=e[5],a+=i;const o=n/i;s[r++]=o,s[r++]=o+1,s[r++]=o+2,s[r++]=o+1,s[r++]=o+3,s[r++]=o+2}},J={extension:{type:n.Ag.ShapeBuilder,name:"triangle"},build:(e,t)=>(t[0]=e.x,t[1]=e.y,t[2]=e.x2,t[3]=e.y2,t[4]=e.x3,t[5]=e.y3,!0),triangulate(e,t,i,n,s,r){let a=0;t[(n*=i)+a]=e[0],t[n+a+1]=e[1],a+=i,t[n+a]=e[2],t[n+a+1]=e[3],a+=i,t[n+a]=e[4],t[n+a+1]=e[5];const o=n/i;s[r++]=o,s[r++]=o+1,s[r++]=o+2}};var ee=i(8457);const te=new h.u,ie=new u.M;const ne={};n.XO.handleByMap(n.Ag.ShapeBuilder,ne),n.XO.add(Z,Q,J,f,g,m);const se=new u.M,re=new h.u;function ae(e,t,i){const n=[],s=ne.rectangle,r=se;r.x=e.dx,r.y=e.dy,r.width=e.dw,r.height=e.dh;const a=e.transform;if(!s.build(r,n))return;const{vertices:o,uvs:h,indices:u}=i,d=u.length,f=o.length/2;a&&c(n,a),s.triangulate(n,o,2,f,u,d);const g=e.image,m=g.uvs;h.push(m.x0,m.y0,m.x1,m.y1,m.x3,m.y3,m.x2,m.y2);const _=l.Z.get(p.G);_.indexOffset=d,_.indexSize=u.length-d,_.attributeOffset=f,_.attributeSize=o.length/2-f,_.baseColor=e.style,_.alpha=e.alpha,_.texture=g,_.geometryData=i,t.push(_)}function oe(e,t,i,n,s){const{vertices:r,uvs:a,indices:o}=s;e.shapePrimitives.forEach(({shape:e,transform:h,holes:u})=>{const f=[],g=ne[e.type];if(!g.build(e,f))return;const m=o.length,x=r.length/2;let T="triangle-list";if(h&&c(f,h),i){const i=e.closePath??!0,n=t;n.pixelLine?(!function(e,t,i,n){const s=v;if(0===e.length)return;const r=e[0],a=e[1],o=e[e.length-2],l=e[e.length-1],h=t||Math.abs(r-o)<s&&Math.abs(a-l)<s,u=i,c=e.length/2,d=u.length/2;for(let t=0;t<c;t++)u.push(e[2*t]),u.push(e[2*t+1]);for(let e=0;e<c-1;e++)n.push(d+e,d+e+1);h&&n.push(d+c-1,d)}(f,i,r,o),T="line-list"):function(e,t,i,n,s,r){const a=v;if(0===e.length)return;const o=t;let l=o.alignment;if(.5!==t.alignment){let t=function(e){const t=e.length;if(t<6)return 1;let i=0;for(let n=0,s=e[t-2],r=e[t-1];n<t;n+=2){const t=e[n],a=e[n+1];i+=(t-s)*(a+r),s=t,r=a}return i<0?-1:1}(e);i&&(t*=-1),l=(l-.5)*t+.5}const h=new _.b(e[0],e[1]),u=new _.b(e[e.length-2],e[e.length-1]),c=n,d=Math.abs(h.x-u.x)<a&&Math.abs(h.y-u.y)<a;if(c){e=e.slice(),d&&(e.pop(),e.pop(),u.set(e[e.length-2],e[e.length-1]));const t=.5*(h.x+u.x),i=.5*(u.y+h.y);e.unshift(t,i),e.push(t,i)}const p=s,f=e.length/2;let g=e.length;const m=p.length/2,x=o.width/2,T=x*x,S=o.miterLimit*o.miterLimit;let A=e[0],E=e[1],C=e[2],w=e[3],P=0,I=0,M=-(E-w),R=A-C,L=0,k=0,D=Math.sqrt(M*M+R*R);M/=D,R/=D,M*=x,R*=x;const O=2*(1-l),B=2*l;c||("round"===o.cap?g+=b(A-M*(O-B)*.5,E-R*(O-B)*.5,A-M*O,E-R*O,A+M*B,E+R*B,p,!0)+2:"square"===o.cap&&(g+=y(A,E,M,R,O,B,!0,p))),p.push(A-M*O,E-R*O),p.push(A+M*B,E+R*B);for(let t=1;t<f-1;++t){A=e[2*(t-1)],E=e[2*(t-1)+1],C=e[2*t],w=e[2*t+1],P=e[2*(t+1)],I=e[2*(t+1)+1],M=-(E-w),R=A-C,D=Math.sqrt(M*M+R*R),M/=D,R/=D,M*=x,R*=x,L=-(w-I),k=C-P,D=Math.sqrt(L*L+k*k),L/=D,k/=D,L*=x,k*=x;const i=C-A,n=E-w,s=C-P,r=I-w,a=i*s+n*r,l=n*s-r*i,h=l<0;if(Math.abs(l)<.001*Math.abs(a)){p.push(C-M*O,w-R*O),p.push(C+M*B,w+R*B),a>=0&&("round"===o.join?g+=b(C,w,C-M*O,w-R*O,C-L*O,w-k*O,p,!1)+4:g+=2,p.push(C-L*B,w-k*B),p.push(C+L*O,w+k*O));continue}const u=(-M+A)*(-R+w)-(-M+C)*(-R+E),c=(-L+P)*(-k+w)-(-L+C)*(-k+I),d=(i*c-s*u)/l,f=(r*u-n*c)/l,m=(d-C)*(d-C)+(f-w)*(f-w),_=C+(d-C)*O,v=w+(f-w)*O,y=C-(d-C)*B,G=w-(f-w)*B,F=h?O:B;m<=Math.min(i*i+n*n,s*s+r*r)+F*F*T?"bevel"===o.join||m/T>S?(h?(p.push(_,v),p.push(C+M*B,w+R*B),p.push(_,v),p.push(C+L*B,w+k*B)):(p.push(C-M*O,w-R*O),p.push(y,G),p.push(C-L*O,w-k*O),p.push(y,G)),g+=2):"round"===o.join?h?(p.push(_,v),p.push(C+M*B,w+R*B),g+=b(C,w,C+M*B,w+R*B,C+L*B,w+k*B,p,!0)+4,p.push(_,v),p.push(C+L*B,w+k*B)):(p.push(C-M*O,w-R*O),p.push(y,G),g+=b(C,w,C-M*O,w-R*O,C-L*O,w-k*O,p,!1)+4,p.push(C-L*O,w-k*O),p.push(y,G)):(p.push(_,v),p.push(y,G)):(p.push(C-M*O,w-R*O),p.push(C+M*B,w+R*B),"round"===o.join?g+=h?b(C,w,C+M*B,w+R*B,C+L*B,w+k*B,p,!0)+2:b(C,w,C-M*O,w-R*O,C-L*O,w-k*O,p,!1)+2:"miter"===o.join&&m/T<=S&&(h?(p.push(y,G),p.push(y,G)):(p.push(_,v),p.push(_,v)),g+=2),p.push(C-L*O,w-k*O),p.push(C+L*B,w+k*B),g+=2)}A=e[2*(f-2)],E=e[2*(f-2)+1],C=e[2*(f-1)],w=e[2*(f-1)+1],M=-(E-w),R=A-C,D=Math.sqrt(M*M+R*R),M/=D,R/=D,M*=x,R*=x,p.push(C-M*O,w-R*O),p.push(C+M*B,w+R*B),c||("round"===o.cap?g+=b(C-M*(O-B)*.5,w-R*(O-B)*.5,C-M*O,w-R*O,C+M*B,w+R*B,p,!1)+2:"square"===o.cap&&(g+=y(C,w,M,R,O,B,!1,p)));for(let e=m;e<g+m-2;++e)A=p[2*e],E=p[2*e+1],C=p[2*(e+1)],w=p[2*(e+1)+1],P=p[2*(e+2)],I=p[2*(e+2)+1],Math.abs(A*(w-I)+C*(I-E)+P*(E-w))<1e-8||r.push(e,e+1,e+2)}(f,n,!1,i,r,o)}else if(u){const e=[],t=f.slice();(function(e){const t=[];for(let i=0;i<e.length;i++){const n=e[i].shape,s=[];ne[n.type].build(n,s)&&t.push(s)}return t})(u).forEach(i=>{e.push(t.length/2),t.push(...i)}),q(t,e,r,2,x,o,m)}else g.triangulate(f,r,2,x,o,m);const S=a.length/2,A=t.texture;if(A!==d.g.WHITE){const i=function(e,t,i,n){const s=t.matrix?e.copyFrom(t.matrix).invert():e.identity();if("local"===t.textureSpace){const e=i.getBounds(ie);t.width&&e.pad(t.width);const{x:n,y:r}=e,a=1/e.width,o=1/e.height,l=-n*a,h=-r*o,u=s.a,c=s.b,d=s.c,p=s.d;s.a*=a,s.b*=a,s.c*=o,s.d*=o,s.tx=l*u+h*d+s.tx,s.ty=l*c+h*p+s.ty}else s.translate(t.texture.frame.x,t.texture.frame.y),s.scale(1/t.texture.source.width,1/t.texture.source.height);const r=t.texture.source.style;return t.fill instanceof ee._||"clamp-to-edge"!==r.addressMode||(r.addressMode="repeat",r.update()),n&&s.append(te.copyFrom(n).invert()),s}(re,t,e,h);!function(e,t,i,n,s,r,a,o=null){let l=0;i*=t,s*=r;const h=o.a,u=o.b,c=o.c,d=o.d,p=o.tx,f=o.ty;for(;l<a;){const a=e[i],o=e[i+1];n[s]=h*a+c*o+p,n[s+1]=u*a+d*o+f,s+=r,i+=t,l++}}(r,2,x,a,S,2,r.length/2-x,i)}else!function(e,t,i,n){let s=0;for(t*=i;s<n;)e[t]=0,e[t+1]=0,t+=i,s++}(a,S,2,r.length/2-x);const E=l.Z.get(p.G);E.indexOffset=m,E.indexSize=o.length-m,E.attributeOffset=x,E.attributeSize=r.length/2-x,E.baseColor=t.color,E.alpha=t.alpha,E.texture=A,E.geometryData=s,E.topology=T,n.push(E)})}class le{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class he{constructor(){this.instructions=new a.L}init(e){this.batcher=new r.J({maxTextures:e}),this.instructions.reset()}get geometry(){return(0,o.t6)(o.Ek,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}destroy(){this.batcher.destroy(),this.instructions.destroy(),this.batcher=null,this.instructions=null}}const ue=class e{constructor(e){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),this._renderer=e,e.renderableGC.addManagedHash(this,"_gpuContextHash"),e.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(t){e.defaultOptions.bezierSmoothness=t?.bezierSmoothness??e.defaultOptions.bezierSmoothness}getContextRenderData(e){return this._graphicsDataContextHash[e.uid]||this._initContextRenderData(e)}updateGpuContext(e){let t=this._gpuContextHash[e.uid]||this._initContext(e);if(e.dirty){t?this._cleanGraphicsContextData(e):t=this._initContext(e),function(e,t){const{geometryData:i,batches:n}=t;n.length=0,i.indices.length=0,i.vertices.length=0,i.uvs.length=0;for(let t=0;t<e.instructions.length;t++){const s=e.instructions[t];if("texture"===s.action)ae(s.data,n,i);else if("fill"===s.action||"stroke"===s.action){const e="stroke"===s.action,t=s.data.path.shapePath,r=s.data.style,a=s.data.hole;e&&a&&oe(a.shapePath,r,!0,n,i),a&&(t.shapePrimitives[t.shapePrimitives.length-1].holes=a.shapePath.shapePrimitives),oe(t,r,e,n,i)}}}(e,t);const i=e.batchMode;e.customShader||"no-batch"===i?t.isBatchable=!1:t.isBatchable="auto"!==i||t.geometryData.vertices.length<400,e.dirty=!1}return t}getGpuContext(e){return this._gpuContextHash[e.uid]||this._initContext(e)}_initContextRenderData(e){const t=l.Z.get(he,{maxTextures:this._renderer.limits.maxBatchableTextures}),{batches:i,geometryData:n}=this._gpuContextHash[e.uid],r=n.vertices.length,a=n.indices.length;for(let e=0;e<i.length;e++)i[e].applyTransform=!1;const o=t.batcher;o.ensureAttributeBuffer(r),o.ensureIndexBuffer(a),o.begin();for(let e=0;e<i.length;e++){const t=i[e];o.add(t)}o.finish(t.instructions);const h=o.geometry;h.indexBuffer.setDataWithSize(o.indexBuffer,o.indexSize,!0),h.buffers[0].setDataWithSize(o.attributeBuffer.float32View,o.attributeSize,!0);const u=o.batches;for(let e=0;e<u.length;e++){const t=u[e];t.bindGroup=(0,s.w)(t.textures.textures,t.textures.count,this._renderer.limits.maxBatchableTextures)}return this._graphicsDataContextHash[e.uid]=t,t}_initContext(e){const t=new le;return t.context=e,this._gpuContextHash[e.uid]=t,e.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]}onGraphicsContextDestroy(e){this._cleanGraphicsContextData(e),e.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[e.uid]=null}_cleanGraphicsContextData(e){const t=this._gpuContextHash[e.uid];t.isBatchable||this._graphicsDataContextHash[e.uid]&&(l.Z.return(this.getContextRenderData(e)),this._graphicsDataContextHash[e.uid]=null),t.batches&&t.batches.forEach(e=>{l.Z.return(e)})}destroy(){for(const e in this._gpuContextHash)this._gpuContextHash[e]&&this.onGraphicsContextDestroy(this._gpuContextHash[e].context)}};ue.extension={type:[n.Ag.WebGLSystem,n.Ag.WebGPUSystem,n.Ag.CanvasSystem],name:"graphicsContext"},ue.defaultOptions={bezierSmoothness:.5};let ce=ue},3065:(e,t,i)=>{"use strict";i.d(t,{K:()=>n});class n{constructor(){this.batcherName="default",this.topology="triangle-list",this.attributeSize=4,this.indexSize=6,this.packAsQuad=!0,this.roundPixels=0,this._attributeStart=0,this._batcher=null,this._batch=null}get blendMode(){return this.renderable.groupBlendMode}get color(){return this.renderable.groupColorAlpha}reset(){this.renderable=null,this.texture=null,this._batcher=null,this._batch=null,this.bounds=null}destroy(){}}},3079:(e,t,i)=>{"use strict";i.d(t,{mc:()=>X,u:()=>W,ig:()=>V,fR:()=>j});var n=i(2551),s=i(7747);var r=i(8602),a=i(6680),o=i(1851),l=i(7313),h=i(198),u=i(4303),c=i(9731),d=i(5148);const p={get isCachedAsTexture(){return!!this.renderGroup?.isCachedAsTexture},cacheAsTexture(e){"boolean"==typeof e&&!1===e?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(!0===e?{}:e))},updateCacheTexture(){this.renderGroup?.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(e){(0,u.t6)("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(e)}};var f=i(7752);const g={allowChildren:!0,removeChildren(e=0,t){const i=t??this.children.length,n=i-e,s=[];if(n>0&&n<=i){for(let t=i-1;t>=e;t--){const e=this.children[t];e&&(s.push(e),e.parent=null)}(0,f.d)(this.children,e,i);const t=this.renderGroup||this.parentRenderGroup;t&&t.removeChildren(s);for(let e=0;e<s.length;++e){const t=s[e];t.parentRenderLayer?.detach(t),this.emit("childRemoved",t,this,e),s[e].emit("removed",this)}return s.length>0&&this._didViewChangeTick++,s}if(0===n&&0===this.children.length)return s;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(e){const t=this.getChildAt(e);return this.removeChild(t)},getChildAt(e){if(e<0||e>=this.children.length)throw new Error(`getChildAt: Index (${e}) does not exist.`);return this.children[e]},setChildIndex(e,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);this.getChildIndex(e),this.addChildAt(e,t)},getChildIndex(e){const t=this.children.indexOf(e);if(-1===t)throw new Error("The supplied Container must be a child of the caller");return t},addChildAt(e,t){this.allowChildren||(0,u.t6)(u.lj,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:i}=this;if(t<0||t>i.length)throw new Error(`${e}addChildAt: The index ${t} supplied is out of bounds ${i.length}`);if(e.parent){const i=e.parent.children.indexOf(e);if(e.parent===this&&i===t)return e;-1!==i&&e.parent.children.splice(i,1)}t===i.length?i.push(e):i.splice(t,0,e),e.parent=this,e.didChange=!0,e._updateFlags=15;const n=this.renderGroup||this.parentRenderGroup;return n&&n.addChild(e),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",e,this,t),e.emit("added",this),e},swapChildren(e,t){if(e===t)return;const i=this.getChildIndex(e),n=this.getChildIndex(t);this.children[i]=t,this.children[n]=e;const s=this.renderGroup||this.parentRenderGroup;s&&(s.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){this.parent?.removeChild(this)},reparentChild(...e){return 1===e.length?this.reparentChildAt(e[0],this.children.length):(e.forEach(e=>this.reparentChildAt(e,this.children.length)),e[0])},reparentChildAt(e,t){if(e.parent===this)return this.setChildIndex(e,t),e;const i=e.worldTransform.clone();e.removeFromParent(),this.addChildAt(e,t);const n=this.worldTransform.clone();return n.invert(),i.prepend(n),e.setFromMatrix(i),e},replaceChild(e,t){e.updateLocalTransform(),this.addChildAt(t,this.getChildIndex(e)),t.setFromMatrix(e.localTransform),t.updateLocalTransform(),this.removeChild(e)}},m={collectRenderables(e,t,i){this.parentRenderLayer&&this.parentRenderLayer!==i||this.globalDisplayStatus<7||!this.includeInBuild||(this.sortableChildren&&this.sortChildren(),this.isSimple?this.collectRenderablesSimple(e,t,i):this.renderGroup?t.renderPipes.renderGroup.addRenderGroup(this.renderGroup,e):this.collectRenderablesWithEffects(e,t,i))},collectRenderablesSimple(e,t,i){const n=this.children,s=n.length;for(let r=0;r<s;r++)n[r].collectRenderables(e,t,i)},collectRenderablesWithEffects(e,t,i){const{renderPipes:n}=t;for(let t=0;t<this.effects.length;t++){const i=this.effects[t];n[i.pipe].push(i,this,e)}this.collectRenderablesSimple(e,t,i);for(let t=this.effects.length-1;t>=0;t--){const i=this.effects[t];n[i.pipe].pop(i,this,e)}}};var _=i(9302);const v=new class{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(e=>{this.add({test:e.test,maskClass:e})}))}add(e){this._tests.push(e)}getMaskEffect(e){this._initialized||this.init();for(let t=0;t<this._tests.length;t++){const i=this._tests[t];if(i.test(e))return d.Z.get(i.maskClass,e)}return e}returnMaskEffect(e){d.Z.return(e)}};r.XO.handleByList(r.Ag.MaskEffect,v._effectClasses);const y={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){const e=this.renderGroup||this.parentRenderGroup;e&&(e.structureDidChange=!0)},addEffect(e){-1===this.effects.indexOf(e)&&(this.effects.push(e),this.effects.sort((e,t)=>e.priority-t.priority),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(e){const t=this.effects.indexOf(e);-1!==t&&(this.effects.splice(t,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(e){const t=this._maskEffect;t?.mask!==e&&(t&&(this.removeEffect(t),v.returnMaskEffect(t),this._maskEffect=null),null!=e&&(this._maskEffect=v.getMaskEffect(e),this.addEffect(this._maskEffect)))},get mask(){return this._maskEffect?.mask},setMask(e){this._maskOptions={...this._maskOptions,...e},e.mask&&(this.mask=e.mask),this._markStructureAsChanged()},set filters(e){!Array.isArray(e)&&e&&(e=[e]);const t=this._filterEffect||(this._filterEffect=new _.a),i=e?.length>0,n=i!==t.filters?.length>0;e=Array.isArray(e)?e.slice(0):e,t.filters=Object.freeze(e),n&&(i?this.addEffect(t):(this.removeEffect(t),t.filters=e??null))},get filters(){return this._filterEffect?.filters},set filterArea(e){this._filterEffect||(this._filterEffect=new _.a),this._filterEffect.filterArea=e},get filterArea(){return this._filterEffect?.filterArea}},b={label:null,get name(){return(0,u.t6)(u.lj,"Container.name property has been removed, use Container.label instead"),this.label},set name(e){(0,u.t6)(u.lj,"Container.name property has been removed, use Container.label instead"),this.label=e},getChildByName(e,t=!1){return this.getChildByLabel(e,t)},getChildByLabel(e,t=!1){const i=this.children;for(let t=0;t<i.length;t++){const n=i[t];if(n.label===e||e instanceof RegExp&&e.test(n.label))return n}if(t)for(let t=0;t<i.length;t++){const n=i[t].getChildByLabel(e,!0);if(n)return n}return null},getChildrenByLabel(e,t=!1,i=[]){const n=this.children;for(let t=0;t<n.length;t++){const s=n[t];(s.label===e||e instanceof RegExp&&e.test(s.label))&&i.push(s)}if(t)for(let t=0;t<n.length;t++)n[t].getChildrenByLabel(e,!0,i);return i}};var x=i(3289),T=i(1675);const S=new a.u,A={getFastGlobalBounds(e,t){t||(t=new x.c),t.clear(),this._getGlobalBoundsRecursive(!!e,t,this.parentRenderLayer),t.isValid||t.set(0,0,0,0);const i=this.renderGroup||this.parentRenderGroup;return t.applyMatrix(i.worldTransform),t},_getGlobalBoundsRecursive(e,t,i){let n=t;if(e&&this.parentRenderLayer&&this.parentRenderLayer!==i)return;if(7!==this.localDisplayStatus||!this.measurable)return;const s=!!this.effects.length;if((this.renderGroup||s)&&(n=T.o.get().clear()),this.boundsArea)t.addRect(this.boundsArea,this.worldTransform);else{if(this.renderPipeId){const e=this.bounds;n.addFrame(e.minX,e.minY,e.maxX,e.maxY,this.groupTransform)}const t=this.children;for(let s=0;s<t.length;s++)t[s]._getGlobalBoundsRecursive(e,n,i)}if(s){let e=!1;const i=this.renderGroup||this.parentRenderGroup;for(let t=0;t<this.effects.length;t++)this.effects[t].addBounds&&(e||(e=!0,n.applyMatrix(i.worldTransform)),this.effects[t].addBounds(n,!0));e&&n.applyMatrix(i.worldTransform.copyTo(S).invert()),t.addBounds(n),T.o.return(n)}else this.renderGroup&&(t.addBounds(n,this.relativeGroupTransform),T.o.return(n))}};var E=i(6456),C=i(4490);function w(e){return((255&e)<<16)+(65280&e)+(e>>16&255)}const P={getGlobalAlpha(e){if(e)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let t=this.alpha,i=this.parent;for(;i;)t*=i.alpha,i=i.parent;return t},getGlobalTransform(e=new a.u,t){if(t)return e.copyFrom(this.worldTransform);this.updateLocalTransform();const i=(0,E.E)(this,T.u.get().identity());return e.appendFrom(this.localTransform,i),T.u.return(i),e},getGlobalTint(e){if(e)return this.renderGroup?w(this.renderGroup.worldColor):this.parentRenderGroup?w((0,C.j)(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let t=this.localColor,i=this.parent;for(;i;)t=(0,C.j)(t,i.localColor),i=i.parent;return w(t)}};var I=i(2276);function M(e,t){const i=e.children;for(let e=0;e<i.length;e++){const n=i[e],s=n.uid,r=(65535&n._didViewChangeTick)<<16|65535&n._didContainerChangeTick,a=t.index;t.data[a]===s&&t.data[a+1]===r||(t.data[t.index]=s,t.data[t.index+1]=r,t.didChange=!0),t.index=a+2,n.children.length&&M(n,t)}return t.didChange}const R=new a.u,L={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(e,t){const i=Math.sign(this.scale.x)||1;this.scale.x=0!==t?e/t*i:i},_setHeight(e,t){const i=Math.sign(this.scale.y)||1;this.scale.y=0!==t?e/t*i:i},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new x.c});const e=this._localBoundsCacheData;return e.index=1,e.didChange=!1,e.data[0]!==this._didViewChangeTick&&(e.didChange=!0,e.data[0]=this._didViewChangeTick),M(this,e),e.didChange&&(0,I.n)(this,e.localBounds,R),e.localBounds},getBounds(e,t){return(0,E.f)(this,e,t||new x.c)}},k={_onRender:null,set onRender(e){const t=this.renderGroup||this.parentRenderGroup;if(!e)return this._onRender&&t?.removeOnRender(this),void(this._onRender=null);this._onRender||t?.addOnRender(this),this._onRender=e},get onRender(){return this._onRender}},D={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(e){this._zIndex!==e&&(this._zIndex=e,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(O))}};function O(e,t){return e._zIndex-t._zIndex}var B=i(1828);const G={getGlobalPosition(e=new B.b,t=!1){return this.parent?this.parent.toGlobal(this._position,e,t):(e.x=this._position.x,e.y=this._position.y),e},toGlobal(e,t,i=!1){const n=this.getGlobalTransform(T.u.get(),i);return t=n.apply(e,t),T.u.return(n),t},toLocal(e,t,i,n){t&&(e=t.toGlobal(e,i,n));const s=this.getGlobalTransform(T.u.get(),n);return i=s.applyInverse(e,i),T.u.return(s),i}};var F=i(3797);const U=new l.o(null),N=new l.o(null),z=new l.o(null,1,1),H=new l.o(null),V=1,W=2,j=4;class X extends n.A{constructor(e={}){super(),this.uid=(0,h.L)("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.updateTick=-1,this.localTransform=new a.u,this.relativeGroupTransform=new a.u,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new l.o(this,0,0),this._scale=z,this._pivot=N,this._origin=H,this._skew=U,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],function(e,t,i={}){for(const n in t)i[n]||void 0===t[n]||(e[n]=t[n])}(this,e,{children:!0,parent:!0,effects:!0}),e.children?.forEach(e=>this.addChild(e)),e.parent?.addChild(this)}static mixin(e){(0,u.t6)("8.8.0","Container.mixin is deprecated, please use extensions.mixin instead."),r.XO.mixin(X,e)}set _didChangeId(e){this._didViewChangeTick=e>>12&4095,this._didContainerChangeTick=4095&e}get _didChangeId(){return 4095&this._didContainerChangeTick|(4095&this._didViewChangeTick)<<12}addChild(...e){if(this.allowChildren||(0,u.t6)(u.lj,"addChild: Only Containers will be allowed to add children in v8.0.0"),e.length>1){for(let t=0;t<e.length;t++)this.addChild(e[t]);return e[0]}const t=e[0],i=this.renderGroup||this.parentRenderGroup;return t.parent===this?(this.children.splice(this.children.indexOf(t),1),this.children.push(t),i&&(i.structureDidChange=!0),t):(t.parent&&t.parent.removeChild(t),this.children.push(t),this.sortableChildren&&(this.sortDirty=!0),t.parent=this,t.didChange=!0,t._updateFlags=15,i&&i.addChild(t),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this),this._didViewChangeTick++,0!==t._zIndex&&t.depthOfChildModified(),t)}removeChild(...e){if(e.length>1){for(let t=0;t<e.length;t++)this.removeChild(e[t]);return e[0]}const t=e[0],i=this.children.indexOf(t);return i>-1&&(this._didViewChangeTick++,this.children.splice(i,1),this.renderGroup?this.renderGroup.removeChild(t):this.parentRenderGroup&&this.parentRenderGroup.removeChild(t),t.parentRenderLayer&&t.parentRenderLayer.detach(t),t.parent=null,this.emit("childRemoved",t,this,i),t.emit("removed",this)),t}_onUpdate(e){e&&e===this._skew&&this._updateSkew(),this._didContainerChangeTick++,this.didChange||(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(e){!!this.renderGroup!==e&&(e?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const e=this.parentRenderGroup;e?.removeChild(this),this.renderGroup=d.Z.get(F.m,this),this.groupTransform=a.u.IDENTITY,e?.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const e=this.parentRenderGroup;e?.removeChild(this),d.Z.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,e?.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&0===this.effects.length}get worldTransform(){return this._worldTransform||(this._worldTransform=new a.u),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(e){this._position.x=e}get y(){return this._position.y}set y(e){this._position.y=e}get position(){return this._position}set position(e){this._position.copyFrom(e)}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this._onUpdate(this._skew))}get angle(){return this.rotation*o.bO}set angle(e){this.rotation=e*o.Td}get pivot(){return this._pivot===N&&(this._pivot=new l.o(this,0,0)),this._pivot}set pivot(e){this._pivot===N&&(this._pivot=new l.o(this,0,0),this._origin!==H&&(0,c.R)("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),"number"==typeof e?this._pivot.set(e):this._pivot.copyFrom(e)}get skew(){return this._skew===U&&(this._skew=new l.o(this,0,0)),this._skew}set skew(e){this._skew===U&&(this._skew=new l.o(this,0,0)),this._skew.copyFrom(e)}get scale(){return this._scale===z&&(this._scale=new l.o(this,1,1)),this._scale}set scale(e){this._scale===z&&(this._scale=new l.o(this,0,0)),"string"==typeof e&&(e=parseFloat(e)),"number"==typeof e?this._scale.set(e):this._scale.copyFrom(e)}get origin(){return this._origin===H&&(this._origin=new l.o(this,0,0)),this._origin}set origin(e){this._origin===H&&(this._origin=new l.o(this,0,0),this._pivot!==N&&(0,c.R)("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),"number"==typeof e?this._origin.set(e):this._origin.copyFrom(e)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(e){const t=this.getLocalBounds().width;this._setWidth(e,t)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(e){const t=this.getLocalBounds().height;this._setHeight(e,t)}getSize(e){e||(e={});const t=this.getLocalBounds();return e.width=Math.abs(this.scale.x*t.width),e.height=Math.abs(this.scale.y*t.height),e}setSize(e,t){const i=this.getLocalBounds();"object"==typeof e?(t=e.height??e.width,e=e.width):t??(t=e),void 0!==e&&this._setWidth(e,i.width),void 0!==t&&this._setHeight(t,i.height)}_updateSkew(){const e=this._rotation,t=this._skew;this._cx=Math.cos(e+t._y),this._sx=Math.sin(e+t._y),this._cy=-Math.sin(e-t._x),this._sy=Math.cos(e-t._x)}updateTransform(e){return this.position.set("number"==typeof e.x?e.x:this.position.x,"number"==typeof e.y?e.y:this.position.y),this.scale.set("number"==typeof e.scaleX?e.scaleX||1:this.scale.x,"number"==typeof e.scaleY?e.scaleY||1:this.scale.y),this.rotation="number"==typeof e.rotation?e.rotation:this.rotation,this.skew.set("number"==typeof e.skewX?e.skewX:this.skew.x,"number"==typeof e.skewY?e.skewY:this.skew.y),this.pivot.set("number"==typeof e.pivotX?e.pivotX:this.pivot.x,"number"==typeof e.pivotY?e.pivotY:this.pivot.y),this.origin.set("number"==typeof e.originX?e.originX:this.origin.x,"number"==typeof e.originY?e.originY:this.origin.y),this}setFromMatrix(e){e.decompose(this)}updateLocalTransform(){const e=this._didContainerChangeTick;if(this._didLocalTransformChangeId===e)return;this._didLocalTransformChangeId=e;const t=this.localTransform,i=this._scale,n=this._pivot,s=this._origin,r=this._position,a=i._x,o=i._y,l=n._x,h=n._y,u=-s._x,c=-s._y;t.a=this._cx*a,t.b=this._sx*a,t.c=this._cy*o,t.d=this._sy*o,t.tx=r._x-(l*t.a+h*t.c)+(u*t.a+c*t.c)-u,t.ty=r._y-(l*t.b+h*t.d)+(u*t.b+c*t.d)-c}set alpha(e){e!==this.localAlpha&&(this.localAlpha=e,this._updateFlags|=V,this._onUpdate())}get alpha(){return this.localAlpha}set tint(e){const t=s.Q.shared.setValue(e??16777215).toBgrNumber();t!==this.localColor&&(this.localColor=t,this._updateFlags|=V,this._onUpdate())}get tint(){return w(this.localColor)}set blendMode(e){this.localBlendMode!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=W,this.localBlendMode=e,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(2&this.localDisplayStatus)}set visible(e){const t=e?2:0;(2&this.localDisplayStatus)!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=j,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(4&this.localDisplayStatus)}set culled(e){const t=e?0:4;(4&this.localDisplayStatus)!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=j,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(1&this.localDisplayStatus)}set renderable(e){const t=e?1:0;(1&this.localDisplayStatus)!==t&&(this._updateFlags|=j,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return 7===this.localDisplayStatus&&this.groupAlpha>0}destroy(e=!1){if(this.destroyed)return;let t;this.destroyed=!0,this.children.length&&(t=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._origin=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners();if(("boolean"==typeof e?e:e?.children)&&t)for(let i=0;i<t.length;++i)t[i].destroy(e);this.renderGroup?.destroy(),this.renderGroup=null}}r.XO.mixin(X,g,A,G,k,L,y,b,D,{cullArea:null,cullable:!1,cullableChildren:!0},p,P,m)},3196:(e,t,i)=>{"use strict";var n,s,r,a,o=o||function(e){var t={},i=t.lib={},n=function(){},s=i.Base={extend:function(e){n.prototype=this;var t=new n;return e&&t.mixIn(e),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},r=i.WordArray=s.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||o).stringify(this)},concat:function(e){var t=this.words,i=e.words,n=this.sigBytes;if(e=e.sigBytes,this.clamp(),n%4)for(var s=0;s<e;s++)t[n+s>>>2]|=(i[s>>>2]>>>24-s%4*8&255)<<24-(n+s)%4*8;else if(65535<i.length)for(s=0;s<e;s+=4)t[n+s>>>2]=i[s>>>2];else t.push.apply(t,i);return this.sigBytes+=e,this},clamp:function(){var t=this.words,i=this.sigBytes;t[i>>>2]&=4294967295<<32-i%4*8,t.length=e.ceil(i/4)},clone:function(){var e=s.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var i=[],n=0;n<t;n+=4)i.push(4294967296*e.random()|0);return new r.init(i,t)}}),a=t.enc={},o=a.Hex={stringify:function(e){var t=e.words;e=e.sigBytes;for(var i=[],n=0;n<e;n++){var s=t[n>>>2]>>>24-n%4*8&255;i.push((s>>>4).toString(16)),i.push((15&s).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,i=[],n=0;n<t;n+=2)i[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new r.init(i,t/2)}},l=a.Latin1={stringify:function(e){var t=e.words;e=e.sigBytes;for(var i=[],n=0;n<e;n++)i.push(String.fromCharCode(t[n>>>2]>>>24-n%4*8&255));return i.join("")},parse:function(e){for(var t=e.length,i=[],n=0;n<t;n++)i[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new r.init(i,t)}},h=a.Utf8={stringify:function(e){try{return decodeURIComponent(escape(l.stringify(e)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(e){return l.parse(unescape(encodeURIComponent(e)))}},u=i.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new r.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=h.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var i=this._data,n=i.words,s=i.sigBytes,a=this.blockSize,o=s/(4*a);if(t=(o=t?e.ceil(o):e.max((0|o)-this._minBufferSize,0))*a,s=e.min(4*t,s),t){for(var l=0;l<t;l+=a)this._doProcessBlock(n,l);l=n.splice(0,t),i.sigBytes-=s}return new r.init(l,s)},clone:function(){var e=s.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0});i.Hasher=u.extend({cfg:s.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,i){return new e.init(i).finalize(t)}},_createHmacHelper:function(e){return function(t,i){return new c.HMAC.init(e,i).finalize(t)}}});var c=t.algo={};return t}(Math);!function(e){for(var t=o,i=(s=t.lib).WordArray,n=s.Hasher,s=t.algo,r=[],a=[],l=function(e){return 4294967296*(e-(0|e))|0},h=2,u=0;64>u;){var c;e:{c=h;for(var d=e.sqrt(c),p=2;p<=d;p++)if(!(c%p)){c=!1;break e}c=!0}c&&(8>u&&(r[u]=l(e.pow(h,.5))),a[u]=l(e.pow(h,1/3)),u++),h++}var f=[];s=s.SHA256=n.extend({_doReset:function(){this._hash=new i.init(r.slice(0))},_doProcessBlock:function(e,t){for(var i=this._hash.words,n=i[0],s=i[1],r=i[2],o=i[3],l=i[4],h=i[5],u=i[6],c=i[7],d=0;64>d;d++){if(16>d)f[d]=0|e[t+d];else{var p=f[d-15],g=f[d-2];f[d]=((p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3)+f[d-7]+((g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10)+f[d-16]}p=c+((l<<26|l>>>6)^(l<<21|l>>>11)^(l<<7|l>>>25))+(l&h^~l&u)+a[d]+f[d],g=((n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22))+(n&s^n&r^s&r),c=u,u=h,h=l,l=o+p|0,o=r,r=s,s=n,n=p+g|0}i[0]=i[0]+n|0,i[1]=i[1]+s|0,i[2]=i[2]+r|0,i[3]=i[3]+o|0,i[4]=i[4]+l|0,i[5]=i[5]+h|0,i[6]=i[6]+u|0,i[7]=i[7]+c|0},_doFinalize:function(){var t=this._data,i=t.words,n=8*this._nDataBytes,s=8*t.sigBytes;return i[s>>>5]|=128<<24-s%32,i[14+(s+64>>>9<<4)]=e.floor(n/4294967296),i[15+(s+64>>>9<<4)]=n,t.sigBytes=4*i.length,this._process(),this._hash},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=n._createHelper(s),t.HmacSHA256=n._createHmacHelper(s)}(Math),s=(n=o).enc.Utf8,n.algo.HMAC=n.lib.Base.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=s.parse(t));var i=e.blockSize,n=4*i;t.sigBytes>n&&(t=e.finalize(t)),t.clamp();for(var r=this._oKey=t.clone(),a=this._iKey=t.clone(),o=r.words,l=a.words,h=0;h<i;h++)o[h]^=1549556828,l[h]^=909522486;r.sigBytes=a.sigBytes=n,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher;return e=t.finalize(e),t.reset(),t.finalize(this._oKey.clone().concat(e))}}),function(){var e=o,t=e.lib.WordArray;e.enc.Base64={stringify:function(e){var t=e.words,i=e.sigBytes,n=this._map;e.clamp(),e=[];for(var s=0;s<i;s+=3)for(var r=(t[s>>>2]>>>24-s%4*8&255)<<16|(t[s+1>>>2]>>>24-(s+1)%4*8&255)<<8|t[s+2>>>2]>>>24-(s+2)%4*8&255,a=0;4>a&&s+.75*a<i;a++)e.push(n.charAt(r>>>6*(3-a)&63));if(t=n.charAt(64))for(;e.length%4;)e.push(t);return e.join("")},parse:function(e){var i=e.length,n=this._map;(s=n.charAt(64))&&(-1!=(s=e.indexOf(s))&&(i=s));for(var s=[],r=0,a=0;a<i;a++)if(a%4){var o=n.indexOf(e.charAt(a-1))<<a%4*2,l=n.indexOf(e.charAt(a))>>>6-a%4*2;s[r>>>2]|=(o|l)<<24-r%4*8,r++}return t.create(s,r)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(e){!function(e){e[e.Undefined=0]="Undefined",e[e.Debug=1]="Debug",e[e.Info=2]="Info",e[e.Warning=3]="Warning",e[e.Error=4]="Error",e[e.Critical=5]="Critical"}(e.EGAErrorSeverity||(e.EGAErrorSeverity={})),function(e){e[e.Undefined=0]="Undefined",e[e.Start=1]="Start",e[e.Complete=2]="Complete",e[e.Fail=3]="Fail"}(e.EGAProgressionStatus||(e.EGAProgressionStatus={})),function(e){e[e.Undefined=0]="Undefined",e[e.Source=1]="Source",e[e.Sink=2]="Sink"}(e.EGAResourceFlowType||(e.EGAResourceFlowType={})),function(e){e[e.Undefined=0]="Undefined",e[e.Clicked=1]="Clicked",e[e.Show=2]="Show",e[e.FailedShow=3]="FailedShow",e[e.RewardReceived=4]="RewardReceived"}(e.EGAAdAction||(e.EGAAdAction={})),function(e){e[e.Undefined=0]="Undefined",e[e.Unknown=1]="Unknown",e[e.Offline=2]="Offline",e[e.NoFill=3]="NoFill",e[e.InternalError=4]="InternalError",e[e.InvalidRequest=5]="InvalidRequest",e[e.UnableToPrecache=6]="UnableToPrecache"}(e.EGAAdError||(e.EGAAdError={})),function(e){e[e.Undefined=0]="Undefined",e[e.Video=1]="Video",e[e.RewardedVideo=2]="RewardedVideo",e[e.Playable=3]="Playable",e[e.Interstitial=4]="Interstitial",e[e.OfferWall=5]="OfferWall",e[e.Banner=6]="Banner"}(e.EGAAdType||(e.EGAAdType={})),function(e){!function(e){e[e.NoResponse=0]="NoResponse",e[e.BadResponse=1]="BadResponse",e[e.RequestTimeout=2]="RequestTimeout",e[e.JsonEncodeFailed=3]="JsonEncodeFailed",e[e.JsonDecodeFailed=4]="JsonDecodeFailed",e[e.InternalServerError=5]="InternalServerError",e[e.BadRequest=6]="BadRequest",e[e.Unauthorized=7]="Unauthorized",e[e.UnknownResponseCode=8]="UnknownResponseCode",e[e.Ok=9]="Ok",e[e.Created=10]="Created"}(e.EGAHTTPApiResponse||(e.EGAHTTPApiResponse={}))}(e.http||(e.http={})),function(e){!function(e){e[e.Undefined=0]="Undefined",e[e.EventValidation=1]="EventValidation",e[e.Database=2]="Database",e[e.Init=3]="Init",e[e.Http=4]="Http",e[e.Json=5]="Json"}(e.EGASdkErrorCategory||(e.EGASdkErrorCategory={})),function(e){e[e.Undefined=0]="Undefined",e[e.BusinessEvent=1]="BusinessEvent",e[e.ResourceEvent=2]="ResourceEvent",e[e.ProgressionEvent=3]="ProgressionEvent",e[e.DesignEvent=4]="DesignEvent",e[e.ErrorEvent=5]="ErrorEvent",e[e.InitHttp=9]="InitHttp",e[e.EventsHttp=10]="EventsHttp",e[e.ProcessEvents=11]="ProcessEvents",e[e.AddEventsToStore=12]="AddEventsToStore",e[e.AdEvent=20]="AdEvent"}(e.EGASdkErrorArea||(e.EGASdkErrorArea={})),function(e){e[e.Undefined=0]="Undefined",e[e.InvalidCurrency=1]="InvalidCurrency",e[e.InvalidShortString=2]="InvalidShortString",e[e.InvalidEventPartLength=3]="InvalidEventPartLength",e[e.InvalidEventPartCharacters=4]="InvalidEventPartCharacters",e[e.InvalidStore=5]="InvalidStore",e[e.InvalidFlowType=6]="InvalidFlowType",e[e.StringEmptyOrNull=7]="StringEmptyOrNull",e[e.NotFoundInAvailableCurrencies=8]="NotFoundInAvailableCurrencies",e[e.InvalidAmount=9]="InvalidAmount",e[e.NotFoundInAvailableItemTypes=10]="NotFoundInAvailableItemTypes",e[e.WrongProgressionOrder=11]="WrongProgressionOrder",e[e.InvalidEventIdLength=12]="InvalidEventIdLength",e[e.InvalidEventIdCharacters=13]="InvalidEventIdCharacters",e[e.InvalidProgressionStatus=15]="InvalidProgressionStatus",e[e.InvalidSeverity=16]="InvalidSeverity",e[e.InvalidLongString=17]="InvalidLongString",e[e.DatabaseTooLarge=18]="DatabaseTooLarge",e[e.DatabaseOpenOrCreate=19]="DatabaseOpenOrCreate",e[e.JsonError=25]="JsonError",e[e.FailHttpJsonDecode=29]="FailHttpJsonDecode",e[e.FailHttpJsonEncode=30]="FailHttpJsonEncode",e[e.InvalidAdAction=31]="InvalidAdAction",e[e.InvalidAdType=32]="InvalidAdType",e[e.InvalidString=33]="InvalidString"}(e.EGASdkErrorAction||(e.EGASdkErrorAction={})),function(e){e[e.Undefined=0]="Undefined",e[e.Currency=1]="Currency",e[e.CartType=2]="CartType",e[e.ItemType=3]="ItemType",e[e.ItemId=4]="ItemId",e[e.Store=5]="Store",e[e.FlowType=6]="FlowType",e[e.Amount=7]="Amount",e[e.Progression01=8]="Progression01",e[e.Progression02=9]="Progression02",e[e.Progression03=10]="Progression03",e[e.EventId=11]="EventId",e[e.ProgressionStatus=12]="ProgressionStatus",e[e.Severity=13]="Severity",e[e.Message=14]="Message",e[e.AdAction=15]="AdAction",e[e.AdType=16]="AdType",e[e.AdSdkName=17]="AdSdkName",e[e.AdPlacement=18]="AdPlacement"}(e.EGASdkErrorParameter||(e.EGASdkErrorParameter={}))}(e.events||(e.events={}))}(a||(a={})),function(e){!function(e){e[e.Undefined=0]="Undefined",e[e.Debug=1]="Debug",e[e.Info=2]="Info",e[e.Warning=3]="Warning",e[e.Error=4]="Error",e[e.Critical=5]="Critical"}(e.EGAErrorSeverity||(e.EGAErrorSeverity={})),function(e){e[e.Undefined=0]="Undefined",e[e.Start=1]="Start",e[e.Complete=2]="Complete",e[e.Fail=3]="Fail"}(e.EGAProgressionStatus||(e.EGAProgressionStatus={})),function(e){e[e.Undefined=0]="Undefined",e[e.Source=1]="Source",e[e.Sink=2]="Sink"}(e.EGAResourceFlowType||(e.EGAResourceFlowType={})),function(e){e[e.Undefined=0]="Undefined",e[e.Clicked=1]="Clicked",e[e.Show=2]="Show",e[e.FailedShow=3]="FailedShow",e[e.RewardReceived=4]="RewardReceived"}(e.EGAAdAction||(e.EGAAdAction={})),function(e){e[e.Undefined=0]="Undefined",e[e.Unknown=1]="Unknown",e[e.Offline=2]="Offline",e[e.NoFill=3]="NoFill",e[e.InternalError=4]="InternalError",e[e.InvalidRequest=5]="InvalidRequest",e[e.UnableToPrecache=6]="UnableToPrecache"}(e.EGAAdError||(e.EGAAdError={})),function(e){e[e.Undefined=0]="Undefined",e[e.Video=1]="Video",e[e.RewardedVideo=2]="RewardedVideo",e[e.Playable=3]="Playable",e[e.Interstitial=4]="Interstitial",e[e.OfferWall=5]="OfferWall",e[e.Banner=6]="Banner"}(e.EGAAdType||(e.EGAAdType={}))}(r||(r={})),function(e){!function(e){var t;!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Debug=3]="Debug"}(t||(t={}));var i=function(){function e(){e.debugEnabled=!1}return e.setInfoLog=function(t){e.instance.infoLogEnabled=t},e.setVerboseLog=function(t){e.instance.infoLogVerboseEnabled=t},e.i=function(i){if(e.instance.infoLogEnabled){var n="Info/"+e.Tag+": "+i;e.instance.sendNotificationMessage(n,t.Info)}},e.w=function(i){var n="Warning/"+e.Tag+": "+i;e.instance.sendNotificationMessage(n,t.Warning)},e.e=function(i){var n="Error/"+e.Tag+": "+i;e.instance.sendNotificationMessage(n,t.Error)},e.ii=function(i){if(e.instance.infoLogVerboseEnabled){var n="Verbose/"+e.Tag+": "+i;e.instance.sendNotificationMessage(n,t.Info)}},e.d=function(i){if(e.debugEnabled){var n="Debug/"+e.Tag+": "+i;e.instance.sendNotificationMessage(n,t.Debug)}},e.prototype.sendNotificationMessage=function(e,i){switch(i){case t.Error:console.error(e);break;case t.Warning:console.warn(e);break;case t.Debug:"function"==typeof console.debug?console.debug(e):console.log(e);break;case t.Info:console.log(e)}},e.instance=new e,e.Tag="GameAnalytics",e}();e.GALogger=i}(e.logging||(e.logging={}))}(a||(a={})),function(e){!function(t){var i=e.logging.GALogger,n=function(){function e(){}return e.getHmac=function(e,t){var i=o.HmacSHA256(t,e);return o.enc.Base64.stringify(i)},e.stringMatch=function(e,t){return!(!e||!t)&&t.test(e)},e.joinStringArray=function(e,t){for(var i="",n=0,s=e.length;n<s;n++)n>0&&(i+=t),i+=e[n];return i},e.stringArrayContainsString=function(e,t){if(0===e.length)return!1;for(var i in e)if(e[i]===t)return!0;return!1},e.encode64=function(t){t=encodeURI(t);var i,n,s,r,a,o="",l=0,h=0,u=0;do{s=(i=t.charCodeAt(u++))>>2,r=(3&i)<<4|(n=t.charCodeAt(u++))>>4,a=(15&n)<<2|(l=t.charCodeAt(u++))>>6,h=63&l,isNaN(n)?a=h=64:isNaN(l)&&(h=64),o=o+e.keyStr.charAt(s)+e.keyStr.charAt(r)+e.keyStr.charAt(a)+e.keyStr.charAt(h),i=n=l=0,s=r=a=h=0}while(u<t.length);return o},e.decode64=function(t){var n,s,r,a,o="",l=0,h=0,u=0;/[^A-Za-z0-9\+\/\=]/g.exec(t)&&i.w("There were invalid base64 characters in the input text. Valid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='. Expect errors in decoding."),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{n=e.keyStr.indexOf(t.charAt(u++))<<2|(r=e.keyStr.indexOf(t.charAt(u++)))>>4,s=(15&r)<<4|(a=e.keyStr.indexOf(t.charAt(u++)))>>2,l=(3&a)<<6|(h=e.keyStr.indexOf(t.charAt(u++))),o+=String.fromCharCode(n),64!=a&&(o+=String.fromCharCode(s)),64!=h&&(o+=String.fromCharCode(l)),n=s=l=0,r=a=h=0}while(u<t.length);return decodeURI(o)},e.timeIntervalSince1970=function(){var e=new Date;return Math.round(e.getTime()/1e3)},e.createGuid=function(){return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,function(e){return(+e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>+e/4).toString(16)})},e.keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",e}();t.GAUtilities=n}(e.utilities||(e.utilities={}))}(a||(a={})),function(e){!function(t){var i=e.logging.GALogger,n=e.utilities.GAUtilities,s=e.events.EGASdkErrorCategory,r=e.events.EGASdkErrorArea,a=e.events.EGASdkErrorAction,o=e.events.EGASdkErrorParameter,l=function(e,t,i,n,s){this.category=e,this.area=t,this.action=i,this.parameter=n,this.reason=s};t.ValidationResult=l;var h=function(){function t(){}return t.validateBusinessEvent=function(e,n,h,u,c){return t.validateCurrency(e)?n<0?(i.w("Validation fail - business event - amount. Cannot be less than 0. Failed amount: "+n),new l(s.EventValidation,r.BusinessEvent,a.InvalidAmount,o.Amount,n+"")):t.validateShortString(h,!0)?t.validateEventPartLength(u,!1)?t.validateEventPartCharacters(u)?t.validateEventPartLength(c,!1)?t.validateEventPartCharacters(c)?null:(i.w("Validation fail - business event - itemId: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+c),new l(s.EventValidation,r.BusinessEvent,a.InvalidEventPartCharacters,o.ItemId,c)):(i.w("Validation fail - business event - itemId. Cannot be (null), empty or above 64 characters. String: "+c),new l(s.EventValidation,r.BusinessEvent,a.InvalidEventPartLength,o.ItemId,c)):(i.w("Validation fail - business event - itemType: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+u),new l(s.EventValidation,r.BusinessEvent,a.InvalidEventPartCharacters,o.ItemType,u)):(i.w("Validation fail - business event - itemType: Cannot be (null), empty or above 64 characters. String: "+u),new l(s.EventValidation,r.BusinessEvent,a.InvalidEventPartLength,o.ItemType,u)):(i.w("Validation fail - business event - cartType. Cannot be above 32 length. String: "+h),new l(s.EventValidation,r.BusinessEvent,a.InvalidShortString,o.CartType,h)):(i.w("Validation fail - business event - currency: Cannot be (null) and need to be A-Z, 3 characters and in the standard at openexchangerates.org. Failed currency: "+e),new l(s.EventValidation,r.BusinessEvent,a.InvalidCurrency,o.Currency,e))},t.validateResourceEvent=function(h,u,c,d,p,f,g){return h==e.EGAResourceFlowType.Undefined?(i.w("Validation fail - resource event - flowType: Invalid flow type."),new l(s.EventValidation,r.ResourceEvent,a.InvalidFlowType,o.FlowType,"")):u?n.stringArrayContainsString(f,u)?c>0?d?t.validateEventPartLength(d,!1)?t.validateEventPartCharacters(d)?n.stringArrayContainsString(g,d)?t.validateEventPartLength(p,!1)?t.validateEventPartCharacters(p)?null:(i.w("Validation fail - resource event - itemId: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+p),new l(s.EventValidation,r.ResourceEvent,a.InvalidEventPartCharacters,o.ItemId,p)):(i.w("Validation fail - resource event - itemId: Cannot be (null), empty or above 64 characters. String: "+p),new l(s.EventValidation,r.ResourceEvent,a.InvalidEventPartLength,o.ItemId,p)):(i.w("Validation fail - resource event - itemType: Not found in list of pre-defined available resource itemTypes. String: "+d),new l(s.EventValidation,r.ResourceEvent,a.NotFoundInAvailableItemTypes,o.ItemType,d)):(i.w("Validation fail - resource event - itemType: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+d),new l(s.EventValidation,r.ResourceEvent,a.InvalidEventPartCharacters,o.ItemType,d)):(i.w("Validation fail - resource event - itemType: Cannot be (null), empty or above 64 characters. String: "+d),new l(s.EventValidation,r.ResourceEvent,a.InvalidEventPartLength,o.ItemType,d)):(i.w("Validation fail - resource event - itemType: Cannot be (null)"),new l(s.EventValidation,r.ResourceEvent,a.StringEmptyOrNull,o.ItemType,"")):(i.w("Validation fail - resource event - amount: Float amount cannot be 0 or negative. Value: "+c),new l(s.EventValidation,r.ResourceEvent,a.InvalidAmount,o.Amount,c+"")):(i.w("Validation fail - resource event - currency: Not found in list of pre-defined available resource currencies. String: "+u),new l(s.EventValidation,r.ResourceEvent,a.NotFoundInAvailableCurrencies,o.Currency,u)):(i.w("Validation fail - resource event - currency: Cannot be (null)"),new l(s.EventValidation,r.ResourceEvent,a.StringEmptyOrNull,o.Currency,""))},t.validateProgressionEvent=function(n,h,u,c){if(n==e.EGAProgressionStatus.Undefined)return i.w("Validation fail - progression event: Invalid progression status."),new l(s.EventValidation,r.ProgressionEvent,a.InvalidProgressionStatus,o.ProgressionStatus,"");if(c&&!u&&h)return i.w("Validation fail - progression event: 03 found but 01+02 are invalid. Progression must be set as either 01, 01+02 or 01+02+03."),new l(s.EventValidation,r.ProgressionEvent,a.WrongProgressionOrder,o.Undefined,h+":"+u+":"+c);if(u&&!h)return i.w("Validation fail - progression event: 02 found but not 01. Progression must be set as either 01, 01+02 or 01+02+03"),new l(s.EventValidation,r.ProgressionEvent,a.WrongProgressionOrder,o.Undefined,h+":"+u+":"+c);if(!h)return i.w("Validation fail - progression event: progression01 not valid. Progressions must be set as either 01, 01+02 or 01+02+03"),new l(s.EventValidation,r.ProgressionEvent,a.WrongProgressionOrder,o.Undefined,(h||"")+":"+(u||"")+":"+(c||""));if(!t.validateEventPartLength(h,!1))return i.w("Validation fail - progression event - progression01: Cannot be (null), empty or above 64 characters. String: "+h),new l(s.EventValidation,r.ProgressionEvent,a.InvalidEventPartLength,o.Progression01,h);if(!t.validateEventPartCharacters(h))return i.w("Validation fail - progression event - progression01: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+h),new l(s.EventValidation,r.ProgressionEvent,a.InvalidEventPartCharacters,o.Progression01,h);if(u){if(!t.validateEventPartLength(u,!0))return i.w("Validation fail - progression event - progression02: Cannot be empty or above 64 characters. String: "+u),new l(s.EventValidation,r.ProgressionEvent,a.InvalidEventPartLength,o.Progression02,u);if(!t.validateEventPartCharacters(u))return i.w("Validation fail - progression event - progression02: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+u),new l(s.EventValidation,r.ProgressionEvent,a.InvalidEventPartCharacters,o.Progression02,u)}if(c){if(!t.validateEventPartLength(c,!0))return i.w("Validation fail - progression event - progression03: Cannot be empty or above 64 characters. String: "+c),new l(s.EventValidation,r.ProgressionEvent,a.InvalidEventPartLength,o.Progression03,c);if(!t.validateEventPartCharacters(c))return i.w("Validation fail - progression event - progression03: Cannot contain other characters than A-z, 0-9, -_., ()!?. String: "+c),new l(s.EventValidation,r.ProgressionEvent,a.InvalidEventPartCharacters,o.Progression03,c)}return null},t.validateDesignEvent=function(e){return t.validateEventIdLength(e)?t.validateEventIdCharacters(e)?null:(i.w("Validation fail - design event - eventId: Non valid characters. Only allowed A-z, 0-9, -_., ()!?. String: "+e),new l(s.EventValidation,r.DesignEvent,a.InvalidEventIdCharacters,o.EventId,e)):(i.w("Validation fail - design event - eventId: Cannot be (null) or empty. Only 5 event parts allowed seperated by :. Each part need to be 64 characters or less. String: "+e),new l(s.EventValidation,r.DesignEvent,a.InvalidEventIdLength,o.EventId,e))},t.validateErrorEvent=function(n,h){return n==e.EGAErrorSeverity.Undefined?(i.w("Validation fail - error event - severity: Severity was unsupported value."),new l(s.EventValidation,r.ErrorEvent,a.InvalidSeverity,o.Severity,"")):t.validateLongString(h,!0)?null:(i.w("Validation fail - error event - message: Message cannot be above 8192 characters."),new l(s.EventValidation,r.ErrorEvent,a.InvalidLongString,o.Message,h))},t.validateAdEvent=function(n,h,u,c){return n==e.EGAAdAction.Undefined?(i.w("Validation fail - error event - severity: Severity was unsupported value."),new l(s.EventValidation,r.AdEvent,a.InvalidAdAction,o.AdAction,"")):h==e.EGAAdType.Undefined?(i.w("Validation fail - ad event - adType: Ad type was unsupported value."),new l(s.EventValidation,r.AdEvent,a.InvalidAdType,o.AdType,"")):t.validateShortString(u,!1)?t.validateString(c,!1)?null:(i.w("Validation fail - ad event - message: Ad placement cannot be above 64 characters."),new l(s.EventValidation,r.AdEvent,a.InvalidString,o.AdPlacement,c)):(i.w("Validation fail - ad event - message: Ad SDK name cannot be above 32 characters."),new l(s.EventValidation,r.AdEvent,a.InvalidShortString,o.AdSdkName,u))},t.validateSdkErrorEvent=function(e,n,o,l,h){return!!t.validateKeys(e,n)&&(o===s.Undefined?(i.w("Validation fail - sdk error event - type: Category was unsupported value."),!1):l===r.Undefined?(i.w("Validation fail - sdk error event - type: Area was unsupported value."),!1):h!==a.Undefined||(i.w("Validation fail - sdk error event - type: Action was unsupported value."),!1))},t.validateKeys=function(e,t){return!(!n.stringMatch(e,/^[A-z0-9]{32}$/)||!n.stringMatch(t,/^[A-z0-9]{40}$/))},t.validateCurrency=function(e){return!!e&&!!n.stringMatch(e,/^[A-Z]{3}$/)},t.validateEventPartLength=function(e,t){return!(!t||e)||!!e&&!(e.length>64)},t.validateEventPartCharacters=function(e){return!!n.stringMatch(e,/^[A-Za-z0-9\s\-_\.\(\)\!\?]{1,64}$/)},t.validateEventIdLength=function(e){return!!e&&!!n.stringMatch(e,/^[^:]{1,64}(?::[^:]{1,64}){0,4}$/)},t.validateEventIdCharacters=function(e){return!!e&&!!n.stringMatch(e,/^[A-Za-z0-9\s\-_\.\(\)\!\?]{1,64}(:[A-Za-z0-9\s\-_\.\(\)\!\?]{1,64}){0,4}$/)},t.validateAndCleanInitRequestResponse=function(e,t){if(null==e)return i.w("validateInitRequestResponse failed - no response dictionary."),null;var n={};try{var s=e.server_ts;if(!(s>0))return i.w("validateInitRequestResponse failed - invalid value in 'server_ts' field."),null;n.server_ts=s}catch(t){return i.w("validateInitRequestResponse failed - invalid type in 'server_ts' field. type="+typeof e.server_ts+", value="+e.server_ts+", "+t),null}if(t){try{var r=e.configs;n.configs=r}catch(t){return i.w("validateInitRequestResponse failed - invalid type in 'configs' field. type="+typeof e.configs+", value="+e.configs+", "+t),null}try{var a=e.configs_hash;n.configs_hash=a}catch(t){return i.w("validateInitRequestResponse failed - invalid type in 'configs_hash' field. type="+typeof e.configs_hash+", value="+e.configs_hash+", "+t),null}try{var o=e.ab_id;n.ab_id=o}catch(t){return i.w("validateInitRequestResponse failed - invalid type in 'ab_id' field. type="+typeof e.ab_id+", value="+e.ab_id+", "+t),null}try{var l=e.ab_variant_id;n.ab_variant_id=l}catch(t){return i.w("validateInitRequestResponse failed - invalid type in 'ab_variant_id' field. type="+typeof e.ab_variant_id+", value="+e.ab_variant_id+", "+t),null}}return n},t.validateBuild=function(e){return!!t.validateShortString(e,!1)},t.validateSdkWrapperVersion=function(e){return!!n.stringMatch(e,/^(unity|unreal|gamemaker|cocos2d|construct|defold|godot|flutter) [0-9]{0,5}(\.[0-9]{0,5}){0,2}$/)},t.validateEngineVersion=function(e){return!(!e||!n.stringMatch(e,/^(unity|unreal|gamemaker|cocos2d|construct|defold|godot) [0-9]{0,5}(\.[0-9]{0,5}){0,2}$/))},t.validateUserId=function(e){return!!t.validateString(e,!1)||(i.w("Validation fail - user id: id cannot be (null), empty or above 64 characters."),!1)},t.validateShortString=function(e,t){return!(!t||e)||!(!e||e.length>32)},t.validateString=function(e,t){return!(!t||e)||!(!e||e.length>64)},t.validateLongString=function(e,t){return!(!t||e)||!(!e||e.length>8192)},t.validateConnectionType=function(e){return n.stringMatch(e,/^(wwan|wifi|lan|offline)$/)},t.validateCustomDimensions=function(e){return t.validateArrayOfStrings(20,32,!1,"custom dimensions",e)},t.validateResourceCurrencies=function(e){if(!t.validateArrayOfStrings(20,64,!1,"resource currencies",e))return!1;for(var s=0;s<e.length;++s)if(!n.stringMatch(e[s],/^[A-Za-z]+$/))return i.w("resource currencies validation failed: a resource currency can only be A-Z, a-z. String was: "+e[s]),!1;return!0},t.validateResourceItemTypes=function(e){if(!t.validateArrayOfStrings(20,32,!1,"resource item types",e))return!1;for(var n=0;n<e.length;++n)if(!t.validateEventPartCharacters(e[n]))return i.w("resource item types validation failed: a resource item type cannot contain other characters than A-z, 0-9, -_., ()!?. String was: "+e[n]),!1;return!0},t.validateDimension01=function(e,t){return!e||!!n.stringArrayContainsString(t,e)},t.validateDimension02=function(e,t){return!e||!!n.stringArrayContainsString(t,e)},t.validateDimension03=function(e,t){return!e||!!n.stringArrayContainsString(t,e)},t.validateArrayOfStrings=function(e,t,n,s,r){var a=s;if(a||(a="Array"),!r)return i.w(a+" validation failed: array cannot be null. "),!1;if(0==n&&0==r.length)return i.w(a+" validation failed: array cannot be empty. "),!1;if(e>0&&r.length>e)return i.w(a+" validation failed: array cannot exceed "+e+" values. It has "+r.length+" values."),!1;for(var o=0;o<r.length;++o){var l=r[o]?r[o].length:0;if(0===l)return i.w(a+" validation failed: contained an empty string. Array="+JSON.stringify(r)),!1;if(t>0&&l>t)return i.w(a+" validation failed: a string exceeded max allowed length (which is: "+t+"). String was: "+r[o]),!1}return!0},t.validateClientTs=function(e){return!(e<0||e>99999999999)},t}();t.GAValidator=h}(e.validators||(e.validators={}))}(a||(a={})),function(e){!function(e){var t=function(e,t,i){this.name=e,this.value=t,this.version=i};e.NameValueVersion=t;var i=function(e,t){this.name=e,this.version=t};e.NameVersion=i;var n=function(){function e(){}return e.touch=function(){},e.getRelevantSdkVersion=function(){return e.sdkGameEngineVersion?e.sdkGameEngineVersion:e.sdkWrapperVersion},e.getConnectionType=function(){return e.connectionType},e.updateConnectionType=function(){navigator.onLine?"ios"===e.buildPlatform||"android"===e.buildPlatform?e.connectionType="wwan":e.connectionType="lan":e.connectionType="offline"},e.getOSVersionString=function(){return e.buildPlatform+" "+e.osVersionPair.version},e.runtimePlatformToString=function(){return e.osVersionPair.name},e.getBrowserVersionString=function(){var t,i=navigator.userAgent,n=i.match(/(opera|chrome|safari|firefox|ubrowser|msie|trident|fbav(?=\/))\/?\s*(\d+)/i)||[];if(0==n.length&&"ios"===e.buildPlatform)return"webkit_"+e.osVersion;if(/trident/i.test(n[1]))return"IE "+((t=/\brv[ :]+(\d+)/g.exec(i)||[])[1]||"");if("Chrome"===n[1]&&null!=(t=i.match(/\b(OPR|Edge|UBrowser)\/(\d+)/)))return t.slice(1).join(" ").replace("OPR","Opera").replace("UBrowser","UC").toLowerCase();if(n[1]&&"fbav"===n[1].toLowerCase()&&(n[1]="facebook",n[2]))return"facebook "+n[2];var s=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"];return null!=(t=i.match(/version\/(\d+)/i))&&s.splice(1,1,t[1]),s.join(" ").toLowerCase()},e.getDeviceModel=function(){return"unknown"},e.getDeviceManufacturer=function(){return"unknown"},e.matchItem=function(e,t){var n,s,r,a,o=new i("unknown","0.0.0"),l=0,h=0;for(l=0;l<t.length;l+=1)if(new RegExp(t[l].value,"i").test(e)){if(n=new RegExp(t[l].version+"[- /:;]([\\d._]+)","i"),a="",(s=e.match(n))&&s[1]&&(r=s[1]),r){var u=r.split(/[._]+/);for(h=0;h<Math.min(u.length,3);h+=1)a+=u[h]+(h<Math.min(u.length,3)-1?".":"")}else a="0.0.0";return o.name=t[l].name,o.version=a,o}return o},e.sdkWrapperVersion="javascript 4.4.6",e.osVersionPair=e.matchItem([navigator.platform,navigator.userAgent,navigator.appVersion,navigator.vendor].join(" "),[new t("windows_phone","Windows Phone","OS"),new t("windows","Win","NT"),new t("ios","iPhone","OS"),new t("ios","iPad","OS"),new t("ios","iPod","OS"),new t("android","Android","Android"),new t("blackBerry","BlackBerry","/"),new t("mac_osx","Mac","OS X"),new t("tizen","Tizen","Tizen"),new t("linux","Linux","rv"),new t("kai_os","KAIOS","KAIOS")]),e.buildPlatform=e.runtimePlatformToString(),e.deviceModel=e.getDeviceModel(),e.deviceManufacturer=e.getDeviceManufacturer(),e.osVersion=e.getOSVersionString(),e.browserVersion=e.getBrowserVersionString(),e}();e.GADevice=n}(e.device||(e.device={}))}(a||(a={})),function(e){!function(e){var t=function(){function e(t){this.deadline=t,this.ignore=!1,this.async=!1,this.running=!1,this.id=++e.idCounter}return e.idCounter=0,e}();e.TimedBlock=t}(e.threading||(e.threading={}))}(a||(a={})),function(e){!function(e){var t=function(){function e(e){this.comparer=e,this._subQueues={},this._sortedKeys=[]}return e.prototype.enqueue=function(e,t){-1===this._sortedKeys.indexOf(e)&&this.addQueueOfPriority(e),this._subQueues[e].push(t)},e.prototype.addQueueOfPriority=function(e){var t=this;this._sortedKeys.push(e),this._sortedKeys.sort(function(e,i){return t.comparer.compare(e,i)}),this._subQueues[e]=[]},e.prototype.peek=function(){if(this.hasItems())return this._subQueues[this._sortedKeys[0]][0];throw new Error("The queue is empty")},e.prototype.hasItems=function(){return this._sortedKeys.length>0},e.prototype.dequeue=function(){if(this.hasItems())return this.dequeueFromHighPriorityQueue();throw new Error("The queue is empty")},e.prototype.dequeueFromHighPriorityQueue=function(){var e=this._sortedKeys[0],t=this._subQueues[e].shift();return 0===this._subQueues[e].length&&(this._sortedKeys.shift(),delete this._subQueues[e]),t},e}();e.PriorityQueue=t}(e.threading||(e.threading={}))}(a||(a={})),function(e){!function(t){var i,n,s=e.logging.GALogger;!function(e){e[e.Equal=0]="Equal",e[e.LessOrEqual=1]="LessOrEqual",e[e.NotEqual=2]="NotEqual"}(i=t.EGAStoreArgsOperator||(t.EGAStoreArgsOperator={})),function(e){e[e.Events=0]="Events",e[e.Sessions=1]="Sessions",e[e.Progression=2]="Progression"}(n=t.EGAStore||(t.EGAStore={}));var r=function(){function e(){this.eventsStore=[],this.sessionsStore=[],this.progressionStore=[],this.storeItems={};try{"object"==typeof localStorage?(localStorage.setItem("testingLocalStorage","yes"),localStorage.removeItem("testingLocalStorage"),e.storageAvailable=!0):e.storageAvailable=!1}catch(e){}}return e.isStorageAvailable=function(){return e.storageAvailable},e.isStoreTooLargeForEvents=function(){return e.instance.eventsStore.length+e.instance.sessionsStore.length>e.MaxNumberOfEntries},e.select=function(t,n,s,r){void 0===n&&(n=[]),void 0===s&&(s=!1),void 0===r&&(r=0);var a=e.getStore(t);if(!a)return null;for(var o=[],l=0;l<a.length;++l){for(var h=a[l],u=!0,c=0;c<n.length;++c){var d=n[c];if(h[d[0]])switch(d[1]){case i.Equal:u=h[d[0]]==d[2];break;case i.LessOrEqual:u=h[d[0]]<=d[2];break;case i.NotEqual:u=h[d[0]]!=d[2];break;default:u=!1}else u=!1;if(!u)break}u&&o.push(h)}return s&&o.sort(function(e,t){return e.client_ts-t.client_ts}),r>0&&o.length>r&&(o=o.slice(0,r+1)),o},e.update=function(t,n,s){void 0===s&&(s=[]);var r=e.getStore(t);if(!r)return!1;for(var a=0;a<r.length;++a){for(var o=r[a],l=!0,h=0;h<s.length;++h){var u=s[h];if(o[u[0]])switch(u[1]){case i.Equal:l=o[u[0]]==u[2];break;case i.LessOrEqual:l=o[u[0]]<=u[2];break;case i.NotEqual:l=o[u[0]]!=u[2];break;default:l=!1}else l=!1;if(!l)break}if(l)for(h=0;h<n.length;++h){var c=n[h];o[c[0]]=c[1]}}return!0},e.delete=function(t,n){var s=e.getStore(t);if(s)for(var r=0;r<s.length;++r){for(var a=s[r],o=!0,l=0;l<n.length;++l){var h=n[l];if(a[h[0]])switch(h[1]){case i.Equal:o=a[h[0]]==h[2];break;case i.LessOrEqual:o=a[h[0]]<=h[2];break;case i.NotEqual:o=a[h[0]]!=h[2];break;default:o=!1}else o=!1;if(!o)break}o&&(s.splice(r,1),--r)}},e.insert=function(t,i,n,s){void 0===n&&(n=!1),void 0===s&&(s=null);var r=e.getStore(t);if(r)if(n){if(!s)return;for(var a=!1,o=0;o<r.length;++o){var l=r[o];if(l[s]==i[s]){for(var h in i)l[h]=i[h];a=!0;break}}a||r.push(i)}else r.push(i)},e.save=function(t){e.isStorageAvailable()?(localStorage.setItem(e.StringFormat(e.KeyFormat,t,e.EventsStoreKey),JSON.stringify(e.instance.eventsStore)),localStorage.setItem(e.StringFormat(e.KeyFormat,t,e.SessionsStoreKey),JSON.stringify(e.instance.sessionsStore)),localStorage.setItem(e.StringFormat(e.KeyFormat,t,e.ProgressionStoreKey),JSON.stringify(e.instance.progressionStore)),localStorage.setItem(e.StringFormat(e.KeyFormat,t,e.ItemsStoreKey),JSON.stringify(e.instance.storeItems))):s.w("Storage is not available, cannot save.")},e.load=function(t){if(e.isStorageAvailable()){try{e.instance.eventsStore=JSON.parse(localStorage.getItem(e.StringFormat(e.KeyFormat,t,e.EventsStoreKey))),e.instance.eventsStore||(e.instance.eventsStore=[])}catch(t){s.w("Load failed for 'events' store. Using empty store."),e.instance.eventsStore=[]}try{e.instance.sessionsStore=JSON.parse(localStorage.getItem(e.StringFormat(e.KeyFormat,t,e.SessionsStoreKey))),e.instance.sessionsStore||(e.instance.sessionsStore=[])}catch(t){s.w("Load failed for 'sessions' store. Using empty store."),e.instance.sessionsStore=[]}try{e.instance.progressionStore=JSON.parse(localStorage.getItem(e.StringFormat(e.KeyFormat,t,e.ProgressionStoreKey))),e.instance.progressionStore||(e.instance.progressionStore=[])}catch(t){s.w("Load failed for 'progression' store. Using empty store."),e.instance.progressionStore=[]}try{e.instance.storeItems=JSON.parse(localStorage.getItem(e.StringFormat(e.KeyFormat,t,e.ItemsStoreKey))),e.instance.storeItems||(e.instance.storeItems={})}catch(t){s.w("Load failed for 'items' store. Using empty store."),e.instance.progressionStore=[]}}else s.w("Storage is not available, cannot load.")},e.setItem=function(t,i,n){var s=e.StringFormat(e.KeyFormat,t,i);n?e.instance.storeItems[s]=n:s in e.instance.storeItems&&delete e.instance.storeItems[s]},e.getItem=function(t,i){var n=e.StringFormat(e.KeyFormat,t,i);return n in e.instance.storeItems?e.instance.storeItems[n]:null},e.getStore=function(t){switch(t){case n.Events:return e.instance.eventsStore;case n.Sessions:return e.instance.sessionsStore;case n.Progression:return e.instance.progressionStore;default:return s.w("GAStore.getStore(): Cannot find store: "+t),null}},e.instance=new e,e.MaxNumberOfEntries=2e3,e.StringFormat=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return e.replace(/{(\d+)}/g,function(e,i){return t[i]||""})},e.KeyFormat="GA::{0}::{1}",e.EventsStoreKey="ga_event",e.SessionsStoreKey="ga_session",e.ProgressionStoreKey="ga_progression",e.ItemsStoreKey="ga_items",e}();t.GAStore=r}(e.store||(e.store={}))}(a||(a={})),function(e){!function(t){var i=e.validators.GAValidator,n=e.utilities.GAUtilities,s=e.logging.GALogger,r=e.store.GAStore,a=e.device.GADevice,o=e.store.EGAStore,l=e.store.EGAStoreArgsOperator,h=function(){function e(){this.availableCustomDimensions01=[],this.availableCustomDimensions02=[],this.availableCustomDimensions03=[],this.currentGlobalCustomEventFields={},this.availableResourceCurrencies=[],this.availableResourceItemTypes=[],this.configurations={},this.remoteConfigsListeners=[],this.beforeUnloadListeners=[],this.sdkConfigDefault={},this.sdkConfig={},this.progressionTries={},this._isEventSubmissionEnabled=!0,this.isUnloading=!1}return e.setUserId=function(t){e.instance.userId=t,e.cacheIdentifier()},e.getIdentifier=function(){return e.instance.identifier},e.isInitialized=function(){return e.instance.initialized},e.setInitialized=function(t){e.instance.initialized=t},e.getSessionStart=function(){return e.instance.sessionStart},e.getSessionNum=function(){return e.instance.sessionNum},e.getTransactionNum=function(){return e.instance.transactionNum},e.getSessionId=function(){return e.instance.sessionId},e.getCurrentCustomDimension01=function(){return e.instance.currentCustomDimension01},e.getCurrentCustomDimension02=function(){return e.instance.currentCustomDimension02},e.getCurrentCustomDimension03=function(){return e.instance.currentCustomDimension03},e.getGameKey=function(){return e.instance.gameKey},e.getGameSecret=function(){return e.instance.gameSecret},e.getAvailableCustomDimensions01=function(){return e.instance.availableCustomDimensions01},e.setAvailableCustomDimensions01=function(t){i.validateCustomDimensions(t)&&(e.instance.availableCustomDimensions01=t,e.validateAndFixCurrentDimensions(),s.i("Set available custom01 dimension values: ("+n.joinStringArray(t,", ")+")"))},e.getAvailableCustomDimensions02=function(){return e.instance.availableCustomDimensions02},e.setAvailableCustomDimensions02=function(t){i.validateCustomDimensions(t)&&(e.instance.availableCustomDimensions02=t,e.validateAndFixCurrentDimensions(),s.i("Set available custom02 dimension values: ("+n.joinStringArray(t,", ")+")"))},e.getAvailableCustomDimensions03=function(){return e.instance.availableCustomDimensions03},e.setAvailableCustomDimensions03=function(t){i.validateCustomDimensions(t)&&(e.instance.availableCustomDimensions03=t,e.validateAndFixCurrentDimensions(),s.i("Set available custom03 dimension values: ("+n.joinStringArray(t,", ")+")"))},e.getAvailableResourceCurrencies=function(){return e.instance.availableResourceCurrencies},e.setAvailableResourceCurrencies=function(t){i.validateResourceCurrencies(t)&&(e.instance.availableResourceCurrencies=t,s.i("Set available resource currencies: ("+n.joinStringArray(t,", ")+")"))},e.getAvailableResourceItemTypes=function(){return e.instance.availableResourceItemTypes},e.setAvailableResourceItemTypes=function(t){i.validateResourceItemTypes(t)&&(e.instance.availableResourceItemTypes=t,s.i("Set available resource item types: ("+n.joinStringArray(t,", ")+")"))},e.getBuild=function(){return e.instance.build},e.setBuild=function(t){e.instance.build=t,s.i("Set build version: "+t)},e.getUseManualSessionHandling=function(){return e.instance.useManualSessionHandling},e.isEventSubmissionEnabled=function(){return e.instance._isEventSubmissionEnabled},e.getABTestingId=function(){return e.instance.abId},e.getABTestingVariantId=function(){return e.instance.abVariantId},e.prototype.setDefaultId=function(t){this.defaultUserId=t||"",e.cacheIdentifier()},e.getDefaultId=function(){return e.instance.defaultUserId},e.getSdkConfig=function(){var t=0;for(var i in e.instance.sdkConfig)0===t&&(n=i),++t;if(n&&t>0)return e.instance.sdkConfig;var n;t=0;for(var i in e.instance.sdkConfigCached)0===t&&(n=i),++t;return n&&t>0?e.instance.sdkConfigCached:e.instance.sdkConfigDefault},e.isEnabled=function(){return!!e.instance.initAuthorized},e.setCustomDimension01=function(t){e.instance.currentCustomDimension01=t,r.setItem(e.getGameKey(),e.Dimension01Key,t),s.i("Set custom01 dimension value: "+t)},e.setCustomDimension02=function(t){e.instance.currentCustomDimension02=t,r.setItem(e.getGameKey(),e.Dimension02Key,t),s.i("Set custom02 dimension value: "+t)},e.setCustomDimension03=function(t){e.instance.currentCustomDimension03=t,r.setItem(e.getGameKey(),e.Dimension03Key,t),s.i("Set custom03 dimension value: "+t)},e.incrementSessionNum=function(){var t=e.getSessionNum()+1;e.instance.sessionNum=t},e.incrementTransactionNum=function(){var t=e.getTransactionNum()+1;e.instance.transactionNum=t},e.incrementProgressionTries=function(t){var i=e.getProgressionTries(t)+1;e.instance.progressionTries[t]=i;var n={};n.progression=t,n.tries=i,r.insert(o.Progression,n,!0,"progression")},e.getProgressionTries=function(t){return t in e.instance.progressionTries?e.instance.progressionTries[t]:0},e.clearProgressionTries=function(t){t in e.instance.progressionTries&&delete e.instance.progressionTries[t];var i=[];i.push(["progression",l.Equal,t]),r.delete(o.Progression,i)},e.setKeys=function(t,i){e.instance.gameKey=t,e.instance.gameSecret=i},e.setManualSessionHandling=function(t){e.instance.useManualSessionHandling=t,s.i("Use manual session handling: "+t)},e.setEnabledEventSubmission=function(t){e.instance._isEventSubmissionEnabled=t},e.getEventAnnotations=function(){var t={v:2};t.event_uuid=n.createGuid(),t.user_id=e.instance.identifier,t.client_ts=e.getClientTsAdjusted(),t.sdk_version=a.getRelevantSdkVersion(),t.os_version=a.osVersion,t.manufacturer=a.deviceManufacturer,t.device=a.deviceModel,t.browser_version=a.browserVersion,t.platform=a.buildPlatform,t.session_id=e.instance.sessionId,t[e.SessionNumKey]=e.instance.sessionNum;var s=a.getConnectionType();if(i.validateConnectionType(s)&&(t.connection_type=s),a.gameEngineVersion&&(t.engine_version=a.gameEngineVersion),e.instance.configurations){var r=0;for(var o in e.instance.configurations){r++;break}r>0&&(t.configurations=e.instance.configurations)}return e.instance.abId&&(t.ab_id=e.instance.abId),e.instance.abVariantId&&(t.ab_variant_id=e.instance.abVariantId),e.instance.build&&(t.build=e.instance.build),t},e.getSdkErrorEventAnnotations=function(){var t={v:2};t.event_uuid=n.createGuid(),t.category=e.CategorySdkError,t.sdk_version=a.getRelevantSdkVersion(),t.os_version=a.osVersion,t.manufacturer=a.deviceManufacturer,t.device=a.deviceModel,t.platform=a.buildPlatform;var s=a.getConnectionType();return i.validateConnectionType(s)&&(t.connection_type=s),a.gameEngineVersion&&(t.engine_version=a.gameEngineVersion),t},e.getInitAnnotations=function(){var t={};return e.getIdentifier()||e.cacheIdentifier(),r.setItem(e.getGameKey(),e.LastUsedIdentifierKey,e.getIdentifier()),t.user_id=e.getIdentifier(),t.sdk_version=a.getRelevantSdkVersion(),t.os_version=a.osVersion,t.platform=a.buildPlatform,e.getBuild()?t.build=e.getBuild():t.build=null,t.session_num=e.getSessionNum(),t.random_salt=e.getSessionNum(),t},e.getClientTsAdjusted=function(){var t=n.timeIntervalSince1970(),s=t+e.instance.clientServerTimeOffset;return i.validateClientTs(s)?s:t},e.sessionIsStarted=function(){return 0!=e.instance.sessionStart},e.cacheIdentifier=function(){e.instance.userId?e.instance.identifier=e.instance.userId:e.instance.defaultUserId&&(e.instance.identifier=e.instance.defaultUserId)},e.ensurePersistedStates=function(){r.isStorageAvailable()&&r.load(e.getGameKey());var t=e.instance;t.setDefaultId(null!=r.getItem(e.getGameKey(),e.DefaultUserIdKey)?r.getItem(e.getGameKey(),e.DefaultUserIdKey):n.createGuid()),t.sessionNum=null!=r.getItem(e.getGameKey(),e.SessionNumKey)?Number(r.getItem(e.getGameKey(),e.SessionNumKey)):0,t.transactionNum=null!=r.getItem(e.getGameKey(),e.TransactionNumKey)?Number(r.getItem(e.getGameKey(),e.TransactionNumKey)):0,t.currentCustomDimension01?r.setItem(e.getGameKey(),e.Dimension01Key,t.currentCustomDimension01):(t.currentCustomDimension01=null!=r.getItem(e.getGameKey(),e.Dimension01Key)?r.getItem(e.getGameKey(),e.Dimension01Key):"",t.currentCustomDimension01),t.currentCustomDimension02?r.setItem(e.getGameKey(),e.Dimension02Key,t.currentCustomDimension02):(t.currentCustomDimension02=null!=r.getItem(e.getGameKey(),e.Dimension02Key)?r.getItem(e.getGameKey(),e.Dimension02Key):"",t.currentCustomDimension02),t.currentCustomDimension03?r.setItem(e.getGameKey(),e.Dimension03Key,t.currentCustomDimension03):(t.currentCustomDimension03=null!=r.getItem(e.getGameKey(),e.Dimension03Key)?r.getItem(e.getGameKey(),e.Dimension03Key):"",t.currentCustomDimension03);var i=null!=r.getItem(e.getGameKey(),e.SdkConfigCachedKey)?r.getItem(e.getGameKey(),e.SdkConfigCachedKey):"";if(i){var a=JSON.parse(n.decode64(i));if(a){var l=r.getItem(e.getGameKey(),e.LastUsedIdentifierKey);null!=l&&l!=e.getIdentifier()&&(s.w("New identifier spotted compared to last one used, clearing cached configs hash!!"),a.configs_hash&&delete a.configs_hash),t.sdkConfigCached=a}}var h=e.getSdkConfig();t.configsHash=h.configs_hash?h.configs_hash:"",t.abId=h.ab_id?h.ab_id:"",t.abVariantId=h.ab_variant_id?h.ab_variant_id:"";var u=r.select(o.Progression);if(u)for(var c=0;c<u.length;++c){var d=u[c];d&&(t.progressionTries[d.progression]=d.tries)}},e.calculateServerTimeOffset=function(e){return e-n.timeIntervalSince1970()},e.formatString=function(e,t){for(var i=e,n=0;n<t.length;n++){var s=new RegExp("\\{"+n+"\\}","gi");i=i.replace(s,arguments[n])}return i},e.validateAndCleanCustomFields=function(t,i){void 0===i&&(i=null);var r={};if(t){var a=0;for(var o in t){var l=t[o];if(o&&l)if(a<e.MAX_CUSTOM_FIELDS_COUNT){var h=new RegExp("^[a-zA-Z0-9_]{1,"+e.MAX_CUSTOM_FIELDS_KEY_LENGTH+"}$");if(n.stringMatch(o,h)){var u=typeof l;if("string"===u||l instanceof String){var c=l;if(c.length<=e.MAX_CUSTOM_FIELDS_VALUE_STRING_LENGTH&&c.length>0)r[o]=c,++a;else{p="validateAndCleanCustomFields: entry with key={0}, value={1} has been omitted because its value is an empty string or exceeds the max number of characters ("+e.MAX_CUSTOM_FIELDS_VALUE_STRING_LENGTH+")",f=e.formatString(p,[o,l]);s.w(f),i&&i(p,f)}}else if("number"===u||l instanceof Number){var d=l;r[o]=d,++a}else{p="validateAndCleanCustomFields: entry with key={0}, value={1} has been omitted because its value is not a string or number",f=e.formatString(p,[o,l]);s.w(f),i&&i(p,f)}}else{p="validateAndCleanCustomFields: entry with key={0}, value={1} has been omitted because its key contains illegal character, is empty or exceeds the max number of characters ("+e.MAX_CUSTOM_FIELDS_KEY_LENGTH+")",f=e.formatString(p,[o,l]);s.w(f),i&&i(p,f)}}else{p="validateAndCleanCustomFields: entry with key={0}, value={1} has been omitted because it exceeds the max number of custom fields ("+e.MAX_CUSTOM_FIELDS_COUNT+")",f=e.formatString(p,[o,l]);s.w(f),i&&i(p,f)}else{var p="validateAndCleanCustomFields: entry with key={0}, value={1} has been omitted because its key or value is null",f=e.formatString(p,[o,l]);s.w(f),i&&i(p,f)}}}return r},e.validateAndFixCurrentDimensions=function(){i.validateDimension01(e.getCurrentCustomDimension01(),e.getAvailableCustomDimensions01())||e.setCustomDimension01(""),i.validateDimension02(e.getCurrentCustomDimension02(),e.getAvailableCustomDimensions02())||e.setCustomDimension02(""),i.validateDimension03(e.getCurrentCustomDimension03(),e.getAvailableCustomDimensions03())||e.setCustomDimension03("")},e.getConfigurationStringValue=function(t,i){return e.instance.configurations[t]?e.instance.configurations[t].toString():i},e.isRemoteConfigsReady=function(){return e.instance.remoteConfigsIsReady},e.addRemoteConfigsListener=function(t){e.instance.remoteConfigsListeners.indexOf(t)<0&&e.instance.remoteConfigsListeners.push(t)},e.removeRemoteConfigsListener=function(t){var i=e.instance.remoteConfigsListeners.indexOf(t);i>-1&&e.instance.remoteConfigsListeners.splice(i,1)},e.getRemoteConfigsContentAsString=function(){return JSON.stringify(e.instance.configurations)},e.populateConfigurations=function(t){var i=t.configs;if(i){e.instance.configurations={};for(var n=0;n<i.length;++n){var s=i[n];if(s){var r=s.key,a=s.value,o=s.start_ts?s.start_ts:Number.MIN_VALUE,l=s.end_ts?s.end_ts:Number.MAX_VALUE,h=e.getClientTsAdjusted();r&&a&&h>o&&h<l&&(e.instance.configurations[r]=a)}}}e.instance.remoteConfigsIsReady=!0;var u=e.instance.remoteConfigsListeners;for(n=0;n<u.length;++n)u[n]&&u[n].onRemoteConfigsUpdated()},e.addOnBeforeUnloadListener=function(t){e.instance.beforeUnloadListeners.indexOf(t)<0&&e.instance.beforeUnloadListeners.push(t)},e.removeOnBeforeUnloadListener=function(t){var i=e.instance.beforeUnloadListeners.indexOf(t);i>-1&&e.instance.beforeUnloadListeners.splice(i,1)},e.notifyBeforeUnloadListeners=function(){for(var t=e.instance.beforeUnloadListeners,i=0;i<t.length;++i)t[i]&&t[i].onBeforeUnload()},e.CategorySdkError="sdk_error",e.MAX_CUSTOM_FIELDS_COUNT=50,e.MAX_CUSTOM_FIELDS_KEY_LENGTH=64,e.MAX_CUSTOM_FIELDS_VALUE_STRING_LENGTH=256,e.instance=new e,e.DefaultUserIdKey="default_user_id",e.SessionNumKey="session_num",e.TransactionNumKey="transaction_num",e.Dimension01Key="dimension01",e.Dimension02Key="dimension02",e.Dimension03Key="dimension03",e.SdkConfigCachedKey="sdk_config_cached",e.LastUsedIdentifierKey="last_used_identifier",e}();t.GAState=h}(e.state||(e.state={}))}(a||(a={})),function(e){!function(t){var i=e.utilities.GAUtilities,n=e.logging.GALogger,s=function(){function e(){}return e.execute=function(t,s,r,a){var o=new Date;if(e.timestampMap[s]||(e.timestampMap[s]=o),e.countMap[s]||(e.countMap[s]=0),(o.getTime()-e.timestampMap[s].getTime())/1e3>=3600&&(e.timestampMap[s]=o,e.countMap[s]=0),!(e.countMap[s]>=e.MaxCount)){var l=i.getHmac(a,r),h=new XMLHttpRequest;h.onreadystatechange=function(){if(4===h.readyState){if(!h.responseText)return;if(200!=h.status)return void n.w("sdk error failed. response code not 200. status code: "+h.status+", description: "+h.statusText+", body: "+h.responseText);e.countMap[s]=e.countMap[s]+1}},h.open("POST",t,!0),h.setRequestHeader("Content-Type","application/json"),h.setRequestHeader("Authorization",l);try{h.send(r)}catch(e){console.error(e)}}},e.MaxCount=10,e.countMap={},e.timestampMap={},e}();t.SdkErrorTask=s}(e.tasks||(e.tasks={}))}(a||(a={})),function(e){!function(t){var i=e.state.GAState,n=e.logging.GALogger,s=e.utilities.GAUtilities,r=e.validators.GAValidator,a=e.tasks.SdkErrorTask,o=e.events.EGASdkErrorCategory,l=e.events.EGASdkErrorArea,h=e.events.EGASdkErrorAction,u=e.events.EGASdkErrorParameter,c=function(){function e(){this.protocol="https",this.hostName="api.gameanalytics.com",this.version="v2",this.remoteConfigsVersion="v1",this.baseUrl=this.protocol+"://"+this.hostName+"/"+this.version,this.remoteConfigsBaseUrl=this.protocol+"://"+this.hostName+"/remote_configs/"+this.remoteConfigsVersion,this.initializeUrlPath="init",this.eventsUrlPath="events",this.useGzip=!1}return e.prototype.requestInit=function(n,s){var r=i.getGameKey(),a=this.remoteConfigsBaseUrl+"/"+this.initializeUrlPath+"?game_key="+r+"&interval_seconds=0&configs_hash="+n,o=i.getInitAnnotations(),l=JSON.stringify(o);if(l){var h=this.createPayloadData(l,this.useGzip),u=[];u.push(l),e.sendRequest(a,h,u,this.useGzip,e.initRequestCallback,s)}else s(t.EGAHTTPApiResponse.JsonEncodeFailed,null)},e.prototype.sendEventsInArray=function(n,s,r){if(0!=n.length){var a=i.getGameKey(),o=this.baseUrl+"/"+a+"/"+this.eventsUrlPath,l=JSON.stringify(n);if(l){var h=this.createPayloadData(l,this.useGzip),u=[];u.push(l),u.push(s),u.push(n.length.toString()),e.sendRequest(o,h,u,this.useGzip,e.sendEventInArrayRequestCallback,r)}else r(t.EGAHTTPApiResponse.JsonEncodeFailed,null,s,n.length)}},e.prototype.sendSdkErrorEvent=function(t,s,o,l,h,u,c){if(i.isEventSubmissionEnabled()&&r.validateSdkErrorEvent(u,c,t,s,o)){var d,p=this.baseUrl+"/"+u+"/"+this.eventsUrlPath,f="",g=i.getSdkErrorEventAnnotations(),m=e.sdkErrorCategoryString(t);g.error_category=m,f+=m;var _=e.sdkErrorAreaString(s);g.error_area=_,f+=":"+_;var v=e.sdkErrorActionString(o);g.error_action=v;var y=e.sdkErrorParameterString(l);if(y.length>0&&(g.error_parameter=y),h.length>0){var b=h;if(h.length>e.MAX_ERROR_MESSAGE_LENGTH)b=h.substring(0,e.MAX_ERROR_MESSAGE_LENGTH);g.reason=b}var x=[];x.push(g),(d=JSON.stringify(x))?a.execute(p,f,d,c):n.w("sendSdkErrorEvent: JSON encoding failed.")}},e.sendEventInArrayRequestCallback=function(n,s,r,a){void 0===a&&(a=null);a[0],a[1];var c,d,p=a[2],f=parseInt(a[3]);c=n.responseText,d=n.status;var g=e.instance.processRequestResponse(d,n.statusText,c,"Events");if(g==t.EGAHTTPApiResponse.Ok||g==t.EGAHTTPApiResponse.Created||g==t.EGAHTTPApiResponse.BadRequest){var m=c?JSON.parse(c):{};if(null==m)return r(t.EGAHTTPApiResponse.JsonDecodeFailed,null,p,f),void e.instance.sendSdkErrorEvent(o.Http,l.EventsHttp,h.FailHttpJsonDecode,u.Undefined,c,i.getGameKey(),i.getGameSecret());t.EGAHTTPApiResponse.BadRequest,r(g,m,p,f)}else r(g,null,p,f)},e.sendRequest=function(e,t,n,r,a,o){var l=new XMLHttpRequest,h=i.getGameSecret(),u=s.getHmac(h,t),c=[];for(var d in c.push(u),n)c.push(n[d]);if(l.onreadystatechange=function(){4===l.readyState&&a(l,e,o,c)},l.open("POST",e,!0),l.setRequestHeader("Content-Type","application/json"),l.setRequestHeader("Authorization",u),r)throw new Error("gzip not supported");try{l.send(t)}catch(e){console.error(e.stack)}},e.initRequestCallback=function(n,s,a,c){void 0===c&&(c=null);var d,p;c[0],c[1];d=n.responseText,p=n.status;var f=d?JSON.parse(d):{},g=e.instance.processRequestResponse(p,n.statusText,d,"Init");if(g==t.EGAHTTPApiResponse.Ok||g==t.EGAHTTPApiResponse.Created||g==t.EGAHTTPApiResponse.BadRequest){if(null==f)return a(t.EGAHTTPApiResponse.JsonDecodeFailed,null,"",0),void e.instance.sendSdkErrorEvent(o.Http,l.InitHttp,h.FailHttpJsonDecode,u.Undefined,d,i.getGameKey(),i.getGameSecret());if(g!==t.EGAHTTPApiResponse.BadRequest){var m=r.validateAndCleanInitRequestResponse(f,g===t.EGAHTTPApiResponse.Created);m?a(g,m,"",0):a(t.EGAHTTPApiResponse.BadResponse,null,"",0)}else a(g,null,"",0)}else a(g,null,"",0)},e.prototype.createPayloadData=function(e,t){if(t)throw new Error("gzip not supported");return e},e.prototype.processRequestResponse=function(e,i,n,s){return n?200===e?t.EGAHTTPApiResponse.Ok:201===e?t.EGAHTTPApiResponse.Created:0===e||401===e?t.EGAHTTPApiResponse.Unauthorized:400===e?t.EGAHTTPApiResponse.BadRequest:500===e?t.EGAHTTPApiResponse.InternalServerError:t.EGAHTTPApiResponse.UnknownResponseCode:t.EGAHTTPApiResponse.NoResponse},e.sdkErrorCategoryString=function(e){switch(e){case o.EventValidation:return"event_validation";case o.Database:return"db";case o.Init:return"init";case o.Http:return"http";case o.Json:return"json"}return""},e.sdkErrorAreaString=function(e){switch(e){case l.BusinessEvent:return"business";case l.ResourceEvent:return"resource";case l.ProgressionEvent:return"progression";case l.DesignEvent:return"design";case l.ErrorEvent:return"error";case l.InitHttp:return"init_http";case l.EventsHttp:return"events_http";case l.ProcessEvents:return"process_events";case l.AddEventsToStore:return"add_events_to_store"}return""},e.sdkErrorActionString=function(e){switch(e){case h.InvalidCurrency:return"invalid_currency";case h.InvalidShortString:return"invalid_short_string";case h.InvalidEventPartLength:return"invalid_event_part_length";case h.InvalidEventPartCharacters:return"invalid_event_part_characters";case h.InvalidStore:return"invalid_store";case h.InvalidFlowType:return"invalid_flow_type";case h.StringEmptyOrNull:return"string_empty_or_null";case h.NotFoundInAvailableCurrencies:return"not_found_in_available_currencies";case h.InvalidAmount:return"invalid_amount";case h.NotFoundInAvailableItemTypes:return"not_found_in_available_item_types";case h.WrongProgressionOrder:return"wrong_progression_order";case h.InvalidEventIdLength:return"invalid_event_id_length";case h.InvalidEventIdCharacters:return"invalid_event_id_characters";case h.InvalidProgressionStatus:return"invalid_progression_status";case h.InvalidSeverity:return"invalid_severity";case h.InvalidLongString:return"invalid_long_string";case h.DatabaseTooLarge:return"db_too_large";case h.DatabaseOpenOrCreate:return"db_open_or_create";case h.JsonError:return"json_error";case h.FailHttpJsonDecode:return"fail_http_json_decode";case h.FailHttpJsonEncode:return"fail_http_json_encode"}return""},e.sdkErrorParameterString=function(e){switch(e){case u.Currency:return"currency";case u.CartType:return"cart_type";case u.ItemType:return"item_type";case u.ItemId:return"item_id";case u.Store:return"store";case u.FlowType:return"flow_type";case u.Amount:return"amount";case u.Progression01:return"progression01";case u.Progression02:return"progression02";case u.Progression03:return"progression03";case u.EventId:return"event_id";case u.ProgressionStatus:return"progression_status";case u.Severity:return"severity";case u.Message:return"message"}return""},e.instance=new e,e.MAX_ERROR_MESSAGE_LENGTH=256,e}();t.GAHTTPApi=c}(e.http||(e.http={}))}(a||(a={})),function(e){var t,i,n,s,r,a,o,l,h,u,c;t=e.events||(e.events={}),i=e.store.GAStore,n=e.store.EGAStore,s=e.store.EGAStoreArgsOperator,r=e.state.GAState,a=e.logging.GALogger,o=e.utilities.GAUtilities,l=e.http.EGAHTTPApiResponse,h=e.http.GAHTTPApi,u=e.validators.GAValidator,c=function(){function c(){}return c.customEventFieldsErrorCallback=function(t,i){if(r.isEventSubmissionEnabled()){var n=new Date;c.timestampMap[t]||(c.timestampMap[t]=n),c.countMap[t]||(c.countMap[t]=0),(n.getTime()-c.timestampMap[t].getTime())/1e3>=3600&&(c.timestampMap[t]=n,c.countMap[t]=0),c.countMap[t]>=c.MAX_ERROR_COUNT||e.threading.GAThreading.performTaskOnGAThread(function(){c.addErrorEvent(e.EGAErrorSeverity.Warning,i,null,!0),c.countMap[t]=c.countMap[t]+1})}},c.addSessionStartEvent=function(){if(r.isEventSubmissionEnabled()){var e={};e.category=c.CategorySessionStart,r.incrementSessionNum(),i.setItem(r.getGameKey(),r.SessionNumKey,r.getSessionNum().toString()),c.addDimensionsToEvent(e);var t=r.instance.currentGlobalCustomEventFields;c.addCustomFieldsToEvent(e,r.validateAndCleanCustomFields(t,c.customEventFieldsErrorCallback)),c.addEventToStore(e),a.i("Add SESSION START event"),c.processEvents(c.CategorySessionStart,!1)}},c.addSessionEndEvent=function(){if(r.isEventSubmissionEnabled()){var e=r.getSessionStart(),t=r.getClientTsAdjusted()-e;t<0&&(a.w("Session length was calculated to be less then 0. Should not be possible. Resetting to 0."),t=0);var i={};i.category=c.CategorySessionEnd,i.length=t,c.addDimensionsToEvent(i);var n=r.instance.currentGlobalCustomEventFields;c.addCustomFieldsToEvent(i,r.validateAndCleanCustomFields(n,c.customEventFieldsErrorCallback)),c.addEventToStore(i),a.i("Add SESSION END event."),c.processEvents("",!1)}},c.addBusinessEvent=function(e,t,n,s,o,l,d){if(void 0===o&&(o=null),r.isEventSubmissionEnabled()){var p=u.validateBusinessEvent(e,t,o,n,s);if(null==p){var f={};r.incrementTransactionNum(),i.setItem(r.getGameKey(),r.TransactionNumKey,r.getTransactionNum().toString()),f.event_id=n+":"+s,f.category=c.CategoryBusiness,f.currency=e,f.amount=t,f[r.TransactionNumKey]=r.getTransactionNum(),o&&(f.cart_type=o),c.addDimensionsToEvent(f);var g={};if(l&&Object.keys(l).length>0)for(var m in l)g[m]=l[m];else for(var m in r.instance.currentGlobalCustomEventFields)g[m]=r.instance.currentGlobalCustomEventFields[m];if(d&&l&&Object.keys(l).length>0)for(var m in r.instance.currentGlobalCustomEventFields)g[m]||(g[m]=r.instance.currentGlobalCustomEventFields[m]);c.addCustomFieldsToEvent(f,r.validateAndCleanCustomFields(g,c.customEventFieldsErrorCallback)),a.i("Add BUSINESS event: {currency:"+e+", amount:"+t+", itemType:"+n+", itemId:"+s+", cartType:"+o+"}"),c.addEventToStore(f)}else h.instance.sendSdkErrorEvent(p.category,p.area,p.action,p.parameter,p.reason,r.getGameKey(),r.getGameSecret())}},c.addResourceEvent=function(t,i,n,s,o,l,d){if(r.isEventSubmissionEnabled()){var p=u.validateResourceEvent(t,i,n,s,o,r.getAvailableResourceCurrencies(),r.getAvailableResourceItemTypes());if(null==p){t===e.EGAResourceFlowType.Sink&&(n*=-1);var f={},g=c.resourceFlowTypeToString(t);f.event_id=g+":"+i+":"+s+":"+o,f.category=c.CategoryResource,f.amount=n,c.addDimensionsToEvent(f);var m={};if(l&&Object.keys(l).length>0)for(var _ in l)m[_]=l[_];else for(var _ in r.instance.currentGlobalCustomEventFields)m[_]=r.instance.currentGlobalCustomEventFields[_];if(d&&l&&Object.keys(l).length>0)for(var _ in r.instance.currentGlobalCustomEventFields)m[_]||(m[_]=r.instance.currentGlobalCustomEventFields[_]);c.addCustomFieldsToEvent(f,r.validateAndCleanCustomFields(m,c.customEventFieldsErrorCallback)),a.i("Add RESOURCE event: {currency:"+i+", amount:"+n+", itemType:"+s+", itemId:"+o+"}"),c.addEventToStore(f)}else h.instance.sendSdkErrorEvent(p.category,p.area,p.action,p.parameter,p.reason,r.getGameKey(),r.getGameSecret())}},c.addProgressionEvent=function(t,i,n,s,o,l,d,p){if(r.isEventSubmissionEnabled()){var f=c.progressionStatusToString(t),g=u.validateProgressionEvent(t,i,n,s);if(null==g){var m,_={};m=n?s?i+":"+n+":"+s:i+":"+n:i,_.category=c.CategoryProgression,_.event_id=f+":"+m;var v=0;l&&t!=e.EGAProgressionStatus.Start&&(_.score=Math.round(o)),t===e.EGAProgressionStatus.Fail&&r.incrementProgressionTries(m),t===e.EGAProgressionStatus.Complete&&(r.incrementProgressionTries(m),v=r.getProgressionTries(m),_.attempt_num=v,r.clearProgressionTries(m)),c.addDimensionsToEvent(_);var y={};if(d&&Object.keys(d).length>0)for(var b in d)y[b]=d[b];else for(var b in r.instance.currentGlobalCustomEventFields)y[b]=r.instance.currentGlobalCustomEventFields[b];if(p&&d&&Object.keys(d).length>0)for(var b in r.instance.currentGlobalCustomEventFields)y[b]||(y[b]=r.instance.currentGlobalCustomEventFields[b]);c.addCustomFieldsToEvent(_,r.validateAndCleanCustomFields(y,c.customEventFieldsErrorCallback)),a.i("Add PROGRESSION event: {status:"+f+", progression01:"+i+", progression02:"+n+", progression03:"+s+", score:"+o+", attempt:"+v+"}"),c.addEventToStore(_)}else h.instance.sendSdkErrorEvent(g.category,g.area,g.action,g.parameter,g.reason,r.getGameKey(),r.getGameSecret())}},c.addDesignEvent=function(e,t,i,n,s){if(r.isEventSubmissionEnabled()){var o=u.validateDesignEvent(e);if(null==o){var l={};l.category=c.CategoryDesign,l.event_id=e,i&&(l.value=t),c.addDimensionsToEvent(l);var d={};if(n&&Object.keys(n).length>0)for(var p in n)d[p]=n[p];else for(var p in r.instance.currentGlobalCustomEventFields)d[p]=r.instance.currentGlobalCustomEventFields[p];if(s&&n&&Object.keys(n).length>0)for(var p in r.instance.currentGlobalCustomEventFields)d[p]||(d[p]=r.instance.currentGlobalCustomEventFields[p]);c.addCustomFieldsToEvent(l,r.validateAndCleanCustomFields(d,c.customEventFieldsErrorCallback)),a.i("Add DESIGN event: {eventId:"+e+", value:"+t+"}"),c.addEventToStore(l)}else h.instance.sendSdkErrorEvent(o.category,o.area,o.action,o.parameter,o.reason,r.getGameKey(),r.getGameSecret())}},c.addErrorEvent=function(e,t,i,n,s){if(void 0===s&&(s=!1),r.isEventSubmissionEnabled()){var o=c.errorSeverityToString(e),l=u.validateErrorEvent(e,t);if(null==l){var d={};if(d.category=c.CategoryError,d.severity=o,d.message=t,c.addDimensionsToEvent(d),!s){var p={};if(i&&Object.keys(i).length>0)for(var f in i)p[f]=i[f];else for(var f in r.instance.currentGlobalCustomEventFields)p[f]=r.instance.currentGlobalCustomEventFields[f];if(n&&i&&Object.keys(i).length>0)for(var f in r.instance.currentGlobalCustomEventFields)p[f]||(p[f]=r.instance.currentGlobalCustomEventFields[f]);c.addCustomFieldsToEvent(d,r.validateAndCleanCustomFields(p,c.customEventFieldsErrorCallback))}a.i("Add ERROR event: {severity:"+o+", message:"+t+"}"),c.addEventToStore(d)}else h.instance.sendSdkErrorEvent(l.category,l.area,l.action,l.parameter,l.reason,r.getGameKey(),r.getGameSecret())}},c.addAdEvent=function(t,i,n,s,o,l,d,p,f){if(r.isEventSubmissionEnabled()){var g=c.adActionToString(t),m=c.adTypeToString(i),_=c.adErrorToString(o),v=u.validateAdEvent(t,i,n,s);if(null==v){var y={};y.category=c.CategoryAds,y.ad_sdk_name=n,y.ad_placement=s,y.ad_type=m,y.ad_action=g,t==e.EGAAdAction.FailedShow&&_.length>0&&(y.ad_fail_show_reason=_),!d||i!=e.EGAAdType.RewardedVideo&&i!=e.EGAAdType.Video||(y.ad_duration=l),c.addDimensionsToEvent(y);var b={};if(p&&Object.keys(p).length>0)for(var x in p)b[x]=p[x];else for(var x in r.instance.currentGlobalCustomEventFields)b[x]=r.instance.currentGlobalCustomEventFields[x];if(f&&p&&Object.keys(p).length>0)for(var x in r.instance.currentGlobalCustomEventFields)b[x]||(b[x]=r.instance.currentGlobalCustomEventFields[x]);c.addCustomFieldsToEvent(y,r.validateAndCleanCustomFields(b,c.customEventFieldsErrorCallback)),a.i("Add AD event: {ad_sdk_name:"+n+", ad_placement:"+s+", ad_type:"+m+", ad_action:"+g+(t==e.EGAAdAction.FailedShow&&_.length>0?", ad_fail_show_reason:"+_:"")+(!d||i!=e.EGAAdType.RewardedVideo&&i!=e.EGAAdType.Video?"":", ad_duration:"+l)+"}"),c.addEventToStore(y)}else h.instance.sendSdkErrorEvent(v.category,v.area,v.action,v.parameter,v.reason,r.getGameKey(),r.getGameSecret())}},c.processEvents=function(e,l){if(r.isEventSubmissionEnabled())try{var d=o.createGuid();l&&(c.cleanupEvents(),c.fixMissingSessionEndEvents());var p=[];p.push(["status",s.Equal,"new"]);var f=[];f.push(["status",s.Equal,"new"]),e&&(p.push(["category",s.Equal,e]),f.push(["category",s.Equal,e]));var g=[];g.push(["status",d]);var m=i.select(n.Events,p);if(!m||0==m.length)return a.i("Event queue: No events to send"),void c.updateSessionStore();if(m.length>c.MaxEventCount){if(!(m=i.select(n.Events,p,!0,c.MaxEventCount)))return;var _=m[m.length-1].client_ts;if(p.push(["client_ts",s.LessOrEqual,_]),!(m=i.select(n.Events,p)))return;f.push(["client_ts",s.LessOrEqual,_])}if(a.i("Event queue: Sending "+m.length+" events."),!i.update(n.Events,g,f))return;for(var v=[],y=0;y<m.length;++y){var b=m[y],x=JSON.parse(o.decode64(b.event));if(0!=x.length){var T=x.client_ts;T&&!u.validateClientTs(T)&&delete x.client_ts,v.push(x)}}h.instance.sendEventsInArray(v,d,c.processEventsCallback)}catch(e){a.e("Error during ProcessEvents(): "+e.stack),h.instance.sendSdkErrorEvent(t.EGASdkErrorCategory.Json,t.EGASdkErrorArea.ProcessEvents,t.EGASdkErrorAction.JsonError,t.EGASdkErrorParameter.Undefined,e.stack,r.getGameKey(),r.getGameSecret())}},c.processEventsCallback=function(e,t,r,o){var h=[];if(h.push(["status",s.Equal,r]),e===l.Ok)i.delete(n.Events,h),a.i("Event queue: "+o+" events sent.");else if(e===l.NoResponse){var u=[];u.push(["status","new"]),a.w("Event queue: Failed to send events to collector - Retrying next time"),i.update(n.Events,u,h)}else{if(t){var c,d=0;for(var p in t)0==d&&(c=t[p]),++d;e===l.BadRequest&&c.constructor===Array?a.w("Event queue: "+o+" events sent. "+d+" events failed GA server validation."):a.w("Event queue: Failed to send events.")}else a.w("Event queue: Failed to send events.");i.delete(n.Events,h)}},c.cleanupEvents=function(){i.update(n.Events,[["status","new"]])},c.fixMissingSessionEndEvents=function(){if(r.isEventSubmissionEnabled()){var e=[];e.push(["session_id",s.NotEqual,r.getSessionId()]);var t=i.select(n.Sessions,e);if(t&&0!=t.length){a.i(t.length+" session(s) located with missing session_end event.");for(var l=0;l<t.length;++l){var h=JSON.parse(o.decode64(t[l].event)),u=h.client_ts-t[l].timestamp;u=Math.max(0,u),h.category=c.CategorySessionEnd,h.length=u,c.addEventToStore(h)}}}},c.addEventToStore=function(e){if(r.isEventSubmissionEnabled())if(r.isInitialized())try{if(i.isStoreTooLargeForEvents()&&!o.stringMatch(e.category,/^(user|session_end|business)$/))return a.w("Database too large. Event has been blocked."),void h.instance.sendSdkErrorEvent(t.EGASdkErrorCategory.Database,t.EGASdkErrorArea.AddEventsToStore,t.EGASdkErrorAction.DatabaseTooLarge,t.EGASdkErrorParameter.Undefined,"",r.getGameKey(),r.getGameSecret());var l=r.getEventAnnotations();for(var u in e)l[u]=e[u];var d=JSON.stringify(l);a.ii("Event added to queue: "+d);var p={status:"new"};p.category=l.category,p.session_id=l.session_id,p.client_ts=l.client_ts,p.event=o.encode64(JSON.stringify(l)),i.insert(n.Events,p),e.category==c.CategorySessionEnd?i.delete(n.Sessions,[["session_id",s.Equal,l.session_id]]):c.updateSessionStore(),i.isStorageAvailable()&&i.save(r.getGameKey())}catch(u){a.e("addEventToStore: error"),a.e(u.stack),h.instance.sendSdkErrorEvent(t.EGASdkErrorCategory.Database,t.EGASdkErrorArea.AddEventsToStore,t.EGASdkErrorAction.DatabaseTooLarge,t.EGASdkErrorParameter.Undefined,u.stack,r.getGameKey(),r.getGameSecret())}else a.w("Could not add event: SDK is not initialized")},c.updateSessionStore=function(){if(r.sessionIsStarted()){var e={};e.session_id=r.instance.sessionId,e.timestamp=r.getSessionStart();var t=r.getEventAnnotations();c.addDimensionsToEvent(t);var s=r.instance.currentGlobalCustomEventFields;c.addCustomFieldsToEvent(t,r.validateAndCleanCustomFields(s,c.customEventFieldsErrorCallback)),e.event=o.encode64(JSON.stringify(t)),i.insert(n.Sessions,e,!0,"session_id"),i.isStorageAvailable()&&i.save(r.getGameKey())}},c.addDimensionsToEvent=function(e){e&&(r.getCurrentCustomDimension01()&&(e.custom_01=r.getCurrentCustomDimension01()),r.getCurrentCustomDimension02()&&(e.custom_02=r.getCurrentCustomDimension02()),r.getCurrentCustomDimension03()&&(e.custom_03=r.getCurrentCustomDimension03()))},c.addCustomFieldsToEvent=function(e,t){e&&t&&Object.keys(t).length>0&&(e.custom_fields=t)},c.resourceFlowTypeToString=function(t){return t==e.EGAResourceFlowType.Source||t==e.EGAResourceFlowType[e.EGAResourceFlowType.Source]?"Source":t==e.EGAResourceFlowType.Sink||t==e.EGAResourceFlowType[e.EGAResourceFlowType.Sink]?"Sink":""},c.progressionStatusToString=function(t){return t==e.EGAProgressionStatus.Start||t==e.EGAProgressionStatus[e.EGAProgressionStatus.Start]?"Start":t==e.EGAProgressionStatus.Complete||t==e.EGAProgressionStatus[e.EGAProgressionStatus.Complete]?"Complete":t==e.EGAProgressionStatus.Fail||t==e.EGAProgressionStatus[e.EGAProgressionStatus.Fail]?"Fail":""},c.errorSeverityToString=function(t){return t==e.EGAErrorSeverity.Debug||t==e.EGAErrorSeverity[e.EGAErrorSeverity.Debug]?"debug":t==e.EGAErrorSeverity.Info||t==e.EGAErrorSeverity[e.EGAErrorSeverity.Info]?"info":t==e.EGAErrorSeverity.Warning||t==e.EGAErrorSeverity[e.EGAErrorSeverity.Warning]?"warning":t==e.EGAErrorSeverity.Error||t==e.EGAErrorSeverity[e.EGAErrorSeverity.Error]?"error":t==e.EGAErrorSeverity.Critical||t==e.EGAErrorSeverity[e.EGAErrorSeverity.Critical]?"critical":""},c.adActionToString=function(t){return t==e.EGAAdAction.Clicked||t==e.EGAAdAction[e.EGAAdAction.Clicked]?"clicked":t==e.EGAAdAction.Show||t==e.EGAAdAction[e.EGAAdAction.Show]?"show":t==e.EGAAdAction.FailedShow||t==e.EGAAdAction[e.EGAAdAction.FailedShow]?"failed_show":t==e.EGAAdAction.RewardReceived||t==e.EGAAdAction[e.EGAAdAction.RewardReceived]?"reward_received":""},c.adErrorToString=function(t){return t==e.EGAAdError.Unknown||t==e.EGAAdError[e.EGAAdError.Unknown]?"unknown":t==e.EGAAdError.Offline||t==e.EGAAdError[e.EGAAdError.Offline]?"offline":t==e.EGAAdError.NoFill||t==e.EGAAdError[e.EGAAdError.NoFill]?"no_fill":t==e.EGAAdError.InternalError||t==e.EGAAdError[e.EGAAdError.InternalError]?"internal_error":t==e.EGAAdError.InvalidRequest||t==e.EGAAdError[e.EGAAdError.InvalidRequest]?"invalid_request":t==e.EGAAdError.UnableToPrecache||t==e.EGAAdError[e.EGAAdError.UnableToPrecache]?"unable_to_precache":""},c.adTypeToString=function(t){return t==e.EGAAdType.Video||t==e.EGAAdType[e.EGAAdType.Video]?"video":t==e.EGAAdType.RewardedVideo||t==e.EGAAdError[e.EGAAdType.RewardedVideo]?"rewarded_video":t==e.EGAAdType.Playable||t==e.EGAAdError[e.EGAAdType.Playable]?"playable":t==e.EGAAdType.Interstitial||t==e.EGAAdError[e.EGAAdType.Interstitial]?"interstitial":t==e.EGAAdType.OfferWall||t==e.EGAAdError[e.EGAAdType.OfferWall]?"offer_wall":t==e.EGAAdType.Banner||t==e.EGAAdError[e.EGAAdType.Banner]?"banner":""},c.CategorySessionStart="user",c.CategorySessionEnd="session_end",c.CategoryDesign="design",c.CategoryBusiness="business",c.CategoryProgression="progression",c.CategoryResource="resource",c.CategoryError="error",c.CategoryAds="ads",c.MaxEventCount=500,c.MAX_ERROR_COUNT=10,c.countMap={},c.timestampMap={},c}(),t.GAEvents=c}(a||(a={})),function(e){!function(t){var i=e.logging.GALogger,n=e.state.GAState,s=e.events.GAEvents,r=function(){function e(){this.blocks=new t.PriorityQueue({compare:function(e,t){return e-t}}),this.id2TimedBlockMap={},e.startThread()}return e.createTimedBlock=function(e){void 0===e&&(e=0);var i=new Date;return i.setUTCSeconds(i.getUTCSeconds()+e),new t.TimedBlock(i)},e.performTaskOnGAThread=function(i,n){void 0===n&&(n=0);var s=new Date;s.setUTCSeconds(s.getUTCSeconds()+n);var r=new t.TimedBlock(s);r.block=i,e.instance.id2TimedBlockMap[r.id]=r,e.instance.addTimedBlock(r)},e.performTimedBlockOnGAThread=function(t){e.instance.id2TimedBlockMap[t.id]=t,e.instance.addTimedBlock(t)},e.scheduleTimer=function(i,n){var s=new Date;s.setUTCSeconds(s.getUTCSeconds()+i);var r=new t.TimedBlock(s);return r.block=n,e.instance.id2TimedBlockMap[r.id]=r,e.instance.addTimedBlock(r),r.id},e.getTimedBlockById=function(t){return t in e.instance.id2TimedBlockMap?e.instance.id2TimedBlockMap[t]:null},e.ensureEventQueueIsRunning=function(){e.instance.keepRunning=!0,e.instance.isRunning||(e.instance.isRunning=!0,e.scheduleTimer(e.ProcessEventsIntervalInSeconds,e.processEventQueue))},e.endSessionAndStopQueue=function(){n.isInitialized()&&(i.i("Ending session."),e.stopEventQueue(),n.isEnabled()&&n.sessionIsStarted()&&(s.addSessionEndEvent(),n.instance.sessionStart=0))},e.stopEventQueue=function(){e.instance.keepRunning=!1},e.ignoreTimer=function(t){t in e.instance.id2TimedBlockMap&&(e.instance.id2TimedBlockMap[t].ignore=!0)},e.setEventProcessInterval=function(t){t>0&&(e.ProcessEventsIntervalInSeconds=t)},e.prototype.addTimedBlock=function(e){this.blocks.enqueue(e.deadline.getTime(),e)},e.run=function(){clearTimeout(e.runTimeoutId);try{for(var t;t=e.getNextBlock();)if(!t.ignore)if(t.async){if(!t.running){t.running=!0,t.block();break}}else t.block();return void(e.runTimeoutId=setTimeout(e.run,e.ThreadWaitTimeInMs))}catch(e){i.e("Error on GA thread"),i.e(e.stack)}},e.startThread=function(){e.runTimeoutId=setTimeout(e.run,0)},e.getNextBlock=function(){var t=new Date;return e.instance.blocks.hasItems()&&e.instance.blocks.peek().deadline.getTime()<=t.getTime()?e.instance.blocks.peek().async&&e.instance.blocks.peek().running?e.instance.blocks.peek():e.instance.blocks.dequeue():null},e.processEventQueue=function(){s.processEvents("",!0),e.instance.keepRunning?e.scheduleTimer(e.ProcessEventsIntervalInSeconds,e.processEventQueue):e.instance.isRunning=!1},e.instance=new e,e.ThreadWaitTimeInMs=1e3,e.ProcessEventsIntervalInSeconds=8,e}();t.GAThreading=r}(e.threading||(e.threading={}))}(a||(a={})),function(e){var t=e.threading.GAThreading,n=e.logging.GALogger,s=e.store.GAStore,r=e.state.GAState,a=e.http.GAHTTPApi,o=e.device.GADevice,l=e.validators.GAValidator,h=e.http.EGAHTTPApiResponse,u=e.utilities.GAUtilities,c=e.events.GAEvents,d=function(){function d(){}return d.getGlobalObject=function(){return"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==i.g?i.g:void 0},d.init=function(){if(o.touch(),d.methodMap.configureAvailableCustomDimensions01=d.configureAvailableCustomDimensions01,d.methodMap.configureAvailableCustomDimensions02=d.configureAvailableCustomDimensions02,d.methodMap.configureAvailableCustomDimensions03=d.configureAvailableCustomDimensions03,d.methodMap.configureAvailableResourceCurrencies=d.configureAvailableResourceCurrencies,d.methodMap.configureAvailableResourceItemTypes=d.configureAvailableResourceItemTypes,d.methodMap.configureBuild=d.configureBuild,d.methodMap.configureSdkGameEngineVersion=d.configureSdkGameEngineVersion,d.methodMap.configureGameEngineVersion=d.configureGameEngineVersion,d.methodMap.configureUserId=d.configureUserId,d.methodMap.initialize=d.initialize,d.methodMap.addBusinessEvent=d.addBusinessEvent,d.methodMap.addResourceEvent=d.addResourceEvent,d.methodMap.addProgressionEvent=d.addProgressionEvent,d.methodMap.addDesignEvent=d.addDesignEvent,d.methodMap.addErrorEvent=d.addErrorEvent,d.methodMap.addAdEvent=d.addAdEvent,d.methodMap.setEnabledInfoLog=d.setEnabledInfoLog,d.methodMap.setEnabledVerboseLog=d.setEnabledVerboseLog,d.methodMap.setEnabledManualSessionHandling=d.setEnabledManualSessionHandling,d.methodMap.setEnabledEventSubmission=d.setEnabledEventSubmission,d.methodMap.setCustomDimension01=d.setCustomDimension01,d.methodMap.setCustomDimension02=d.setCustomDimension02,d.methodMap.setCustomDimension03=d.setCustomDimension03,d.methodMap.setGlobalCustomEventFields=d.setGlobalCustomEventFields,d.methodMap.setEventProcessInterval=d.setEventProcessInterval,d.methodMap.startSession=d.startSession,d.methodMap.endSession=d.endSession,d.methodMap.onStop=d.onStop,d.methodMap.onResume=d.onResume,d.methodMap.addRemoteConfigsListener=d.addRemoteConfigsListener,d.methodMap.removeRemoteConfigsListener=d.removeRemoteConfigsListener,d.methodMap.getRemoteConfigsValueAsString=d.getRemoteConfigsValueAsString,d.methodMap.isRemoteConfigsReady=d.isRemoteConfigsReady,d.methodMap.getRemoteConfigsContentAsString=d.getRemoteConfigsContentAsString,d.methodMap.addOnBeforeUnloadListener=d.addOnBeforeUnloadListener,d.methodMap.removeOnBeforeUnloadListener=d.removeOnBeforeUnloadListener,void 0!==d.getGlobalObject()&&void 0!==d.getGlobalObject().GameAnalytics&&void 0!==d.getGlobalObject().GameAnalytics.q){var e=d.getGlobalObject().GameAnalytics.q;for(var i in e)d.gaCommand.apply(null,e[i])}window.addEventListener("beforeunload",function(e){console.log("addEventListener unload"),r.instance.isUnloading=!0,r.notifyBeforeUnloadListeners(),t.endSessionAndStopQueue(),r.instance.isUnloading=!1})},d.gaCommand=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];t.length>0&&t[0]in e.GameAnalytics.methodMap&&(t.length>1?e.GameAnalytics.methodMap[t[0]].apply(null,Array.prototype.slice.call(t,1)):e.GameAnalytics.methodMap[t[0]]())},d.configureAvailableCustomDimensions01=function(e){void 0===e&&(e=[]),t.performTaskOnGAThread(function(){d.isSdkReady(!0,!1)?n.w("Available custom dimensions must be set before SDK is initialized"):r.setAvailableCustomDimensions01(e)})},d.configureAvailableCustomDimensions02=function(e){void 0===e&&(e=[]),t.performTaskOnGAThread(function(){d.isSdkReady(!0,!1)?n.w("Available custom dimensions must be set before SDK is initialized"):r.setAvailableCustomDimensions02(e)})},d.configureAvailableCustomDimensions03=function(e){void 0===e&&(e=[]),t.performTaskOnGAThread(function(){d.isSdkReady(!0,!1)?n.w("Available custom dimensions must be set before SDK is initialized"):r.setAvailableCustomDimensions03(e)})},d.configureAvailableResourceCurrencies=function(e){void 0===e&&(e=[]),t.performTaskOnGAThread(function(){d.isSdkReady(!0,!1)?n.w("Available resource currencies must be set before SDK is initialized"):r.setAvailableResourceCurrencies(e)})},d.configureAvailableResourceItemTypes=function(e){void 0===e&&(e=[]),t.performTaskOnGAThread(function(){d.isSdkReady(!0,!1)?n.w("Available resource item types must be set before SDK is initialized"):r.setAvailableResourceItemTypes(e)})},d.configureBuild=function(e){void 0===e&&(e=""),t.performTaskOnGAThread(function(){d.isSdkReady(!0,!1)?n.w("Build version must be set before SDK is initialized."):l.validateBuild(e)?r.setBuild(e):n.i("Validation fail - configure build: Cannot be null, empty or above 32 length. String: "+e)})},d.configureSdkGameEngineVersion=function(e){void 0===e&&(e=""),t.performTaskOnGAThread(function(){d.isSdkReady(!0,!1)||(l.validateSdkWrapperVersion(e)?o.sdkGameEngineVersion=e:n.i("Validation fail - configure sdk version: Sdk version not supported. String: "+e))})},d.configureGameEngineVersion=function(e){void 0===e&&(e=""),t.performTaskOnGAThread(function(){d.isSdkReady(!0,!1)||(l.validateEngineVersion(e)?o.gameEngineVersion=e:n.i("Validation fail - configure game engine version: Game engine version not supported. String: "+e))})},d.configureUserId=function(e){void 0===e&&(e=""),t.performTaskOnGAThread(function(){d.isSdkReady(!0,!1)?n.w("A custom user id must be set before SDK is initialized."):l.validateUserId(e)?r.setUserId(e):n.i("Validation fail - configure user_id: Cannot be null, empty or above 64 length. Will use default user_id method. Used string: "+e)})},d.initialize=function(e,i){void 0===e&&(e=""),void 0===i&&(i=""),o.updateConnectionType();var s=t.createTimedBlock();s.async=!0,d.initTimedBlockId=s.id,s.block=function(){d.isSdkReady(!0,!1)?n.w("SDK already initialized. Can only be called once."):l.validateKeys(e,i)?(r.setKeys(e,i),d.internalInitialize()):n.w("SDK failed initialize. Game key or secret key is invalid. Can only contain characters A-z 0-9, gameKey is 32 length, gameSecret is 40 length. Failed keys - gameKey: "+e+", secretKey: "+i)},t.performTimedBlockOnGAThread(s)},d.addBusinessEvent=function(e,i,n,s,a,l,h){if(void 0===e&&(e=""),void 0===i&&(i=0),void 0===n&&(n=""),void 0===s&&(s=""),void 0===a&&(a=""),void 0===l&&(l={}),void 0===h&&(h=!1),o.updateConnectionType(),r.instance.isUnloading){if(!d.isSdkReady(!0,!0,"Could not add business event"))return;c.addBusinessEvent(e,i,n,s,a,l,h)}else t.performTaskOnGAThread(function(){d.isSdkReady(!0,!0,"Could not add business event")&&c.addBusinessEvent(e,i,n,s,a,l,h)})},d.addResourceEvent=function(i,n,s,a,l,h,u){if(void 0===i&&(i=e.EGAResourceFlowType.Undefined),void 0===n&&(n=""),void 0===s&&(s=0),void 0===a&&(a=""),void 0===l&&(l=""),void 0===h&&(h={}),void 0===u&&(u=!1),o.updateConnectionType(),r.instance.isUnloading){if(!d.isSdkReady(!0,!0,"Could not add resource event"))return;c.addResourceEvent(i,n,s,a,l,h,u)}else t.performTaskOnGAThread(function(){d.isSdkReady(!0,!0,"Could not add resource event")&&c.addResourceEvent(i,n,s,a,l,h,u)})},d.addProgressionEvent=function(i,n,s,a,l,h,u){if(void 0===i&&(i=e.EGAProgressionStatus.Undefined),void 0===n&&(n=""),void 0===s&&(s=""),void 0===a&&(a=""),void 0===h&&(h={}),void 0===u&&(u=!1),o.updateConnectionType(),r.instance.isUnloading){if(!d.isSdkReady(!0,!0,"Could not add progression event"))return;var p="number"==typeof l;c.addProgressionEvent(i,n,s,a,p?l:0,p,h,u)}else t.performTaskOnGAThread(function(){if(d.isSdkReady(!0,!0,"Could not add progression event")){var e="number"==typeof l;c.addProgressionEvent(i,n,s,a,e?l:0,e,h,u)}})},d.addDesignEvent=function(e,i,n,s){if(void 0===n&&(n={}),void 0===s&&(s=!1),o.updateConnectionType(),r.instance.isUnloading){if(!d.isSdkReady(!0,!0,"Could not add design event"))return;var a="number"==typeof i;c.addDesignEvent(e,a?i:0,a,n,s)}else t.performTaskOnGAThread(function(){if(d.isSdkReady(!0,!0,"Could not add design event")){var t="number"==typeof i;c.addDesignEvent(e,t?i:0,t,n,s)}})},d.addErrorEvent=function(i,n,s,a){if(void 0===i&&(i=e.EGAErrorSeverity.Undefined),void 0===n&&(n=""),void 0===s&&(s={}),void 0===a&&(a=!1),o.updateConnectionType(),r.instance.isUnloading){if(!d.isSdkReady(!0,!0,"Could not add error event"))return;c.addErrorEvent(i,n,s,a)}else t.performTaskOnGAThread(function(){d.isSdkReady(!0,!0,"Could not add error event")&&c.addErrorEvent(i,n,s,a)})},d.addAdEventWithNoAdReason=function(i,n,s,a,l,h,u){if(void 0===i&&(i=e.EGAAdAction.Undefined),void 0===n&&(n=e.EGAAdType.Undefined),void 0===s&&(s=""),void 0===a&&(a=""),void 0===l&&(l=e.EGAAdError.Undefined),void 0===h&&(h={}),void 0===u&&(u=!1),o.updateConnectionType(),r.instance.isUnloading){if(!d.isSdkReady(!0,!0,"Could not add ad event"))return;c.addAdEvent(i,n,s,a,l,0,!1,h,u)}else t.performTaskOnGAThread(function(){d.isSdkReady(!0,!0,"Could not add ad event")&&c.addAdEvent(i,n,s,a,l,0,!1,h,u)})},d.addAdEventWithDuration=function(i,n,s,a,l,h,u){if(void 0===i&&(i=e.EGAAdAction.Undefined),void 0===n&&(n=e.EGAAdType.Undefined),void 0===s&&(s=""),void 0===a&&(a=""),void 0===l&&(l=0),void 0===h&&(h={}),void 0===u&&(u=!1),o.updateConnectionType(),r.instance.isUnloading){if(!d.isSdkReady(!0,!0,"Could not add ad event"))return;c.addAdEvent(i,n,s,a,e.EGAAdError.Undefined,l,!0,h,u)}else t.performTaskOnGAThread(function(){d.isSdkReady(!0,!0,"Could not add ad event")&&c.addAdEvent(i,n,s,a,e.EGAAdError.Undefined,l,!0,h,u)})},d.addAdEvent=function(i,n,s,a,l,h){if(void 0===i&&(i=e.EGAAdAction.Undefined),void 0===n&&(n=e.EGAAdType.Undefined),void 0===s&&(s=""),void 0===a&&(a=""),void 0===l&&(l={}),void 0===h&&(h=!1),o.updateConnectionType(),r.instance.isUnloading){if(!d.isSdkReady(!0,!0,"Could not add ad event"))return;c.addAdEvent(i,n,s,a,e.EGAAdError.Undefined,0,!1,l,h)}else t.performTaskOnGAThread(function(){d.isSdkReady(!0,!0,"Could not add ad event")&&c.addAdEvent(i,n,s,a,e.EGAAdError.Undefined,0,!1,l,h)})},d.setEnabledInfoLog=function(e){void 0===e&&(e=!1),t.performTaskOnGAThread(function(){e?(n.setInfoLog(e),n.i("Info logging enabled")):(n.i("Info logging disabled"),n.setInfoLog(e))})},d.setEnabledVerboseLog=function(e){void 0===e&&(e=!1),t.performTaskOnGAThread(function(){e?(n.setVerboseLog(e),n.i("Verbose logging enabled")):(n.i("Verbose logging disabled"),n.setVerboseLog(e))})},d.setEnabledManualSessionHandling=function(e){void 0===e&&(e=!1),t.performTaskOnGAThread(function(){r.setManualSessionHandling(e)})},d.setEnabledEventSubmission=function(e){void 0===e&&(e=!1),t.performTaskOnGAThread(function(){e?(r.setEnabledEventSubmission(e),n.i("Event submission enabled")):(n.i("Event submission disabled"),r.setEnabledEventSubmission(e))})},d.setCustomDimension01=function(e){void 0===e&&(e=""),t.performTaskOnGAThread(function(){l.validateDimension01(e,r.getAvailableCustomDimensions01())?r.setCustomDimension01(e):n.w("Could not set custom01 dimension value to '"+e+"'. Value not found in available custom01 dimension values")})},d.setCustomDimension02=function(e){void 0===e&&(e=""),t.performTaskOnGAThread(function(){l.validateDimension02(e,r.getAvailableCustomDimensions02())?r.setCustomDimension02(e):n.w("Could not set custom02 dimension value to '"+e+"'. Value not found in available custom02 dimension values")})},d.setCustomDimension03=function(e){void 0===e&&(e=""),t.performTaskOnGAThread(function(){l.validateDimension03(e,r.getAvailableCustomDimensions03())?r.setCustomDimension03(e):n.w("Could not set custom03 dimension value to '"+e+"'. Value not found in available custom03 dimension values")})},d.setGlobalCustomEventFields=function(e){void 0===e&&(e={}),t.performTaskOnGAThread(function(){n.i("Set global custom event fields: "+JSON.stringify(e)),r.instance.currentGlobalCustomEventFields=e})},d.setEventProcessInterval=function(e){t.performTaskOnGAThread(function(){t.setEventProcessInterval(e)})},d.startSession=function(){if(r.isInitialized()){var e=t.createTimedBlock();e.async=!0,d.initTimedBlockId=e.id,e.block=function(){r.isEnabled()&&r.sessionIsStarted()&&t.endSessionAndStopQueue(),d.resumeSessionAndStartQueue()},t.performTimedBlockOnGAThread(e)}},d.endSession=function(){d.onStop()},d.onStop=function(){t.performTaskOnGAThread(function(){try{t.endSessionAndStopQueue()}catch(e){}})},d.onResume=function(){var e=t.createTimedBlock();e.async=!0,d.initTimedBlockId=e.id,e.block=function(){d.resumeSessionAndStartQueue()},t.performTimedBlockOnGAThread(e)},d.getRemoteConfigsValueAsString=function(e,t){return void 0===t&&(t=null),r.getConfigurationStringValue(e,t)},d.isRemoteConfigsReady=function(){return r.isRemoteConfigsReady()},d.addRemoteConfigsListener=function(e){r.addRemoteConfigsListener(e)},d.removeRemoteConfigsListener=function(e){r.removeRemoteConfigsListener(e)},d.getRemoteConfigsContentAsString=function(){return r.getRemoteConfigsContentAsString()},d.getABTestingId=function(){return r.getABTestingId()},d.getABTestingVariantId=function(){return r.getABTestingVariantId()},d.addOnBeforeUnloadListener=function(e){r.addOnBeforeUnloadListener(e)},d.removeOnBeforeUnloadListener=function(e){r.removeOnBeforeUnloadListener(e)},d.internalInitialize=function(){r.ensurePersistedStates(),s.setItem(r.getGameKey(),r.DefaultUserIdKey,r.getDefaultId()),r.setInitialized(!0),d.newSession(),r.isEnabled()&&t.ensureEventQueueIsRunning()},d.newSession=function(){n.i("Starting a new session."),r.validateAndFixCurrentDimensions(),a.instance.requestInit(r.instance.configsHash,d.startNewSessionCallback)},d.startNewSessionCallback=function(e,i){if(e!==h.Ok&&e!==h.Created||!i)e==h.Unauthorized?(n.w("Initialize SDK failed - Unauthorized"),r.instance.initAuthorized=!1):(e===h.NoResponse||e===h.RequestTimeout?n.i("Init call (session start) failed - no response. Could be offline or timeout."):e===h.BadResponse||e===h.JsonEncodeFailed||e===h.JsonDecodeFailed?n.i("Init call (session start) failed - bad response. Could be bad response from proxy or GA servers."):e!==h.BadRequest&&e!==h.UnknownResponseCode||n.i("Init call (session start) failed - bad request or unknown response."),null==r.instance.sdkConfig?null!=r.instance.sdkConfigCached?(n.i("Init call (session start) failed - using cached init values."),r.instance.sdkConfig=r.instance.sdkConfigCached):(n.i("Init call (session start) failed - using default init values."),r.instance.sdkConfig=r.instance.sdkConfigDefault):n.i("Init call (session start) failed - using cached init values."),r.instance.initAuthorized=!0);else{var a=0;if(i.server_ts){var o=i.server_ts;a=r.calculateServerTimeOffset(o)}if(i.time_offset=a,e!=h.Created){var l=r.getSdkConfig();l.configs&&(i.configs=l.configs),l.configs_hash&&(i.configs_hash=l.configs_hash),l.ab_id&&(i.ab_id=l.ab_id),l.ab_variant_id&&(i.ab_variant_id=l.ab_variant_id)}r.instance.configsHash=i.configs_hash?i.configs_hash:"",r.instance.abId=i.ab_id?i.ab_id:"",r.instance.abVariantId=i.ab_variant_id?i.ab_variant_id:"",s.setItem(r.getGameKey(),r.SdkConfigCachedKey,u.encode64(JSON.stringify(i))),r.instance.sdkConfigCached=i,r.instance.sdkConfig=i,r.instance.initAuthorized=!0}if(r.instance.clientServerTimeOffset=r.getSdkConfig().time_offset?r.getSdkConfig().time_offset:0,r.populateConfigurations(r.getSdkConfig()),!r.isEnabled())return n.w("Could not start session: SDK is disabled."),void t.stopEventQueue();t.ensureEventQueueIsRunning();var p=u.createGuid();r.instance.sessionId=p,r.instance.sessionStart=r.getClientTsAdjusted(),c.addSessionStartEvent();var f=t.getTimedBlockById(d.initTimedBlockId);null!=f&&(f.running=!1),d.initTimedBlockId=-1},d.resumeSessionAndStartQueue=function(){r.isInitialized()&&(n.i("Resuming session."),r.sessionIsStarted()||d.newSession())},d.isSdkReady=function(e,t,i){return void 0===t&&(t=!0),void 0===i&&(i=""),i&&(i+=": "),e&&!r.isInitialized()?(t&&n.w(i+"SDK is not initialized"),!1):e&&!r.isEnabled()?(t&&n.w(i+"SDK is disabled"),!1):!(e&&!r.sessionIsStarted())||(t&&n.w(i+"Session has not started yet"),!1)},d.initTimedBlockId=-1,d.methodMap={},d}();e.GameAnalytics=d}(a||(a={})),a.GameAnalytics.init();a.GameAnalytics.gaCommand;e.exports=a},3246:(e,t,i)=>{"use strict";i.d(t,{v:()=>r});var n=i(2551),s=i(4303);class r extends n.A{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return(0,s.t6)(s.lj,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return(0,s.t6)(s.lj,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return(0,s.t6)(s.lj,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return(0,s.t6)(s.lj,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return(0,s.t6)(s.lj,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(e=!1){this.emit("destroy",this),this.removeAllListeners();for(const e in this.chars)this.chars[e].texture?.destroy();this.chars=null,e&&(this.pages.forEach(e=>e.texture.destroy(!0)),this.pages=null)}}},3289:(e,t,i)=>{"use strict";i.d(t,{c:()=>a});var n=i(6680),s=i(2207);const r=new n.u;class a{constructor(e=1/0,t=1/0,i=-1/0,n=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=r,this.minX=e,this.minY=t,this.maxX=i,this.maxY=n}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new s.M);const e=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(e.x=0,e.y=0,e.width=0,e.height=0):e.copyFromBounds(this),e}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=r,this}set(e,t,i,n){this.minX=e,this.minY=t,this.maxX=i,this.maxY=n}addFrame(e,t,i,n,s){s||(s=this.matrix);const r=s.a,a=s.b,o=s.c,l=s.d,h=s.tx,u=s.ty;let c=this.minX,d=this.minY,p=this.maxX,f=this.maxY,g=r*e+o*t+h,m=a*e+l*t+u;g<c&&(c=g),m<d&&(d=m),g>p&&(p=g),m>f&&(f=m),g=r*i+o*t+h,m=a*i+l*t+u,g<c&&(c=g),m<d&&(d=m),g>p&&(p=g),m>f&&(f=m),g=r*e+o*n+h,m=a*e+l*n+u,g<c&&(c=g),m<d&&(d=m),g>p&&(p=g),m>f&&(f=m),g=r*i+o*n+h,m=a*i+l*n+u,g<c&&(c=g),m<d&&(d=m),g>p&&(p=g),m>f&&(f=m),this.minX=c,this.minY=d,this.maxX=p,this.maxY=f}addRect(e,t){this.addFrame(e.x,e.y,e.x+e.width,e.y+e.height,t)}addBounds(e,t){this.addFrame(e.minX,e.minY,e.maxX,e.maxY,t)}addBoundsMask(e){this.minX=this.minX>e.minX?this.minX:e.minX,this.minY=this.minY>e.minY?this.minY:e.minY,this.maxX=this.maxX<e.maxX?this.maxX:e.maxX,this.maxY=this.maxY<e.maxY?this.maxY:e.maxY}applyMatrix(e){const t=this.minX,i=this.minY,n=this.maxX,s=this.maxY,{a:r,b:a,c:o,d:l,tx:h,ty:u}=e;let c=r*t+o*i+h,d=a*t+l*i+u;this.minX=c,this.minY=d,this.maxX=c,this.maxY=d,c=r*n+o*i+h,d=a*n+l*i+u,this.minX=c<this.minX?c:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=c>this.maxX?c:this.maxX,this.maxY=d>this.maxY?d:this.maxY,c=r*t+o*s+h,d=a*t+l*s+u,this.minX=c<this.minX?c:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=c>this.maxX?c:this.maxX,this.maxY=d>this.maxY?d:this.maxY,c=r*n+o*s+h,d=a*n+l*s+u,this.minX=c<this.minX?c:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=c>this.maxX?c:this.maxX,this.maxY=d>this.maxY?d:this.maxY}fit(e){return this.minX<e.left&&(this.minX=e.left),this.maxX>e.right&&(this.maxX=e.right),this.minY<e.top&&(this.minY=e.top),this.maxY>e.bottom&&(this.maxY=e.bottom),this}fitBounds(e,t,i,n){return this.minX<e&&(this.minX=e),this.maxX>t&&(this.maxX=t),this.minY<i&&(this.minY=i),this.maxY>n&&(this.maxY=n),this}pad(e,t=e){return this.minX-=e,this.maxX+=e,this.minY-=t,this.maxY+=t,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new a(this.minX,this.minY,this.maxX,this.maxY)}scale(e,t=e){return this.minX*=e,this.minY*=t,this.maxX*=e,this.maxY*=t,this}get x(){return this.minX}set x(e){const t=this.maxX-this.minX;this.minX=e,this.maxX=e+t}get y(){return this.minY}set y(e){const t=this.maxY-this.minY;this.minY=e,this.maxY=e+t}get width(){return this.maxX-this.minX}set width(e){this.maxX=this.minX+e}get height(){return this.maxY-this.minY}set height(e){this.maxY=this.minY+e}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(e,t,i,n){let s=this.minX,r=this.minY,a=this.maxX,o=this.maxY;n||(n=this.matrix);const l=n.a,h=n.b,u=n.c,c=n.d,d=n.tx,p=n.ty;for(let n=t;n<i;n+=2){const t=e[n],i=e[n+1],f=l*t+u*i+d,g=h*t+c*i+p;s=f<s?f:s,r=g<r?g:r,a=f>a?f:a,o=g>o?g:o}this.minX=s,this.minY=r,this.maxX=a,this.maxY=o}containsPoint(e,t){return this.minX<=e&&this.minY<=t&&this.maxX>=e&&this.maxY>=t}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(e){return this.minX=e.minX,this.minY=e.minY,this.maxX=e.maxX,this.maxY=e.maxY,this}}},3296:(e,t,i)=>{"use strict";i.d(t,{R:()=>n,m:()=>s});const n={name:"texture-bit",vertex:{header:"\n\n        struct TextureUniforms {\n            uTextureMatrix:mat3x3<f32>,\n        }\n\n        @group(2) @binding(2) var<uniform> textureUniforms : TextureUniforms;\n        ",main:"\n            uv = (textureUniforms.uTextureMatrix * vec3(uv, 1.0)).xy;\n        "},fragment:{header:"\n            @group(2) @binding(0) var uTexture: texture_2d<f32>;\n            @group(2) @binding(1) var uSampler: sampler;\n\n\n        ",main:"\n            outColor = textureSample(uTexture, uSampler, vUV);\n        "}},s={name:"texture-bit",vertex:{header:"\n            uniform mat3 uTextureMatrix;\n        ",main:"\n            uv = (uTextureMatrix * vec3(uv, 1.0)).xy;\n        "},fragment:{header:"\n        uniform sampler2D uTexture;\n\n\n        ",main:"\n            outColor = texture(uTexture, vUV);\n        "}}},3377:(e,t,i)=>{"use strict";i.d(t,{d:()=>n});var n=(e=>(e[e.INTERACTION=50]="INTERACTION",e[e.HIGH=25]="HIGH",e[e.NORMAL=0]="NORMAL",e[e.LOW=-25]="LOW",e[e.UTILITY=-50]="UTILITY",e))(n||{})},3381:(e,t,i)=>{"use strict";i.d(t,{M:()=>d});var n=i(2349),s=i(7467);let r;function a(){if(!r){r="mediump";const e=(0,s.W)();if(e&&e.getShaderPrecisionFormat){const t=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);r=t.precision?"highp":"mediump"}}return r}const o={},l={};const h={stripVersion:function(e,t){return t?e.replace("#version 300 es",""):e},ensurePrecision:function(e,t,i){const n=i?t.maxSupportedFragmentPrecision:t.maxSupportedVertexPrecision;if("precision"!==e.substring(0,9)){let s=i?t.requestedFragmentPrecision:t.requestedVertexPrecision;return"highp"===s&&"highp"!==n&&(s="mediump"),`precision ${s} float;\n${e}`}return"highp"!==n&&"precision highp"===e.substring(0,15)?e.replace("precision highp","precision mediump"):e},addProgramDefines:function(e,t,i){return t?e:i?`\n\n        #ifdef GL_ES // This checks if it is WebGL1\n        #define in varying\n        #define finalColor gl_FragColor\n        #define texture texture2D\n        #endif\n        ${e=e.replace("out vec4 finalColor;","")}\n        `:`\n\n        #ifdef GL_ES // This checks if it is WebGL1\n        #define in attribute\n        #define out varying\n        #endif\n        ${e}\n        `},setProgramName:function(e,{name:t="pixi-program"},i=!0){t=t.replace(/\s+/g,"-");const n=i?o:l;return n[t+=i?"-fragment":"-vertex"]?(n[t]++,t+=`-${n[t]}`):n[t]=1,-1!==e.indexOf("#define SHADER_NAME")?e:`${`#define SHADER_NAME ${t}`}\n${e}`},insertVersion:function(e,t){return t?`#version 300 es\n${e}`:e}},u=Object.create(null),c=class e{constructor(t){const i=-1!==(t={...e.defaultOptions,...t}).fragment.indexOf("#version 300 es"),s={stripVersion:i,ensurePrecision:{requestedFragmentPrecision:t.preferredFragmentPrecision,requestedVertexPrecision:t.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:a()},setProgramName:{name:t.name},addProgramDefines:i,insertVersion:i};let r=t.fragment,o=t.vertex;Object.keys(h).forEach(e=>{const t=s[e];r=h[e](r,t,!0),o=h[e](o,t,!1)}),this.fragment=r,this.vertex=o,this.transformFeedbackVaryings=t.transformFeedbackVaryings,this._key=(0,n.X)(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null,u[this._cacheKey]=null}static from(t){const i=`${t.vertex}:${t.fragment}`;return u[i]||(u[i]=new e(t),u[i]._cacheKey=i),u[i]}};c.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let d=c},3385:(e,t,i)=>{"use strict";i.d(t,{g:()=>s});var n=i(6954);const s=[];s[n.K.NONE]=void 0,s[n.K.DISABLED]={stencilWriteMask:0,stencilReadMask:0},s[n.K.RENDERING_MASK_ADD]={stencilFront:{compare:"equal",passOp:"increment-clamp"},stencilBack:{compare:"equal",passOp:"increment-clamp"}},s[n.K.RENDERING_MASK_REMOVE]={stencilFront:{compare:"equal",passOp:"decrement-clamp"},stencilBack:{compare:"equal",passOp:"decrement-clamp"}},s[n.K.MASK_ACTIVE]={stencilWriteMask:0,stencilFront:{compare:"equal",passOp:"keep"},stencilBack:{compare:"equal",passOp:"keep"}},s[n.K.INVERSE_MASK_ACTIVE]={stencilWriteMask:0,stencilFront:{compare:"not-equal",passOp:"keep"},stencilBack:{compare:"not-equal",passOp:"keep"}}},3386:(e,t,i)=>{"use strict";i.d(t,{E:()=>s});var n=i(577);function s(e,t,i,s){const r=["\n        var v = null;\n        var v2 = null;\n        var t = 0;\n        var index = 0;\n        var name = null;\n        var arrayOffset = null;\n    "];let a=0;for(let o=0;o<e.length;o++){const l=e[o],h=l.data.name;let u=!1,c=0;for(let e=0;e<n.$.length;e++){if(n.$[e].test(l.data)){c=l.offset/4,r.push(`name = "${h}";`,`offset += ${c-a};`,n.$[e][t]||n.$[e].ubo),u=!0;break}}if(!u)if(l.data.size>1)c=l.offset/4,r.push(i(l,c-a));else{const e=s[l.data.type];c=l.offset/4,r.push(`\n                    v = uv.${h};\n                    offset += ${c-a};\n                    ${e};\n                `)}a=c}const o=r.join("\n");return new Function("uv","data","dataInt32","offset",o)}},3596:(e,t,i)=>{"use strict";i.d(t,{c:()=>T});var n=i(5957),s=i(4068),r=i(4303),a=i(9731),o=i(8593),l=i(4984),h=i(7747),u=i(2207),c=i(4057),d=i(8390),p=i(8192),f=i(1819),g=i(4588),m=i(6447),_=i(3246);const v=class e extends _.v{constructor(t){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentMaxCharHeight=0,this._currentPageIndex=-1,this._skipKerning=!1;const i={...e.defaultOptions,...t};this._textureSize=i.textureSize,this._mipmap=i.mipmap;const n=i.style.clone();i.overrideFill&&(n._fill.color=16777215,n._fill.alpha=1,n._fill.texture=p.g.WHITE,n._fill.fill=null),this.applyFillAsTint=i.overrideFill;const s=n.fontSize;n.fontSize=this.baseMeasurementFontSize;const r=(0,g.Z)(n);i.overrideSize?n._stroke&&(n._stroke.width*=this.baseRenderedFontSize/s):n.fontSize=this.baseRenderedFontSize=s,this._style=n,this._skipKerning=i.skipKerning??!1,this.resolution=i.resolution??1,this._padding=i.padding??4,i.textureStyle&&(this._textureStyle=i.textureStyle instanceof f.n?i.textureStyle:new f.n(i.textureStyle)),this.fontMetrics=o.P.measureFont(r),this.lineHeight=n.lineHeight||this.fontMetrics.fontSize||n.fontSize}ensureCharacters(e){const t=o.P.graphemeSegmenter(e).filter(e=>!this._currentChars.includes(e)).filter((e,t,i)=>i.indexOf(e)===t);if(!t.length)return;let i;this._currentChars=[...this._currentChars,...t],i=-1===this._currentPageIndex?this._nextPage():this.pages[this._currentPageIndex];let{canvas:n,context:s}=i.canvasAndContext,r=i.texture.source;const a=this._style;let l=this._currentX,h=this._currentY,c=this._currentMaxCharHeight;const d=this.baseRenderedFontSize/this.baseMeasurementFontSize,f=this._padding*d;let g=!1;const m=n.width/this.resolution,_=n.height/this.resolution;for(let e=0;e<t.length;e++){const i=t[e],v=o.P.measureText(i,a,n,!1);v.lineHeight=v.height;const y=v.width*d,b=Math.ceil(("italic"===a.fontStyle?2:1)*y)+2*f,x=v.height*d+2*f;if(g=!1,"\n"!==i&&"\r"!==i&&"\t"!==i&&" "!==i&&(g=!0,c=Math.ceil(Math.max(x,c))),l+b>m&&(h+=c,c=x,l=0,h+c>_)){r.update();const e=this._nextPage();n=e.canvasAndContext.canvas,s=e.canvasAndContext.context,r=e.texture.source,l=0,h=0,c=0}const T=y/d-(a.dropShadow?.distance??0)-(a._stroke?.width??0);if(this.chars[i]={id:i.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:T,kerning:{}},g){this._drawGlyph(s,v,l+f,h+f,d,a);const e=r.width*d,t=r.height*d,n=new u.M(l/e*r.width,h/t*r.height,b/e*r.width,x/t*r.height);this.chars[i].texture=new p.g({source:r,frame:n}),l+=Math.ceil(b)}}r.update(),this._currentX=l,this._currentY=h,this._currentMaxCharHeight=c,this._skipKerning&&this._applyKerning(t,s)}get pageTextures(){return(0,r.t6)(r.lj,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(e,t){const i=this._measureCache;for(let n=0;n<e.length;n++){const s=e[n];for(let e=0;e<this._currentChars.length;e++){const n=this._currentChars[e];let r=i[s];r||(r=i[s]=t.measureText(s).width);let a=i[n];a||(a=i[n]=t.measureText(n).width);let o=t.measureText(s+n).width,l=o-(r+a);l&&(this.chars[s].kerning[n]=l),o=t.measureText(s+n).width,l=o-(r+a),l&&(this.chars[n].kerning[s]=l)}}}_nextPage(){this._currentPageIndex++;const e=this.resolution,t=c.N.getOptimalCanvasAndContext(this._textureSize,this._textureSize,e);this._setupContext(t.context,this._style,e);const i=e*(this.baseRenderedFontSize/this.baseMeasurementFontSize),n=new p.g({source:new d.b({resource:t.canvas,resolution:i,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})});this._textureStyle&&(n.source.style=this._textureStyle);const s={canvasAndContext:t,texture:n};return this.pages[this._currentPageIndex]=s,s}_setupContext(e,t,i){t.fontSize=this.baseRenderedFontSize,e.scale(i,i),e.font=(0,g.Z)(t),t.fontSize=this.baseMeasurementFontSize,e.textBaseline=t.textBaseline;const n=t._stroke,s=n?.width??0;if(n&&(e.lineWidth=s,e.lineJoin=n.join,e.miterLimit=n.miterLimit,e.strokeStyle=(0,m.r)(n,e)),t._fill&&(e.fillStyle=(0,m.r)(t._fill,e)),t.dropShadow){const n=t.dropShadow,s=h.Q.shared.setValue(n.color).toArray(),r=n.blur*i,a=n.distance*i;e.shadowColor=`rgba(${255*s[0]},${255*s[1]},${255*s[2]},${n.alpha})`,e.shadowBlur=r,e.shadowOffsetX=Math.cos(n.angle)*a,e.shadowOffsetY=Math.sin(n.angle)*a}else e.shadowColor="black",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0}_drawGlyph(e,t,i,n,s,r){const a=t.text,o=t.fontProperties,l=r._stroke,h=(l?.width??0)*s,u=i+h/2,c=n-h/2,d=o.descent*s,p=t.lineHeight*s;let f=!1;r.stroke&&h&&(f=!0,e.strokeText(a,u,c+p-d));const{shadowBlur:g,shadowOffsetX:m,shadowOffsetY:_}=e;r._fill&&(f&&(e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0),e.fillText(a,u,c+p-d)),f&&(e.shadowBlur=g,e.shadowOffsetX=m,e.shadowOffsetY=_)}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){const{canvasAndContext:t,texture:i}=this.pages[e];c.N.returnCanvasAndContext(t),i.destroy(!0)}this.pages=null}};v.defaultOptions={textureSize:512,style:new l.x,mipmap:!0};let y=v;var b=i(594);let x=0;const T=new class{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1,textureStyle:null},this.measureCache=(0,n.g)(1e3)}getFont(e,t){let i=`${t.fontFamily}-bitmap`,n=!0;if(t._fill.fill&&!t._stroke?(i+=t._fill.fill.styleKey,n=!1):(t._stroke||t.dropShadow)&&(i=`${t.styleKey}-bitmap`,n=!1),!s.l.has(i)){const e=Object.create(t);e.lineHeight=0;const r=new y({style:e,overrideFill:n,overrideSize:!0,...this.defaultOptions});x++,x>50&&(0,a.R)("BitmapText",`You have dynamically created ${x} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),r.once("destroy",()=>{x--,s.l.remove(i)}),s.l.set(i,r)}const r=s.l.get(i);return r.ensureCharacters?.(e),r}getLayout(e,t,i=!0){const n=this.getFont(e,t),s=`${e}-${t.styleKey}-${i}`;if(this.measureCache.has(s))return this.measureCache.get(s);const r=o.P.graphemeSegmenter(e),a=(0,b.Z)(r,t,n,i);return this.measureCache.set(s,a),a}measureText(e,t,i=!0){return this.getLayout(e,t,i)}install(...e){let t=e[0];"string"==typeof t&&(t={name:t,style:e[1],chars:e[2]?.chars,resolution:e[2]?.resolution,padding:e[2]?.padding,skipKerning:e[2]?.skipKerning},(0,r.t6)(r.lj,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const i=t?.name;if(!i)throw new Error("[BitmapFontManager] Property `name` is required.");t={...this.defaultOptions,...t};const n=t.style,a=n instanceof l.x?n:new l.x(n),o=t.dynamicFill??this._canUseTintForStyle(a),h=new y({style:a,overrideFill:o,skipKerning:t.skipKerning,padding:t.padding,resolution:t.resolution,overrideSize:!1,textureStyle:t.textureStyle}),u=function(e){if(""===e)return[];"string"==typeof e&&(e=[e]);const t=[];for(let i=0,n=e.length;i<n;i++){const n=e[i];if(Array.isArray(n)){if(2!==n.length)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${n.length}.`);if(0===n[0].length||0===n[1].length)throw new Error("[BitmapFont]: Invalid character delimiter.");const e=n[0].charCodeAt(0),i=n[1].charCodeAt(0);if(i<e)throw new Error("[BitmapFont]: Invalid character range.");for(let n=e,s=i;n<=s;n++)t.push(String.fromCharCode(n))}else t.push(...Array.from(n))}if(0===t.length)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}(t.chars);return h.ensureCharacters(u.join("")),s.l.set(`${i}-bitmap`,h),h.once("destroy",()=>s.l.remove(`${i}-bitmap`)),h}uninstall(e){const t=`${e}-bitmap`,i=s.l.get(t);i&&i.destroy()}_canUseTintForStyle(e){return!(e._stroke||e.dropShadow&&0!==e.dropShadow.color||e._fill.fill||16777215!==e._fill.color)}}},3630:(e,t,i)=>{"use strict";var n=i(4068),s=i(8602),r=i(5884),a=i(8192);const o=[];function l(e={}){const t=e&&e.resource,i=t?e.resource:e,n=t?e:{resource:e};for(let e=0;e<o.length;e++){const t=o[e];if(t.test(i))return new t(n)}throw new Error(`Could not find a source type for resource: ${n.resource}`)}s.XO.handleByList(s.Ag.TextureSource,o),a.g.from=function(e,t=!1){return"string"==typeof e?n.l.get(e):e instanceof r.v?new a.g({source:e}):function(e={},t=!1){const i=e&&e.resource,s=i?e.resource:e,r=i?e:{resource:e};if(!t&&n.l.has(s))return n.l.get(s);const o=new a.g({source:l(r)});return o.on("destroy",()=>{n.l.has(s)&&n.l.remove(s)}),t||n.l.set(s,o),o}(e,t)},r.v.from=l},3639:(e,t,i)=>{"use strict";i.d(t,{WebGLRenderer:()=>Qe});var n=i(8602),s=i(6680),r=i(6566),a=i(9140),o=i(2581),l=i(9922),h=i(358),u=i(6479),c=i(9232),d=i(9037);class p{contextChange(e){const t=new d.k({uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uTransformMatrix:{value:new s.u,type:"mat3x3<f32>"},uRound:{value:0,type:"f32"}}),i=e.limits.maxBatchableTextures,n=(0,r.I)({name:"graphics",bits:[a.a,(0,o.P)(i),l.mA,h.m]});this.shader=new c.M({glProgram:n,resources:{localUniforms:t,batchSamplers:(0,u.n)(i)}})}execute(e,t){const i=t.context,n=i.customShader||this.shader,s=e.renderer,r=s.graphicsContext,{batcher:a,instructions:o}=r.getContextRenderData(i);n.groups[0]=s.globalUniforms.bindGroup,s.state.set(e.state),s.shader.bind(n),s.geometry.bind(a.geometry,n.glProgram);const l=o.instructions;for(let e=0;e<o.instructionSize;e++){const t=l[e];if(t.size){for(let e=0;e<t.textures.count;e++)s.texture.bind(t.textures.textures[e],e);s.geometry.draw(t.topology,t.size,t.start)}}}destroy(){this.shader.destroy(!0),this.shader=null}}p.extension={type:[n.Ag.WebGLPipesAdaptor],name:"graphics"};var f=i(3296),g=i(8192),m=i(9731);class _{init(){const e=(0,r.I)({name:"mesh",bits:[l.mA,f.m,h.m]});this._shader=new c.M({glProgram:e,resources:{uTexture:g.g.EMPTY.source,textureUniforms:{uTextureMatrix:{type:"mat3x3<f32>",value:new s.u}}}})}execute(e,t){const i=e.renderer;let n=t._shader;if(n){if(!n.glProgram)return void(0,m.R)("Mesh shader has no glProgram",t.shader)}else{n=this._shader;const e=t.texture,i=e.source;n.resources.uTexture=i,n.resources.uSampler=i.style,n.resources.textureUniforms.uniforms.uTextureMatrix=e.textureMatrix.mapCoord}n.groups[100]=i.globalUniforms.bindGroup,n.groups[101]=e.localUniformsBindGroup,i.encoder.draw({geometry:t._geometry,shader:n,state:t.state})}destroy(){this._shader.destroy(!0),this._shader=null}}_.extension={type:[n.Ag.WebGLPipesAdaptor],name:"mesh"};var v=i(4060);class y{constructor(){this._tempState=v.U.for2d(),this._didUploadHash={}}init(e){e.renderer.runners.contextChange.add(this)}contextChange(){this._didUploadHash={}}start(e,t,i){const n=e.renderer,s=this._didUploadHash[i.uid];n.shader.bind(i,s),s||(this._didUploadHash[i.uid]=!0),n.shader.updateUniformGroup(n.globalUniforms.uniformGroup),n.geometry.bind(t,i.glProgram)}execute(e,t){const i=e.renderer;this._tempState.blendMode=t.blendMode,i.state.set(this._tempState);const n=t.textures.textures;for(let e=0;e<t.textures.count;e++)i.texture.bind(n[e],e);i.geometry.draw(t.topology,t.size,t.start)}}y.extension={type:[n.Ag.WebGLPipesAdaptor],name:"batch"};var b=i(9745),x=i(6709),T=i(9998),S=i(2409),A=(e=>(e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e))(A||{});class E{constructor(e,t){this._lastBindBaseLocation=-1,this._lastBindCallId=-1,this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.type=t}}class C{constructor(e){this._gpuBuffers=Object.create(null),this._boundBufferBases=Object.create(null),this._minBaseLocation=0,this._nextBindBaseIndex=this._minBaseLocation,this._bindCallId=0,this._renderer=e,this._renderer.renderableGC.addManagedHash(this,"_gpuBuffers")}destroy(){this._renderer=null,this._gl=null,this._gpuBuffers=null,this._boundBufferBases=null}contextChange(){this._gl=this._renderer.gl,this._gpuBuffers=Object.create(null),this._maxBindings=this._renderer.limits.maxUniformBindings}getGlBuffer(e){return this._gpuBuffers[e.uid]||this.createGLBuffer(e)}bind(e){const{_gl:t}=this,i=this.getGlBuffer(e);t.bindBuffer(i.type,i.buffer)}bindBufferBase(e,t){const{_gl:i}=this;this._boundBufferBases[t]!==e&&(this._boundBufferBases[t]=e,e._lastBindBaseLocation=t,i.bindBufferBase(i.UNIFORM_BUFFER,t,e.buffer))}nextBindBase(e){this._bindCallId++,this._minBaseLocation=0,e&&(this._boundBufferBases[0]=null,this._minBaseLocation=1,this._nextBindBaseIndex<1&&(this._nextBindBaseIndex=1))}freeLocationForBufferBase(e){let t=this.getLastBindBaseLocation(e);if(t>=this._minBaseLocation)return e._lastBindCallId=this._bindCallId,t;let i=0,n=this._nextBindBaseIndex;for(;i<2;){n>=this._maxBindings&&(n=this._minBaseLocation,i++);const e=this._boundBufferBases[n];if(!e||e._lastBindCallId!==this._bindCallId)break;n++}return t=n,this._nextBindBaseIndex=n+1,i>=2?-1:(e._lastBindCallId=this._bindCallId,this._boundBufferBases[t]=null,t)}getLastBindBaseLocation(e){const t=e._lastBindBaseLocation;return this._boundBufferBases[t]===e?t:-1}bindBufferRange(e,t,i,n){const{_gl:s}=this;i||(i=0),t||(t=0),this._boundBufferBases[t]=null,s.bindBufferRange(s.UNIFORM_BUFFER,t||0,e.buffer,256*i,n||256)}updateBuffer(e){const{_gl:t}=this,i=this.getGlBuffer(e);if(e._updateID===i.updateID)return i;i.updateID=e._updateID,t.bindBuffer(i.type,i.buffer);const n=e.data,s=e.descriptor.usage&S.S.STATIC?t.STATIC_DRAW:t.DYNAMIC_DRAW;return n?i.byteLength>=n.byteLength?t.bufferSubData(i.type,0,n,0,e._updateSize/n.BYTES_PER_ELEMENT):(i.byteLength=n.byteLength,t.bufferData(i.type,n,s)):(i.byteLength=e.descriptor.size,t.bufferData(i.type,i.byteLength,s)),i}destroyAll(){const e=this._gl;for(const t in this._gpuBuffers)e.deleteBuffer(this._gpuBuffers[t].buffer);this._gpuBuffers=Object.create(null)}onBufferDestroy(e,t){const i=this._gpuBuffers[e.uid],n=this._gl;t||n.deleteBuffer(i.buffer),this._gpuBuffers[e.uid]=null}createGLBuffer(e){const{_gl:t}=this;let i=A.ARRAY_BUFFER;e.descriptor.usage&S.S.INDEX?i=A.ELEMENT_ARRAY_BUFFER:e.descriptor.usage&S.S.UNIFORM&&(i=A.UNIFORM_BUFFER);const n=new E(t.createBuffer(),i);return this._gpuBuffers[e.uid]=n,e.on("destroy",this.onBufferDestroy,this),n}resetState(){this._boundBufferBases=Object.create(null)}}C.extension={type:[n.Ag.WebGLSystem],name:"buffer"};var w=i(5553);const P=class e{constructor(e){this.supports={uint32Indices:!0,uniformBufferObject:!0,vertexArrayObject:!0,srgbTextures:!0,nonPowOf2wrapping:!0,msaa:!0,nonPowOf2mipmaps:!0},this._renderer=e,this.extensions=Object.create(null),this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this._renderer.gl=e}init(t){t={...e.defaultOptions,...t};let i=this.multiView=t.multiView;if(t.context&&i&&((0,m.R)("Renderer created with both a context and multiview enabled. Disabling multiView as both cannot work together."),i=!1),this.canvas=i?w.e.get().createCanvas(this._renderer.canvas.width,this._renderer.canvas.height):this._renderer.view.canvas,t.context)this.initFromContext(t.context);else{const e=this._renderer.background.alpha<1,i=t.premultipliedAlpha??!0,n=t.antialias&&!this._renderer.backBuffer.useBackBuffer;this.createContext(t.preferWebGLVersion,{alpha:e,premultipliedAlpha:i,antialias:n,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:t.powerPreference??"default"})}}ensureCanvasSize(e){if(!this.multiView)return void(e!==this.canvas&&(0,m.R)("multiView is disabled, but targetCanvas is not the main canvas"));const{canvas:t}=this;(t.width<e.width||t.height<e.height)&&(t.width=Math.max(e.width,e.width),t.height=Math.max(e.height,e.height))}initFromContext(e){this.gl=e,this.webGLVersion=e instanceof w.e.get().getWebGLRenderingContext()?1:2,this.getExtensions(),this.validateContext(e),this._renderer.runners.contextChange.emit(e);const t=this._renderer.view.canvas;t.addEventListener("webglcontextlost",this.handleContextLost,!1),t.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}createContext(e,t){let i;const n=this.canvas;if(2===e&&(i=n.getContext("webgl2",t)),!i&&(i=n.getContext("webgl",t),!i))throw new Error("This browser does not support WebGL. Try using the canvas renderer");this.gl=i,this.initFromContext(this.gl)}getExtensions(){const{gl:e}=this,t={anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc"),bptc:e.getExtension("EXT_texture_compression_bptc"),rgtc:e.getExtension("EXT_texture_compression_rgtc"),loseContext:e.getExtension("WEBGL_lose_context")};if(1===this.webGLVersion)this.extensions={...t,drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear"),vertexAttribDivisorANGLE:e.getExtension("ANGLE_instanced_arrays"),srgb:e.getExtension("EXT_sRGB")};else{this.extensions={...t,colorBufferFloat:e.getExtension("EXT_color_buffer_float")};const i=e.getExtension("WEBGL_provoking_vertex");i&&i.provokingVertexWEBGL(i.FIRST_VERTEX_CONVENTION_WEBGL)}}handleContextLost(e){e.preventDefault(),this._contextLossForced&&(this._contextLossForced=!1,setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext?.restoreContext()},0))}handleContextRestored(){this.getExtensions(),this._renderer.runners.contextChange.emit(this.gl)}destroy(){const e=this._renderer.view.canvas;this._renderer=null,e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext?.loseContext()}forceContextLoss(){this.extensions.loseContext?.loseContext(),this._contextLossForced=!0}validateContext(e){const t=e.getContextAttributes();t&&!t.stencil&&(0,m.R)("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const i=this.supports,n=2===this.webGLVersion,s=this.extensions;i.uint32Indices=n||!!s.uint32ElementIndex,i.uniformBufferObject=n,i.vertexArrayObject=n||!!s.vertexArrayObject,i.srgbTextures=n||!!s.srgb,i.nonPowOf2wrapping=n,i.nonPowOf2mipmaps=n,i.msaa=n,i.uint32Indices||(0,m.R)("Provided WebGL context does not support 32 index buffer, large scenes may not render correctly")}};P.extension={type:[n.Ag.WebGLSystem],name:"context"},P.defaultOptions={context:null,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:void 0,preferWebGLVersion:2,multiView:!1};let I=P;var M=i(8605),R=i(563),L=(e=>(e[e.RGBA=6408]="RGBA",e[e.RGB=6407]="RGB",e[e.RG=33319]="RG",e[e.RED=6403]="RED",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.ALPHA=6406]="ALPHA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e))(L||{}),k=(e=>(e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e))(k||{}),D=(e=>(e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.BYTE=5120]="BYTE",e[e.SHORT=5122]="SHORT",e[e.INT=5124]="INT",e[e.FLOAT=5126]="FLOAT",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.HALF_FLOAT=36193]="HALF_FLOAT",e))(D||{});const O={uint8x2:D.UNSIGNED_BYTE,uint8x4:D.UNSIGNED_BYTE,sint8x2:D.BYTE,sint8x4:D.BYTE,unorm8x2:D.UNSIGNED_BYTE,unorm8x4:D.UNSIGNED_BYTE,snorm8x2:D.BYTE,snorm8x4:D.BYTE,uint16x2:D.UNSIGNED_SHORT,uint16x4:D.UNSIGNED_SHORT,sint16x2:D.SHORT,sint16x4:D.SHORT,unorm16x2:D.UNSIGNED_SHORT,unorm16x4:D.UNSIGNED_SHORT,snorm16x2:D.SHORT,snorm16x4:D.SHORT,float16x2:D.HALF_FLOAT,float16x4:D.HALF_FLOAT,float32:D.FLOAT,float32x2:D.FLOAT,float32x3:D.FLOAT,float32x4:D.FLOAT,uint32:D.UNSIGNED_INT,uint32x2:D.UNSIGNED_INT,uint32x3:D.UNSIGNED_INT,uint32x4:D.UNSIGNED_INT,sint32:D.INT,sint32x2:D.INT,sint32x3:D.INT,sint32x4:D.INT};function B(e){return O[e]??O.float32}const G={"point-list":0,"line-list":1,"line-strip":3,"triangle-list":4,"triangle-strip":5};class F{constructor(e){this._geometryVaoHash=Object.create(null),this._renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this._renderer.renderableGC.addManagedHash(this,"_geometryVaoHash")}contextChange(){const e=this.gl=this._renderer.gl;if(!this._renderer.context.supports.vertexArrayObject)throw new Error("[PixiJS] Vertex Array Objects are not supported on this device");const t=this._renderer.context.extensions.vertexArrayObject;t&&(e.createVertexArray=()=>t.createVertexArrayOES(),e.bindVertexArray=e=>t.bindVertexArrayOES(e),e.deleteVertexArray=e=>t.deleteVertexArrayOES(e));const i=this._renderer.context.extensions.vertexAttribDivisorANGLE;i&&(e.drawArraysInstanced=(e,t,n,s)=>{i.drawArraysInstancedANGLE(e,t,n,s)},e.drawElementsInstanced=(e,t,n,s,r)=>{i.drawElementsInstancedANGLE(e,t,n,s,r)},e.vertexAttribDivisor=(e,t)=>i.vertexAttribDivisorANGLE(e,t)),this._activeGeometry=null,this._activeVao=null,this._geometryVaoHash=Object.create(null)}bind(e,t){const i=this.gl;this._activeGeometry=e;const n=this.getVao(e,t);this._activeVao!==n&&(this._activeVao=n,i.bindVertexArray(n)),this.updateBuffers()}resetState(){this.unbind()}updateBuffers(){const e=this._activeGeometry,t=this._renderer.buffer;for(let i=0;i<e.buffers.length;i++){const n=e.buffers[i];t.updateBuffer(n)}}checkCompatibility(e,t){const i=e.attributes,n=t._attributeData;for(const e in n)if(!i[e])throw new Error(`shader and geometry incompatible, geometry missing the "${e}" attribute`)}getSignature(e,t){const i=e.attributes,n=t._attributeData,s=["g",e.uid];for(const e in i)n[e]&&s.push(e,n[e].location);return s.join("-")}getVao(e,t){return this._geometryVaoHash[e.uid]?.[t._key]||this.initGeometryVao(e,t)}initGeometryVao(e,t,i=!0){const n=this._renderer.gl,s=this._renderer.buffer;this._renderer.shader._getProgramData(t),this.checkCompatibility(e,t);const r=this.getSignature(e,t);this._geometryVaoHash[e.uid]||(this._geometryVaoHash[e.uid]=Object.create(null),e.on("destroy",this.onGeometryDestroy,this));const a=this._geometryVaoHash[e.uid];let o=a[r];if(o)return a[t._key]=o,o;(0,R.q)(e,t._attributeData);const l=e.buffers;o=n.createVertexArray(),n.bindVertexArray(o);for(let e=0;e<l.length;e++){const t=l[e];s.bind(t)}return this.activateVao(e,t),a[t._key]=o,a[r]=o,n.bindVertexArray(null),o}onGeometryDestroy(e,t){const i=this._geometryVaoHash[e.uid],n=this.gl;if(i){if(t)for(const e in i)this._activeVao!==i[e]&&this.unbind(),n.deleteVertexArray(i[e]);this._geometryVaoHash[e.uid]=null}}destroyAll(e=!1){const t=this.gl;for(const i in this._geometryVaoHash){if(e)for(const e in this._geometryVaoHash[i]){const n=this._geometryVaoHash[i];this._activeVao!==n&&this.unbind(),t.deleteVertexArray(n[e])}this._geometryVaoHash[i]=null}}activateVao(e,t){const i=this._renderer.gl,n=this._renderer.buffer,s=e.attributes;e.indexBuffer&&n.bind(e.indexBuffer);let r=null;for(const e in s){const a=s[e],o=a.buffer,l=n.getGlBuffer(o),h=t._attributeData[e];if(h){r!==l&&(n.bind(o),r=l);const e=h.location;i.enableVertexAttribArray(e);const t=(0,M.m)(a.format),s=B(a.format);if("int"===h.format?.substring(1,4)?i.vertexAttribIPointer(e,t.size,s,a.stride,a.offset):i.vertexAttribPointer(e,t.size,s,t.normalised,a.stride,a.offset),a.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");{const t=a.divisor??1;i.vertexAttribDivisor(e,t)}}}}}draw(e,t,i,n){const{gl:s}=this._renderer,r=this._activeGeometry,a=G[e||r.topology];if(n??(n=r.instanceCount),r.indexBuffer){const e=r.indexBuffer.data.BYTES_PER_ELEMENT,o=2===e?s.UNSIGNED_SHORT:s.UNSIGNED_INT;n>1?s.drawElementsInstanced(a,t||r.indexBuffer.data.length,o,(i||0)*e,n):s.drawElements(a,t||r.indexBuffer.data.length,o,(i||0)*e)}else n>1?s.drawArraysInstanced(a,i||0,t||r.getSize(),n):s.drawArrays(a,i||0,t||r.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this._renderer=null,this.gl=null,this._activeVao=null,this._activeGeometry=null,this._geometryVaoHash=null}}F.extension={type:[n.Ag.WebGLSystem],name:"geometry"};var U=i(5178),N=i(5884),z=i(3381);const H=new U.V({attributes:{aPosition:[-1,-1,3,-1,-1,3]}}),V=class e{constructor(e){this.useBackBuffer=!1,this._useBackBufferThisRender=!1,this._renderer=e}init(t={}){const{useBackBuffer:i,antialias:n}={...e.defaultOptions,...t};this.useBackBuffer=i,this._antialias=n,this._renderer.context.supports.msaa||((0,m.R)("antialiasing, is not supported on when using the back buffer"),this._antialias=!1),this._state=v.U.for2d();const s=new z.M({vertex:"\n                attribute vec2 aPosition;\n                out vec2 vUv;\n\n                void main() {\n                    gl_Position = vec4(aPosition, 0.0, 1.0);\n\n                    vUv = (aPosition + 1.0) / 2.0;\n\n                    // flip dem UVs\n                    vUv.y = 1.0 - vUv.y;\n                }",fragment:"\n                in vec2 vUv;\n                out vec4 finalColor;\n\n                uniform sampler2D uTexture;\n\n                void main() {\n                    finalColor = texture(uTexture, vUv);\n                }",name:"big-triangle"});this._bigTriangleShader=new c.M({glProgram:s,resources:{uTexture:g.g.WHITE.source}})}renderStart(e){const t=this._renderer.renderTarget.getRenderTarget(e.target);if(this._useBackBufferThisRender=this.useBackBuffer&&!!t.isRoot,this._useBackBufferThisRender){const t=this._renderer.renderTarget.getRenderTarget(e.target);this._targetTexture=t.colorTexture,e.target=this._getBackBufferTexture(t.colorTexture)}}renderEnd(){this._presentBackBuffer()}_presentBackBuffer(){const e=this._renderer;e.renderTarget.finishRenderPass(),this._useBackBufferThisRender&&(e.renderTarget.bind(this._targetTexture,!1),this._bigTriangleShader.resources.uTexture=this._backBufferTexture.source,e.encoder.draw({geometry:H,shader:this._bigTriangleShader,state:this._state}))}_getBackBufferTexture(e){return this._backBufferTexture=this._backBufferTexture||new g.g({source:new N.v({width:e.width,height:e.height,resolution:e._resolution,antialias:this._antialias})}),this._backBufferTexture.source.resize(e.width,e.height,e._resolution),this._backBufferTexture}destroy(){this._backBufferTexture&&(this._backBufferTexture.destroy(),this._backBufferTexture=null)}};V.extension={type:[n.Ag.WebGLSystem],name:"backBuffer",priority:1},V.defaultOptions={useBackBuffer:!1};let W=V;class j{constructor(e){this._colorMaskCache=15,this._renderer=e}setMask(e){this._colorMaskCache!==e&&(this._colorMaskCache=e,this._renderer.gl.colorMask(!!(8&e),!!(4&e),!!(2&e),!!(1&e)))}}j.extension={type:[n.Ag.WebGLSystem],name:"colorMask"};class X{constructor(e){this.commandFinished=Promise.resolve(),this._renderer=e}setGeometry(e,t){this._renderer.geometry.bind(e,t.glProgram)}finishRenderPass(){}draw(e){const t=this._renderer,{geometry:i,shader:n,state:s,skipSync:r,topology:a,size:o,start:l,instanceCount:h}=e;t.shader.bind(n,r),t.geometry.bind(i,t.shader._activeProgram),s&&t.state.set(s),t.geometry.draw(a,o,l,h??i.instanceCount)}destroy(){this._renderer=null}}X.extension={type:[n.Ag.WebGLSystem],name:"encoder"};var Y=i(8117);class K{constructor(e){this._renderer=e}contextChange(){const e=this._renderer.gl;this.maxTextures=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),this.maxBatchableTextures=(0,Y.u)(this.maxTextures,e);const t=2===this._renderer.context.webGLVersion;this.maxUniformBindings=t?e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS):0}destroy(){}}K.extension={type:[n.Ag.WebGLSystem],name:"limits"};var q=i(3385),$=i(6954);class Q{constructor(e){this._stencilCache={enabled:!1,stencilReference:0,stencilMode:$.K.NONE},this._renderTargetStencilState=Object.create(null),e.renderTarget.onRenderTargetChange.add(this)}contextChange(e){this._gl=e,this._comparisonFuncMapping={always:e.ALWAYS,never:e.NEVER,equal:e.EQUAL,"not-equal":e.NOTEQUAL,less:e.LESS,"less-equal":e.LEQUAL,greater:e.GREATER,"greater-equal":e.GEQUAL},this._stencilOpsMapping={keep:e.KEEP,zero:e.ZERO,replace:e.REPLACE,invert:e.INVERT,"increment-clamp":e.INCR,"decrement-clamp":e.DECR,"increment-wrap":e.INCR_WRAP,"decrement-wrap":e.DECR_WRAP},this.resetState()}onRenderTargetChange(e){if(this._activeRenderTarget===e)return;this._activeRenderTarget=e;let t=this._renderTargetStencilState[e.uid];t||(t=this._renderTargetStencilState[e.uid]={stencilMode:$.K.DISABLED,stencilReference:0}),this.setStencilMode(t.stencilMode,t.stencilReference)}resetState(){this._stencilCache.enabled=!1,this._stencilCache.stencilMode=$.K.NONE,this._stencilCache.stencilReference=0}setStencilMode(e,t){const i=this._renderTargetStencilState[this._activeRenderTarget.uid],n=this._gl,s=q.g[e],r=this._stencilCache;i.stencilMode=e,i.stencilReference=t,e!==$.K.DISABLED?(this._stencilCache.enabled||(this._stencilCache.enabled=!0,n.enable(n.STENCIL_TEST)),e===r.stencilMode&&r.stencilReference===t||(r.stencilMode=e,r.stencilReference=t,n.stencilFunc(this._comparisonFuncMapping[s.stencilBack.compare],t,255),n.stencilOp(n.KEEP,n.KEEP,this._stencilOpsMapping[s.stencilBack.passOp]))):this._stencilCache.enabled&&(this._stencilCache.enabled=!1,n.disable(n.STENCIL_TEST))}}Q.extension={type:[n.Ag.WebGLSystem],name:"stencil"};var Z=i(7670);const J={f32:4,i32:4,"vec2<f32>":8,"vec3<f32>":12,"vec4<f32>":16,"vec2<i32>":8,"vec3<i32>":12,"vec4<i32>":16,"mat2x2<f32>":32,"mat3x3<f32>":48,"mat4x4<f32>":64};function ee(e){const t=e.map(e=>({data:e,offset:0,size:0}));let i=0,n=0;for(let e=0;e<t.length;e++){const s=t[e];if(i=J[s.data.type],!i)throw new Error(`Unknown type ${s.data.type}`);s.data.size>1&&(i=Math.max(i,16)*s.data.size);const r=12===i?16:i;s.size=i;const a=n%16;n+=a>0&&16-a<r?(16-a)%16:(i-a%i)%i,s.offset=n,n+=i}return n=16*Math.ceil(n/16),{uboElements:t,size:n}}var te=i(3386),ie=i(1017);function ne(e,t){const i=Math.max(J[e.data.type]/16,1),n=e.data.value.length/e.data.size,s=(4-n%4)%4,r=e.data.type.indexOf("i32")>=0?"dataInt32":"data";return`\n        v = uv.${e.data.name};\n        offset += ${t};\n\n        arrayOffset = offset;\n\n        t = 0;\n\n        for(var i=0; i < ${e.data.size*i}; i++)\n        {\n            for(var j = 0; j < ${n}; j++)\n            {\n                ${r}[arrayOffset++] = v[t++];\n            }\n            ${0!==s?`arrayOffset += ${s};`:""}\n        }\n    `}function se(e){return(0,te.E)(e,"uboStd40",ne,ie.g)}class re extends Z.W{constructor(){super({createUboElements:ee,generateUboSync:se})}}re.extension={type:[n.Ag.WebGLSystem],name:"ubo"};var ae=i(6399),oe=i(2207),le=i(7797),he=i(2874);class ue{constructor(){this.width=-1,this.height=-1,this.msaa=!1,this.msaaRenderBuffer=[]}}class ce{constructor(){this._clearColorCache=[0,0,0,0],this._viewPortCache=new oe.M}init(e,t){this._renderer=e,this._renderTargetSystem=t,e.runners.contextChange.add(this)}contextChange(){this._clearColorCache=[0,0,0,0],this._viewPortCache=new oe.M}copyToTexture(e,t,i,n,s){const r=this._renderTargetSystem,a=this._renderer,o=r.getGpuRenderTarget(e),l=a.gl;return this.finishRenderPass(e),l.bindFramebuffer(l.FRAMEBUFFER,o.resolveTargetFramebuffer),a.texture.bind(t,0),l.copyTexSubImage2D(l.TEXTURE_2D,0,s.x,s.y,i.x,i.y,n.width,n.height),t}startRenderPass(e,t=!0,i,n){const s=this._renderTargetSystem,r=e.colorTexture,a=s.getGpuRenderTarget(e);let o=n.y;e.isRoot&&(o=r.pixelHeight-n.height),e.colorTextures.forEach(e=>{this._renderer.texture.unbind(e)});const l=this._renderer.gl;l.bindFramebuffer(l.FRAMEBUFFER,a.framebuffer);const h=this._viewPortCache;h.x===n.x&&h.y===o&&h.width===n.width&&h.height===n.height||(h.x=n.x,h.y=o,h.width=n.width,h.height=n.height,l.viewport(n.x,o,n.width,n.height)),a.depthStencilRenderBuffer||!e.stencil&&!e.depth||this._initStencil(a),this.clear(e,t,i)}finishRenderPass(e){const t=this._renderTargetSystem.getGpuRenderTarget(e);if(!t.msaa)return;const i=this._renderer.gl;i.bindFramebuffer(i.FRAMEBUFFER,t.resolveTargetFramebuffer),i.bindFramebuffer(i.READ_FRAMEBUFFER,t.framebuffer),i.blitFramebuffer(0,0,t.width,t.height,0,0,t.width,t.height,i.COLOR_BUFFER_BIT,i.NEAREST),i.bindFramebuffer(i.FRAMEBUFFER,t.framebuffer)}initGpuRenderTarget(e){const t=this._renderer.gl,i=new ue;return e.colorTexture instanceof le.q?(this._renderer.context.ensureCanvasSize(e.colorTexture.resource),i.framebuffer=null,i):(this._initColor(e,i),t.bindFramebuffer(t.FRAMEBUFFER,null),i)}destroyGpuRenderTarget(e){const t=this._renderer.gl;e.framebuffer&&(t.deleteFramebuffer(e.framebuffer),e.framebuffer=null),e.resolveTargetFramebuffer&&(t.deleteFramebuffer(e.resolveTargetFramebuffer),e.resolveTargetFramebuffer=null),e.depthStencilRenderBuffer&&(t.deleteRenderbuffer(e.depthStencilRenderBuffer),e.depthStencilRenderBuffer=null),e.msaaRenderBuffer.forEach(e=>{t.deleteRenderbuffer(e)}),e.msaaRenderBuffer=null}clear(e,t,i){if(!t)return;const n=this._renderTargetSystem;"boolean"==typeof t&&(t=t?he.u.ALL:he.u.NONE);const s=this._renderer.gl;if(t&he.u.COLOR){i??(i=n.defaultClearColor);const e=this._clearColorCache,t=i;e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]||(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],s.clearColor(t[0],t[1],t[2],t[3]))}s.clear(t)}resizeGpuRenderTarget(e){if(e.isRoot)return;const t=this._renderTargetSystem.getGpuRenderTarget(e);this._resizeColor(e,t),(e.stencil||e.depth)&&this._resizeStencil(t)}_initColor(e,t){const i=this._renderer,n=i.gl,s=n.createFramebuffer();if(t.resolveTargetFramebuffer=s,n.bindFramebuffer(n.FRAMEBUFFER,s),t.width=e.colorTexture.source.pixelWidth,t.height=e.colorTexture.source.pixelHeight,e.colorTextures.forEach((e,s)=>{const r=e.source;r.antialias&&(i.context.supports.msaa?t.msaa=!0:(0,m.R)("[RenderTexture] Antialiasing on textures is not supported in WebGL1")),i.texture.bindSource(r,0);const a=i.texture.getGlSource(r).texture;n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+s,3553,a,0)}),t.msaa){const i=n.createFramebuffer();t.framebuffer=i,n.bindFramebuffer(n.FRAMEBUFFER,i),e.colorTextures.forEach((e,i)=>{const s=n.createRenderbuffer();t.msaaRenderBuffer[i]=s})}else t.framebuffer=s;this._resizeColor(e,t)}_resizeColor(e,t){const i=e.colorTexture.source;if(t.width=i.pixelWidth,t.height=i.pixelHeight,e.colorTextures.forEach((e,t)=>{0!==t&&e.source.resize(i.width,i.height,i._resolution)}),t.msaa){const i=this._renderer,n=i.gl,s=t.framebuffer;n.bindFramebuffer(n.FRAMEBUFFER,s),e.colorTextures.forEach((e,s)=>{const r=e.source;i.texture.bindSource(r,0);const a=i.texture.getGlSource(r).internalFormat,o=t.msaaRenderBuffer[s];n.bindRenderbuffer(n.RENDERBUFFER,o),n.renderbufferStorageMultisample(n.RENDERBUFFER,4,a,r.pixelWidth,r.pixelHeight),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+s,n.RENDERBUFFER,o)})}}_initStencil(e){if(null===e.framebuffer)return;const t=this._renderer.gl,i=t.createRenderbuffer();e.depthStencilRenderBuffer=i,t.bindRenderbuffer(t.RENDERBUFFER,i),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,i),this._resizeStencil(e)}_resizeStencil(e){const t=this._renderer.gl;t.bindRenderbuffer(t.RENDERBUFFER,e.depthStencilRenderBuffer),e.msaa?t.renderbufferStorageMultisample(t.RENDERBUFFER,4,t.DEPTH24_STENCIL8,e.width,e.height):t.renderbufferStorage(t.RENDERBUFFER,2===this._renderer.context.webGLVersion?t.DEPTH24_STENCIL8:t.DEPTH_STENCIL,e.width,e.height)}prerender(e){const t=e.colorTexture.resource;this._renderer.context.multiView&&le.q.test(t)&&this._renderer.context.ensureCanvasSize(t)}postrender(e){if(this._renderer.context.multiView&&le.q.test(e.colorTexture.resource)){const t=this._renderer.context.canvas,i=e.colorTexture;i.context2D.drawImage(t,0,i.pixelHeight-t.height)}}}class de extends ae.l{constructor(e){super(e),this.adaptor=new ce,this.adaptor.init(e,this)}}de.extension={type:[n.Ag.WebGLSystem],name:"renderTarget"};var pe=i(3642);class fe{constructor(e,t){this.program=e,this.uniformData=t,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBlockBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBlockBindings=null,this.program=null}}function ge(e,t,i){const n=e.createShader(t);return e.shaderSource(n,i),e.compileShader(n),n}function me(e){const t=new Array(e);for(let e=0;e<t.length;e++)t[e]=!1;return t}function _e(e,t){switch(e){case"float":case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return me(2*t);case"bvec3":return me(3*t);case"bvec4":return me(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}let ve=null;const ye={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"},be={float:"float32",vec2:"float32x2",vec3:"float32x3",vec4:"float32x4",int:"sint32",ivec2:"sint32x2",ivec3:"sint32x3",ivec4:"sint32x4",uint:"uint32",uvec2:"uint32x2",uvec3:"uint32x3",uvec4:"uint32x4",bool:"uint32",bvec2:"uint32x2",bvec3:"uint32x3",bvec4:"uint32x4"};function xe(e,t){if(!ve){const t=Object.keys(ye);ve={};for(let i=0;i<t.length;++i){const n=t[i];ve[e[n]]=ye[n]}}return ve[t]}function Te(e,t){const i=xe(e,t);return be[i]||"float32"}function Se(e,t){const i=e.getShaderSource(t).split("\n").map((e,t)=>`${t}: ${e}`),n=e.getShaderInfoLog(t),s=n.split("\n"),r={},a=s.map(e=>parseFloat(e.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(e=>!(!e||r[e])&&(r[e]=!0,!0)),o=[""];a.forEach(e=>{i[e-1]=`%c${i[e-1]}%c`,o.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const l=i.join("\n");o[0]=l,console.error(n),console.groupCollapsed("click to view full shader code"),console.warn(...o),console.groupEnd()}function Ae(e,t){const i=ge(e,e.VERTEX_SHADER,t.vertex),n=ge(e,e.FRAGMENT_SHADER,t.fragment),s=e.createProgram();e.attachShader(s,i),e.attachShader(s,n);const r=t.transformFeedbackVaryings;r&&("function"!=typeof e.transformFeedbackVaryings?(0,m.R)("TransformFeedback is not supported but TransformFeedbackVaryings are given."):e.transformFeedbackVaryings(s,r.names,"separate"===r.bufferMode?e.SEPARATE_ATTRIBS:e.INTERLEAVED_ATTRIBS)),e.linkProgram(s),e.getProgramParameter(s,e.LINK_STATUS)||function(e,t,i,n){e.getProgramParameter(t,e.LINK_STATUS)||(e.getShaderParameter(i,e.COMPILE_STATUS)||Se(e,i),e.getShaderParameter(n,e.COMPILE_STATUS)||Se(e,n),console.error("PixiJS Error: Could not initialize shader."),""!==e.getProgramInfoLog(t)&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",e.getProgramInfoLog(t)))}(e,s,i,n),t._attributeData=function(e,t,i=!1){const n={},s=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let i=0;i<s;i++){const s=t.getActiveAttrib(e,i);if(s.name.startsWith("gl_"))continue;const r=Te(t,s.type);n[s.name]={location:0,format:r,stride:(0,M.m)(r).stride,offset:0,instance:!1,start:0}}const r=Object.keys(n);if(i){r.sort((e,t)=>e>t?1:-1);for(let i=0;i<r.length;i++)n[r[i]].location=i,t.bindAttribLocation(e,i,r[i]);t.linkProgram(e)}else for(let i=0;i<r.length;i++)n[r[i]].location=t.getAttribLocation(e,r[i]);return n}(s,e,!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertex)),t._uniformData=function(e,t){const i={},n=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let s=0;s<n;s++){const n=t.getActiveUniform(e,s),r=n.name.replace(/\[.*?\]$/,""),a=!!n.name.match(/\[.*?\]$/),o=xe(t,n.type);i[r]={name:r,index:s,type:o,size:n.size,isArray:a,value:_e(o,n.size)}}return i}(s,e),t._uniformBlockData=function(e,t){if(!t.ACTIVE_UNIFORM_BLOCKS)return{};const i={},n=t.getProgramParameter(e,t.ACTIVE_UNIFORM_BLOCKS);for(let s=0;s<n;s++){const n=t.getActiveUniformBlockName(e,s),r=t.getUniformBlockIndex(e,n),a=t.getActiveUniformBlockParameter(e,s,t.UNIFORM_BLOCK_DATA_SIZE);i[n]={name:n,index:r,size:a}}return i}(s,e),e.deleteShader(i),e.deleteShader(n);const a={};for(const i in t._uniformData){const n=t._uniformData[i];a[i]={location:e.getUniformLocation(s,i),value:_e(n.type,n.size)}}return new fe(s,a)}const Ee={textureCount:0,blockIndex:0};class Ce{constructor(e){this._activeProgram=null,this._programDataHash=Object.create(null),this._shaderSyncFunctions=Object.create(null),this._renderer=e,this._renderer.renderableGC.addManagedHash(this,"_programDataHash")}contextChange(e){this._gl=e,this._programDataHash=Object.create(null),this._shaderSyncFunctions=Object.create(null),this._activeProgram=null}bind(e,t){if(this._setProgram(e.glProgram),t)return;Ee.textureCount=0,Ee.blockIndex=0;let i=this._shaderSyncFunctions[e.glProgram._key];i||(i=this._shaderSyncFunctions[e.glProgram._key]=this._generateShaderSync(e,this)),this._renderer.buffer.nextBindBase(!!e.glProgram.transformFeedbackVaryings),i(this._renderer,e,Ee)}updateUniformGroup(e){this._renderer.uniformGroup.updateUniformGroup(e,this._activeProgram,Ee)}bindUniformBlock(e,t,i=0){const n=this._renderer.buffer,s=this._getProgramData(this._activeProgram),r=e._bufferResource;r||this._renderer.ubo.updateUniformGroup(e);const a=e.buffer,o=n.updateBuffer(a),l=n.freeLocationForBufferBase(o);if(r){const{offset:t,size:i}=e;0===t&&i===a.data.byteLength?n.bindBufferBase(o,l):n.bindBufferRange(o,l,t)}else n.getLastBindBaseLocation(o)!==l&&n.bindBufferBase(o,l);const h=this._activeProgram._uniformBlockData[t].index;s.uniformBlockBindings[i]!==l&&(s.uniformBlockBindings[i]=l,this._renderer.gl.uniformBlockBinding(s.program,h,l))}_setProgram(e){if(this._activeProgram===e)return;this._activeProgram=e;const t=this._getProgramData(e);this._gl.useProgram(t.program)}_getProgramData(e){return this._programDataHash[e._key]||this._createProgramData(e)}_createProgramData(e){const t=e._key;return this._programDataHash[t]=Ae(this._gl,e),this._programDataHash[t]}destroy(){for(const e of Object.keys(this._programDataHash)){this._programDataHash[e].destroy(),this._programDataHash[e]=null}this._programDataHash=null,this._shaderSyncFunctions=null,this._activeProgram=null,this._renderer=null,this._gl=null}_generateShaderSync(e,t){return function(e,t){const i=[],n=["\n        var g = s.groups;\n        var sS = r.shader;\n        var p = s.glProgram;\n        var ugS = r.uniformGroup;\n        var resources;\n    "];let s=!1,r=0;const a=t._getProgramData(e.glProgram);for(const o in e.groups){const l=e.groups[o];i.push(`\n            resources = g[${o}].resources;\n        `);for(const h in l.resources){const u=l.resources[h];if(u instanceof d.k)if(u.ubo){const t=e._uniformBindMap[o][Number(h)];i.push(`\n                        sS.bindUniformBlock(\n                            resources[${h}],\n                            '${t}',\n                            ${e.glProgram._uniformBlockData[t].index}\n                        );\n                    `)}else i.push(`\n                        ugS.updateUniformGroup(resources[${h}], p, sD);\n                    `);else if(u instanceof pe.d){const t=e._uniformBindMap[o][Number(h)];i.push(`\n                    sS.bindUniformBlock(\n                        resources[${h}],\n                        '${t}',\n                        ${e.glProgram._uniformBlockData[t].index}\n                    );\n                `)}else if(u instanceof N.v){const l=e._uniformBindMap[o][h],u=a.uniformData[l];u&&(s||(s=!0,n.push("\n                        var tS = r.texture;\n                        ")),t._gl.uniform1i(u.location,r),i.push(`\n                        tS.bind(resources[${h}], ${r});\n                    `),r++)}}}const o=[...n,...i].join("\n");return new Function("r","s","sD",o)}(e,t)}resetState(){this._activeProgram=null}}Ce.extension={type:[n.Ag.WebGLSystem],name:"shader"};var we=i(577);const Pe={f32:"if (cv !== v) {\n            cu.value = v;\n            gl.uniform1f(location, v);\n        }","vec2<f32>":"if (cv[0] !== v[0] || cv[1] !== v[1]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            gl.uniform2f(location, v[0], v[1]);\n        }","vec3<f32>":"if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            cv[2] = v[2];\n            gl.uniform3f(location, v[0], v[1], v[2]);\n        }","vec4<f32>":"if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            cv[2] = v[2];\n            cv[3] = v[3];\n            gl.uniform4f(location, v[0], v[1], v[2], v[3]);\n        }",i32:"if (cv !== v) {\n            cu.value = v;\n            gl.uniform1i(location, v);\n        }","vec2<i32>":"if (cv[0] !== v[0] || cv[1] !== v[1]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            gl.uniform2i(location, v[0], v[1]);\n        }","vec3<i32>":"if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            cv[2] = v[2];\n            gl.uniform3i(location, v[0], v[1], v[2]);\n        }","vec4<i32>":"if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            cv[2] = v[2];\n            cv[3] = v[3];\n            gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n        }",u32:"if (cv !== v) {\n            cu.value = v;\n            gl.uniform1ui(location, v);\n        }","vec2<u32>":"if (cv[0] !== v[0] || cv[1] !== v[1]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            gl.uniform2ui(location, v[0], v[1]);\n        }","vec3<u32>":"if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            cv[2] = v[2];\n            gl.uniform3ui(location, v[0], v[1], v[2]);\n        }","vec4<u32>":"if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            cv[2] = v[2];\n            cv[3] = v[3];\n            gl.uniform4ui(location, v[0], v[1], v[2], v[3]);\n        }",bool:"if (cv !== v) {\n            cu.value = v;\n            gl.uniform1i(location, v);\n        }","vec2<bool>":"if (cv[0] !== v[0] || cv[1] !== v[1]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            gl.uniform2i(location, v[0], v[1]);\n        }","vec3<bool>":"if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            cv[2] = v[2];\n            gl.uniform3i(location, v[0], v[1], v[2]);\n        }","vec4<bool>":"if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            cv[2] = v[2];\n            cv[3] = v[3];\n            gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n        }","mat2x2<f32>":"gl.uniformMatrix2fv(location, false, v);","mat3x3<f32>":"gl.uniformMatrix3fv(location, false, v);","mat4x4<f32>":"gl.uniformMatrix4fv(location, false, v);"},Ie={f32:"gl.uniform1fv(location, v);","vec2<f32>":"gl.uniform2fv(location, v);","vec3<f32>":"gl.uniform3fv(location, v);","vec4<f32>":"gl.uniform4fv(location, v);","mat2x2<f32>":"gl.uniformMatrix2fv(location, false, v);","mat3x3<f32>":"gl.uniformMatrix3fv(location, false, v);","mat4x4<f32>":"gl.uniformMatrix4fv(location, false, v);",i32:"gl.uniform1iv(location, v);","vec2<i32>":"gl.uniform2iv(location, v);","vec3<i32>":"gl.uniform3iv(location, v);","vec4<i32>":"gl.uniform4iv(location, v);",u32:"gl.uniform1iv(location, v);","vec2<u32>":"gl.uniform2iv(location, v);","vec3<u32>":"gl.uniform3iv(location, v);","vec4<u32>":"gl.uniform4iv(location, v);",bool:"gl.uniform1iv(location, v);","vec2<bool>":"gl.uniform2iv(location, v);","vec3<bool>":"gl.uniform3iv(location, v);","vec4<bool>":"gl.uniform4iv(location, v);"};class Me{constructor(e){this._cache={},this._uniformGroupSyncHash={},this._renderer=e,this.gl=null,this._cache={}}contextChange(e){this.gl=e}updateUniformGroup(e,t,i){const n=this._renderer.shader._getProgramData(t);if(!e.isStatic||e._dirtyId!==n.uniformDirtyGroups[e.uid]){n.uniformDirtyGroups[e.uid]=e._dirtyId;this._getUniformSyncFunction(e,t)(n.uniformData,e.uniforms,this._renderer,i)}}_getUniformSyncFunction(e,t){return this._uniformGroupSyncHash[e._signature]?.[t._key]||this._createUniformSyncFunction(e,t)}_createUniformSyncFunction(e,t){const i=this._uniformGroupSyncHash[e._signature]||(this._uniformGroupSyncHash[e._signature]={}),n=this._getSignature(e,t._uniformData,"u");return this._cache[n]||(this._cache[n]=this._generateUniformsSync(e,t._uniformData)),i[t._key]=this._cache[n],i[t._key]}_generateUniformsSync(e,t){return function(e,t){const i=["\n        var v = null;\n        var cv = null;\n        var cu = null;\n        var t = 0;\n        var gl = renderer.gl;\n        var name = null;\n    "];for(const n in e.uniforms){if(!t[n]){e.uniforms[n]instanceof d.k?e.uniforms[n].ubo?i.push(`\n                        renderer.shader.bindUniformBlock(uv.${n}, "${n}");\n                    `):i.push(`\n                        renderer.shader.updateUniformGroup(uv.${n});\n                    `):e.uniforms[n]instanceof pe.d&&i.push(`\n                        renderer.shader.bindBufferResource(uv.${n}, "${n}");\n                    `);continue}const s=e.uniformStructures[n];let r=!1;for(let e=0;e<we.$.length;e++){const t=we.$[e];if(s.type===t.type&&t.test(s)){i.push(`name = "${n}";`,we.$[e].uniform),r=!0;break}}if(!r){const e=(1===s.size?Pe:Ie)[s.type].replace("location",`ud["${n}"].location`);i.push(`\n            cu = ud["${n}"];\n            cv = cu.value;\n            v = uv["${n}"];\n            ${e};`)}}return new Function("ud","uv","renderer","syncData",i.join("\n"))}(e,t)}_getSignature(e,t,i){const n=e.uniforms,s=[`${i}-`];for(const e in n)s.push(e),t[e]&&s.push(t[e].type);return s.join("-")}destroy(){this._renderer=null,this._cache=null}}Me.extension={type:[n.Ag.WebGLSystem],name:"uniformGroup"};const Re=class e{constructor(e){this._invertFrontFace=!1,this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode="none",this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=v.U.for2d(),e.renderTarget.onRenderTargetChange.add(this)}onRenderTargetChange(e){this._invertFrontFace=!e.isRoot,this._cullFace?this.setFrontFace(this._frontFace):this._frontFaceDirty=!0}contextChange(e){this.gl=e,this.blendModesMap=function(e){const t={};if(t.normal=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t.add=[e.ONE,e.ONE],t.multiply=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t.screen=[e.ONE,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t.none=[0,0],t["normal-npm"]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t["add-npm"]=[e.SRC_ALPHA,e.ONE,e.ONE,e.ONE],t["screen-npm"]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t.erase=[e.ZERO,e.ONE_MINUS_SRC_ALPHA],e instanceof w.e.get().getWebGLRenderingContext()){const i=e.getExtension("EXT_blend_minmax");i&&(t.min=[e.ONE,e.ONE,e.ONE,e.ONE,i.MIN_EXT,i.MIN_EXT],t.max=[e.ONE,e.ONE,e.ONE,e.ONE,i.MAX_EXT,i.MAX_EXT])}else t.min=[e.ONE,e.ONE,e.ONE,e.ONE,e.MIN,e.MIN],t.max=[e.ONE,e.ONE,e.ONE,e.ONE,e.MAX,e.MAX];return t}(e),this.resetState()}set(e){if(e||(e=this.defaultState),this.stateId!==e.data){let t=this.stateId^e.data,i=0;for(;t;)1&t&&this.map[i].call(this,!!(e.data&1<<i)),t>>=1,i++;this.stateId=e.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,e)}forceState(e){e||(e=this.defaultState);for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,e);this.stateId=e.data}setBlend(t){this._updateCheck(e._checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)}setOffset(t){this._updateCheck(e._checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this._cullFace=e,this.gl[e?"enable":"disable"](this.gl.CULL_FACE),this._cullFace&&this._frontFaceDirty&&this.setFrontFace(this._frontFace)}setFrontFace(e){this._frontFace=e,this._frontFaceDirty=!1;const t=this._invertFrontFace?!e:e;this._glFrontFace!==t&&(this._glFrontFace=t,this.gl.frontFace(this.gl[t?"CW":"CCW"]))}setBlendMode(e){if(this.blendModesMap[e]||(e="normal"),e===this.blendMode)return;this.blendMode=e;const t=this.blendModesMap[e],i=this.gl;2===t.length?i.blendFunc(t[0],t[1]):i.blendFuncSeparate(t[0],t[1],t[2],t[3]),6===t.length?(this._blendEq=!0,i.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD))}setPolygonOffset(e,t){this.gl.polygonOffset(e,t)}resetState(){this._glFrontFace=!1,this._frontFace=!1,this._cullFace=!1,this._frontFaceDirty=!1,this._invertFrontFace=!1,this.gl.frontFace(this.gl.CCW),this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode="",this.setBlendMode("normal")}_updateCheck(e,t){const i=this.checks.indexOf(e);t&&-1===i?this.checks.push(e):t||-1===i||this.checks.splice(i,1)}static _checkBlendMode(e,t){e.setBlendMode(t.blendMode)}static _checkPolygonOffset(e,t){e.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null,this.checks.length=0}};Re.extension={type:[n.Ag.WebGLSystem],name:"state"};let Le=Re;class ke{constructor(e){this.target=k.TEXTURE_2D,this.texture=e,this.width=-1,this.height=-1,this.type=D.UNSIGNED_BYTE,this.internalFormat=L.RGBA,this.format=L.RGBA,this.samplerType=0}}const De={id:"buffer",upload(e,t,i){t.width===e.width||t.height===e.height?i.texSubImage2D(i.TEXTURE_2D,0,0,0,e.width,e.height,t.format,t.type,e.resource):i.texImage2D(t.target,0,t.internalFormat,e.width,e.height,0,t.format,t.type,e.resource),t.width=e.width,t.height=e.height}},Oe={"bc1-rgba-unorm":!0,"bc1-rgba-unorm-srgb":!0,"bc2-rgba-unorm":!0,"bc2-rgba-unorm-srgb":!0,"bc3-rgba-unorm":!0,"bc3-rgba-unorm-srgb":!0,"bc4-r-unorm":!0,"bc4-r-snorm":!0,"bc5-rg-unorm":!0,"bc5-rg-snorm":!0,"bc6h-rgb-ufloat":!0,"bc6h-rgb-float":!0,"bc7-rgba-unorm":!0,"bc7-rgba-unorm-srgb":!0,"etc2-rgb8unorm":!0,"etc2-rgb8unorm-srgb":!0,"etc2-rgb8a1unorm":!0,"etc2-rgb8a1unorm-srgb":!0,"etc2-rgba8unorm":!0,"etc2-rgba8unorm-srgb":!0,"eac-r11unorm":!0,"eac-r11snorm":!0,"eac-rg11unorm":!0,"eac-rg11snorm":!0,"astc-4x4-unorm":!0,"astc-4x4-unorm-srgb":!0,"astc-5x4-unorm":!0,"astc-5x4-unorm-srgb":!0,"astc-5x5-unorm":!0,"astc-5x5-unorm-srgb":!0,"astc-6x5-unorm":!0,"astc-6x5-unorm-srgb":!0,"astc-6x6-unorm":!0,"astc-6x6-unorm-srgb":!0,"astc-8x5-unorm":!0,"astc-8x5-unorm-srgb":!0,"astc-8x6-unorm":!0,"astc-8x6-unorm-srgb":!0,"astc-8x8-unorm":!0,"astc-8x8-unorm-srgb":!0,"astc-10x5-unorm":!0,"astc-10x5-unorm-srgb":!0,"astc-10x6-unorm":!0,"astc-10x6-unorm-srgb":!0,"astc-10x8-unorm":!0,"astc-10x8-unorm-srgb":!0,"astc-10x10-unorm":!0,"astc-10x10-unorm-srgb":!0,"astc-12x10-unorm":!0,"astc-12x10-unorm-srgb":!0,"astc-12x12-unorm":!0,"astc-12x12-unorm-srgb":!0},Be={id:"compressed",upload(e,t,i){i.pixelStorei(i.UNPACK_ALIGNMENT,4);let n=e.pixelWidth,s=e.pixelHeight;const r=!!Oe[e.format];for(let a=0;a<e.resource.length;a++){const o=e.resource[a];r?i.compressedTexImage2D(i.TEXTURE_2D,a,t.internalFormat,n,s,0,o):i.texImage2D(i.TEXTURE_2D,a,t.internalFormat,n,s,0,t.format,t.type,o),n=Math.max(n>>1,1),s=Math.max(s>>1,1)}}},Ge={id:"image",upload(e,t,i,n){const s=t.width,r=t.height,a=e.pixelWidth,o=e.pixelHeight,l=e.resourceWidth,h=e.resourceHeight;l<a||h<o?(s===a&&r===o||i.texImage2D(t.target,0,t.internalFormat,a,o,0,t.format,t.type,null),2===n?i.texSubImage2D(i.TEXTURE_2D,0,0,0,l,h,t.format,t.type,e.resource):i.texSubImage2D(i.TEXTURE_2D,0,0,0,t.format,t.type,e.resource)):s===a&&r===o?i.texSubImage2D(i.TEXTURE_2D,0,0,0,t.format,t.type,e.resource):2===n?i.texImage2D(t.target,0,t.internalFormat,a,o,0,t.format,t.type,e.resource):i.texImage2D(t.target,0,t.internalFormat,t.format,t.type,e.resource),t.width=a,t.height=o}},Fe={id:"video",upload(e,t,i,n){e.isValid?Ge.upload(e,t,i,n):i.texImage2D(t.target,0,t.internalFormat,1,1,0,t.format,t.type,null)}},Ue={linear:9729,nearest:9728},Ne={linear:{linear:9987,nearest:9985},nearest:{linear:9986,nearest:9984}},ze={"clamp-to-edge":33071,repeat:10497,"mirror-repeat":33648},He={never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519};function Ve(e,t,i,n,s,r,a,o){const l=r;if(!o||"repeat"!==e.addressModeU||"repeat"!==e.addressModeV||"repeat"!==e.addressModeW){const i=ze[a?"clamp-to-edge":e.addressModeU],n=ze[a?"clamp-to-edge":e.addressModeV],r=ze[a?"clamp-to-edge":e.addressModeW];t[s](l,t.TEXTURE_WRAP_S,i),t[s](l,t.TEXTURE_WRAP_T,n),t.TEXTURE_WRAP_R&&t[s](l,t.TEXTURE_WRAP_R,r)}if(o&&"linear"===e.magFilter||t[s](l,t.TEXTURE_MAG_FILTER,Ue[e.magFilter]),i){if(!o||"linear"!==e.mipmapFilter){const i=Ne[e.minFilter][e.mipmapFilter];t[s](l,t.TEXTURE_MIN_FILTER,i)}}else t[s](l,t.TEXTURE_MIN_FILTER,Ue[e.minFilter]);if(n&&e.maxAnisotropy>1){const i=Math.min(e.maxAnisotropy,t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT));t[s](l,n.TEXTURE_MAX_ANISOTROPY_EXT,i)}e.compare&&t[s](l,t.TEXTURE_COMPARE_FUNC,He[e.compare])}class We{constructor(e){this.managedTextures=[],this._glTextures=Object.create(null),this._glSamplers=Object.create(null),this._boundTextures=[],this._activeTextureLocation=-1,this._boundSamplers=Object.create(null),this._uploads={image:Ge,buffer:De,video:Fe,compressed:Be},this._premultiplyAlpha=!1,this._useSeparateSamplers=!1,this._renderer=e,this._renderer.renderableGC.addManagedHash(this,"_glTextures"),this._renderer.renderableGC.addManagedHash(this,"_glSamplers")}contextChange(e){this._gl=e,this._mapFormatToInternalFormat||(this._mapFormatToInternalFormat=function(e,t){let i={},n=e.RGBA;return e instanceof w.e.get().getWebGLRenderingContext()?t.srgb&&(i={"rgba8unorm-srgb":t.srgb.SRGB8_ALPHA8_EXT,"bgra8unorm-srgb":t.srgb.SRGB8_ALPHA8_EXT}):(i={"rgba8unorm-srgb":e.SRGB8_ALPHA8,"bgra8unorm-srgb":e.SRGB8_ALPHA8},n=e.RGBA8),{r8unorm:e.R8,r8snorm:e.R8_SNORM,r8uint:e.R8UI,r8sint:e.R8I,r16uint:e.R16UI,r16sint:e.R16I,r16float:e.R16F,rg8unorm:e.RG8,rg8snorm:e.RG8_SNORM,rg8uint:e.RG8UI,rg8sint:e.RG8I,r32uint:e.R32UI,r32sint:e.R32I,r32float:e.R32F,rg16uint:e.RG16UI,rg16sint:e.RG16I,rg16float:e.RG16F,rgba8unorm:e.RGBA,...i,rgba8snorm:e.RGBA8_SNORM,rgba8uint:e.RGBA8UI,rgba8sint:e.RGBA8I,bgra8unorm:n,rgb9e5ufloat:e.RGB9_E5,rgb10a2unorm:e.RGB10_A2,rg11b10ufloat:e.R11F_G11F_B10F,rg32uint:e.RG32UI,rg32sint:e.RG32I,rg32float:e.RG32F,rgba16uint:e.RGBA16UI,rgba16sint:e.RGBA16I,rgba16float:e.RGBA16F,rgba32uint:e.RGBA32UI,rgba32sint:e.RGBA32I,rgba32float:e.RGBA32F,stencil8:e.STENCIL_INDEX8,depth16unorm:e.DEPTH_COMPONENT16,depth24plus:e.DEPTH_COMPONENT24,"depth24plus-stencil8":e.DEPTH24_STENCIL8,depth32float:e.DEPTH_COMPONENT32F,"depth32float-stencil8":e.DEPTH32F_STENCIL8,...t.s3tc?{"bc1-rgba-unorm":t.s3tc.COMPRESSED_RGBA_S3TC_DXT1_EXT,"bc2-rgba-unorm":t.s3tc.COMPRESSED_RGBA_S3TC_DXT3_EXT,"bc3-rgba-unorm":t.s3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT}:{},...t.s3tc_sRGB?{"bc1-rgba-unorm-srgb":t.s3tc_sRGB.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,"bc2-rgba-unorm-srgb":t.s3tc_sRGB.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,"bc3-rgba-unorm-srgb":t.s3tc_sRGB.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}:{},...t.rgtc?{"bc4-r-unorm":t.rgtc.COMPRESSED_RED_RGTC1_EXT,"bc4-r-snorm":t.rgtc.COMPRESSED_SIGNED_RED_RGTC1_EXT,"bc5-rg-unorm":t.rgtc.COMPRESSED_RED_GREEN_RGTC2_EXT,"bc5-rg-snorm":t.rgtc.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}:{},...t.bptc?{"bc6h-rgb-float":t.bptc.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,"bc6h-rgb-ufloat":t.bptc.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,"bc7-rgba-unorm":t.bptc.COMPRESSED_RGBA_BPTC_UNORM_EXT,"bc7-rgba-unorm-srgb":t.bptc.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT}:{},...t.etc?{"etc2-rgb8unorm":t.etc.COMPRESSED_RGB8_ETC2,"etc2-rgb8unorm-srgb":t.etc.COMPRESSED_SRGB8_ETC2,"etc2-rgb8a1unorm":t.etc.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2,"etc2-rgb8a1unorm-srgb":t.etc.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2,"etc2-rgba8unorm":t.etc.COMPRESSED_RGBA8_ETC2_EAC,"etc2-rgba8unorm-srgb":t.etc.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC,"eac-r11unorm":t.etc.COMPRESSED_R11_EAC,"eac-rg11unorm":t.etc.COMPRESSED_SIGNED_RG11_EAC}:{},...t.astc?{"astc-4x4-unorm":t.astc.COMPRESSED_RGBA_ASTC_4x4_KHR,"astc-4x4-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR,"astc-5x4-unorm":t.astc.COMPRESSED_RGBA_ASTC_5x4_KHR,"astc-5x4-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR,"astc-5x5-unorm":t.astc.COMPRESSED_RGBA_ASTC_5x5_KHR,"astc-5x5-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR,"astc-6x5-unorm":t.astc.COMPRESSED_RGBA_ASTC_6x5_KHR,"astc-6x5-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR,"astc-6x6-unorm":t.astc.COMPRESSED_RGBA_ASTC_6x6_KHR,"astc-6x6-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR,"astc-8x5-unorm":t.astc.COMPRESSED_RGBA_ASTC_8x5_KHR,"astc-8x5-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR,"astc-8x6-unorm":t.astc.COMPRESSED_RGBA_ASTC_8x6_KHR,"astc-8x6-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR,"astc-8x8-unorm":t.astc.COMPRESSED_RGBA_ASTC_8x8_KHR,"astc-8x8-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR,"astc-10x5-unorm":t.astc.COMPRESSED_RGBA_ASTC_10x5_KHR,"astc-10x5-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR,"astc-10x6-unorm":t.astc.COMPRESSED_RGBA_ASTC_10x6_KHR,"astc-10x6-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR,"astc-10x8-unorm":t.astc.COMPRESSED_RGBA_ASTC_10x8_KHR,"astc-10x8-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR,"astc-10x10-unorm":t.astc.COMPRESSED_RGBA_ASTC_10x10_KHR,"astc-10x10-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR,"astc-12x10-unorm":t.astc.COMPRESSED_RGBA_ASTC_12x10_KHR,"astc-12x10-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR,"astc-12x12-unorm":t.astc.COMPRESSED_RGBA_ASTC_12x12_KHR,"astc-12x12-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR}:{}}}(e,this._renderer.context.extensions),this._mapFormatToType=function(e){return{r8unorm:e.UNSIGNED_BYTE,r8snorm:e.BYTE,r8uint:e.UNSIGNED_BYTE,r8sint:e.BYTE,r16uint:e.UNSIGNED_SHORT,r16sint:e.SHORT,r16float:e.HALF_FLOAT,rg8unorm:e.UNSIGNED_BYTE,rg8snorm:e.BYTE,rg8uint:e.UNSIGNED_BYTE,rg8sint:e.BYTE,r32uint:e.UNSIGNED_INT,r32sint:e.INT,r32float:e.FLOAT,rg16uint:e.UNSIGNED_SHORT,rg16sint:e.SHORT,rg16float:e.HALF_FLOAT,rgba8unorm:e.UNSIGNED_BYTE,"rgba8unorm-srgb":e.UNSIGNED_BYTE,rgba8snorm:e.BYTE,rgba8uint:e.UNSIGNED_BYTE,rgba8sint:e.BYTE,bgra8unorm:e.UNSIGNED_BYTE,"bgra8unorm-srgb":e.UNSIGNED_BYTE,rgb9e5ufloat:e.UNSIGNED_INT_5_9_9_9_REV,rgb10a2unorm:e.UNSIGNED_INT_2_10_10_10_REV,rg11b10ufloat:e.UNSIGNED_INT_10F_11F_11F_REV,rg32uint:e.UNSIGNED_INT,rg32sint:e.INT,rg32float:e.FLOAT,rgba16uint:e.UNSIGNED_SHORT,rgba16sint:e.SHORT,rgba16float:e.HALF_FLOAT,rgba32uint:e.UNSIGNED_INT,rgba32sint:e.INT,rgba32float:e.FLOAT,stencil8:e.UNSIGNED_BYTE,depth16unorm:e.UNSIGNED_SHORT,depth24plus:e.UNSIGNED_INT,"depth24plus-stencil8":e.UNSIGNED_INT_24_8,depth32float:e.FLOAT,"depth32float-stencil8":e.FLOAT_32_UNSIGNED_INT_24_8_REV}}(e),this._mapFormatToFormat=function(e){return{r8unorm:e.RED,r8snorm:e.RED,r8uint:e.RED,r8sint:e.RED,r16uint:e.RED,r16sint:e.RED,r16float:e.RED,rg8unorm:e.RG,rg8snorm:e.RG,rg8uint:e.RG,rg8sint:e.RG,r32uint:e.RED,r32sint:e.RED,r32float:e.RED,rg16uint:e.RG,rg16sint:e.RG,rg16float:e.RG,rgba8unorm:e.RGBA,"rgba8unorm-srgb":e.RGBA,rgba8snorm:e.RGBA,rgba8uint:e.RGBA,rgba8sint:e.RGBA,bgra8unorm:e.RGBA,"bgra8unorm-srgb":e.RGBA,rgb9e5ufloat:e.RGB,rgb10a2unorm:e.RGBA,rg11b10ufloat:e.RGB,rg32uint:e.RG,rg32sint:e.RG,rg32float:e.RG,rgba16uint:e.RGBA,rgba16sint:e.RGBA,rgba16float:e.RGBA,rgba32uint:e.RGBA,rgba32sint:e.RGBA,rgba32float:e.RGBA,stencil8:e.STENCIL_INDEX8,depth16unorm:e.DEPTH_COMPONENT,depth24plus:e.DEPTH_COMPONENT,"depth24plus-stencil8":e.DEPTH_STENCIL,depth32float:e.DEPTH_COMPONENT,"depth32float-stencil8":e.DEPTH_STENCIL}}(e)),this._glTextures=Object.create(null),this._glSamplers=Object.create(null),this._boundSamplers=Object.create(null),this._premultiplyAlpha=!1;for(let e=0;e<16;e++)this.bind(g.g.EMPTY,e)}initSource(e){this.bind(e)}bind(e,t=0){const i=e.source;e?(this.bindSource(i,t),this._useSeparateSamplers&&this._bindSampler(i.style,t)):(this.bindSource(null,t),this._useSeparateSamplers&&this._bindSampler(null,t))}bindSource(e,t=0){const i=this._gl;if(e._touched=this._renderer.textureGC.count,this._boundTextures[t]!==e){this._boundTextures[t]=e,this._activateLocation(t),e||(e=g.g.EMPTY.source);const n=this.getGlSource(e);i.bindTexture(n.target,n.texture)}}_bindSampler(e,t=0){const i=this._gl;if(!e)return this._boundSamplers[t]=null,void i.bindSampler(t,null);const n=this._getGlSampler(e);this._boundSamplers[t]!==n&&(this._boundSamplers[t]=n,i.bindSampler(t,n))}unbind(e){const t=e.source,i=this._boundTextures,n=this._gl;for(let e=0;e<i.length;e++)if(i[e]===t){this._activateLocation(e);const s=this.getGlSource(t);n.bindTexture(s.target,null),i[e]=null}}_activateLocation(e){this._activeTextureLocation!==e&&(this._activeTextureLocation=e,this._gl.activeTexture(this._gl.TEXTURE0+e))}_initSource(e){const t=this._gl,i=new ke(t.createTexture());if(i.type=this._mapFormatToType[e.format],i.internalFormat=this._mapFormatToInternalFormat[e.format],i.format=this._mapFormatToFormat[e.format],e.autoGenerateMipmaps&&(this._renderer.context.supports.nonPowOf2mipmaps||e.isPowerOfTwo)){const t=Math.max(e.width,e.height);e.mipLevelCount=Math.floor(Math.log2(t))+1}return this._glTextures[e.uid]=i,this.managedTextures.includes(e)||(e.on("update",this.onSourceUpdate,this),e.on("resize",this.onSourceUpdate,this),e.on("styleChange",this.onStyleChange,this),e.on("destroy",this.onSourceDestroy,this),e.on("unload",this.onSourceUnload,this),e.on("updateMipmaps",this.onUpdateMipmaps,this),this.managedTextures.push(e)),this.onSourceUpdate(e),this.updateStyle(e,!1),i}onStyleChange(e){this.updateStyle(e,!1)}updateStyle(e,t){const i=this._gl,n=this.getGlSource(e);i.bindTexture(i.TEXTURE_2D,n.texture),this._boundTextures[this._activeTextureLocation]=e,Ve(e.style,i,e.mipLevelCount>1,this._renderer.context.extensions.anisotropicFiltering,"texParameteri",i.TEXTURE_2D,!this._renderer.context.supports.nonPowOf2wrapping&&!e.isPowerOfTwo,t)}onSourceUnload(e){const t=this._glTextures[e.uid];t&&(this.unbind(e),this._glTextures[e.uid]=null,this._gl.deleteTexture(t.texture))}onSourceUpdate(e){const t=this._gl,i=this.getGlSource(e);t.bindTexture(t.TEXTURE_2D,i.texture),this._boundTextures[this._activeTextureLocation]=e;const n="premultiply-alpha-on-upload"===e.alphaMode;this._premultiplyAlpha!==n&&(this._premultiplyAlpha=n,t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n)),this._uploads[e.uploadMethodId]?this._uploads[e.uploadMethodId].upload(e,i,t,this._renderer.context.webGLVersion):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e.pixelWidth,e.pixelHeight,0,t.RGBA,t.UNSIGNED_BYTE,null),e.autoGenerateMipmaps&&e.mipLevelCount>1&&this.onUpdateMipmaps(e,!1)}onUpdateMipmaps(e,t=!0){t&&this.bindSource(e,0);const i=this.getGlSource(e);this._gl.generateMipmap(i.target)}onSourceDestroy(e){e.off("destroy",this.onSourceDestroy,this),e.off("update",this.onSourceUpdate,this),e.off("resize",this.onSourceUpdate,this),e.off("unload",this.onSourceUnload,this),e.off("styleChange",this.onStyleChange,this),e.off("updateMipmaps",this.onUpdateMipmaps,this),this.managedTextures.splice(this.managedTextures.indexOf(e),1),this.onSourceUnload(e)}_initSampler(e){const t=this._gl,i=this._gl.createSampler();return this._glSamplers[e._resourceId]=i,Ve(e,t,this._boundTextures[this._activeTextureLocation].mipLevelCount>1,this._renderer.context.extensions.anisotropicFiltering,"samplerParameteri",i,!1,!0),this._glSamplers[e._resourceId]}_getGlSampler(e){return this._glSamplers[e._resourceId]||this._initSampler(e)}getGlSource(e){return this._glTextures[e.uid]||this._initSource(e)}generateCanvas(e){const{pixels:t,width:i,height:n}=this.getPixels(e),s=w.e.get().createCanvas();s.width=i,s.height=n;const r=s.getContext("2d");if(r){const e=r.createImageData(i,n);e.data.set(t),r.putImageData(e,0,0)}return s}getPixels(e){const t=e.source.resolution,i=e.frame,n=Math.max(Math.round(i.width*t),1),s=Math.max(Math.round(i.height*t),1),r=new Uint8Array(4*n*s),a=this._renderer,o=a.renderTarget.getRenderTarget(e),l=a.renderTarget.getGpuRenderTarget(o),h=a.gl;return h.bindFramebuffer(h.FRAMEBUFFER,l.resolveTargetFramebuffer),h.readPixels(Math.round(i.x*t),Math.round(i.y*t),n,s,h.RGBA,h.UNSIGNED_BYTE,r),{pixels:new Uint8ClampedArray(r.buffer),width:n,height:s}}destroy(){this.managedTextures.slice().forEach(e=>this.onSourceDestroy(e)),this.managedTextures=null,this._glTextures=null,this._glSamplers=null,this._boundTextures=null,this._boundSamplers=null,this._mapFormatToInternalFormat=null,this._mapFormatToType=null,this._mapFormatToFormat=null,this._uploads=null,this._renderer=null}resetState(){this._activeTextureLocation=-1,this._boundTextures.fill(g.g.EMPTY.source),this._boundSamplers=Object.create(null);const e=this._gl;this._premultiplyAlpha=!1,e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this._premultiplyAlpha)}}We.extension={type:[n.Ag.WebGLSystem],name:"texture"};const je=[...x.i,re,W,I,K,C,We,de,F,Me,Ce,X,Le,Q,j],Xe=[...x.f],Ye=[y,_,p],Ke=[],qe=[],$e=[];n.XO.handleByNamedList(n.Ag.WebGLSystem,Ke),n.XO.handleByNamedList(n.Ag.WebGLPipes,qe),n.XO.handleByNamedList(n.Ag.WebGLPipesAdaptor,$e),n.XO.add(...je,...Xe,...Ye);class Qe extends b.k{constructor(){super({name:"webgl",type:T.W.WEBGL,systems:Ke,renderPipes:qe,renderPipeAdaptors:$e})}}},3642:(e,t,i)=>{"use strict";i.d(t,{d:()=>r});var n=i(2551),s=i(198);class r extends n.A{constructor({buffer:e,offset:t,size:i}){super(),this.uid=(0,s.L)("buffer"),this._resourceType="bufferResource",this._touched=0,this._resourceId=(0,s.L)("resource"),this._bufferResource=!0,this.destroyed=!1,this.buffer=e,this.offset=0|t,this.size=i,this.buffer.on("change",this.onBufferChange,this)}onBufferChange(){this._resourceId=(0,s.L)("resource"),this.emit("change",this)}destroy(e=!1){this.destroyed=!0,e&&this.buffer.destroy(),this.emit("change",this),this.buffer=null}}},3650:(e,t,i)=>{"use strict";i.d(t,{T:()=>n});class n{constructor(e){this.resources=Object.create(null),this._dirty=!0;let t=0;for(const i in e){const n=e[i];this.setResource(n,t++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const e=[];let t=0;for(const i in this.resources)e[t++]=this.resources[i]._resourceId;this._key=e.join("|")}setResource(e,t){const i=this.resources[t];e!==i&&(i&&e.off?.("change",this.onResourceChange,this),e.on?.("change",this.onResourceChange,this),this.resources[t]=e,this._dirty=!0)}getResource(e){return this.resources[e]}_touch(e){const t=this.resources;for(const i in t)t[i]._touched=e}destroy(){const e=this.resources;for(const t in e){const i=e[t];i?.off?.("change",this.onResourceChange,this)}this.resources=null}onResourceChange(e){if(this._dirty=!0,e.destroyed){const t=this.resources;for(const i in t)t[i]===e&&(t[i]=null)}else this._updateKey()}}},3705:(e,t,i)=>{"use strict";i.d(t,{WebGPURenderer:()=>Ee});var n=i(8602),s=i(6680),r=i(7414),a=i(6566),o=i(9140),l=i(2581),h=i(9922),u=i(358),c=i(9232),d=i(9037);class p{constructor(){this._maxTextures=0}contextChange(e){const t=new d.k({uTransformMatrix:{value:new s.u,type:"mat3x3<f32>"},uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uRound:{value:0,type:"f32"}});this._maxTextures=e.limits.maxBatchableTextures;const i=(0,a.v)({name:"graphics",bits:[o.F,(0,l._)(this._maxTextures),h._Q,u.b]});this.shader=new c.M({gpuProgram:i,resources:{localUniforms:t}})}execute(e,t){const i=t.context,n=i.customShader||this.shader,s=e.renderer,a=s.graphicsContext,{batcher:o,instructions:l}=a.getContextRenderData(i),h=s.encoder;h.setGeometry(o.geometry,n.gpuProgram);const u=s.globalUniforms.bindGroup;h.setBindGroup(0,u,n.gpuProgram);const c=s.renderPipes.uniformBatch.getUniformBindGroup(n.resources.localUniforms,!0);h.setBindGroup(2,c,n.gpuProgram);const d=l.instructions;let p=null;for(let t=0;t<l.instructionSize;t++){const i=d[t];if(i.topology!==p&&(p=i.topology,h.setPipelineFromGeometryProgramAndState(o.geometry,n.gpuProgram,e.state,i.topology)),n.groups[1]=i.bindGroup,!i.gpuBindGroup){const e=i.textures;i.bindGroup=(0,r.w)(e.textures,e.count,this._maxTextures),i.gpuBindGroup=s.bindGroup.getBindGroup(i.bindGroup,n.gpuProgram,1)}h.setBindGroup(1,i.bindGroup,n.gpuProgram),h.renderPassEncoder.drawIndexed(i.size,1,i.start)}}destroy(){this.shader.destroy(!0),this.shader=null}}p.extension={type:[n.Ag.WebGPUPipesAdaptor],name:"graphics"};var f=i(3296),g=i(8192),m=i(9731);class _{init(){const e=(0,a.v)({name:"mesh",bits:[h.Ls,f.R,u.b]});this._shader=new c.M({gpuProgram:e,resources:{uTexture:g.g.EMPTY._source,uSampler:g.g.EMPTY._source.style,textureUniforms:{uTextureMatrix:{type:"mat3x3<f32>",value:new s.u}}}})}execute(e,t){const i=e.renderer;let n=t._shader;if(n){if(!n.gpuProgram)return void(0,m.R)("Mesh shader has no gpuProgram",t.shader)}else n=this._shader,n.groups[2]=i.texture.getTextureBindGroup(t.texture);const s=n.gpuProgram;if(s.autoAssignGlobalUniforms&&(n.groups[0]=i.globalUniforms.bindGroup),s.autoAssignLocalUniforms){const t=e.localUniforms;n.groups[1]=i.renderPipes.uniformBatch.getUniformBindGroup(t,!0)}i.encoder.draw({geometry:t._geometry,shader:n,state:t.state})}destroy(){this._shader.destroy(!0),this._shader=null}}_.extension={type:[n.Ag.WebGPUPipesAdaptor],name:"mesh"};var v=i(4060);const y=v.U.for2d();class b{start(e,t,i){const n=e.renderer,s=n.encoder,r=i.gpuProgram;this._shader=i,this._geometry=t,s.setGeometry(t,r),y.blendMode="normal",n.pipeline.getPipeline(t,r,y);const a=n.globalUniforms.bindGroup;s.resetBindGroup(1),s.setBindGroup(0,a,r)}execute(e,t){const i=this._shader.gpuProgram,n=e.renderer,s=n.encoder;if(!t.bindGroup){const e=t.textures;t.bindGroup=(0,r.w)(e.textures,e.count,n.limits.maxBatchableTextures)}y.blendMode=t.blendMode;const a=n.bindGroup.getBindGroup(t.bindGroup,i,1),o=n.pipeline.getPipeline(this._geometry,i,y,t.topology);t.bindGroup._touch(n.textureGC.count),s.setPipeline(o),s.renderPassEncoder.setBindGroup(1,a),s.renderPassEncoder.drawIndexed(t.size,1,t.start)}}b.extension={type:[n.Ag.WebGPUPipesAdaptor],name:"batch"};var x=i(9745),T=i(6709),S=i(9998);class A{constructor(e){this._hash=Object.create(null),this._renderer=e,this._renderer.renderableGC.addManagedHash(this,"_hash")}contextChange(e){this._gpu=e}getBindGroup(e,t,i){e._updateKey();return this._hash[e._key]||this._createBindGroup(e,t,i)}_createBindGroup(e,t,i){const n=this._gpu.device,s=t.layout[i],r=[],a=this._renderer;for(const t in s){const i=e.resources[t]??e.resources[s[t]];let n;if("uniformGroup"===i._resourceType){const e=i;a.ubo.updateUniformGroup(e);const t=e.buffer;n={buffer:a.buffer.getGPUBuffer(t),offset:0,size:t.descriptor.size}}else if("buffer"===i._resourceType){const e=i;n={buffer:a.buffer.getGPUBuffer(e),offset:0,size:e.descriptor.size}}else if("bufferResource"===i._resourceType){const e=i;n={buffer:a.buffer.getGPUBuffer(e.buffer),offset:e.offset,size:e.size}}else if("textureSampler"===i._resourceType){const e=i;n=a.texture.getGpuSampler(e)}else if("textureSource"===i._resourceType){const e=i;n=a.texture.getGpuSource(e).createView({})}r.push({binding:s[t],resource:n})}const o=a.shader.getProgramData(t).bindGroups[i],l=n.createBindGroup({layout:o,entries:r});return this._hash[e._key]=l,l}destroy(){for(const e of Object.keys(this._hash))this._hash[e]=null;this._hash=null,this._renderer=null}}A.extension={type:[n.Ag.WebGPUSystem],name:"bindGroup"};var E=i(9803);class C{constructor(e){this._gpuBuffers=Object.create(null),this._managedBuffers=[],e.renderableGC.addManagedHash(this,"_gpuBuffers")}contextChange(e){this._gpu=e}getGPUBuffer(e){return this._gpuBuffers[e.uid]||this.createGPUBuffer(e)}updateBuffer(e){const t=this._gpuBuffers[e.uid]||this.createGPUBuffer(e),i=e.data;return e._updateID&&i&&(e._updateID=0,this._gpu.device.queue.writeBuffer(t,0,i.buffer,0,(e._updateSize||i.byteLength)+3&-4)),t}destroyAll(){for(const e in this._gpuBuffers)this._gpuBuffers[e].destroy();this._gpuBuffers={}}createGPUBuffer(e){this._gpuBuffers[e.uid]||(e.on("update",this.updateBuffer,this),e.on("change",this.onBufferChange,this),e.on("destroy",this.onBufferDestroy,this),this._managedBuffers.push(e));const t=this._gpu.device.createBuffer(e.descriptor);return e._updateID=0,e.data&&((0,E.W)(e.data.buffer,t.getMappedRange()),t.unmap()),this._gpuBuffers[e.uid]=t,t}onBufferChange(e){this._gpuBuffers[e.uid].destroy(),e._updateID=0,this._gpuBuffers[e.uid]=this.createGPUBuffer(e)}onBufferDestroy(e){this._managedBuffers.splice(this._managedBuffers.indexOf(e),1),this._destroyBuffer(e)}destroy(){this._managedBuffers.forEach(e=>this._destroyBuffer(e)),this._managedBuffers=null,this._gpuBuffers=null}_destroyBuffer(e){this._gpuBuffers[e.uid].destroy(),e.off("update",this.updateBuffer,this),e.off("change",this.onBufferChange,this),e.off("destroy",this.onBufferDestroy,this),this._gpuBuffers[e.uid]=null}}C.extension={type:[n.Ag.WebGPUSystem],name:"buffer"};class w{constructor(e){this._colorMaskCache=15,this._renderer=e}setMask(e){this._colorMaskCache!==e&&(this._colorMaskCache=e,this._renderer.pipeline.setColorMask(e))}destroy(){this._renderer=null,this._colorMaskCache=null}}w.extension={type:[n.Ag.WebGPUSystem],name:"colorMask"};var P=i(5553);class I{constructor(e){this._renderer=e}async init(e){return this._initPromise||(this._initPromise=(e.gpu?Promise.resolve(e.gpu):this._createDeviceAndAdaptor(e)).then(e=>{this.gpu=e,this._renderer.runners.contextChange.emit(this.gpu)})),this._initPromise}contextChange(e){this._renderer.gpu=e}async _createDeviceAndAdaptor(e){const t=await P.e.get().getNavigator().gpu.requestAdapter({powerPreference:e.powerPreference,forceFallbackAdapter:e.forceFallbackAdapter}),i=["texture-compression-bc","texture-compression-astc","texture-compression-etc2"].filter(e=>t.features.has(e)),n=await t.requestDevice({requiredFeatures:i});return{adapter:t,device:n}}destroy(){this.gpu=null,this._renderer=null}}I.extension={type:[n.Ag.WebGPUSystem],name:"device"},I.defaultOptions={powerPreference:void 0,forceFallbackAdapter:!1};class M{constructor(e){this._boundBindGroup=Object.create(null),this._boundVertexBuffer=Object.create(null),this._renderer=e}renderStart(){this.commandFinished=new Promise(e=>{this._resolveCommandFinished=e}),this.commandEncoder=this._renderer.gpu.device.createCommandEncoder()}beginRenderPass(e){this.endRenderPass(),this._clearCache(),this.renderPassEncoder=this.commandEncoder.beginRenderPass(e.descriptor)}endRenderPass(){this.renderPassEncoder&&this.renderPassEncoder.end(),this.renderPassEncoder=null}setViewport(e){this.renderPassEncoder.setViewport(e.x,e.y,e.width,e.height,0,1)}setPipelineFromGeometryProgramAndState(e,t,i,n){const s=this._renderer.pipeline.getPipeline(e,t,i,n);this.setPipeline(s)}setPipeline(e){this._boundPipeline!==e&&(this._boundPipeline=e,this.renderPassEncoder.setPipeline(e))}_setVertexBuffer(e,t){this._boundVertexBuffer[e]!==t&&(this._boundVertexBuffer[e]=t,this.renderPassEncoder.setVertexBuffer(e,this._renderer.buffer.updateBuffer(t)))}_setIndexBuffer(e){if(this._boundIndexBuffer===e)return;this._boundIndexBuffer=e;const t=2===e.data.BYTES_PER_ELEMENT?"uint16":"uint32";this.renderPassEncoder.setIndexBuffer(this._renderer.buffer.updateBuffer(e),t)}resetBindGroup(e){this._boundBindGroup[e]=null}setBindGroup(e,t,i){if(this._boundBindGroup[e]===t)return;this._boundBindGroup[e]=t,t._touch(this._renderer.textureGC.count);const n=this._renderer.bindGroup.getBindGroup(t,i,e);this.renderPassEncoder.setBindGroup(e,n)}setGeometry(e,t){const i=this._renderer.pipeline.getBufferNamesToBind(e,t);for(const t in i)this._setVertexBuffer(parseInt(t,10),e.attributes[i[t]].buffer);e.indexBuffer&&this._setIndexBuffer(e.indexBuffer)}_setShaderBindGroups(e,t){for(const i in e.groups){const n=e.groups[i];t||this._syncBindGroup(n),this.setBindGroup(i,n,e.gpuProgram)}}_syncBindGroup(e){for(const t in e.resources){const i=e.resources[t];i.isUniformGroup&&this._renderer.ubo.updateUniformGroup(i)}}draw(e){const{geometry:t,shader:i,state:n,topology:s,size:r,start:a,instanceCount:o,skipSync:l}=e;this.setPipelineFromGeometryProgramAndState(t,i.gpuProgram,n,s),this.setGeometry(t,i.gpuProgram),this._setShaderBindGroups(i,l),t.indexBuffer?this.renderPassEncoder.drawIndexed(r||t.indexBuffer.data.length,o??t.instanceCount,a||0):this.renderPassEncoder.draw(r||t.getSize(),o??t.instanceCount,a||0)}finishRenderPass(){this.renderPassEncoder&&(this.renderPassEncoder.end(),this.renderPassEncoder=null)}postrender(){this.finishRenderPass(),this._gpu.device.queue.submit([this.commandEncoder.finish()]),this._resolveCommandFinished(),this.commandEncoder=null}restoreRenderPass(){const e=this._renderer.renderTarget.adaptor.getDescriptor(this._renderer.renderTarget.renderTarget,!1,[0,0,0,1]);this.renderPassEncoder=this.commandEncoder.beginRenderPass(e);const t=this._boundPipeline,i={...this._boundVertexBuffer},n=this._boundIndexBuffer,s={...this._boundBindGroup};this._clearCache();const r=this._renderer.renderTarget.viewport;this.renderPassEncoder.setViewport(r.x,r.y,r.width,r.height,0,1),this.setPipeline(t);for(const e in i)this._setVertexBuffer(e,i[e]);for(const e in s)this.setBindGroup(e,s[e],null);this._setIndexBuffer(n)}_clearCache(){for(let e=0;e<16;e++)this._boundBindGroup[e]=null,this._boundVertexBuffer[e]=null;this._boundIndexBuffer=null,this._boundPipeline=null}destroy(){this._renderer=null,this._gpu=null,this._boundBindGroup=null,this._boundVertexBuffer=null,this._boundIndexBuffer=null,this._boundPipeline=null}contextChange(e){this._gpu=e}}M.extension={type:[n.Ag.WebGPUSystem],name:"encoder",priority:1};class R{constructor(e){this._renderer=e}contextChange(){this.maxTextures=this._renderer.device.gpu.device.limits.maxSampledTexturesPerShaderStage,this.maxBatchableTextures=this.maxTextures}destroy(){}}R.extension={type:[n.Ag.WebGPUSystem],name:"limits"};var L=i(6954);class k{constructor(e){this._renderTargetStencilState=Object.create(null),this._renderer=e,e.renderTarget.onRenderTargetChange.add(this)}onRenderTargetChange(e){let t=this._renderTargetStencilState[e.uid];t||(t=this._renderTargetStencilState[e.uid]={stencilMode:L.K.DISABLED,stencilReference:0}),this._activeRenderTarget=e,this.setStencilMode(t.stencilMode,t.stencilReference)}setStencilMode(e,t){const i=this._renderTargetStencilState[this._activeRenderTarget.uid];i.stencilMode=e,i.stencilReference=t;const n=this._renderer;n.pipeline.setStencilMode(e),n.encoder.renderPassEncoder.setStencilReference(t)}destroy(){this._renderer.renderTarget.onRenderTargetChange.remove(this),this._renderer=null,this._activeRenderTarget=null,this._renderTargetStencilState=null}}k.extension={type:[n.Ag.WebGPUSystem],name:"stencil"};var D=i(7670);const O={i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},f16:{align:2,size:2},"vec2<i32>":{align:8,size:8},"vec2<u32>":{align:8,size:8},"vec2<f32>":{align:8,size:8},"vec2<f16>":{align:4,size:4},"vec3<i32>":{align:16,size:12},"vec3<u32>":{align:16,size:12},"vec3<f32>":{align:16,size:12},"vec3<f16>":{align:8,size:6},"vec4<i32>":{align:16,size:16},"vec4<u32>":{align:16,size:16},"vec4<f32>":{align:16,size:16},"vec4<f16>":{align:8,size:8},"mat2x2<f32>":{align:8,size:16},"mat2x2<f16>":{align:4,size:8},"mat3x2<f32>":{align:8,size:24},"mat3x2<f16>":{align:4,size:12},"mat4x2<f32>":{align:8,size:32},"mat4x2<f16>":{align:4,size:16},"mat2x3<f32>":{align:16,size:32},"mat2x3<f16>":{align:8,size:16},"mat3x3<f32>":{align:16,size:48},"mat3x3<f16>":{align:8,size:24},"mat4x3<f32>":{align:16,size:64},"mat4x3<f16>":{align:8,size:32},"mat2x4<f32>":{align:16,size:32},"mat2x4<f16>":{align:8,size:16},"mat3x4<f32>":{align:16,size:48},"mat3x4<f16>":{align:8,size:24},"mat4x4<f32>":{align:16,size:64},"mat4x4<f16>":{align:8,size:32}};function B(e){const t=e.map(e=>({data:e,offset:0,size:0}));let i=0;for(let e=0;e<t.length;e++){const n=t[e];let s=O[n.data.type].size;const r=O[n.data.type].align;if(!O[n.data.type])throw new Error(`[Pixi.js] WebGPU UniformBuffer: Unknown type ${n.data.type}`);n.data.size>1&&(s=Math.max(s,r)*n.data.size),i=Math.ceil(i/r)*r,n.size=s,n.offset=i,i+=s}return i=16*Math.ceil(i/16),{uboElements:t,size:i}}var G=i(3386),F=i(1017);function U(e,t){const{size:i,align:n}=O[e.data.type],s=(n-i)/4,r=e.data.type.indexOf("i32")>=0?"dataInt32":"data";return`\n         v = uv.${e.data.name};\n         ${0!==t?`offset += ${t};`:""}\n\n         arrayOffset = offset;\n\n         t = 0;\n\n         for(var i=0; i < ${e.data.size*(i/4)}; i++)\n         {\n             for(var j = 0; j < ${i/4}; j++)\n             {\n                 ${r}[arrayOffset++] = v[t++];\n             }\n             ${0!==s?`arrayOffset += ${s};`:""}\n         }\n     `}function N(e){return(0,G.E)(e,"uboWgsl",U,F._)}class z extends D.W{constructor(){super({createUboElements:B,generateUboSync:N})}}z.extension={type:[n.Ag.WebGPUSystem],name:"ubo"};var H=i(5662),V=i(3642),W=i(2409);class j{constructor({minUniformOffsetAlignment:e}){this._minUniformOffsetAlignment=256,this.byteIndex=0,this._minUniformOffsetAlignment=e,this.data=new Float32Array(65535)}clear(){this.byteIndex=0}addEmptyGroup(e){if(e>this._minUniformOffsetAlignment/4)throw new Error("UniformBufferBatch: array is too large: "+4*e);const t=this.byteIndex;let i=t+4*e;if(i=Math.ceil(i/this._minUniformOffsetAlignment)*this._minUniformOffsetAlignment,i>4*this.data.length)throw new Error("UniformBufferBatch: ubo batch got too big");return this.byteIndex=i,t}addGroup(e){const t=this.addEmptyGroup(e.length);for(let i=0;i<e.length;i++)this.data[t/4+i]=e[i];return t}destroy(){this.data=null}}var X=i(3650);const Y=128;class K{constructor(e){this._bindGroupHash=Object.create(null),this._buffers=[],this._bindGroups=[],this._bufferResources=[],this._renderer=e,this._renderer.renderableGC.addManagedHash(this,"_bindGroupHash"),this._batchBuffer=new j({minUniformOffsetAlignment:Y});for(let e=0;e<2;e++){let t=W.S.UNIFORM|W.S.COPY_DST;0===e&&(t|=W.S.COPY_SRC),this._buffers.push(new H.h({data:this._batchBuffer.data,usage:t}))}}renderEnd(){this._uploadBindGroups(),this._resetBindGroups()}_resetBindGroups(){for(const e in this._bindGroupHash)this._bindGroupHash[e]=null;this._batchBuffer.clear()}getUniformBindGroup(e,t){if(!t&&this._bindGroupHash[e.uid])return this._bindGroupHash[e.uid];this._renderer.ubo.ensureUniformGroup(e);const i=e.buffer.data,n=this._batchBuffer.addEmptyGroup(i.length);return this._renderer.ubo.syncUniformGroup(e,this._batchBuffer.data,n/4),this._bindGroupHash[e.uid]=this._getBindGroup(n/Y),this._bindGroupHash[e.uid]}getUboResource(e){this._renderer.ubo.updateUniformGroup(e);const t=e.buffer.data,i=this._batchBuffer.addGroup(t);return this._getBufferResource(i/Y)}getArrayBindGroup(e){const t=this._batchBuffer.addGroup(e);return this._getBindGroup(t/Y)}getArrayBufferResource(e){const t=this._batchBuffer.addGroup(e)/Y;return this._getBufferResource(t)}_getBufferResource(e){if(!this._bufferResources[e]){const t=this._buffers[e%2];this._bufferResources[e]=new V.d({buffer:t,offset:256*(e/2|0),size:Y})}return this._bufferResources[e]}_getBindGroup(e){if(!this._bindGroups[e]){const t=new X.T({0:this._getBufferResource(e)});this._bindGroups[e]=t}return this._bindGroups[e]}_uploadBindGroups(){const e=this._renderer.buffer,t=this._buffers[0];t.update(this._batchBuffer.byteIndex),e.updateBuffer(t);const i=this._renderer.gpu.device.createCommandEncoder();for(let n=1;n<this._buffers.length;n++){const s=this._buffers[n];i.copyBufferToBuffer(e.getGPUBuffer(t),Y,e.getGPUBuffer(s),0,this._batchBuffer.byteIndex)}this._renderer.gpu.device.queue.submit([i.finish()])}destroy(){for(let e=0;e<this._bindGroups.length;e++)this._bindGroups[e]?.destroy();this._bindGroups=null,this._bindGroupHash=null;for(let e=0;e<this._buffers.length;e++)this._buffers[e].destroy();this._buffers=null;for(let e=0;e<this._bufferResources.length;e++)this._bufferResources[e].destroy();this._bufferResources=null,this._batchBuffer.destroy(),this._bindGroupHash=null,this._renderer=null}}K.extension={type:[n.Ag.WebGPUPipes],name:"uniformBatch"};var q=i(563),$=i(2349),Q=i(3385);const Z={"point-list":0,"line-list":1,"line-strip":2,"triangle-list":3,"triangle-strip":4};class J{constructor(e){this._moduleCache=Object.create(null),this._bufferLayoutsCache=Object.create(null),this._bindingNamesCache=Object.create(null),this._pipeCache=Object.create(null),this._pipeStateCaches=Object.create(null),this._colorMask=15,this._multisampleCount=1,this._renderer=e}contextChange(e){this._gpu=e,this.setStencilMode(L.K.DISABLED),this._updatePipeHash()}setMultisampleCount(e){this._multisampleCount!==e&&(this._multisampleCount=e,this._updatePipeHash())}setRenderTarget(e){this._multisampleCount=e.msaaSamples,this._depthStencilAttachment=e.descriptor.depthStencilAttachment?1:0,this._updatePipeHash()}setColorMask(e){this._colorMask!==e&&(this._colorMask=e,this._updatePipeHash())}setStencilMode(e){this._stencilMode!==e&&(this._stencilMode=e,this._stencilState=Q.g[e],this._updatePipeHash())}setPipeline(e,t,i,n){const s=this.getPipeline(e,t,i);n.setPipeline(s)}getPipeline(e,t,i,n){e._layoutKey||((0,q.q)(e,t.attributeData),this._generateBufferKey(e)),n||(n=e.topology);const s=function(e,t,i,n,s){return e<<24|t<<16|i<<10|n<<5|s}(e._layoutKey,t._layoutKey,i.data,i._blendModeId,Z[n]);return this._pipeCache[s]||(this._pipeCache[s]=this._createPipeline(e,t,i,n)),this._pipeCache[s]}_createPipeline(e,t,i,n){const s=this._gpu.device,r=this._createVertexBufferLayouts(e,t),a=this._renderer.state.getColorTargets(i);a[0].writeMask=this._stencilMode===L.K.RENDERING_MASK_ADD?0:this._colorMask;const o=this._renderer.shader.getProgramData(t).pipeline,l={vertex:{module:this._getModule(t.vertex.source),entryPoint:t.vertex.entryPoint,buffers:r},fragment:{module:this._getModule(t.fragment.source),entryPoint:t.fragment.entryPoint,targets:a},primitive:{topology:n,cullMode:i.cullMode},layout:o,multisample:{count:this._multisampleCount},label:"PIXI Pipeline"};this._depthStencilAttachment&&(l.depthStencil={...this._stencilState,format:"depth24plus-stencil8",depthWriteEnabled:i.depthTest,depthCompare:i.depthTest?"less":"always"});return s.createRenderPipeline(l)}_getModule(e){return this._moduleCache[e]||this._createModule(e)}_createModule(e){const t=this._gpu.device;return this._moduleCache[e]=t.createShaderModule({code:e}),this._moduleCache[e]}_generateBufferKey(e){const t=[];let i=0;const n=Object.keys(e.attributes).sort();for(let s=0;s<n.length;s++){const r=e.attributes[n[s]];t[i++]=r.offset,t[i++]=r.format,t[i++]=r.stride,t[i++]=r.instance}const s=t.join("|");return e._layoutKey=(0,$.X)(s,"geometry"),e._layoutKey}_generateAttributeLocationsKey(e){const t=[];let i=0;const n=Object.keys(e.attributeData).sort();for(let s=0;s<n.length;s++){const r=e.attributeData[n[s]];t[i++]=r.location}const s=t.join("|");return e._attributeLocationsKey=(0,$.X)(s,"programAttributes"),e._attributeLocationsKey}getBufferNamesToBind(e,t){const i=e._layoutKey<<16|t._attributeLocationsKey;if(this._bindingNamesCache[i])return this._bindingNamesCache[i];const n=this._createVertexBufferLayouts(e,t),s=Object.create(null),r=t.attributeData;for(let e=0;e<n.length;e++){const t=Object.values(n[e].attributes)[0].shaderLocation;for(const i in r)if(r[i].location===t){s[e]=i;break}}return this._bindingNamesCache[i]=s,s}_createVertexBufferLayouts(e,t){t._attributeLocationsKey||this._generateAttributeLocationsKey(t);const i=e._layoutKey<<16|t._attributeLocationsKey;if(this._bufferLayoutsCache[i])return this._bufferLayoutsCache[i];const n=[];return e.buffers.forEach(i=>{const s={arrayStride:0,stepMode:"vertex",attributes:[]},r=s.attributes;for(const n in t.attributeData){const a=e.attributes[n];1!==(a.divisor??1)&&(0,m.R)(`Attribute ${n} has an invalid divisor value of '${a.divisor}'. WebGPU only supports a divisor value of 1`),a.buffer===i&&(s.arrayStride=a.stride,s.stepMode=a.instance?"instance":"vertex",r.push({shaderLocation:t.attributeData[n].location,offset:a.offset,format:a.format}))}r.length&&n.push(s)}),this._bufferLayoutsCache[i]=n,n}_updatePipeHash(){const e=(t=this._stencilMode,i=this._multisampleCount,n=this._colorMask,s=this._depthStencilAttachment,n<<6|t<<3|s<<1|i);var t,i,n,s;this._pipeStateCaches[e]||(this._pipeStateCaches[e]=Object.create(null)),this._pipeCache=this._pipeStateCaches[e]}destroy(){this._renderer=null,this._bufferLayoutsCache=null}}J.extension={type:[n.Ag.WebGPUSystem],name:"pipeline"};var ee=i(6399),te=i(2874),ie=i(7797),ne=i(5884);class se{constructor(){this.contexts=[],this.msaaTextures=[],this.msaaSamples=1}}class re{init(e,t){this._renderer=e,this._renderTargetSystem=t}copyToTexture(e,t,i,n,s){const r=this._renderer,a=this._getGpuColorTexture(e),o=r.texture.getGpuSource(t.source);return r.encoder.commandEncoder.copyTextureToTexture({texture:a,origin:i},{texture:o,origin:s},n),t}startRenderPass(e,t=!0,i,n){const s=this._renderTargetSystem.getGpuRenderTarget(e),r=this.getDescriptor(e,t,i);s.descriptor=r,this._renderer.pipeline.setRenderTarget(s),this._renderer.encoder.beginRenderPass(s),this._renderer.encoder.setViewport(n)}finishRenderPass(){this._renderer.encoder.endRenderPass()}_getGpuColorTexture(e){const t=this._renderTargetSystem.getGpuRenderTarget(e);return t.contexts[0]?t.contexts[0].getCurrentTexture():this._renderer.texture.getGpuSource(e.colorTextures[0].source)}getDescriptor(e,t,i){"boolean"==typeof t&&(t=t?te.u.ALL:te.u.NONE);const n=this._renderTargetSystem,s=n.getGpuRenderTarget(e),r=e.colorTextures.map((e,r)=>{const a=s.contexts[r];let o,l;if(a){o=a.getCurrentTexture().createView()}else o=this._renderer.texture.getGpuSource(e).createView({mipLevelCount:1});s.msaaTextures[r]&&(l=o,o=this._renderer.texture.getTextureView(s.msaaTextures[r]));const h=t&te.u.COLOR?"clear":"load";return i??(i=n.defaultClearColor),{view:o,resolveTarget:l,clearValue:i,storeOp:"store",loadOp:h}});let a;if(!e.stencil&&!e.depth||e.depthStencilTexture||(e.ensureDepthStencilTexture(),e.depthStencilTexture.source.sampleCount=s.msaa?4:1),e.depthStencilTexture){const i=t&te.u.STENCIL?"clear":"load",n=t&te.u.DEPTH?"clear":"load";a={view:this._renderer.texture.getGpuSource(e.depthStencilTexture.source).createView(),stencilStoreOp:"store",stencilLoadOp:i,depthClearValue:1,depthLoadOp:n,depthStoreOp:"store"}}return{colorAttachments:r,depthStencilAttachment:a}}clear(e,t=!0,i,n){if(!t)return;const{gpu:s,encoder:r}=this._renderer,a=s.device;if(null===r.commandEncoder){const s=a.createCommandEncoder(),r=this.getDescriptor(e,t,i),o=s.beginRenderPass(r);o.setViewport(n.x,n.y,n.width,n.height,0,1),o.end();const l=s.finish();a.queue.submit([l])}else this.startRenderPass(e,t,i,n)}initGpuRenderTarget(e){e.isRoot=!0;const t=new se;return e.colorTextures.forEach((e,i)=>{if(e instanceof ie.q){const n=e.resource.getContext("webgpu"),s=e.transparent?"premultiplied":"opaque";try{n.configure({device:this._renderer.gpu.device,usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC,format:"bgra8unorm",alphaMode:s})}catch(e){console.error(e)}t.contexts[i]=n}if(t.msaa=e.source.antialias,e.source.antialias){const e=new ne.v({width:0,height:0,sampleCount:4});t.msaaTextures[i]=e}}),t.msaa&&(t.msaaSamples=4,e.depthStencilTexture&&(e.depthStencilTexture.source.sampleCount=4)),t}destroyGpuRenderTarget(e){e.contexts.forEach(e=>{e.unconfigure()}),e.msaaTextures.forEach(e=>{e.destroy()}),e.msaaTextures.length=0,e.contexts.length=0}ensureDepthStencilTexture(e){const t=this._renderTargetSystem.getGpuRenderTarget(e);e.depthStencilTexture&&t.msaa&&(e.depthStencilTexture.source.sampleCount=4)}resizeGpuRenderTarget(e){const t=this._renderTargetSystem.getGpuRenderTarget(e);t.width=e.width,t.height=e.height,t.msaa&&e.colorTextures.forEach((e,i)=>{const n=t.msaaTextures[i];n?.resize(e.source.width,e.source.height,e.source._resolution)})}}class ae extends ee.l{constructor(e){super(e),this.adaptor=new re,this.adaptor.init(e,this)}}ae.extension={type:[n.Ag.WebGPUSystem],name:"renderTarget"};class oe{constructor(){this._gpuProgramData=Object.create(null)}contextChange(e){this._gpu=e}getProgramData(e){return this._gpuProgramData[e._layoutKey]||this._createGPUProgramData(e)}_createGPUProgramData(e){const t=this._gpu.device,i=e.gpuLayout.map(e=>t.createBindGroupLayout({entries:e})),n={bindGroupLayouts:i};return this._gpuProgramData[e._layoutKey]={bindGroups:i,pipeline:t.createPipelineLayout(n)},this._gpuProgramData[e._layoutKey]}destroy(){this._gpu=null,this._gpuProgramData=null}}oe.extension={type:[n.Ag.WebGPUSystem],name:"shader"};const le={normal:{alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"}},add:{alpha:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"one",dstFactor:"one",operation:"add"}},multiply:{alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"dst",dstFactor:"one-minus-src-alpha",operation:"add"}},screen:{alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"one",dstFactor:"one-minus-src",operation:"add"}},overlay:{alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"one",dstFactor:"one-minus-src",operation:"add"}},none:{alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"zero",dstFactor:"zero",operation:"add"}},"normal-npm":{alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha",operation:"add"}},"add-npm":{alpha:{srcFactor:"one",dstFactor:"one",operation:"add"},color:{srcFactor:"src-alpha",dstFactor:"one",operation:"add"}},"screen-npm":{alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"src-alpha",dstFactor:"one-minus-src",operation:"add"}},erase:{alpha:{srcFactor:"zero",dstFactor:"one-minus-src-alpha",operation:"add"},color:{srcFactor:"zero",dstFactor:"one-minus-src",operation:"add"}},min:{alpha:{srcFactor:"one",dstFactor:"one",operation:"min"},color:{srcFactor:"one",dstFactor:"one",operation:"min"}},max:{alpha:{srcFactor:"one",dstFactor:"one",operation:"max"},color:{srcFactor:"one",dstFactor:"one",operation:"max"}}};class he{constructor(){this.defaultState=new v.U,this.defaultState.blend=!0}contextChange(e){this.gpu=e}getColorTargets(e){return[{format:"bgra8unorm",writeMask:0,blend:le[e.blendMode]||le.normal}]}destroy(){this.gpu=null}}he.extension={type:[n.Ag.WebGPUSystem],name:"state"};var ue=i(4057);const ce={type:"image",upload(e,t,i){const n=e.resource,s=(0|e.pixelWidth)*(0|e.pixelHeight),r=n.byteLength/s;i.device.queue.writeTexture({texture:t},n,{offset:0,rowsPerImage:e.pixelHeight,bytesPerRow:e.pixelHeight*r},{width:e.pixelWidth,height:e.pixelHeight,depthOrArrayLayers:1})}},de={"bc1-rgba-unorm":{blockBytes:8,blockWidth:4,blockHeight:4},"bc2-rgba-unorm":{blockBytes:16,blockWidth:4,blockHeight:4},"bc3-rgba-unorm":{blockBytes:16,blockWidth:4,blockHeight:4},"bc7-rgba-unorm":{blockBytes:16,blockWidth:4,blockHeight:4},"etc1-rgb-unorm":{blockBytes:8,blockWidth:4,blockHeight:4},"etc2-rgba8unorm":{blockBytes:16,blockWidth:4,blockHeight:4},"astc-4x4-unorm":{blockBytes:16,blockWidth:4,blockHeight:4}},pe={blockBytes:4,blockWidth:1,blockHeight:1},fe={type:"compressed",upload(e,t,i){let n=e.pixelWidth,s=e.pixelHeight;const r=de[e.format]||pe;for(let a=0;a<e.resource.length;a++){const o=e.resource[a],l=Math.ceil(n/r.blockWidth)*r.blockBytes;i.device.queue.writeTexture({texture:t,mipLevel:a},o,{offset:0,bytesPerRow:l},{width:Math.ceil(n/r.blockWidth)*r.blockWidth,height:Math.ceil(s/r.blockHeight)*r.blockHeight,depthOrArrayLayers:1}),n=Math.max(n>>1,1),s=Math.max(s>>1,1)}}},ge={type:"image",upload(e,t,i){const n=e.resource;if(!n)return;if(globalThis.HTMLImageElement&&n instanceof HTMLImageElement){const t=P.e.get().createCanvas(n.width,n.height);t.getContext("2d").drawImage(n,0,0,n.width,n.height),e.resource=t,(0,m.R)("ImageSource: Image element passed, converting to canvas and replacing resource.")}const s=Math.min(t.width,e.resourceWidth||e.pixelWidth),r=Math.min(t.height,e.resourceHeight||e.pixelHeight),a="premultiply-alpha-on-upload"===e.alphaMode;i.device.queue.copyExternalImageToTexture({source:n},{texture:t,premultipliedAlpha:a},{width:s,height:r})}},me={type:"video",upload(e,t,i){ge.upload(e,t,i)}};class _e{constructor(e){this.device=e,this.sampler=e.createSampler({minFilter:"linear"}),this.pipelines={}}_getMipmapPipeline(e){let t=this.pipelines[e];return t||(this.mipmapShaderModule||(this.mipmapShaderModule=this.device.createShaderModule({code:"\n                        var<private> pos : array<vec2<f32>, 3> = array<vec2<f32>, 3>(\n                        vec2<f32>(-1.0, -1.0), vec2<f32>(-1.0, 3.0), vec2<f32>(3.0, -1.0));\n\n                        struct VertexOutput {\n                        @builtin(position) position : vec4<f32>,\n                        @location(0) texCoord : vec2<f32>,\n                        };\n\n                        @vertex\n                        fn vertexMain(@builtin(vertex_index) vertexIndex : u32) -> VertexOutput {\n                        var output : VertexOutput;\n                        output.texCoord = pos[vertexIndex] * vec2<f32>(0.5, -0.5) + vec2<f32>(0.5);\n                        output.position = vec4<f32>(pos[vertexIndex], 0.0, 1.0);\n                        return output;\n                        }\n\n                        @group(0) @binding(0) var imgSampler : sampler;\n                        @group(0) @binding(1) var img : texture_2d<f32>;\n\n                        @fragment\n                        fn fragmentMain(@location(0) texCoord : vec2<f32>) -> @location(0) vec4<f32> {\n                        return textureSample(img, imgSampler, texCoord);\n                        }\n                    "})),t=this.device.createRenderPipeline({layout:"auto",vertex:{module:this.mipmapShaderModule,entryPoint:"vertexMain"},fragment:{module:this.mipmapShaderModule,entryPoint:"fragmentMain",targets:[{format:e}]}}),this.pipelines[e]=t),t}generateMipmap(e){const t=this._getMipmapPipeline(e.format);if("3d"===e.dimension||"1d"===e.dimension)throw new Error("Generating mipmaps for non-2d textures is currently unsupported!");let i=e;const n=e.depthOrArrayLayers||1,s=e.usage&GPUTextureUsage.RENDER_ATTACHMENT;if(!s){const t={size:{width:Math.ceil(e.width/2),height:Math.ceil(e.height/2),depthOrArrayLayers:n},format:e.format,usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_SRC|GPUTextureUsage.RENDER_ATTACHMENT,mipLevelCount:e.mipLevelCount-1};i=this.device.createTexture(t)}const r=this.device.createCommandEncoder({}),a=t.getBindGroupLayout(0);for(let o=0;o<n;++o){let n=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:"2d",baseArrayLayer:o,arrayLayerCount:1}),l=s?1:0;for(let s=1;s<e.mipLevelCount;++s){const e=i.createView({baseMipLevel:l++,mipLevelCount:1,dimension:"2d",baseArrayLayer:o,arrayLayerCount:1}),s=r.beginRenderPass({colorAttachments:[{view:e,storeOp:"store",loadOp:"clear",clearValue:{r:0,g:0,b:0,a:0}}]}),h=this.device.createBindGroup({layout:a,entries:[{binding:0,resource:this.sampler},{binding:1,resource:n}]});s.setPipeline(t),s.setBindGroup(0,h),s.draw(3,1,0,0),s.end(),n=e}}if(!s){const t={width:Math.ceil(e.width/2),height:Math.ceil(e.height/2),depthOrArrayLayers:n};for(let n=1;n<e.mipLevelCount;++n)r.copyTextureToTexture({texture:i,mipLevel:n-1},{texture:e,mipLevel:n},t),t.width=Math.ceil(t.width/2),t.height=Math.ceil(t.height/2)}return this.device.queue.submit([r.finish()]),s||i.destroy(),e}}class ve{constructor(e){this.managedTextures=[],this._gpuSources=Object.create(null),this._gpuSamplers=Object.create(null),this._bindGroupHash=Object.create(null),this._textureViewHash=Object.create(null),this._uploads={image:ge,buffer:ce,video:me,compressed:fe},this._renderer=e,e.renderableGC.addManagedHash(this,"_gpuSources"),e.renderableGC.addManagedHash(this,"_gpuSamplers"),e.renderableGC.addManagedHash(this,"_bindGroupHash"),e.renderableGC.addManagedHash(this,"_textureViewHash")}contextChange(e){this._gpu=e}initSource(e){return this._gpuSources[e.uid]?this._gpuSources[e.uid]:this._initSource(e)}_initSource(e){if(e.autoGenerateMipmaps){const t=Math.max(e.pixelWidth,e.pixelHeight);e.mipLevelCount=Math.floor(Math.log2(t))+1}let t=GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST;"compressed"!==e.uploadMethodId&&(t|=GPUTextureUsage.RENDER_ATTACHMENT,t|=GPUTextureUsage.COPY_SRC);const i=de[e.format]||{blockBytes:4,blockWidth:1,blockHeight:1},n=Math.ceil(e.pixelWidth/i.blockWidth)*i.blockWidth,s=Math.ceil(e.pixelHeight/i.blockHeight)*i.blockHeight,r={label:e.label,size:{width:n,height:s},format:e.format,sampleCount:e.sampleCount,mipLevelCount:e.mipLevelCount,dimension:e.dimension,usage:t},a=this._gpuSources[e.uid]=this._gpu.device.createTexture(r);return this.managedTextures.includes(e)||(e.on("update",this.onSourceUpdate,this),e.on("resize",this.onSourceResize,this),e.on("destroy",this.onSourceDestroy,this),e.on("unload",this.onSourceUnload,this),e.on("updateMipmaps",this.onUpdateMipmaps,this),this.managedTextures.push(e)),this.onSourceUpdate(e),a}onSourceUpdate(e){const t=this.getGpuSource(e);t&&(this._uploads[e.uploadMethodId]&&this._uploads[e.uploadMethodId].upload(e,t,this._gpu),e.autoGenerateMipmaps&&e.mipLevelCount>1&&this.onUpdateMipmaps(e))}onSourceUnload(e){const t=this._gpuSources[e.uid];t&&(this._gpuSources[e.uid]=null,t.destroy())}onUpdateMipmaps(e){this._mipmapGenerator||(this._mipmapGenerator=new _e(this._gpu.device));const t=this.getGpuSource(e);this._mipmapGenerator.generateMipmap(t)}onSourceDestroy(e){e.off("update",this.onSourceUpdate,this),e.off("unload",this.onSourceUnload,this),e.off("destroy",this.onSourceDestroy,this),e.off("resize",this.onSourceResize,this),e.off("updateMipmaps",this.onUpdateMipmaps,this),this.managedTextures.splice(this.managedTextures.indexOf(e),1),this.onSourceUnload(e)}onSourceResize(e){const t=this._gpuSources[e.uid];t?t.width===e.pixelWidth&&t.height===e.pixelHeight||(this._textureViewHash[e.uid]=null,this._bindGroupHash[e.uid]=null,this.onSourceUnload(e),this.initSource(e)):this.initSource(e)}_initSampler(e){return this._gpuSamplers[e._resourceId]=this._gpu.device.createSampler(e),this._gpuSamplers[e._resourceId]}getGpuSampler(e){return this._gpuSamplers[e._resourceId]||this._initSampler(e)}getGpuSource(e){return this._gpuSources[e.uid]||this.initSource(e)}getTextureBindGroup(e){return this._bindGroupHash[e.uid]??this._createTextureBindGroup(e)}_createTextureBindGroup(e){const t=e.source;return this._bindGroupHash[e.uid]=new X.T({0:t,1:t.style,2:new d.k({uTextureMatrix:{type:"mat3x3<f32>",value:e.textureMatrix.mapCoord}})}),this._bindGroupHash[e.uid]}getTextureView(e){const t=e.source;return this._textureViewHash[t.uid]??this._createTextureView(t)}_createTextureView(e){return this._textureViewHash[e.uid]=this.getGpuSource(e).createView(),this._textureViewHash[e.uid]}generateCanvas(e){const t=this._renderer,i=t.gpu.device.createCommandEncoder(),n=P.e.get().createCanvas();n.width=e.source.pixelWidth,n.height=e.source.pixelHeight;const s=n.getContext("webgpu");return s.configure({device:t.gpu.device,usage:GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC,format:P.e.get().getNavigator().gpu.getPreferredCanvasFormat(),alphaMode:"premultiplied"}),i.copyTextureToTexture({texture:t.texture.getGpuSource(e.source),origin:{x:0,y:0}},{texture:s.getCurrentTexture()},{width:n.width,height:n.height}),t.gpu.device.queue.submit([i.finish()]),n}getPixels(e){const t=this.generateCanvas(e),i=ue.N.getOptimalCanvasAndContext(t.width,t.height),n=i.context;n.drawImage(t,0,0);const{width:s,height:r}=t,a=n.getImageData(0,0,s,r),o=new Uint8ClampedArray(a.data.buffer);return ue.N.returnCanvasAndContext(i),{pixels:o,width:s,height:r}}destroy(){this.managedTextures.slice().forEach(e=>this.onSourceDestroy(e)),this.managedTextures=null;for(const e of Object.keys(this._bindGroupHash)){const t=Number(e),i=this._bindGroupHash[t];i?.destroy(),this._bindGroupHash[t]=null}this._gpu=null,this._mipmapGenerator=null,this._gpuSources=null,this._bindGroupHash=null,this._textureViewHash=null,this._gpuSamplers=null}}ve.extension={type:[n.Ag.WebGPUSystem],name:"texture"};const ye=[...T.i,z,M,I,R,C,ve,ae,oe,he,J,w,k,A],be=[...T.f,K],xe=[b,_,p],Te=[],Se=[],Ae=[];n.XO.handleByNamedList(n.Ag.WebGPUSystem,Te),n.XO.handleByNamedList(n.Ag.WebGPUPipes,Se),n.XO.handleByNamedList(n.Ag.WebGPUPipesAdaptor,Ae),n.XO.add(...ye,...be,...xe);class Ee extends x.k{constructor(){super({name:"webgpu",type:S.W.WEBGPU,systems:Te,renderPipes:Se,renderPipeAdaptors:Ae})}}},3797:(e,t,i)=>{"use strict";i.d(t,{m:()=>a});var n=i(6680),s=i(7),r=i(1862);class a{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new n.u,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.gcTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new s.L,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(e){this.root=e,e._onRender&&this.addOnRender(e),e.didChange=!0;const t=e.children;for(let e=0;e<t.length;e++){const i=t[e];i._updateFlags=15,this.addChild(i)}}enableCacheAsTexture(e={}){this.textureOptions=e,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(r.W.returnTexture(this.texture,!0),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0;const e=this._parentCacheAsTextureRenderGroup;e&&!e.textureNeedsUpdate&&e.updateCacheTexture()}reset(){this.renderGroupChildren.length=0;for(const e in this.childrenToUpdate){const t=this.childrenToUpdate[e];t.list.fill(null),t.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(e){e.renderGroupParent&&e.renderGroupParent._removeRenderGroupChild(e),e.renderGroupParent=this,this.renderGroupChildren.push(e)}_removeRenderGroupChild(e){const t=this.renderGroupChildren.indexOf(e);t>-1&&this.renderGroupChildren.splice(t,1),e.renderGroupParent=null}addChild(e){if(this.structureDidChange=!0,e.parentRenderGroup=this,e.updateTick=-1,e.parent===this.root?e.relativeRenderGroupDepth=1:e.relativeRenderGroupDepth=e.parent.relativeRenderGroupDepth+1,e.didChange=!0,this.onChildUpdate(e),e.renderGroup)return void this.addRenderGroupChild(e.renderGroup);e._onRender&&this.addOnRender(e);const t=e.children;for(let e=0;e<t.length;e++)this.addChild(t[e])}removeChild(e){if(this.structureDidChange=!0,e._onRender&&(e.renderGroup||this.removeOnRender(e)),e.parentRenderGroup=null,e.renderGroup)return void this._removeRenderGroupChild(e.renderGroup);const t=e.children;for(let e=0;e<t.length;e++)this.removeChild(t[e])}removeChildren(e){for(let t=0;t<e.length;t++)this.removeChild(e[t])}onChildUpdate(e){let t=this.childrenToUpdate[e.relativeRenderGroupDepth];t||(t=this.childrenToUpdate[e.relativeRenderGroupDepth]={index:0,list:[]}),t.list[t.index++]=e}updateRenderable(e){e.globalDisplayStatus<7||(this.instructionSet.renderPipes[e.renderPipeId].updateRenderable(e),e.didViewUpdate=!1)}onChildViewUpdate(e){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=e}get isRenderable(){return 7===this.root.localDisplayStatus&&this.worldAlpha>0}addOnRender(e){this._onRenderContainers.push(e)}removeOnRender(e){this._onRenderContainers.splice(this._onRenderContainers.indexOf(e),1)}runOnRender(e){for(let t=0;t<this._onRenderContainers.length;t++)this._onRenderContainers[t]._onRender(e)}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(e=[]){const t=this.root.children;for(let i=0;i<t.length;i++)this._getChildren(t[i],e);return e}_getChildren(e,t=[]){if(t.push(e),e.renderGroup)return t;const i=e.children;for(let e=0;e<i.length;e++)this._getChildren(i[e],t);return t}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return 1&this._matrixDirty?(this._matrixDirty&=-2,this._inverseWorldTransform||(this._inverseWorldTransform=new n.u),this._inverseWorldTransform.copyFrom(this.worldTransform).invert()):this._inverseWorldTransform}get textureOffsetInverseTransform(){return 2&this._matrixDirty?(this._matrixDirty&=-3,this._textureOffsetInverseTransform||(this._textureOffsetInverseTransform=new n.u),this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y)):this._textureOffsetInverseTransform}get inverseParentTextureTransform(){if(!(4&this._matrixDirty))return this._inverseParentTextureTransform;this._matrixDirty&=-5;const e=this._parentCacheAsTextureRenderGroup;return e?(this._inverseParentTextureTransform||(this._inverseParentTextureTransform=new n.u),this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(e.inverseWorldTransform).translate(-e._textureBounds.x,-e._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this.isCachedAsTexture?this.textureOffsetInverseTransform:this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}}},3865:(e,t,i)=>{"use strict";i.d(t,{z:()=>n});const n=(e,t,i=!1)=>(Array.isArray(e)||(e=[e]),t?e.map(e=>"string"==typeof e||i?t(e):e):e)},3902:(e,t,i)=>{"use strict";i.d(t,{M:()=>r,d:()=>a});var n=i(8602),s=i(6286);class r{static init(){globalThis.__PIXI_APP_INIT__?.(this,s.xv)}static destroy(){}}r.extension=n.Ag.Application;class a{constructor(e){this._renderer=e}init(){globalThis.__PIXI_RENDERER_INIT__?.(this._renderer,s.xv)}destroy(){this._renderer=null}}a.extension={type:[n.Ag.WebGLSystem,n.Ag.WebGPUSystem],name:"initHook",priority:-10}},3989:(e,t,i)=>{"use strict";i.d(t,{m:()=>a});var n=i(6680),s=i(198);const r={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class a{constructor(e,t){this.uid=(0,s.L)("fillPattern"),this._tick=0,this.transform=new n.u,this.texture=e,this.transform.scale(1/e.frame.width,1/e.frame.height),t&&(e.source.style.addressModeU=r[t].addressModeU,e.source.style.addressModeV=r[t].addressModeV)}setTransform(e){const t=this.texture;this.transform.copyFrom(e),this.transform.invert(),this.transform.scale(1/t.frame.width,1/t.frame.height),this._tick++}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture=e,this._tick++)}get styleKey(){return`fill-pattern-${this.uid}-${this._tick}`}destroy(){this.texture.destroy(!0),this.texture=null}}},4036:(e,t,i)=>{"use strict";i.d(t,{Y:()=>n});const n=(e,t)=>{const i=t.split("?")[1];return i&&(e+=`?${i}`),e}},4057:(e,t,i)=>{"use strict";i.d(t,{N:()=>a});var n=i(5553),s=i(9550),r=i(9298);const a=new class{constructor(e){this._canvasPool=Object.create(null),this.canvasOptions=e||{},this.enableFullScreen=!1}_createCanvasAndContext(e,t){const i=n.e.get().createCanvas();i.width=e,i.height=t;const s=i.getContext("2d");return{canvas:i,context:s}}getOptimalCanvasAndContext(e,t,i=1){e=Math.ceil(e*i-1e-6),t=Math.ceil(t*i-1e-6);const n=((e=(0,s.U5)(e))<<17)+((t=(0,s.U5)(t))<<1);this._canvasPool[n]||(this._canvasPool[n]=[]);let r=this._canvasPool[n].pop();return r||(r=this._createCanvasAndContext(e,t)),r}returnCanvasAndContext(e){const t=e.canvas,{width:i,height:n}=t,s=(i<<17)+(n<<1);e.context.resetTransform(),e.context.clearRect(0,0,i,n),this._canvasPool[s].push(e)}clear(){this._canvasPool={}}};r.L.register(a)},4060:(e,t,i)=>{"use strict";i.d(t,{U:()=>r});const n={normal:0,add:1,multiply:2,screen:3,overlay:4,erase:5,"normal-npm":6,"add-npm":7,"screen-npm":8,min:9,max:10},s=class e{constructor(){this.data=0,this.blendMode="normal",this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(1&this.data)}set blend(e){!!(1&this.data)!==e&&(this.data^=1)}get offsets(){return!!(2&this.data)}set offsets(e){!!(2&this.data)!==e&&(this.data^=2)}set cullMode(e){"none"!==e?(this.culling=!0,this.clockwiseFrontFace="front"===e):this.culling=!1}get cullMode(){return this.culling?this.clockwiseFrontFace?"front":"back":"none"}get culling(){return!!(4&this.data)}set culling(e){!!(4&this.data)!==e&&(this.data^=4)}get depthTest(){return!!(8&this.data)}set depthTest(e){!!(8&this.data)!==e&&(this.data^=8)}get depthMask(){return!!(32&this.data)}set depthMask(e){!!(32&this.data)!==e&&(this.data^=32)}get clockwiseFrontFace(){return!!(16&this.data)}set clockwiseFrontFace(e){!!(16&this.data)!==e&&(this.data^=16)}get blendMode(){return this._blendMode}set blendMode(e){this.blend="none"!==e,this._blendMode=e,this._blendModeId=n[e]||0}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}toString(){return`[pixi.js/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const t=new e;return t.depthTest=!1,t.blend=!0,t}};s.default2d=s.for2d();let r=s},4068:(e,t,i)=>{"use strict";i.d(t,{l:()=>r});var n=i(9731),s=i(3865);const r=new class{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){const t=this._cache.get(e);return t||(0,n.R)(`[Assets] Asset id ${e} was not found in the Cache`),t}set(e,t){const i=(0,s.z)(e);let r;for(let e=0;e<this.parsers.length;e++){const n=this.parsers[e];if(n.test(t)){r=n.getCacheableAssets(i,t);break}}const a=new Map(Object.entries(r||{}));r||i.forEach(e=>{a.set(e,t)});const o=[...a.keys()],l={cacheKeys:o,keys:i};i.forEach(e=>{this._cacheMap.set(e,l)}),o.forEach(e=>{const i=r?r[e]:t;this._cache.has(e)&&this._cache.get(e)!==i&&(0,n.R)("[Cache] already has key:",e),this._cache.set(e,a.get(e))})}remove(e){if(!this._cacheMap.has(e))return void(0,n.R)(`[Assets] Asset id ${e} was not found in the Cache`);const t=this._cacheMap.get(e);t.cacheKeys.forEach(e=>{this._cache.delete(e)}),t.keys.forEach(e=>{this._cacheMap.delete(e)})}get parsers(){return this._parsers}}},4196:(e,t,i)=>{var n;!function(){"use strict";var s=function(){this.init()};s.prototype={init:function(){var e=this||r;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var t=this||r;if(e=parseFloat(e),t.ctx||p(),void 0!==e&&e>=0&&e<=1){if(t._volume=e,t._muted)return t;t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e,r.ctx.currentTime);for(var i=0;i<t._howls.length;i++)if(!t._howls[i]._webAudio)for(var n=t._howls[i]._getSoundIds(),s=0;s<n.length;s++){var a=t._howls[i]._soundById(n[s]);a&&a._node&&(a._node.volume=a._volume*e)}return t}return t._volume},mute:function(e){var t=this||r;t.ctx||p(),t._muted=e,t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e?0:t._volume,r.ctx.currentTime);for(var i=0;i<t._howls.length;i++)if(!t._howls[i]._webAudio)for(var n=t._howls[i]._getSoundIds(),s=0;s<n.length;s++){var a=t._howls[i]._soundById(n[s]);a&&a._node&&(a._node.muted=!!e||a._muted)}return t},stop:function(){for(var e=this||r,t=0;t<e._howls.length;t++)e._howls[t].stop();return e},unload:function(){for(var e=this||r,t=e._howls.length-1;t>=0;t--)e._howls[t].unload();return e.usingWebAudio&&e.ctx&&void 0!==e.ctx.close&&(e.ctx.close(),e.ctx=null,p()),e},codecs:function(e){return(this||r)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||r;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(e._canPlayEvent="canplay")}catch(t){e.noAudio=!0}else e.noAudio=!0;try{(new Audio).muted&&(e.noAudio=!0)}catch(e){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||r,t=null;try{t="undefined"!=typeof Audio?new Audio:null}catch(t){return e}if(!t||"function"!=typeof t.canPlayType)return e;var i=t.canPlayType("audio/mpeg;").replace(/^no$/,""),n=e._navigator?e._navigator.userAgent:"",s=n.match(/OPR\/(\d+)/g),a=s&&parseInt(s[0].split("/")[1],10)<33,o=-1!==n.indexOf("Safari")&&-1===n.indexOf("Chrome"),l=n.match(/Version\/(.*?) /),h=o&&l&&parseInt(l[1],10)<15;return e._codecs={mp3:!(a||!i&&!t.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!i,opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(t.canPlayType('audio/wav; codecs="1"')||t.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!t.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(t.canPlayType("audio/x-m4b;")||t.canPlayType("audio/m4b;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(h||!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(h||!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||r;if(!e._audioUnlocked&&e.ctx){e._audioUnlocked=!1,e.autoUnlock=!1,e._mobileUnloaded||44100===e.ctx.sampleRate||(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var t=function(i){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var n=new Audio;n._unlocked=!0,e._releaseHtml5Audio(n)}catch(i){e.noAudio=!0;break}for(var s=0;s<e._howls.length;s++)if(!e._howls[s]._webAudio)for(var r=e._howls[s]._getSoundIds(),a=0;a<r.length;a++){var o=e._howls[s]._soundById(r[a]);o&&o._node&&!o._node._unlocked&&(o._node._unlocked=!0,o._node.load())}e._autoResume();var l=e.ctx.createBufferSource();l.buffer=e._scratchBuffer,l.connect(e.ctx.destination),void 0===l.start?l.noteOn(0):l.start(0),"function"==typeof e.ctx.resume&&e.ctx.resume(),l.onended=function(){l.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",t,!0),document.removeEventListener("touchend",t,!0),document.removeEventListener("click",t,!0),document.removeEventListener("keydown",t,!0);for(var i=0;i<e._howls.length;i++)e._howls[i]._emit("unlock")}};return document.addEventListener("touchstart",t,!0),document.addEventListener("touchend",t,!0),document.addEventListener("click",t,!0),document.addEventListener("keydown",t,!0),e}},_obtainHtml5Audio:function(){var e=this||r;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var t=(new Audio).play();return t&&"undefined"!=typeof Promise&&(t instanceof Promise||"function"==typeof t.then)&&t.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(e){var t=this||r;return e._unlocked&&t._html5AudioPool.push(e),t},_autoSuspend:function(){var e=this;if(e.autoSuspend&&e.ctx&&void 0!==e.ctx.suspend&&r.usingWebAudio){for(var t=0;t<e._howls.length;t++)if(e._howls[t]._webAudio)for(var i=0;i<e._howls[t]._sounds.length;i++)if(!e._howls[t]._sounds[i]._paused)return e;return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(function(){if(e.autoSuspend){e._suspendTimer=null,e.state="suspending";var t=function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(t,t)}},3e4),e}},_autoResume:function(){var e=this;if(e.ctx&&void 0!==e.ctx.resume&&r.usingWebAudio)return"running"===e.state&&"interrupted"!==e.ctx.state&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):"suspended"===e.state||"running"===e.state&&"interrupted"===e.ctx.state?(e.ctx.resume().then(function(){e.state="running";for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):"suspending"===e.state&&(e._resumeAfterSuspend=!0),e}};var r=new s,a=function(e){e.src&&0!==e.src.length?this.init(e):console.error("An array of source files must be passed with any new Howl.")};a.prototype={init:function(e){var t=this;return r.ctx||p(),t._autoplay=e.autoplay||!1,t._format="string"!=typeof e.format?e.format:[e.format],t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload="boolean"!=typeof e.preload&&"metadata"!==e.preload||e.preload,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src="string"!=typeof e.src?e.src:[e.src],t._volume=void 0!==e.volume?e.volume:1,t._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:"GET",headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:!(!e.xhr||!e.xhr.withCredentials)&&e.xhr.withCredentials},t._duration=0,t._state="unloaded",t._sounds=[],t._endTimers={},t._queue=[],t._playLock=!1,t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._onunlock=e.onunlock?[{fn:e.onunlock}]:[],t._onresume=[],t._webAudio=r.usingWebAudio&&!t._html5,void 0!==r.ctx&&r.ctx&&r.autoUnlock&&r._unlockAudio(),r._howls.push(t),t._autoplay&&t._queue.push({event:"play",action:function(){t.play()}}),t._preload&&"none"!==t._preload&&t.load(),t},load:function(){var e=this,t=null;if(r.noAudio)e._emit("loaderror",null,"No audio support.");else{"string"==typeof e._src&&(e._src=[e._src]);for(var i=0;i<e._src.length;i++){var n,s;if(e._format&&e._format[i])n=e._format[i];else{if("string"!=typeof(s=e._src[i])){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(n=/^data:audio\/([^;,]+);/i.exec(s))||(n=/\.([^.]+)$/.exec(s.split("?",1)[0])),n&&(n=n[1].toLowerCase())}if(n||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),n&&r.codecs(n)){t=e._src[i];break}}if(t)return e._src=t,e._state="loading","https:"===window.location.protocol&&"http:"===t.slice(0,5)&&(e._html5=!0,e._webAudio=!1),new o(e),e._webAudio&&h(e),e;e._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(e,t){var i=this,n=null;if("number"==typeof e)n=e,e=null;else{if("string"==typeof e&&"loaded"===i._state&&!i._sprite[e])return null;if(void 0===e&&(e="__default",!i._playLock)){for(var s=0,a=0;a<i._sounds.length;a++)i._sounds[a]._paused&&!i._sounds[a]._ended&&(s++,n=i._sounds[a]._id);1===s?e=null:n=null}}var o=n?i._soundById(n):i._inactiveSound();if(!o)return null;if(n&&!e&&(e=o._sprite||"__default"),"loaded"!==i._state){o._sprite=e,o._ended=!1;var l=o._id;return i._queue.push({event:"play",action:function(){i.play(l)}}),l}if(n&&!o._paused)return t||i._loadQueue("play"),o._id;i._webAudio&&r._autoResume();var h=Math.max(0,o._seek>0?o._seek:i._sprite[e][0]/1e3),u=Math.max(0,(i._sprite[e][0]+i._sprite[e][1])/1e3-h),c=1e3*u/Math.abs(o._rate),d=i._sprite[e][0]/1e3,p=(i._sprite[e][0]+i._sprite[e][1])/1e3;o._sprite=e,o._ended=!1;var f=function(){o._paused=!1,o._seek=h,o._start=d,o._stop=p,o._loop=!(!o._loop&&!i._sprite[e][2])};if(!(h>=p)){var g=o._node;if(i._webAudio){var m=function(){i._playLock=!1,f(),i._refreshBuffer(o);var e=o._muted||i._muted?0:o._volume;g.gain.setValueAtTime(e,r.ctx.currentTime),o._playStart=r.ctx.currentTime,void 0===g.bufferSource.start?o._loop?g.bufferSource.noteGrainOn(0,h,86400):g.bufferSource.noteGrainOn(0,h,u):o._loop?g.bufferSource.start(0,h,86400):g.bufferSource.start(0,h,u),c!==1/0&&(i._endTimers[o._id]=setTimeout(i._ended.bind(i,o),c)),t||setTimeout(function(){i._emit("play",o._id),i._loadQueue()},0)};"running"===r.state&&"interrupted"!==r.ctx.state?m():(i._playLock=!0,i.once("resume",m),i._clearTimer(o._id))}else{var _=function(){g.currentTime=h,g.muted=o._muted||i._muted||r._muted||g.muted,g.volume=o._volume*r.volume(),g.playbackRate=o._rate;try{var n=g.play();if(n&&"undefined"!=typeof Promise&&(n instanceof Promise||"function"==typeof n.then)?(i._playLock=!0,f(),n.then(function(){i._playLock=!1,g._unlocked=!0,t?i._loadQueue():i._emit("play",o._id)}).catch(function(){i._playLock=!1,i._emit("playerror",o._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),o._ended=!0,o._paused=!0})):t||(i._playLock=!1,f(),i._emit("play",o._id)),g.playbackRate=o._rate,g.paused)return void i._emit("playerror",o._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==e||o._loop?i._endTimers[o._id]=setTimeout(i._ended.bind(i,o),c):(i._endTimers[o._id]=function(){i._ended(o),g.removeEventListener("ended",i._endTimers[o._id],!1)},g.addEventListener("ended",i._endTimers[o._id],!1))}catch(e){i._emit("playerror",o._id,e)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===g.src&&(g.src=i._src,g.load());var v=window&&window.ejecta||!g.readyState&&r._navigator.isCocoonJS;if(g.readyState>=3||v)_();else{i._playLock=!0,i._state="loading";var y=function(){i._state="loaded",_(),g.removeEventListener(r._canPlayEvent,y,!1)};g.addEventListener(r._canPlayEvent,y,!1),i._clearTimer(o._id)}}return o._id}i._ended(o)},pause:function(e){var t=this;if("loaded"!==t._state||t._playLock)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var i=t._getSoundIds(e),n=0;n<i.length;n++){t._clearTimer(i[n]);var s=t._soundById(i[n]);if(s&&!s._paused&&(s._seek=t.seek(i[n]),s._rateSeek=0,s._paused=!0,t._stopFade(i[n]),s._node))if(t._webAudio){if(!s._node.bufferSource)continue;void 0===s._node.bufferSource.stop?s._node.bufferSource.noteOff(0):s._node.bufferSource.stop(0),t._cleanBuffer(s._node)}else isNaN(s._node.duration)&&s._node.duration!==1/0||s._node.pause();arguments[1]||t._emit("pause",s?s._id:null)}return t},stop:function(e,t){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"stop",action:function(){i.stop(e)}}),i;for(var n=i._getSoundIds(e),s=0;s<n.length;s++){i._clearTimer(n[s]);var r=i._soundById(n[s]);r&&(r._seek=r._start||0,r._rateSeek=0,r._paused=!0,r._ended=!0,i._stopFade(n[s]),r._node&&(i._webAudio?r._node.bufferSource&&(void 0===r._node.bufferSource.stop?r._node.bufferSource.noteOff(0):r._node.bufferSource.stop(0),i._cleanBuffer(r._node)):isNaN(r._node.duration)&&r._node.duration!==1/0||(r._node.currentTime=r._start||0,r._node.pause(),r._node.duration===1/0&&i._clearSound(r._node))),t||i._emit("stop",r._id))}return i},mute:function(e,t){var i=this;if("loaded"!==i._state||i._playLock)return i._queue.push({event:"mute",action:function(){i.mute(e,t)}}),i;if(void 0===t){if("boolean"!=typeof e)return i._muted;i._muted=e}for(var n=i._getSoundIds(t),s=0;s<n.length;s++){var a=i._soundById(n[s]);a&&(a._muted=e,a._interval&&i._stopFade(a._id),i._webAudio&&a._node?a._node.gain.setValueAtTime(e?0:a._volume,r.ctx.currentTime):a._node&&(a._node.muted=!!r._muted||e),i._emit("mute",a._id))}return i},volume:function(){var e,t,i,n=this,s=arguments;if(0===s.length)return n._volume;if(1===s.length||2===s.length&&void 0===s[1]?n._getSoundIds().indexOf(s[0])>=0?t=parseInt(s[0],10):e=parseFloat(s[0]):s.length>=2&&(e=parseFloat(s[0]),t=parseInt(s[1],10)),!(void 0!==e&&e>=0&&e<=1))return(i=t?n._soundById(t):n._sounds[0])?i._volume:0;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"volume",action:function(){n.volume.apply(n,s)}}),n;void 0===t&&(n._volume=e),t=n._getSoundIds(t);for(var a=0;a<t.length;a++)(i=n._soundById(t[a]))&&(i._volume=e,s[2]||n._stopFade(t[a]),n._webAudio&&i._node&&!i._muted?i._node.gain.setValueAtTime(e,r.ctx.currentTime):i._node&&!i._muted&&(i._node.volume=e*r.volume()),n._emit("volume",i._id));return n},fade:function(e,t,i,n){var s=this;if("loaded"!==s._state||s._playLock)return s._queue.push({event:"fade",action:function(){s.fade(e,t,i,n)}}),s;e=Math.min(Math.max(0,parseFloat(e)),1),t=Math.min(Math.max(0,parseFloat(t)),1),i=parseFloat(i),s.volume(e,n);for(var a=s._getSoundIds(n),o=0;o<a.length;o++){var l=s._soundById(a[o]);if(l){if(n||s._stopFade(a[o]),s._webAudio&&!l._muted){var h=r.ctx.currentTime,u=h+i/1e3;l._volume=e,l._node.gain.setValueAtTime(e,h),l._node.gain.linearRampToValueAtTime(t,u)}s._startFadeInterval(l,e,t,i,a[o],void 0===n)}}return s},_startFadeInterval:function(e,t,i,n,s,r){var a=this,o=t,l=i-t,h=Math.abs(l/.01),u=Math.max(4,h>0?n/h:n),c=Date.now();e._fadeTo=i,e._interval=setInterval(function(){var s=(Date.now()-c)/n;c=Date.now(),o+=l*s,o=Math.round(100*o)/100,o=l<0?Math.max(i,o):Math.min(i,o),a._webAudio?e._volume=o:a.volume(o,e._id,!0),r&&(a._volume=o),(i<t&&o<=i||i>t&&o>=i)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,a.volume(i,e._id),a._emit("fade",e._id))},u)},_stopFade:function(e){var t=this,i=t._soundById(e);return i&&i._interval&&(t._webAudio&&i._node.gain.cancelScheduledValues(r.ctx.currentTime),clearInterval(i._interval),i._interval=null,t.volume(i._fadeTo,e),i._fadeTo=null,t._emit("fade",e)),t},loop:function(){var e,t,i,n=this,s=arguments;if(0===s.length)return n._loop;if(1===s.length){if("boolean"!=typeof s[0])return!!(i=n._soundById(parseInt(s[0],10)))&&i._loop;e=s[0],n._loop=e}else 2===s.length&&(e=s[0],t=parseInt(s[1],10));for(var r=n._getSoundIds(t),a=0;a<r.length;a++)(i=n._soundById(r[a]))&&(i._loop=e,n._webAudio&&i._node&&i._node.bufferSource&&(i._node.bufferSource.loop=e,e&&(i._node.bufferSource.loopStart=i._start||0,i._node.bufferSource.loopEnd=i._stop,n.playing(r[a])&&(n.pause(r[a],!0),n.play(r[a],!0)))));return n},rate:function(){var e,t,i,n=this,s=arguments;if(0===s.length)t=n._sounds[0]._id;else if(1===s.length){n._getSoundIds().indexOf(s[0])>=0?t=parseInt(s[0],10):e=parseFloat(s[0])}else 2===s.length&&(e=parseFloat(s[0]),t=parseInt(s[1],10));if("number"!=typeof e)return(i=n._soundById(t))?i._rate:n._rate;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"rate",action:function(){n.rate.apply(n,s)}}),n;void 0===t&&(n._rate=e),t=n._getSoundIds(t);for(var a=0;a<t.length;a++)if(i=n._soundById(t[a])){n.playing(t[a])&&(i._rateSeek=n.seek(t[a]),i._playStart=n._webAudio?r.ctx.currentTime:i._playStart),i._rate=e,n._webAudio&&i._node&&i._node.bufferSource?i._node.bufferSource.playbackRate.setValueAtTime(e,r.ctx.currentTime):i._node&&(i._node.playbackRate=e);var o=n.seek(t[a]),l=1e3*((n._sprite[i._sprite][0]+n._sprite[i._sprite][1])/1e3-o)/Math.abs(i._rate);!n._endTimers[t[a]]&&i._paused||(n._clearTimer(t[a]),n._endTimers[t[a]]=setTimeout(n._ended.bind(n,i),l)),n._emit("rate",i._id)}return n},seek:function(){var e,t,i=this,n=arguments;if(0===n.length)i._sounds.length&&(t=i._sounds[0]._id);else if(1===n.length){i._getSoundIds().indexOf(n[0])>=0?t=parseInt(n[0],10):i._sounds.length&&(t=i._sounds[0]._id,e=parseFloat(n[0]))}else 2===n.length&&(e=parseFloat(n[0]),t=parseInt(n[1],10));if(void 0===t)return 0;if("number"==typeof e&&("loaded"!==i._state||i._playLock))return i._queue.push({event:"seek",action:function(){i.seek.apply(i,n)}}),i;var s=i._soundById(t);if(s){if(!("number"==typeof e&&e>=0)){if(i._webAudio){var a=i.playing(t)?r.ctx.currentTime-s._playStart:0,o=s._rateSeek?s._rateSeek-s._seek:0;return s._seek+(o+a*Math.abs(s._rate))}return s._node.currentTime}var l=i.playing(t);l&&i.pause(t,!0),s._seek=e,s._ended=!1,i._clearTimer(t),i._webAudio||!s._node||isNaN(s._node.duration)||(s._node.currentTime=e);var h=function(){l&&i.play(t,!0),i._emit("seek",t)};if(l&&!i._webAudio){var u=function(){i._playLock?setTimeout(u,0):h()};setTimeout(u,0)}else h()}return i},playing:function(e){var t=this;if("number"==typeof e){var i=t._soundById(e);return!!i&&!i._paused}for(var n=0;n<t._sounds.length;n++)if(!t._sounds[n]._paused)return!0;return!1},duration:function(e){var t=this,i=t._duration,n=t._soundById(e);return n&&(i=t._sprite[n._sprite][1]/1e3),i},state:function(){return this._state},unload:function(){for(var e=this,t=e._sounds,i=0;i<t.length;i++)t[i]._paused||e.stop(t[i]._id),e._webAudio||(e._clearSound(t[i]._node),t[i]._node.removeEventListener("error",t[i]._errorFn,!1),t[i]._node.removeEventListener(r._canPlayEvent,t[i]._loadFn,!1),t[i]._node.removeEventListener("ended",t[i]._endFn,!1),r._releaseHtml5Audio(t[i]._node)),delete t[i]._node,e._clearTimer(t[i]._id);var n=r._howls.indexOf(e);n>=0&&r._howls.splice(n,1);var s=!0;for(i=0;i<r._howls.length;i++)if(r._howls[i]._src===e._src||e._src.indexOf(r._howls[i]._src)>=0){s=!1;break}return l&&s&&delete l[e._src],r.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,t,i,n){var s=this["_on"+e];return"function"==typeof t&&s.push(n?{id:i,fn:t,once:n}:{id:i,fn:t}),this},off:function(e,t,i){var n=this,s=n["_on"+e],r=0;if("number"==typeof t&&(i=t,t=null),t||i)for(r=0;r<s.length;r++){var a=i===s[r].id;if(t===s[r].fn&&a||!t&&a){s.splice(r,1);break}}else if(e)n["_on"+e]=[];else{var o=Object.keys(n);for(r=0;r<o.length;r++)0===o[r].indexOf("_on")&&Array.isArray(n[o[r]])&&(n[o[r]]=[])}return n},once:function(e,t,i){return this.on(e,t,i,1),this},_emit:function(e,t,i){for(var n=this,s=n["_on"+e],r=s.length-1;r>=0;r--)s[r].id&&s[r].id!==t&&"load"!==e||(setTimeout(function(e){e.call(this,t,i)}.bind(n,s[r].fn),0),s[r].once&&n.off(e,s[r].fn,s[r].id));return n._loadQueue(e),n},_loadQueue:function(e){var t=this;if(t._queue.length>0){var i=t._queue[0];i.event===e&&(t._queue.shift(),t._loadQueue()),e||i.action()}return t},_ended:function(e){var t=this,i=e._sprite;if(!t._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(t._ended.bind(t,e),100),t;var n=!(!e._loop&&!t._sprite[i][2]);if(t._emit("end",e._id),!t._webAudio&&n&&t.stop(e._id,!0).play(e._id),t._webAudio&&n){t._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=r.ctx.currentTime;var s=1e3*(e._stop-e._start)/Math.abs(e._rate);t._endTimers[e._id]=setTimeout(t._ended.bind(t,e),s)}return t._webAudio&&!n&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,t._clearTimer(e._id),t._cleanBuffer(e._node),r._autoSuspend()),t._webAudio||n||t.stop(e._id,!0),t},_clearTimer:function(e){var t=this;if(t._endTimers[e]){if("function"!=typeof t._endTimers[e])clearTimeout(t._endTimers[e]);else{var i=t._soundById(e);i&&i._node&&i._node.removeEventListener("ended",t._endTimers[e],!1)}delete t._endTimers[e]}return t},_soundById:function(e){for(var t=this,i=0;i<t._sounds.length;i++)if(e===t._sounds[i]._id)return t._sounds[i];return null},_inactiveSound:function(){var e=this;e._drain();for(var t=0;t<e._sounds.length;t++)if(e._sounds[t]._ended)return e._sounds[t].reset();return new o(e)},_drain:function(){var e=this,t=e._pool,i=0,n=0;if(!(e._sounds.length<t)){for(n=0;n<e._sounds.length;n++)e._sounds[n]._ended&&i++;for(n=e._sounds.length-1;n>=0;n--){if(i<=t)return;e._sounds[n]._ended&&(e._webAudio&&e._sounds[n]._node&&e._sounds[n]._node.disconnect(0),e._sounds.splice(n,1),i--)}}},_getSoundIds:function(e){if(void 0===e){for(var t=[],i=0;i<this._sounds.length;i++)t.push(this._sounds[i]._id);return t}return[e]},_refreshBuffer:function(e){return e._node.bufferSource=r.ctx.createBufferSource(),e._node.bufferSource.buffer=l[this._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,r.ctx.currentTime),this},_cleanBuffer:function(e){var t=r._navigator&&r._navigator.vendor.indexOf("Apple")>=0;if(!e.bufferSource)return this;if(r._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),t))try{e.bufferSource.buffer=r._scratchBuffer}catch(e){}return e.bufferSource=null,this},_clearSound:function(e){/MSIE |Trident\//.test(r._navigator&&r._navigator.userAgent)||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var o=function(e){this._parent=e,this.init()};o.prototype={init:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++r._counter,t._sounds.push(e),e.create(),e},create:function(){var e=this,t=e._parent,i=r._muted||e._muted||e._parent._muted?0:e._volume;return t._webAudio?(e._node=void 0===r.ctx.createGain?r.ctx.createGainNode():r.ctx.createGain(),e._node.gain.setValueAtTime(i,r.ctx.currentTime),e._node.paused=!0,e._node.connect(r.masterGain)):r.noAudio||(e._node=r._obtainHtml5Audio(),e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(r._canPlayEvent,e._loadFn,!1),e._endFn=e._endListener.bind(e),e._node.addEventListener("ended",e._endFn,!1),e._node.src=t._src,e._node.preload=!0===t._preload?"auto":t._preload,e._node.volume=i*r.volume(),e._node.load()),e},reset:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++r._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,t=e._parent;t._duration=Math.ceil(10*e._node.duration)/10,0===Object.keys(t._sprite).length&&(t._sprite={__default:[0,1e3*t._duration]}),"loaded"!==t._state&&(t._state="loaded",t._emit("load"),t._loadQueue()),e._node.removeEventListener(r._canPlayEvent,e._loadFn,!1)},_endListener:function(){var e=this,t=e._parent;t._duration===1/0&&(t._duration=Math.ceil(10*e._node.duration)/10,t._sprite.__default[1]===1/0&&(t._sprite.__default[1]=1e3*t._duration),t._ended(e)),e._node.removeEventListener("ended",e._endFn,!1)}};var l={},h=function(e){var t=e._src;if(l[t])return e._duration=l[t].duration,void d(e);if(/^data:[^;]+;base64,/.test(t)){for(var i=atob(t.split(",")[1]),n=new Uint8Array(i.length),s=0;s<i.length;++s)n[s]=i.charCodeAt(s);c(n.buffer,e)}else{var r=new XMLHttpRequest;r.open(e._xhr.method,t,!0),r.withCredentials=e._xhr.withCredentials,r.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach(function(t){r.setRequestHeader(t,e._xhr.headers[t])}),r.onload=function(){var t=(r.status+"")[0];"0"===t||"2"===t||"3"===t?c(r.response,e):e._emit("loaderror",null,"Failed loading audio file with status: "+r.status+".")},r.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete l[t],e.load())},u(r)}},u=function(e){try{e.send()}catch(t){e.onerror()}},c=function(e,t){var i=function(){t._emit("loaderror",null,"Decoding audio data failed.")},n=function(e){e&&t._sounds.length>0?(l[t._src]=e,d(t,e)):i()};"undefined"!=typeof Promise&&1===r.ctx.decodeAudioData.length?r.ctx.decodeAudioData(e).then(n).catch(i):r.ctx.decodeAudioData(e,n,i)},d=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},p=function(){if(r.usingWebAudio){try{"undefined"!=typeof AudioContext?r.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?r.ctx=new webkitAudioContext:r.usingWebAudio=!1}catch(e){r.usingWebAudio=!1}r.ctx||(r.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(r._navigator&&r._navigator.platform),t=r._navigator&&r._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),i=t?parseInt(t[1],10):null;if(e&&i&&i<9){var n=/safari/.test(r._navigator&&r._navigator.userAgent.toLowerCase());r._navigator&&!n&&(r.usingWebAudio=!1)}r.usingWebAudio&&(r.masterGain=void 0===r.ctx.createGain?r.ctx.createGainNode():r.ctx.createGain(),r.masterGain.gain.setValueAtTime(r._muted?0:r._volume,r.ctx.currentTime),r.masterGain.connect(r.ctx.destination)),r._setup()}};void 0===(n=function(){return{Howler:r,Howl:a}}.apply(t,[]))||(e.exports=n),t.Howler=r,t.Howl=a,void 0!==i.g?(i.g.HowlerGlobal=s,i.g.Howler=r,i.g.Howl=a,i.g.Sound=o):"undefined"!=typeof window&&(window.HowlerGlobal=s,window.Howler=r,window.Howl=a,window.Sound=o)}(),function(){"use strict";var e;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var t=this;if(!t.ctx||!t.ctx.listener)return t;for(var i=t._howls.length-1;i>=0;i--)t._howls[i].stereo(e);return t},HowlerGlobal.prototype.pos=function(e,t,i){var n=this;return n.ctx&&n.ctx.listener?(t="number"!=typeof t?n._pos[1]:t,i="number"!=typeof i?n._pos[2]:i,"number"!=typeof e?n._pos:(n._pos=[e,t,i],void 0!==n.ctx.listener.positionX?(n.ctx.listener.positionX.setTargetAtTime(n._pos[0],Howler.ctx.currentTime,.1),n.ctx.listener.positionY.setTargetAtTime(n._pos[1],Howler.ctx.currentTime,.1),n.ctx.listener.positionZ.setTargetAtTime(n._pos[2],Howler.ctx.currentTime,.1)):n.ctx.listener.setPosition(n._pos[0],n._pos[1],n._pos[2]),n)):n},HowlerGlobal.prototype.orientation=function(e,t,i,n,s,r){var a=this;if(!a.ctx||!a.ctx.listener)return a;var o=a._orientation;return t="number"!=typeof t?o[1]:t,i="number"!=typeof i?o[2]:i,n="number"!=typeof n?o[3]:n,s="number"!=typeof s?o[4]:s,r="number"!=typeof r?o[5]:r,"number"!=typeof e?o:(a._orientation=[e,t,i,n,s,r],void 0!==a.ctx.listener.forwardX?(a.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),a.ctx.listener.forwardY.setTargetAtTime(t,Howler.ctx.currentTime,.1),a.ctx.listener.forwardZ.setTargetAtTime(i,Howler.ctx.currentTime,.1),a.ctx.listener.upX.setTargetAtTime(n,Howler.ctx.currentTime,.1),a.ctx.listener.upY.setTargetAtTime(s,Howler.ctx.currentTime,.1),a.ctx.listener.upZ.setTargetAtTime(r,Howler.ctx.currentTime,.1)):a.ctx.listener.setOrientation(e,t,i,n,s,r),a)},Howl.prototype.init=(e=Howl.prototype.init,function(t){var i=this;return i._orientation=t.orientation||[1,0,0],i._stereo=t.stereo||null,i._pos=t.pos||null,i._pannerAttr={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:360,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:360,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:0,distanceModel:void 0!==t.distanceModel?t.distanceModel:"inverse",maxDistance:void 0!==t.maxDistance?t.maxDistance:1e4,panningModel:void 0!==t.panningModel?t.panningModel:"HRTF",refDistance:void 0!==t.refDistance?t.refDistance:1,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:1},i._onstereo=t.onstereo?[{fn:t.onstereo}]:[],i._onpos=t.onpos?[{fn:t.onpos}]:[],i._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}),Howl.prototype.stereo=function(e,i){var n=this;if(!n._webAudio)return n;if("loaded"!==n._state)return n._queue.push({event:"stereo",action:function(){n.stereo(e,i)}}),n;var s=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===i){if("number"!=typeof e)return n._stereo;n._stereo=e,n._pos=[e,0,0]}for(var r=n._getSoundIds(i),a=0;a<r.length;a++){var o=n._soundById(r[a]);if(o){if("number"!=typeof e)return o._stereo;o._stereo=e,o._pos=[e,0,0],o._node&&(o._pannerAttr.panningModel="equalpower",o._panner&&o._panner.pan||t(o,s),"spatial"===s?void 0!==o._panner.positionX?(o._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),o._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),o._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):o._panner.setPosition(e,0,0):o._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),n._emit("stereo",o._id)}}return n},Howl.prototype.pos=function(e,i,n,s){var r=this;if(!r._webAudio)return r;if("loaded"!==r._state)return r._queue.push({event:"pos",action:function(){r.pos(e,i,n,s)}}),r;if(i="number"!=typeof i?0:i,n="number"!=typeof n?-.5:n,void 0===s){if("number"!=typeof e)return r._pos;r._pos=[e,i,n]}for(var a=r._getSoundIds(s),o=0;o<a.length;o++){var l=r._soundById(a[o]);if(l){if("number"!=typeof e)return l._pos;l._pos=[e,i,n],l._node&&(l._panner&&!l._panner.pan||t(l,"spatial"),void 0!==l._panner.positionX?(l._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),l._panner.positionY.setValueAtTime(i,Howler.ctx.currentTime),l._panner.positionZ.setValueAtTime(n,Howler.ctx.currentTime)):l._panner.setPosition(e,i,n)),r._emit("pos",l._id)}}return r},Howl.prototype.orientation=function(e,i,n,s){var r=this;if(!r._webAudio)return r;if("loaded"!==r._state)return r._queue.push({event:"orientation",action:function(){r.orientation(e,i,n,s)}}),r;if(i="number"!=typeof i?r._orientation[1]:i,n="number"!=typeof n?r._orientation[2]:n,void 0===s){if("number"!=typeof e)return r._orientation;r._orientation=[e,i,n]}for(var a=r._getSoundIds(s),o=0;o<a.length;o++){var l=r._soundById(a[o]);if(l){if("number"!=typeof e)return l._orientation;l._orientation=[e,i,n],l._node&&(l._panner||(l._pos||(l._pos=r._pos||[0,0,-.5]),t(l,"spatial")),void 0!==l._panner.orientationX?(l._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),l._panner.orientationY.setValueAtTime(i,Howler.ctx.currentTime),l._panner.orientationZ.setValueAtTime(n,Howler.ctx.currentTime)):l._panner.setOrientation(e,i,n)),r._emit("orientation",l._id)}}return r},Howl.prototype.pannerAttr=function(){var e,i,n,s=this,r=arguments;if(!s._webAudio)return s;if(0===r.length)return s._pannerAttr;if(1===r.length){if("object"!=typeof r[0])return(n=s._soundById(parseInt(r[0],10)))?n._pannerAttr:s._pannerAttr;e=r[0],void 0===i&&(e.pannerAttr||(e.pannerAttr={coneInnerAngle:e.coneInnerAngle,coneOuterAngle:e.coneOuterAngle,coneOuterGain:e.coneOuterGain,distanceModel:e.distanceModel,maxDistance:e.maxDistance,refDistance:e.refDistance,rolloffFactor:e.rolloffFactor,panningModel:e.panningModel}),s._pannerAttr={coneInnerAngle:void 0!==e.pannerAttr.coneInnerAngle?e.pannerAttr.coneInnerAngle:s._coneInnerAngle,coneOuterAngle:void 0!==e.pannerAttr.coneOuterAngle?e.pannerAttr.coneOuterAngle:s._coneOuterAngle,coneOuterGain:void 0!==e.pannerAttr.coneOuterGain?e.pannerAttr.coneOuterGain:s._coneOuterGain,distanceModel:void 0!==e.pannerAttr.distanceModel?e.pannerAttr.distanceModel:s._distanceModel,maxDistance:void 0!==e.pannerAttr.maxDistance?e.pannerAttr.maxDistance:s._maxDistance,refDistance:void 0!==e.pannerAttr.refDistance?e.pannerAttr.refDistance:s._refDistance,rolloffFactor:void 0!==e.pannerAttr.rolloffFactor?e.pannerAttr.rolloffFactor:s._rolloffFactor,panningModel:void 0!==e.pannerAttr.panningModel?e.pannerAttr.panningModel:s._panningModel})}else 2===r.length&&(e=r[0],i=parseInt(r[1],10));for(var a=s._getSoundIds(i),o=0;o<a.length;o++)if(n=s._soundById(a[o])){var l=n._pannerAttr;l={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:l.coneInnerAngle,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:l.coneOuterAngle,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:l.coneOuterGain,distanceModel:void 0!==e.distanceModel?e.distanceModel:l.distanceModel,maxDistance:void 0!==e.maxDistance?e.maxDistance:l.maxDistance,refDistance:void 0!==e.refDistance?e.refDistance:l.refDistance,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:l.rolloffFactor,panningModel:void 0!==e.panningModel?e.panningModel:l.panningModel};var h=n._panner;h||(n._pos||(n._pos=s._pos||[0,0,-.5]),t(n,"spatial"),h=n._panner),h.coneInnerAngle=l.coneInnerAngle,h.coneOuterAngle=l.coneOuterAngle,h.coneOuterGain=l.coneOuterGain,h.distanceModel=l.distanceModel,h.maxDistance=l.maxDistance,h.refDistance=l.refDistance,h.rolloffFactor=l.rolloffFactor,h.panningModel=l.panningModel}return s},Sound.prototype.init=function(e){return function(){var t=this,i=t._parent;t._orientation=i._orientation,t._stereo=i._stereo,t._pos=i._pos,t._pannerAttr=i._pannerAttr,e.call(this),t._stereo?i.stereo(t._stereo):t._pos&&i.pos(t._pos[0],t._pos[1],t._pos[2],t._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var t=this,i=t._parent;return t._orientation=i._orientation,t._stereo=i._stereo,t._pos=i._pos,t._pannerAttr=i._pannerAttr,t._stereo?i.stereo(t._stereo):t._pos?i.pos(t._pos[0],t._pos[1],t._pos[2],t._id):t._panner&&(t._panner.disconnect(0),t._panner=void 0,i._refreshBuffer(t)),e.call(this)}}(Sound.prototype.reset);var t=function(e,t){"spatial"===(t=t||"spatial")?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,void 0!==e._panner.positionX?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),void 0!==e._panner.orientationX?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}}()},4214:(e,t,i)=>{"use strict";i.d(t,{v:()=>_});var n=i(7747),s=i(2207),r=i(4057),a=i(5553),o=i(9550);let l=null,h=null;function u(e,t,i){for(let n=0,s=4*i*t;n<t;++n,s+=4)if(0!==e[s+3])return!1;return!0}function c(e,t,i,n,s){const r=4*t;for(let t=n,a=n*r+4*i;t<=s;++t,a+=r)if(0!==e[a+3])return!1;return!0}function d(...e){let t=e[0];t.canvas||(t={canvas:e[0],resolution:e[1]});const{canvas:i}=t,n=Math.min(t.resolution??1,1),r=t.width??i.width,d=t.height??i.height;let p=t.output;if(function(e,t){l||(l=a.e.get().createCanvas(256,128),h=l.getContext("2d",{willReadFrequently:!0}),h.globalCompositeOperation="copy",h.globalAlpha=1),(l.width<e||l.height<t)&&(l.width=(0,o.U5)(e),l.height=(0,o.U5)(t))}(r,d),!h)throw new TypeError("Failed to get canvas 2D context");h.drawImage(i,0,0,r,d,0,0,r*n,d*n);const f=h.getImageData(0,0,r,d).data;let g=0,m=0,_=r-1,v=d-1;for(;m<d&&u(f,r,m);)++m;if(m===d)return s.M.EMPTY;for(;u(f,r,v);)--v;for(;c(f,r,g,m,v);)++g;for(;c(f,r,_,m,v);)--_;return++_,++v,h.globalCompositeOperation="source-over",h.strokeRect(g,m,_-g,v-m),h.globalCompositeOperation="copy",p??(p=new s.M),p.set(g/n,m/n,(_-g)/n,(v-m)/n),p}var p=i(8593),f=i(4588),g=i(6447);const m=new s.M;const _=new class{getCanvasAndContext(e){const{text:t,style:i,resolution:n=1}=e,s=i._getFinalPadding(),a=p.P.measureText(t||" ",i),o=Math.ceil(Math.ceil(Math.max(1,a.width)+2*s)*n),l=Math.ceil(Math.ceil(Math.max(1,a.height)+2*s)*n),h=r.N.getOptimalCanvasAndContext(o,l);this._renderTextToCanvas(t,i,s,n,h);return{canvasAndContext:h,frame:i.trim?d({canvas:h.canvas,width:o,height:l,resolution:1,output:m}):m.set(0,0,o,l)}}returnCanvasAndContext(e){r.N.returnCanvasAndContext(e)}_renderTextToCanvas(e,t,i,s,r){const{canvas:a,context:o}=r,l=(0,f.Z)(t),h=p.P.measureText(e||" ",t),u=h.lines,c=h.lineHeight,d=h.lineWidths,m=h.maxLineWidth,_=h.fontProperties,v=a.height;if(o.resetTransform(),o.scale(s,s),o.textBaseline=t.textBaseline,t._stroke?.width){const e=t._stroke;o.lineWidth=e.width,o.miterLimit=e.miterLimit,o.lineJoin=e.join,o.lineCap=e.cap}let y,b;o.font=l;const x=t.dropShadow?2:1;for(let e=0;e<x;++e){const a=t.dropShadow&&0===e,l=a?Math.ceil(Math.max(1,v)+2*i):0,p=l*s;if(a){o.fillStyle="black",o.strokeStyle="black";const e=t.dropShadow,i=e.color,r=e.alpha;o.shadowColor=n.Q.shared.setValue(i).setAlpha(r).toRgbaString();const a=e.blur*s,l=e.distance*s;o.shadowBlur=a,o.shadowOffsetX=Math.cos(e.angle)*l,o.shadowOffsetY=Math.sin(e.angle)*l+p}else{if(o.fillStyle=t._fill?(0,g.r)(t._fill,o,h,2*i):null,t._stroke?.width){const e=.5*t._stroke.width+2*i;o.strokeStyle=(0,g.r)(t._stroke,o,h,e)}o.shadowColor="black"}let f=(c-_.fontSize)/2;c-_.fontSize<0&&(f=0);const x=t._stroke?.width??0;for(let e=0;e<u.length;e++)y=x/2,b=x/2+e*c+_.ascent+f,"right"===t.align?y+=m-d[e]:"center"===t.align&&(y+=(m-d[e])/2),t._stroke?.width&&this._drawLetterSpacing(u[e],t,r,y+i,b+i-l,!0),void 0!==t._fill&&this._drawLetterSpacing(u[e],t,r,y+i,b+i-l)}}_drawLetterSpacing(e,t,i,n,s,r=!1){const{context:a}=i,o=t.letterSpacing;let l=!1;if(p.P.experimentalLetterSpacingSupported&&(p.P.experimentalLetterSpacing?(a.letterSpacing=`${o}px`,a.textLetterSpacing=`${o}px`,l=!0):(a.letterSpacing="0px",a.textLetterSpacing="0px")),0===o||l)return void(r?a.strokeText(e,n,s):a.fillText(e,n,s));let h=n;const u=p.P.graphemeSegmenter(e);let c=a.measureText(e).width,d=0;for(let e=0;e<u.length;++e){const t=u[e];r?a.strokeText(t,h,s):a.fillText(t,h,s);let i="";for(let t=e+1;t<u.length;++t)i+=u[t];d=a.measureText(i).width,h+=c-d+o,c=d}}}},4255:(e,t,i)=>{"use strict";i.d(t,{G:()=>a});var n=i(6680),s=i(7605);const r=new n.u;class a{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.renderable&&this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const e=this.baseColor,t=e>>16|65280&e|(255&e)<<16,i=this.renderable;return i?(0,s.u)(t,i.groupColor)+(this.alpha*i.groupAlpha*255<<24):t+(255*this.alpha<<24)}get transform(){return this.renderable?.groupTransform||r}copyTo(e){e.indexOffset=this.indexOffset,e.indexSize=this.indexSize,e.attributeOffset=this.attributeOffset,e.attributeSize=this.attributeSize,e.baseColor=this.baseColor,e.alpha=this.alpha,e.texture=this.texture,e.geometryData=this.geometryData,e.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}destroy(){this.renderable=null,this.texture=null,this.geometryData=null,this._batcher=null,this._batch=null}}},4303:(e,t,i)=>{"use strict";i.d(t,{Ek:()=>r,lj:()=>s,t6:()=>o});const n=new Set,s="8.0.0",r="8.3.4",a={quiet:!1,noColor:!1},o=(e,t,i=3)=>{if(a.quiet||n.has(t))return;let s=(new Error).stack;const r=`${t}\nDeprecated since v${e}`,o="function"==typeof console.groupCollapsed&&!a.noColor;void 0===s?console.warn("PixiJS Deprecation Warning: ",r):(s=s.split("\n").splice(i).join("\n"),o?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",r),console.warn(s),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",r),console.warn(s))),n.add(t)};Object.defineProperties(o,{quiet:{get:()=>a.quiet,set:e=>{a.quiet=e},enumerable:!0,configurable:!1},noColor:{get:()=>a.noColor,set:e=>{a.noColor=e},enumerable:!0,configurable:!1}})},4377:(e,t,i)=>{"use strict";i.d(t,{M:()=>r});var n=i(1862);const s=new(i(3289).c);function r(e,t,i,r){const a=s;a.minX=0,a.minY=0,a.maxX=e.width/r|0,a.maxY=e.height/r|0;const o=n.W.getOptimalTexture(a.width,a.height,r,!1);return o.source.uploadMethodId="image",o.source.resource=e,o.source.alphaMode="premultiply-alpha-on-upload",o.frame.width=t/r,o.frame.height=i/r,o.source.emit("update",o.source),o.updateUvs(),o}},4490:(e,t,i)=>{"use strict";i.d(t,{j:()=>r});var n=i(7605);const s=16777215;function r(e,t){return e===s?t:t===s?e:(0,n.u)(e,t)}},4541:(e,t,i)=>{"use strict";t.__esModule=!0,function(e){for(var i in e)t.hasOwnProperty(i)||(t[i]=e[i])}(i(2291));var n=i(2291);t.default=n.default},4588:(e,t,i)=>{"use strict";i.d(t,{Z:()=>s});const n=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function s(e){const t="number"==typeof e.fontSize?`${e.fontSize}px`:e.fontSize;let i=e.fontFamily;Array.isArray(e.fontFamily)||(i=e.fontFamily.split(","));for(let e=i.length-1;e>=0;e--){let t=i[e].trim();/([\"\'])[^\'\"]+\1/.test(t)||n.includes(t)||(t=`"${t}"`),i[e]=t}return`${e.fontStyle} ${e.fontVariant} ${e.fontWeight} ${t} ${i.join(",")}`}},4753:(e,t,i)=>{"use strict";i.d(t,{u:()=>n});class n{constructor(e){"number"==typeof e?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this.uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${e} isn't a valid view type`)}}}},4767:(e,t,i)=>{"use strict";var n=i(8602),s=i(1002),r=i(1891),a=i(4036),o=i(8192),l=i(7384),h=i(2207),u=i(5884);const c=class e{constructor(e,t){this.linkedSheets=[];let i=e;e?.source instanceof u.v&&(i={texture:e,data:t});const{texture:n,data:s,cachePrefix:r=""}=i;this.cachePrefix=r,this._texture=n instanceof o.g?n:null,this.textureSource=n.source,this.textures={},this.animations={},this.data=s;const a=parseFloat(s.meta.scale);a?(this.resolution=a,n.source.resolution=this.resolution):this.resolution=n.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=e.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(t){let i=t;const n=e.BATCH_SIZE;for(;i-t<n&&i<this._frameKeys.length;){const e=this._frameKeys[i],t=this._frames[e],n=t.frame;if(n){let i=null,s=null;const r=!1!==t.trimmed&&t.sourceSize?t.sourceSize:t.frame,a=new h.M(0,0,Math.floor(r.w)/this.resolution,Math.floor(r.h)/this.resolution);i=t.rotated?new h.M(Math.floor(n.x)/this.resolution,Math.floor(n.y)/this.resolution,Math.floor(n.h)/this.resolution,Math.floor(n.w)/this.resolution):new h.M(Math.floor(n.x)/this.resolution,Math.floor(n.y)/this.resolution,Math.floor(n.w)/this.resolution,Math.floor(n.h)/this.resolution),!1!==t.trimmed&&t.spriteSourceSize&&(s=new h.M(Math.floor(t.spriteSourceSize.x)/this.resolution,Math.floor(t.spriteSourceSize.y)/this.resolution,Math.floor(n.w)/this.resolution,Math.floor(n.h)/this.resolution)),this.textures[e]=new o.g({source:this.textureSource,frame:i,orig:a,trim:s,rotate:t.rotated?2:0,defaultAnchor:t.anchor,defaultBorders:t.borders,label:e.toString()})}i++}}_processAnimations(){const e=this.data.animations||{};for(const t in e){this.animations[t]=[];for(let i=0;i<e[t].length;i++){const n=e[t][i];this.animations[t].push(this.textures[n])}}}_parseComplete(){const e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*e.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*e.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){for(const e in this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&(this._texture?.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};c.BATCH_SIZE=1e3;let d=c;const p=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function f(e,t,i){const n={};if(e.forEach(e=>{n[e]=t}),Object.keys(t.textures).forEach(e=>{n[`${t.cachePrefix}${e}`]=t.textures[e]}),!i){const i=l.A.dirname(e[0]);t.linkedSheets.forEach((e,s)=>{const r=f([`${i}/${t.data.meta.related_multi_packs[s]}`],e,!0);Object.assign(n,r)})}return n}const g={extension:n.Ag.Asset,cache:{test:e=>e instanceof d,getCacheableAssets:(e,t)=>f(e,t,!1)},resolver:{extension:{type:n.Ag.ResolveParser,name:"resolveSpritesheet"},test:e=>{const t=e.split("?")[0].split("."),i=t.pop(),n=t.pop();return"json"===i&&p.includes(n)},parse:e=>{const t=e.split(".");return{resolution:parseFloat(r.x.RETINA_PREFIX.exec(e)?.[1]??"1"),format:t[t.length-2],src:e}}},loader:{name:"spritesheetLoader",id:"spritesheet",extension:{type:n.Ag.LoadParser,priority:s.T.Normal,name:"spritesheetLoader"},testParse:async(e,t)=>".json"===l.A.extname(t.src).toLowerCase()&&!!e.frames,async parse(e,t,i){const{texture:n,imageFilename:s,textureOptions:r,cachePrefix:h}=t?.data??{};let u,c=l.A.dirname(t.src);if(c&&c.lastIndexOf("/")!==c.length-1&&(c+="/"),n instanceof o.g)u=n;else{const n=(0,a.Y)(c+(s??e.meta.image),t.src);u=(await i.load([{src:n,data:r}]))[n]}const p=new d({texture:u.source,data:e,cachePrefix:h});await p.parse();const f=e?.meta?.related_multi_packs;if(Array.isArray(f)){const e=[];for(const n of f){if("string"!=typeof n)continue;let s=c+n;t.data?.ignoreMultiPack||(s=(0,a.Y)(s,t.src),e.push(i.load({src:s,data:{textureOptions:r,ignoreMultiPack:!0}})))}const n=await Promise.all(e);p.linkedSheets=n,n.forEach(e=>{e.linkedSheets=[p].concat(p.linkedSheets.filter(t=>t!==e))})}return p},async unload(e,t,i){await i.unload(e.textureSource._sourceOrigin),e.destroy(!1)}}};n.XO.add(g)},4984:(e,t,i)=>{"use strict";i.d(t,{x:()=>p});var n=i(2551),s=i(7747),r=i(198),a=i(4303),o=i(9731),l=i(8457),h=i(3989),u=i(7867),c=i(6371);const d=class e extends n.A{constructor(t={}){super(),this.uid=(0,r.L)("textStyle"),this._tick=0,function(e){const t=e;if("boolean"==typeof t.dropShadow&&t.dropShadow){const i=p.defaultDropShadow;e.dropShadow={alpha:t.dropShadowAlpha??i.alpha,angle:t.dropShadowAngle??i.angle,blur:t.dropShadowBlur??i.blur,color:t.dropShadowColor??i.color,distance:t.dropShadowDistance??i.distance}}if(void 0!==t.strokeThickness){(0,a.t6)(a.lj,"strokeThickness is now a part of stroke");const i=t.stroke;let n={};if(s.Q.isColorLike(i))n.color=i;else if(i instanceof l._||i instanceof h.m)n.fill=i;else{if(!Object.hasOwnProperty.call(i,"color")&&!Object.hasOwnProperty.call(i,"fill"))throw new Error("Invalid stroke value.");n=i}e.stroke={...n,width:t.strokeThickness}}if(Array.isArray(t.fillGradientStops)){if((0,a.t6)(a.lj,"gradient fill is now a fill pattern: `new FillGradient(...)`"),!Array.isArray(t.fill)||0===t.fill.length)throw new Error("Invalid fill value. Expected an array of colors for gradient fill.");t.fill.length!==t.fillGradientStops.length&&(0,o.R)("The number of fill colors must match the number of fill gradient stops.");const i=new l._({start:{x:0,y:0},end:{x:0,y:1},textureSpace:"local"}),n=t.fillGradientStops.slice(),r=t.fill.map(e=>s.Q.shared.setValue(e).toNumber());n.forEach((e,t)=>{i.addColorStop(e,r[t])}),e.fill={fill:i}}}(t);const i={...e.defaultTextStyle,...t};for(const e in i){this[e]=i[e]}this.update(),this._tick=0}get align(){return this._align}set align(e){this._align=e,this.update()}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords=e,this.update()}get dropShadow(){return this._dropShadow}set dropShadow(t){this._dropShadow=null!==t&&"object"==typeof t?this._createProxy({...e.defaultDropShadow,...t}):t?this._createProxy({...e.defaultDropShadow}):null,this.update()}get fontFamily(){return this._fontFamily}set fontFamily(e){this._fontFamily=e,this.update()}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize="string"==typeof e?parseInt(e,10):e,this.update()}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle=e.toLowerCase(),this.update()}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant=e,this.update()}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight=e,this.update()}get leading(){return this._leading}set leading(e){this._leading=e,this.update()}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing=e,this.update()}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight=e,this.update()}get padding(){return this._padding}set padding(e){this._padding=e,this.update()}get filters(){return this._filters}set filters(e){this._filters=Object.freeze(e),this.update()}get trim(){return this._trim}set trim(e){this._trim=e,this.update()}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline=e,this.update()}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace=e,this.update()}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap=e,this.update()}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth=e,this.update()}get fill(){return this._originalFill}set fill(e){e!==this._originalFill&&(this._originalFill=e,this._isFillStyle(e)&&(this._originalFill=this._createProxy({...u.T.defaultFillStyle,...e},()=>{this._fill=(0,c.w)({...this._originalFill},u.T.defaultFillStyle)})),this._fill=(0,c.w)(0===e?"black":e,u.T.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(e){e!==this._originalStroke&&(this._originalStroke=e,this._isFillStyle(e)&&(this._originalStroke=this._createProxy({...u.T.defaultStrokeStyle,...e},()=>{this._stroke=(0,c.T)({...this._originalStroke},u.T.defaultStrokeStyle)})),this._stroke=(0,c.T)(e,u.T.defaultStrokeStyle),this.update())}update(){this._tick++,this.emit("update",this)}reset(){const t=e.defaultTextStyle;for(const e in t)this[e]=t[e]}get styleKey(){return`${this.uid}-${this._tick}`}clone(){return new e({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth,filters:this._filters?[...this._filters]:void 0})}_getFinalPadding(){let e=0;if(this._filters)for(let t=0;t<this._filters.length;t++)e+=this._filters[t].padding;return Math.max(this._padding,e)}destroy(e=!1){this.removeAllListeners();if("boolean"==typeof e?e:e?.texture){const t="boolean"==typeof e?e:e?.textureSource;this._fill?.texture&&this._fill.texture.destroy(t),this._originalFill?.texture&&this._originalFill.texture.destroy(t),this._stroke?.texture&&this._stroke.texture.destroy(t),this._originalStroke?.texture&&this._originalStroke.texture.destroy(t)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(e,t){return new Proxy(e,{set:(e,i,n)=>(e[i]=n,t?.(i,n),this.update(),!0)})}_isFillStyle(e){return null!==(e??null)&&!(s.Q.isColorLike(e)||e instanceof l._||e instanceof h.m)}};d.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5},d.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let p=d},5148:(e,t,i)=>{"use strict";i.d(t,{Z:()=>r});var n=i(9298);class s{constructor(e,t){this._pool=[],this._count=0,this._index=0,this._classType=e,t&&this.prepopulate(t)}prepopulate(e){for(let t=0;t<e;t++)this._pool[this._index++]=new this._classType;this._count+=e}get(e){let t;return t=this._index>0?this._pool[--this._index]:new this._classType,t.init?.(e),t}return(e){e.reset?.(),this._pool[this._index++]=e}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){if(this._pool.length>0&&this._pool[0].destroy)for(let e=0;e<this._index;e++)this._pool[e].destroy();this._pool.length=0,this._count=0,this._index=0}}const r=new class{constructor(){this._poolsByClass=new Map}prepopulate(e,t){this.getPool(e).prepopulate(t)}get(e,t){return this.getPool(e).get(t)}return(e){this.getPool(e.constructor).return(e)}getPool(e){return this._poolsByClass.has(e)||this._poolsByClass.set(e,new s(e)),this._poolsByClass.get(e)}stats(){const e={};return this._poolsByClass.forEach(t=>{const i=e[t._classType.name]?t._classType.name+t._classType.ID:t._classType.name;e[i]={free:t.totalFree,used:t.totalUsed,size:t.totalSize}}),e}clear(){this._poolsByClass.forEach(e=>e.clear()),this._poolsByClass.clear()}};n.L.register(r)},5178:(e,t,i)=>{"use strict";i.d(t,{V:()=>h});var n=i(2551),s=i(3289),r=i(198),a=i(5662),o=i(2409);function l(e,t){if(!(e instanceof a.h)){let i=t?o.S.INDEX:o.S.VERTEX;e instanceof Array&&(t?(e=new Uint32Array(e),i=o.S.INDEX|o.S.COPY_DST):(e=new Float32Array(e),i=o.S.VERTEX|o.S.COPY_DST)),e=new a.h({data:e,label:t?"index-mesh-buffer":"vertex-mesh-buffer",usage:i})}return e}class h extends n.A{constructor(e={}){super(),this.uid=(0,r.L)("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new s.c,this._boundsDirty=!0;const{attributes:t,indexBuffer:i,topology:n}=e;if(this.buffers=[],this.attributes={},t)for(const e in t)this.addAttribute(e,t[e]);this.instanceCount=e.instanceCount??1,i&&this.addIndex(i),this.topology=n||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(e){return this.attributes[e]}getIndex(){return this.indexBuffer}getBuffer(e){return this.getAttribute(e).buffer}getSize(){for(const e in this.attributes){const t=this.attributes[e];return t.buffer.data.length/(t.stride/4||t.size)}return 0}addAttribute(e,t){const i=function(e){return(e instanceof a.h||Array.isArray(e)||e.BYTES_PER_ELEMENT)&&(e={buffer:e}),e.buffer=l(e.buffer,!1),e}(t);-1===this.buffers.indexOf(i.buffer)&&(this.buffers.push(i.buffer),i.buffer.on("update",this.onBufferUpdate,this),i.buffer.on("change",this.onBufferUpdate,this)),this.attributes[e]=i}addIndex(e){this.indexBuffer=l(e,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,function(e,t,i){const n=e.getAttribute(t);if(!n)return i.minX=0,i.minY=0,i.maxX=0,i.maxY=0,i;const s=n.buffer.data;let r=1/0,a=1/0,o=-1/0,l=-1/0;const h=s.BYTES_PER_ELEMENT,u=(n.offset||0)/h,c=(n.stride||8)/h;for(let e=u;e<s.length;e+=c){const t=s[e],i=s[e+1];t>o&&(o=t),i>l&&(l=i),t<r&&(r=t),i<a&&(a=i)}return i.minX=r,i.minY=a,i.maxX=o,i.maxY=l,i}(this,"aPosition",this._bounds)):this._bounds}destroy(e=!1){this.emit("destroy",this),this.removeAllListeners(),e&&this.buffers.forEach(e=>e.destroy()),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}},5231:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var n=i(4303),s=i(822),r=i(7867);class a extends s.l{constructor(e){e instanceof r.T&&(e={context:e});const{context:t,roundPixels:i,...n}=e||{};super({label:"Graphics",...n}),this.renderPipeId="graphics",this._context=t||(this._ownedContext=new r.T),this._context.on("update",this.onViewUpdate,this),this.didViewUpdate=!0,this.allowChildren=!1,this.roundPixels=i??!1}set context(e){e!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=e,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}updateBounds(){}containsPoint(e){return this._context.containsPoint(e)}destroy(e){this._ownedContext&&!e?this._ownedContext.destroy(e):!0!==e&&!0!==e?.context||this._context.destroy(e),this._ownedContext=null,this._context=null,super.destroy(e)}_callContextMethod(e,t){return this.context[e](...t),this}setFillStyle(...e){return this._callContextMethod("setFillStyle",e)}setStrokeStyle(...e){return this._callContextMethod("setStrokeStyle",e)}fill(...e){return this._callContextMethod("fill",e)}stroke(...e){return this._callContextMethod("stroke",e)}texture(...e){return this._callContextMethod("texture",e)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...e){return this._callContextMethod("arc",e)}arcTo(...e){return this._callContextMethod("arcTo",e)}arcToSvg(...e){return this._callContextMethod("arcToSvg",e)}bezierCurveTo(...e){return this._callContextMethod("bezierCurveTo",e)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...e){return this._callContextMethod("ellipse",e)}circle(...e){return this._callContextMethod("circle",e)}path(...e){return this._callContextMethod("path",e)}lineTo(...e){return this._callContextMethod("lineTo",e)}moveTo(...e){return this._callContextMethod("moveTo",e)}quadraticCurveTo(...e){return this._callContextMethod("quadraticCurveTo",e)}rect(...e){return this._callContextMethod("rect",e)}roundRect(...e){return this._callContextMethod("roundRect",e)}poly(...e){return this._callContextMethod("poly",e)}regularPoly(...e){return this._callContextMethod("regularPoly",e)}roundPoly(...e){return this._callContextMethod("roundPoly",e)}roundShape(...e){return this._callContextMethod("roundShape",e)}filletRect(...e){return this._callContextMethod("filletRect",e)}chamferRect(...e){return this._callContextMethod("chamferRect",e)}star(...e){return this._callContextMethod("star",e)}svg(...e){return this._callContextMethod("svg",e)}restore(...e){return this._callContextMethod("restore",e)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...e){return this._callContextMethod("rotate",e)}scaleTransform(...e){return this._callContextMethod("scale",e)}setTransform(...e){return this._callContextMethod("setTransform",e)}transform(...e){return this._callContextMethod("transform",e)}translateTransform(...e){return this._callContextMethod("translate",e)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(e){this._context.fillStyle=e}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(e){this._context.strokeStyle=e}clone(e=!1){if(e)return new a(this._context.clone());this._ownedContext=null;return new a(this._context)}lineStyle(e,t,i){(0,n.t6)(n.lj,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const s={};return e&&(s.width=e),t&&(s.color=t),i&&(s.alpha=i),this.context.strokeStyle=s,this}beginFill(e,t){(0,n.t6)(n.lj,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const i={};return void 0!==e&&(i.color=e),void 0!==t&&(i.alpha=t),this.context.fillStyle=i,this}endFill(){(0,n.t6)(n.lj,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const e=this.context.strokeStyle;return e.width===r.T.defaultStrokeStyle.width&&e.color===r.T.defaultStrokeStyle.color&&e.alpha===r.T.defaultStrokeStyle.alpha||this.context.stroke(),this}drawCircle(...e){return(0,n.t6)(n.lj,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",e)}drawEllipse(...e){return(0,n.t6)(n.lj,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",e)}drawPolygon(...e){return(0,n.t6)(n.lj,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",e)}drawRect(...e){return(0,n.t6)(n.lj,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",e)}drawRoundedRect(...e){return(0,n.t6)(n.lj,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",e)}drawStar(...e){return(0,n.t6)(n.lj,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",e)}}},5337:(e,t,i)=>{"use strict";i.d(t,{k:()=>l});var n=i(7313),s=i(8192),r=i(7025),a=i(4303),o=i(822);class l extends o.l{constructor(e=s.g.EMPTY){e instanceof s.g&&(e={texture:e});const{texture:t=s.g.EMPTY,anchor:i,roundPixels:r,width:a,height:o,...l}=e;super({label:"Sprite",...l}),this.renderPipeId="sprite",this.batched=!0,this._visualBounds={minX:0,maxX:1,minY:0,maxY:0},this._anchor=new n.o({_onUpdate:()=>{this.onViewUpdate()}}),i?this.anchor=i:t.defaultAnchor&&(this.anchor=t.defaultAnchor),this.texture=t,this.allowChildren=!1,this.roundPixels=r??!1,void 0!==a&&(this.width=a),void 0!==o&&(this.height=o)}static from(e,t=!1){return e instanceof s.g?new l(e):new l(s.g.from(e,t))}set texture(e){e||(e=s.g.EMPTY);const t=this._texture;t!==e&&(t&&t.dynamic&&t.off("update",this.onViewUpdate,this),e.dynamic&&e.on("update",this.onViewUpdate,this),this._texture=e,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get visualBounds(){return(0,r.y)(this._visualBounds,this._anchor,this._texture),this._visualBounds}get sourceBounds(){return(0,a.t6)("8.6.1","Sprite.sourceBounds is deprecated, use visualBounds instead."),this.visualBounds}updateBounds(){const e=this._anchor,t=this._texture,i=this._bounds,{width:n,height:s}=t.orig;i.minX=-e._x*n,i.maxX=i.minX+n,i.minY=-e._y*s,i.maxY=i.minY+s}destroy(e=!1){super.destroy(e);if("boolean"==typeof e?e:e?.texture){const t="boolean"==typeof e?e:e?.textureSource;this._texture.destroy(t)}this._texture=null,this._visualBounds=null,this._bounds=null,this._anchor=null,this._gpuData=null}get anchor(){return this._anchor}set anchor(e){"number"==typeof e?this._anchor.set(e):this._anchor.copyFrom(e)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this._setWidth(e,this._texture.orig.width),this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this._setHeight(e,this._texture.orig.height),this._height=e}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this._texture.orig.width,e.height=Math.abs(this.scale.y)*this._texture.orig.height,e}setSize(e,t){"object"==typeof e?(t=e.height??e.width,e=e.width):t??(t=e),void 0!==e&&this._setWidth(e,this._texture.orig.width),void 0!==t&&this._setHeight(t,this._texture.orig.height)}}},5371:(e,t,i)=>{var n;!function(){function s(e,t,i){return e.call.apply(e.bind,arguments)}function r(e,t,i){if(!e)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,n),e.apply(t,i)}}return function(){return e.apply(t,arguments)}}function a(e,t,i){return(a=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?s:r).apply(null,arguments)}var o=Date.now||function(){return+new Date};function l(e,t){this.a=e,this.o=t||e,this.c=this.o.document}var h=!!window.FontFace;function u(e,t,i,n){if(t=e.c.createElement(t),i)for(var s in i)i.hasOwnProperty(s)&&("style"==s?t.style.cssText=i[s]:t.setAttribute(s,i[s]));return n&&t.appendChild(e.c.createTextNode(n)),t}function c(e,t,i){(e=e.c.getElementsByTagName(t)[0])||(e=document.documentElement),e.insertBefore(i,e.lastChild)}function d(e){e.parentNode&&e.parentNode.removeChild(e)}function p(e,t,i){t=t||[],i=i||[];for(var n=e.className.split(/\s+/),s=0;s<t.length;s+=1){for(var r=!1,a=0;a<n.length;a+=1)if(t[s]===n[a]){r=!0;break}r||n.push(t[s])}for(t=[],s=0;s<n.length;s+=1){for(r=!1,a=0;a<i.length;a+=1)if(n[s]===i[a]){r=!0;break}r||t.push(n[s])}e.className=t.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function f(e,t){for(var i=e.className.split(/\s+/),n=0,s=i.length;n<s;n++)if(i[n]==t)return!0;return!1}function g(e,t,i){function n(){o&&s&&r&&(o(a),o=null)}t=u(e,"link",{rel:"stylesheet",href:t,media:"all"});var s=!1,r=!0,a=null,o=i||null;h?(t.onload=function(){s=!0,n()},t.onerror=function(){s=!0,a=Error("Stylesheet failed to load"),n()}):setTimeout(function(){s=!0,n()},0),c(e,"head",t)}function m(e,t,i,n){var s=e.c.getElementsByTagName("head")[0];if(s){var r=u(e,"script",{src:t}),a=!1;return r.onload=r.onreadystatechange=function(){a||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(a=!0,i&&i(null),r.onload=r.onreadystatechange=null,"HEAD"==r.parentNode.tagName&&s.removeChild(r))},s.appendChild(r),setTimeout(function(){a||(a=!0,i&&i(Error("Script load timeout")))},n||5e3),r}return null}function _(){this.a=0,this.c=null}function v(e){return e.a++,function(){e.a--,b(e)}}function y(e,t){e.c=t,b(e)}function b(e){0==e.a&&e.c&&(e.c(),e.c=null)}function x(e){this.a=e||"-"}function T(e,t){this.c=e,this.f=4,this.a="n";var i=(t||"n4").match(/^([nio])([1-9])$/i);i&&(this.a=i[1],this.f=parseInt(i[2],10))}function S(e){var t=[];e=e.split(/,\s*/);for(var i=0;i<e.length;i++){var n=e[i].replace(/['"]/g,"");-1!=n.indexOf(" ")||/^\d/.test(n)?t.push("'"+n+"'"):t.push(n)}return t.join(",")}function A(e){return e.a+e.f}function E(e){var t="normal";return"o"===e.a?t="oblique":"i"===e.a&&(t="italic"),t}function C(e){var t=4,i="n",n=null;return e&&((n=e.match(/(normal|oblique|italic)/i))&&n[1]&&(i=n[1].substr(0,1).toLowerCase()),(n=e.match(/([1-9]00|normal|bold)/i))&&n[1]&&(/bold/i.test(n[1])?t=7:/[1-9]00/.test(n[1])&&(t=parseInt(n[1].substr(0,1),10)))),i+t}function w(e,t){this.c=e,this.f=e.o.document.documentElement,this.h=t,this.a=new x("-"),this.j=!1!==t.events,this.g=!1!==t.classes}function P(e){if(e.g){var t=f(e.f,e.a.c("wf","active")),i=[],n=[e.a.c("wf","loading")];t||i.push(e.a.c("wf","inactive")),p(e.f,i,n)}I(e,"inactive")}function I(e,t,i){e.j&&e.h[t]&&(i?e.h[t](i.c,A(i)):e.h[t]())}function M(){this.c={}}function R(e,t){this.c=e,this.f=t,this.a=u(this.c,"span",{"aria-hidden":"true"},this.f)}function L(e){c(e.c,"body",e.a)}function k(e){return"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+S(e.c)+";font-style:"+E(e)+";font-weight:"+e.f+"00;"}function D(e,t,i,n,s,r){this.g=e,this.j=t,this.a=n,this.c=i,this.f=s||3e3,this.h=r||void 0}function O(e,t,i,n,s,r,a){this.v=e,this.B=t,this.c=i,this.a=n,this.s=a||"BESbswy",this.f={},this.w=s||3e3,this.u=r||null,this.m=this.j=this.h=this.g=null,this.g=new R(this.c,this.s),this.h=new R(this.c,this.s),this.j=new R(this.c,this.s),this.m=new R(this.c,this.s),e=k(e=new T(this.a.c+",serif",A(this.a))),this.g.a.style.cssText=e,e=k(e=new T(this.a.c+",sans-serif",A(this.a))),this.h.a.style.cssText=e,e=k(e=new T("serif",A(this.a))),this.j.a.style.cssText=e,e=k(e=new T("sans-serif",A(this.a))),this.m.a.style.cssText=e,L(this.g),L(this.h),L(this.j),L(this.m)}x.prototype.c=function(e){for(var t=[],i=0;i<arguments.length;i++)t.push(arguments[i].replace(/[\W_]+/g,"").toLowerCase());return t.join(this.a)},D.prototype.start=function(){var e=this.c.o.document,t=this,i=o(),n=new Promise(function(n,s){!function r(){o()-i>=t.f?s():e.fonts.load(function(e){return E(e)+" "+e.f+"00 300px "+S(e.c)}(t.a),t.h).then(function(e){1<=e.length?n():setTimeout(r,25)},function(){s()})}()}),s=null,r=new Promise(function(e,i){s=setTimeout(i,t.f)});Promise.race([r,n]).then(function(){s&&(clearTimeout(s),s=null),t.g(t.a)},function(){t.j(t.a)})};var B={D:"serif",C:"sans-serif"},G=null;function F(){if(null===G){var e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent);G=!!e&&(536>parseInt(e[1],10)||536===parseInt(e[1],10)&&11>=parseInt(e[2],10))}return G}function U(e,t,i){for(var n in B)if(B.hasOwnProperty(n)&&t===e.f[B[n]]&&i===e.f[B[n]])return!0;return!1}function N(e){var t,i=e.g.a.offsetWidth,n=e.h.a.offsetWidth;(t=i===e.f.serif&&n===e.f["sans-serif"])||(t=F()&&U(e,i,n)),t?o()-e.A>=e.w?F()&&U(e,i,n)&&(null===e.u||e.u.hasOwnProperty(e.a.c))?z(e,e.v):z(e,e.B):function(e){setTimeout(a(function(){N(this)},e),50)}(e):z(e,e.v)}function z(e,t){setTimeout(a(function(){d(this.g.a),d(this.h.a),d(this.j.a),d(this.m.a),t(this.a)},e),0)}function H(e,t,i){this.c=e,this.a=t,this.f=0,this.m=this.j=!1,this.s=i}O.prototype.start=function(){this.f.serif=this.j.a.offsetWidth,this.f["sans-serif"]=this.m.a.offsetWidth,this.A=o(),N(this)};var V=null;function W(e){0==--e.f&&e.j&&(e.m?((e=e.a).g&&p(e.f,[e.a.c("wf","active")],[e.a.c("wf","loading"),e.a.c("wf","inactive")]),I(e,"active")):P(e.a))}function j(e){this.j=e,this.a=new M,this.h=0,this.f=this.g=!0}function X(e,t,i,n,s){var r=0==--e.h;(e.f||e.g)&&setTimeout(function(){var e=s||null,o=n||{};if(0===i.length&&r)P(t.a);else{t.f+=i.length,r&&(t.j=r);var l,h=[];for(l=0;l<i.length;l++){var u=i[l],c=o[u.c],d=t.a,f=u;if(d.g&&p(d.f,[d.a.c("wf",f.c,A(f).toString(),"loading")]),I(d,"fontloading",f),d=null,null===V)if(window.FontFace){f=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent);var g=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);V=f?42<parseInt(f[1],10):!g}else V=!1;d=V?new D(a(t.g,t),a(t.h,t),t.c,u,t.s,c):new O(a(t.g,t),a(t.h,t),t.c,u,t.s,e,c),h.push(d)}for(l=0;l<h.length;l++)h[l].start()}},0)}function Y(e,t){this.c=e,this.a=t}function K(e,t){this.c=e,this.a=t}function q(e,t){this.c=e||$,this.a=[],this.f=[],this.g=t||""}H.prototype.g=function(e){var t=this.a;t.g&&p(t.f,[t.a.c("wf",e.c,A(e).toString(),"active")],[t.a.c("wf",e.c,A(e).toString(),"loading"),t.a.c("wf",e.c,A(e).toString(),"inactive")]),I(t,"fontactive",e),this.m=!0,W(this)},H.prototype.h=function(e){var t=this.a;if(t.g){var i=f(t.f,t.a.c("wf",e.c,A(e).toString(),"active")),n=[],s=[t.a.c("wf",e.c,A(e).toString(),"loading")];i||n.push(t.a.c("wf",e.c,A(e).toString(),"inactive")),p(t.f,n,s)}I(t,"fontinactive",e),W(this)},j.prototype.load=function(e){this.c=new l(this.j,e.context||this.j),this.g=!1!==e.events,this.f=!1!==e.classes,function(e,t,i){var n=[],s=i.timeout;!function(e){e.g&&p(e.f,[e.a.c("wf","loading")]),I(e,"loading")}(t);n=function(e,t,i){var n,s=[];for(n in t)if(t.hasOwnProperty(n)){var r=e.c[n];r&&s.push(r(t[n],i))}return s}(e.a,i,e.c);var r=new H(e.c,t,s);for(e.h=n.length,t=0,i=n.length;t<i;t++)n[t].load(function(t,i,n){X(e,r,t,i,n)})}(this,new w(this.c,e),e)},Y.prototype.load=function(e){function t(){if(r["__mti_fntLst"+n]){var i,s=r["__mti_fntLst"+n](),a=[];if(s)for(var o=0;o<s.length;o++){var l=s[o].fontfamily;null!=s[o].fontStyle&&null!=s[o].fontWeight?(i=s[o].fontStyle+s[o].fontWeight,a.push(new T(l,i))):a.push(new T(l))}e(a)}else setTimeout(function(){t()},50)}var i=this,n=i.a.projectId,s=i.a.version;if(n){var r=i.c.o;m(this.c,(i.a.api||"https://fast.fonts.net/jsapi")+"/"+n+".js"+(s?"?v="+s:""),function(s){s?e([]):(r["__MonotypeConfiguration__"+n]=function(){return i.a},t())}).id="__MonotypeAPIScript__"+n}else e([])},K.prototype.load=function(e){var t,i,n=this.a.urls||[],s=this.a.families||[],r=this.a.testStrings||{},a=new _;for(t=0,i=n.length;t<i;t++)g(this.c,n[t],v(a));var o=[];for(t=0,i=s.length;t<i;t++)if((n=s[t].split(":"))[1])for(var l=n[1].split(","),h=0;h<l.length;h+=1)o.push(new T(n[0],l[h]));else o.push(new T(n[0]));y(a,function(){e(o,r)})};var $="https://fonts.googleapis.com/css";function Q(e){this.f=e,this.a=[],this.c={}}var Z={latin:"BESbswy","latin-ext":"",cyrillic:"",greek:"",khmer:"",Hanuman:""},J={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},ee={i:"i",italic:"i",n:"n",normal:"n"},te=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;function ie(e,t){this.c=e,this.a=t}var ne={Arimo:!0,Cousine:!0,Tinos:!0};function se(e,t){this.c=e,this.a=t}function re(e,t){this.c=e,this.f=t,this.a=[]}ie.prototype.load=function(e){var t=new _,i=this.c,n=new q(this.a.api,this.a.text),s=this.a.families;!function(e,t){for(var i=t.length,n=0;n<i;n++){var s=t[n].split(":");3==s.length&&e.f.push(s.pop());var r="";2==s.length&&""!=s[1]&&(r=":"),e.a.push(s.join(r))}}(n,s);var r=new Q(s);!function(e){for(var t=e.f.length,i=0;i<t;i++){var n=e.f[i].split(":"),s=n[0].replace(/\+/g," "),r=["n4"];if(2<=n.length){var a;if(a=[],o=n[1])for(var o,l=(o=o.split(",")).length,h=0;h<l;h++){var u;if((u=o[h]).match(/^[\w-]+$/))if(null==(c=te.exec(u.toLowerCase())))u="";else{if(u=null==(u=c[2])||""==u?"n":ee[u],null==(c=c[1])||""==c)c="4";else var c=J[c]||(isNaN(c)?"4":c.substr(0,1));u=[u,c].join("")}else u="";u&&a.push(u)}0<a.length&&(r=a),3==n.length&&(a=[],0<(n=(n=n[2])?n.split(","):a).length&&(n=Z[n[0]])&&(e.c[s]=n))}for(e.c[s]||(n=Z[s])&&(e.c[s]=n),n=0;n<r.length;n+=1)e.a.push(new T(s,r[n]))}}(r),g(i,function(e){if(0==e.a.length)throw Error("No fonts to load!");if(-1!=e.c.indexOf("kit="))return e.c;for(var t=e.a.length,i=[],n=0;n<t;n++)i.push(e.a[n].replace(/ /g,"+"));return t=e.c+"?family="+i.join("%7C"),0<e.f.length&&(t+="&subset="+e.f.join(",")),0<e.g.length&&(t+="&text="+encodeURIComponent(e.g)),t}(n),v(t)),y(t,function(){e(r.a,r.c,ne)})},se.prototype.load=function(e){var t=this.a.id,i=this.c.o;t?m(this.c,(this.a.api||"https://use.typekit.net")+"/"+t+".js",function(t){if(t)e([]);else if(i.Typekit&&i.Typekit.config&&i.Typekit.config.fn){t=i.Typekit.config.fn;for(var n=[],s=0;s<t.length;s+=2)for(var r=t[s],a=t[s+1],o=0;o<a.length;o++)n.push(new T(r,a[o]));try{i.Typekit.load({events:!1,classes:!1,async:!0})}catch(e){}e(n)}},2e3):e([])},re.prototype.load=function(e){var t=this.f.id,i=this.c.o,n=this;t?(i.__webfontfontdeckmodule__||(i.__webfontfontdeckmodule__={}),i.__webfontfontdeckmodule__[t]=function(t,i){for(var s=0,r=i.fonts.length;s<r;++s){var a=i.fonts[s];n.a.push(new T(a.name,C("font-weight:"+a.weight+";font-style:"+a.style)))}e(n.a)},m(this.c,(this.f.api||"https://f.fontdeck.com/s/css/js/")+function(e){return e.o.location.hostname||e.a.location.hostname}(this.c)+"/"+t+".js",function(t){t&&e([])})):e([])};var ae=new j(window);ae.a.c.custom=function(e,t){return new K(t,e)},ae.a.c.fontdeck=function(e,t){return new re(t,e)},ae.a.c.monotype=function(e,t){return new Y(t,e)},ae.a.c.typekit=function(e,t){return new se(t,e)},ae.a.c.google=function(e,t){return new ie(t,e)};var oe={load:a(ae.load,ae)};void 0===(n=function(){return oe}.call(t,i,t,e))||(e.exports=n)}()},5524:(e,t,i)=>{"use strict";i.d(t,{c:()=>o});var n=i(9298),s=i(7797),r=i(8192);const a=new Map;function o(e,t){if(!a.has(e)){const i=new r.g({source:new s.q({resource:e,...t})}),n=()=>{a.get(e)===i&&a.delete(e)};i.once("destroy",n),i.source.once("destroy",n),a.set(e,i)}return a.get(e)}n.L.register(a)},5553:(e,t,i)=>{"use strict";i.d(t,{e:()=>s});let n={createCanvas:(e,t)=>{const i=document.createElement("canvas");return i.width=e,i.height=t,i},createImage:()=>new Image,getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(e,t)=>fetch(e,t),parseXML:e=>(new DOMParser).parseFromString(e,"text/xml")};const s={get:()=>n,set(e){n=e}}},5662:(e,t,i)=>{"use strict";i.d(t,{h:()=>a});var n=i(2551),s=i(198),r=i(2409);class a extends n.A{constructor(e){let{data:t,size:i}=e;const{usage:n,label:r,shrinkToFit:a}=e;super(),this.uid=(0,s.L)("buffer"),this._resourceType="buffer",this._resourceId=(0,s.L)("resource"),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,t instanceof Array&&(t=new Float32Array(t)),this._data=t,i??(i=t?.byteLength);const o=!!t;this.descriptor={size:i,usage:n,mappedAtCreation:o,label:r},this.shrinkToFit=a??!0}get data(){return this._data}set data(e){this.setDataWithSize(e,e.length,!0)}get dataInt32(){return this._dataInt32||(this._dataInt32=new Int32Array(this.data.buffer)),this._dataInt32}get static(){return!!(this.descriptor.usage&r.S.STATIC)}set static(e){e?this.descriptor.usage|=r.S.STATIC:this.descriptor.usage&=~r.S.STATIC}setDataWithSize(e,t,i){if(this._updateID++,this._updateSize=t*e.BYTES_PER_ELEMENT,this._data===e)return void(i&&this.emit("update",this));const n=this._data;this._data=e,this._dataInt32=null,n&&n.length===e.length||!this.shrinkToFit&&n&&e.byteLength<n.byteLength?i&&this.emit("update",this):(this.descriptor.size=e.byteLength,this._resourceId=(0,s.L)("resource"),this.emit("change",this))}update(e){this._updateSize=e??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}}},5884:(e,t,i)=>{"use strict";i.d(t,{v:()=>h});var n=i(2551),s=i(9550),r=i(7893),a=i(198),o=i(1819);const l=class e extends n.A{constructor(t={}){super(),this.options=t,this.uid=(0,a.L)("textureSource"),this._resourceType="textureSource",this._resourceId=(0,a.L)("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,t={...e.defaultOptions,...t},this.label=t.label??"",this.resource=t.resource,this.autoGarbageCollect=t.autoGarbageCollect,this._resolution=t.resolution,t.width?this.pixelWidth=t.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,t.height?this.pixelHeight=t.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=t.format,this.dimension=t.dimensions,this.mipLevelCount=t.mipLevelCount,this.autoGenerateMipmaps=t.autoGenerateMipmaps,this.sampleCount=t.sampleCount,this.antialias=t.antialias,this.alphaMode=t.alphaMode,this.style=new o.n((0,r.S)(t)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(e){this.style!==e&&(this._style?.off("change",this._onStyleChange,this),this._style=e,this._style?.on("change",this._onStyleChange,this),this._onStyleChange())}set maxAnisotropy(e){this._style.maxAnisotropy=e}get maxAnisotropy(){return this._style.maxAnisotropy}get addressMode(){return this._style.addressMode}set addressMode(e){this._style.addressMode=e}get repeatMode(){return this._style.addressMode}set repeatMode(e){this._style.addressMode=e}get magFilter(){return this._style.magFilter}set magFilter(e){this._style.magFilter=e}get minFilter(){return this._style.minFilter}set minFilter(e){this._style.minFilter=e}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(e){this._style.mipmapFilter=e}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(e){this._style.lodMinClamp=e}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(e){this._style.lodMaxClamp=e}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const e=this._resolution;if(this.resize(this.resourceWidth/e,this.resourceHeight/e))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=(0,a.L)("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:e}=this;return e.naturalWidth||e.videoWidth||e.displayWidth||e.width}get resourceHeight(){const{resource:e}=this;return e.naturalHeight||e.videoHeight||e.displayHeight||e.height}get resolution(){return this._resolution}set resolution(e){this._resolution!==e&&(this._resolution=e,this.width=this.pixelWidth/e,this.height=this.pixelHeight/e)}resize(e,t,i){i||(i=this._resolution),e||(e=this.width),t||(t=this.height);const n=Math.round(e*i),s=Math.round(t*i);return this.width=n/i,this.height=s/i,this._resolution=i,(this.pixelWidth!==n||this.pixelHeight!==s)&&(this._refreshPOT(),this.pixelWidth=n,this.pixelHeight=s,this.emit("resize",this),this._resourceId=(0,a.L)("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(e){this._style.wrapMode=e}get wrapMode(){return this._style.wrapMode}set scaleMode(e){this._style.scaleMode=e}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=(0,s.f3)(this.pixelWidth)&&(0,s.f3)(this.pixelHeight)}static test(e){throw new Error("Unimplemented")}};l.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let h=l},5957:(e,t,i)=>{"use strict";i.d(t,{g:()=>s});class n{constructor(e=0,t=0,i=!1){this.first=null,this.items=Object.create(null),this.last=null,this.max=e,this.resetTtl=i,this.size=0,this.ttl=t}clear(){return this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this}delete(e){if(this.has(e)){const t=this.items[e];delete this.items[e],this.size--,null!==t.prev&&(t.prev.next=t.next),null!==t.next&&(t.next.prev=t.prev),this.first===t&&(this.first=t.next),this.last===t&&(this.last=t.prev)}return this}entries(e=this.keys()){return e.map(e=>[e,this.get(e)])}evict(e=!1){if(e||this.size>0){const e=this.first;delete this.items[e.key],0===--this.size?(this.first=null,this.last=null):(this.first=e.next,this.first.prev=null)}return this}expiresAt(e){let t;return this.has(e)&&(t=this.items[e].expiry),t}get(e){const t=this.items[e];if(void 0!==t)return this.ttl>0&&t.expiry<=Date.now()?void this.delete(e):(this.moveToEnd(t),t.value)}has(e){return e in this.items}moveToEnd(e){this.last!==e&&(null!==e.prev&&(e.prev.next=e.next),null!==e.next&&(e.next.prev=e.prev),this.first===e&&(this.first=e.next),e.prev=this.last,e.next=null,null!==this.last&&(this.last.next=e),this.last=e,null===this.first&&(this.first=e))}keys(){const e=[];let t=this.first;for(;null!==t;)e.push(t.key),t=t.next;return e}setWithEvicted(e,t,i=this.resetTtl){let n=null;if(this.has(e))this.set(e,t,!0,i);else{this.max>0&&this.size===this.max&&(n={...this.first},this.evict(!0));let i=this.items[e]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:e,prev:this.last,next:null,value:t};1===++this.size?this.first=i:this.last.next=i,this.last=i}return n}set(e,t,i=!1,n=this.resetTtl){let s=this.items[e];return i||void 0!==s?(s.value=t,!1===i&&n&&(s.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl),this.moveToEnd(s)):(this.max>0&&this.size===this.max&&this.evict(!0),s=this.items[e]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:e,prev:this.last,next:null,value:t},1===++this.size?this.first=s:this.last.next=s,this.last=s),this}values(e=this.keys()){return e.map(e=>this.get(e))}}function s(e=1e3,t=0,i=!1){if(isNaN(e)||e<0)throw new TypeError("Invalid max value");if(isNaN(t)||t<0)throw new TypeError("Invalid ttl value");if("boolean"!=typeof i)throw new TypeError("Invalid resetTtl value");return new n(e,t,i)}},5984:(e,t,i)=>{"use strict";i.d(t,{a:()=>n});const n=e=>!Array.isArray(e)},6208:(e,t,i)=>{"use strict";i.d(t,{E:()=>c});var n=i(6680);const s=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],r=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],a=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],o=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],l=[],h=[],u=Math.sign;!function(){for(let e=0;e<16;e++){const t=[];l.push(t);for(let i=0;i<16;i++){const n=u(s[e]*s[i]+a[e]*r[i]),l=u(r[e]*s[i]+o[e]*r[i]),h=u(s[e]*a[i]+a[e]*o[i]),c=u(r[e]*a[i]+o[e]*o[i]);for(let e=0;e<16;e++)if(s[e]===n&&r[e]===l&&a[e]===h&&o[e]===c){t.push(e);break}}}for(let e=0;e<16;e++){const t=new n.u;t.set(s[e],r[e],a[e],o[e],0,0),h.push(t)}}();const c={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:e=>s[e],uY:e=>r[e],vX:e=>a[e],vY:e=>o[e],inv:e=>8&e?15&e:7&-e,add:(e,t)=>l[e][t],sub:(e,t)=>l[e][c.inv(t)],rotate180:e=>4^e,isVertical:e=>2==(3&e),byDirection:(e,t)=>2*Math.abs(e)<=Math.abs(t)?t>=0?c.S:c.N:2*Math.abs(t)<=Math.abs(e)?e>0?c.E:c.W:t>0?e>0?c.SE:c.SW:e>0?c.NE:c.NW,matrixAppendRotationInv:(e,t,i=0,n=0)=>{const s=h[c.inv(t)];s.tx=i,s.ty=n,e.append(s)},transformRectCoords:(e,t,i,n)=>{const{x:s,y:r,width:a,height:o}=e,{x:l,y:h,width:u,height:d}=t;return i===c.E?(n.set(s+l,r+h,a,o),n):i===c.S?n.set(u-r-o+l,s+h,o,a):i===c.W?n.set(u-s-a+l,d-r-o+h,a,o):i===c.N?n.set(r+l,d-s-a+h,o,a):n.set(s+l,r+h,a,o)}}},6209:(e,t,i)=>{"use strict";var n=i(8602),s=i(8079),r=i(4303),a=i(1047);const o=class e extends a.u{constructor(...e){super({});let t=e[0]??{};"number"==typeof t&&((0,r.t6)(r.lj,"PlaneGeometry constructor changed please use { width, height, verticesX, verticesY } instead"),t={width:t,height:e[1],verticesX:e[2],verticesY:e[3]}),this.build(t)}build(t){t={...e.defaultOptions,...t},this.verticesX=this.verticesX??t.verticesX,this.verticesY=this.verticesY??t.verticesY,this.width=this.width??t.width,this.height=this.height??t.height;const i=this.verticesX*this.verticesY,n=[],s=[],r=[],a=this.verticesX-1,o=this.verticesY-1,l=this.width/a,h=this.height/o;for(let e=0;e<i;e++){const t=e%this.verticesX,i=e/this.verticesX|0;n.push(t*l,i*h),s.push(t/a,i/o)}const u=a*o;for(let e=0;e<u;e++){const t=e%a,i=e/a|0,n=i*this.verticesX+t,s=i*this.verticesX+t+1,o=(i+1)*this.verticesX+t,l=(i+1)*this.verticesX+t+1;r.push(n,s,o,s,l,o)}this.buffers[0].data=new Float32Array(n),this.buffers[1].data=new Float32Array(s),this.indexBuffer.data=new Uint32Array(r),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}};o.defaultOptions={width:100,height:100,verticesX:10,verticesY:10};let l=o;const h=class e extends l{constructor(t={}){super({width:(t={...e.defaultOptions,...t}).width,height:t.height,verticesX:4,verticesY:4}),this.update(t)}update(e){this.width=e.width??this.width,this.height=e.height??this.height,this._originalWidth=e.originalWidth??this._originalWidth,this._originalHeight=e.originalHeight??this._originalHeight,this._leftWidth=e.leftWidth??this._leftWidth,this._rightWidth=e.rightWidth??this._rightWidth,this._topHeight=e.topHeight??this._topHeight,this._bottomHeight=e.bottomHeight??this._bottomHeight,this._anchorX=e.anchor?.x,this._anchorY=e.anchor?.y,this.updateUvs(),this.updatePositions()}updatePositions(){const e=this.positions,{width:t,height:i,_leftWidth:n,_rightWidth:s,_topHeight:r,_bottomHeight:a,_anchorX:o,_anchorY:l}=this,h=n+s,u=t>h?1:t/h,c=r+a,d=i>c?1:i/c,p=Math.min(u,d),f=o*t,g=l*i;e[0]=e[8]=e[16]=e[24]=-f,e[2]=e[10]=e[18]=e[26]=n*p-f,e[4]=e[12]=e[20]=e[28]=t-s*p-f,e[6]=e[14]=e[22]=e[30]=t-f,e[1]=e[3]=e[5]=e[7]=-g,e[9]=e[11]=e[13]=e[15]=r*p-g,e[17]=e[19]=e[21]=e[23]=i-a*p-g,e[25]=e[27]=e[29]=e[31]=i-g,this.getBuffer("aPosition").update()}updateUvs(){const e=this.uvs;e[0]=e[8]=e[16]=e[24]=0,e[1]=e[3]=e[5]=e[7]=0,e[6]=e[14]=e[22]=e[30]=1,e[25]=e[27]=e[29]=e[31]=1;const t=1/this._originalWidth,i=1/this._originalHeight;e[2]=e[10]=e[18]=e[26]=t*this._leftWidth,e[9]=e[11]=e[13]=e[15]=i*this._topHeight,e[4]=e[12]=e[20]=e[28]=1-t*this._rightWidth,e[17]=e[19]=e[21]=e[23]=1-i*this._bottomHeight,this.getBuffer("aUV").update()}};h.defaultOptions={width:100,height:100,leftWidth:10,topHeight:10,rightWidth:10,bottomHeight:10,originalWidth:100,originalHeight:100};let u=h;class c extends s.U{constructor(){super(),this.geometry=new u}destroy(){this.geometry.destroy()}}class d{constructor(e){this._renderer=e}addRenderable(e,t){const i=this._getGpuSprite(e);e.didViewUpdate&&this._updateBatchableSprite(e,i),this._renderer.renderPipes.batch.addToBatch(i,t)}updateRenderable(e){const t=this._getGpuSprite(e);e.didViewUpdate&&this._updateBatchableSprite(e,t),t._batcher.updateElement(t)}validateRenderable(e){const t=this._getGpuSprite(e);return!t._batcher.checkAndUpdateTexture(t,e._texture)}_updateBatchableSprite(e,t){t.geometry.update(e),t.setTexture(e._texture)}_getGpuSprite(e){return e._gpuData[this._renderer.uid]||this._initGPUSprite(e)}_initGPUSprite(e){const t=e._gpuData[this._renderer.uid]=new c,i=t;return i.renderable=e,i.transform=e.groupTransform,i.texture=e._texture,i.roundPixels=this._renderer._roundPixels|e._roundPixels,e.didViewUpdate||this._updateBatchableSprite(e,i),t}destroy(){this._renderer=null}}d.extension={type:[n.Ag.WebGLPipes,n.Ag.WebGPUPipes,n.Ag.CanvasPipes],name:"nineSliceSprite"},n.XO.add(d)},6213:(e,t,i)=>{"use strict";var n=i(8602),s=i(3079),r=i(3377),a=i(379);class o{constructor(e){this._lastTransform="",this._observer=null,this._tickerAttached=!1,this.updateTranslation=()=>{if(!this._canvas)return;const e=this._canvas.getBoundingClientRect(),t=this._canvas.width,i=this._canvas.height,n=e.width/t*this._renderer.resolution,s=e.height/i*this._renderer.resolution,r=`translate(${e.left}px, ${e.top}px) scale(${n}, ${s})`;r!==this._lastTransform&&(this._domElement.style.transform=r,this._lastTransform=r)},this._domElement=e.domElement,this._renderer=e.renderer,globalThis.OffscreenCanvas&&this._renderer.canvas instanceof OffscreenCanvas||(this._canvas=this._renderer.canvas,this._attachObserver())}get canvas(){return this._canvas}ensureAttached(){!this._domElement.parentNode&&this._canvas.parentNode&&(this._canvas.parentNode.appendChild(this._domElement),this.updateTranslation())}_attachObserver(){"ResizeObserver"in globalThis?(this._observer&&(this._observer.disconnect(),this._observer=null),this._observer=new ResizeObserver(e=>{for(const t of e){if(t.target!==this._canvas)continue;const e=this.canvas.width,i=this.canvas.height,n=t.contentRect.width/e*this._renderer.resolution,s=t.contentRect.height/i*this._renderer.resolution;(this._lastScaleX!==n||this._lastScaleY!==s)&&(this.updateTranslation(),this._lastScaleX=n,this._lastScaleY=s)}}),this._observer.observe(this._canvas)):this._tickerAttached||a.R.shared.add(this.updateTranslation,this,r.d.HIGH)}destroy(){this._observer?(this._observer.disconnect(),this._observer=null):this._tickerAttached&&a.R.shared.remove(this.updateTranslation),this._domElement=null,this._renderer=null,this._canvas=null,this._tickerAttached=!1,this._lastTransform="",this._lastScaleX=null,this._lastScaleY=null}}var l=i(1828);class h{constructor(e){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=h.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new l.b,this.page=new l.b,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return!this.manager||this.path&&this.path[this.path.length-1]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(e,t,i){throw new Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(e,t,i,n,s){throw new Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}var u=i(4541),c=i.n(u);const d=(c().default??c())(globalThis.navigator);var p=i(7752);const f=class e{constructor(e,t=d){this._mobileInfo=t,this.debug=!1,this._activateOnTab=!0,this._deactivateOnMouseMove=!0,this._isActive=!1,this._isMobileAccessibility=!1,this._div=null,this._pool=[],this._renderId=0,this._children=[],this._androidUpdateCount=0,this._androidUpdateFrequency=500,this._hookDiv=null,(t.tablet||t.phone)&&this._createTouchHook(),this._renderer=e}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}get hookDiv(){return this._hookDiv}_createTouchHook(){const e=document.createElement("button");e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.zIndex=2..toString(),e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this._activate(),this._destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e}_destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}_activate(){if(this._isActive)return;this._isActive=!0,this._div||(this._div=document.createElement("div"),this._div.style.position="absolute",this._div.style.top="0px",this._div.style.left="0px",this._div.style.pointerEvents="none",this._div.style.zIndex=2..toString(),this._canvasObserver=new o({domElement:this._div,renderer:this._renderer})),this._activateOnTab&&(this._onKeyDown=this._onKeyDown.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)),this._deactivateOnMouseMove&&(this._onMouseMove=this._onMouseMove.bind(this),globalThis.document.addEventListener("mousemove",this._onMouseMove,!0));const e=this._renderer.view.canvas;if(e.parentNode)this._canvasObserver.ensureAttached(),this._initAccessibilitySetup();else{const t=new MutationObserver(()=>{e.parentNode&&(t.disconnect(),this._canvasObserver.ensureAttached(),this._initAccessibilitySetup())});t.observe(document.body,{childList:!0,subtree:!0})}}_initAccessibilitySetup(){this._renderer.runners.postrender.add(this),this._renderer.lastObjectRendered&&this._updateAccessibleObjects(this._renderer.lastObjectRendered)}_deactivate(){if(this._isActive&&!this._isMobileAccessibility){this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),this._activateOnTab&&globalThis.addEventListener("keydown",this._onKeyDown,!1),this._renderer.runners.postrender.remove(this);for(const e of this._children)e._accessibleDiv&&e._accessibleDiv.parentNode&&(e._accessibleDiv.parentNode.removeChild(e._accessibleDiv),e._accessibleDiv=null),e._accessibleActive=!1;this._pool.forEach(e=>{e.parentNode&&e.parentNode.removeChild(e)}),this._div&&this._div.parentNode&&this._div.parentNode.removeChild(this._div),this._pool=[],this._children=[]}}_updateAccessibleObjects(e){if(!e.visible||!e.accessibleChildren)return;e.accessible&&(e._accessibleActive||this._addChild(e),e._renderId=this._renderId);const t=e.children;if(t)for(let e=0;e<t.length;e++)this._updateAccessibleObjects(t[e])}init(t){const i={accessibilityOptions:{...e.defaultOptions,...t?.accessibilityOptions||{}}};this.debug=i.accessibilityOptions.debug,this._activateOnTab=i.accessibilityOptions.activateOnTab,this._deactivateOnMouseMove=i.accessibilityOptions.deactivateOnMouseMove,i.accessibilityOptions.enabledByDefault?this._activate():this._activateOnTab&&(this._onKeyDown=this._onKeyDown.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)),this._renderer.runners.postrender.remove(this)}postrender(){const e=performance.now();if(this._mobileInfo.android.device&&e<this._androidUpdateCount)return;if(this._androidUpdateCount=e+this._androidUpdateFrequency,!this._renderer.renderingToScreen||!this._renderer.view.canvas)return;const t=new Set;if(this._renderer.lastObjectRendered){this._updateAccessibleObjects(this._renderer.lastObjectRendered);for(const e of this._children)e._renderId===this._renderId&&t.add(this._children.indexOf(e))}for(let e=this._children.length-1;e>=0;e--){const i=this._children[e];t.has(e)||(i._accessibleDiv&&i._accessibleDiv.parentNode&&(i._accessibleDiv.parentNode.removeChild(i._accessibleDiv),this._pool.push(i._accessibleDiv),i._accessibleDiv=null),i._accessibleActive=!1,(0,p.d)(this._children,e,1))}this._renderer.renderingToScreen&&this._canvasObserver.ensureAttached();for(let e=0;e<this._children.length;e++){const t=this._children[e];if(!t._accessibleActive||!t._accessibleDiv)continue;const i=t._accessibleDiv,n=t.hitArea||t.getBounds().rectangle;if(t.hitArea){const e=t.worldTransform;i.style.left=`${e.tx+n.x*e.a}px`,i.style.top=`${e.ty+n.y*e.d}px`,i.style.width=n.width*e.a+"px",i.style.height=n.height*e.d+"px"}else this._capHitArea(n),i.style.left=`${n.x}px`,i.style.top=`${n.y}px`,i.style.width=`${n.width}px`,i.style.height=`${n.height}px`}this._renderId++}_updateDebugHTML(e){e.innerHTML=`type: ${e.type}</br> title : ${e.title}</br> tabIndex: ${e.tabIndex}`}_capHitArea(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);const{width:t,height:i}=this._renderer;e.x+e.width>t&&(e.width=t-e.x),e.y+e.height>i&&(e.height=i-e.y)}_addChild(e){let t=this._pool.pop();t||("button"===e.accessibleType?t=document.createElement("button"):(t=document.createElement(e.accessibleType),t.style.cssText="\n                        color: transparent;\n                        pointer-events: none;\n                        padding: 0;\n                        margin: 0;\n                        border: 0;\n                        outline: 0;\n                        background: transparent;\n                        box-sizing: border-box;\n                        user-select: none;\n                        -webkit-user-select: none;\n                        -moz-user-select: none;\n                        -ms-user-select: none;\n                    ",e.accessibleText&&(t.innerText=e.accessibleText)),t.style.width="100px",t.style.height="100px",t.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",t.style.position="absolute",t.style.zIndex=2..toString(),t.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?t.setAttribute("aria-live","off"):t.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?t.setAttribute("aria-relevant","additions"):t.setAttribute("aria-relevant","text"),t.addEventListener("click",this._onClick.bind(this)),t.addEventListener("focus",this._onFocus.bind(this)),t.addEventListener("focusout",this._onFocusOut.bind(this))),t.style.pointerEvents=e.accessiblePointerEvents,t.type=e.accessibleType,e.accessibleTitle&&null!==e.accessibleTitle?t.title=e.accessibleTitle:e.accessibleHint&&null!==e.accessibleHint||(t.title=`container ${e.tabIndex}`),e.accessibleHint&&null!==e.accessibleHint&&t.setAttribute("aria-label",e.accessibleHint),e.interactive?t.tabIndex=e.tabIndex:t.tabIndex=0,this.debug&&this._updateDebugHTML(t),e._accessibleActive=!0,e._accessibleDiv=t,t.container=e,this._children.push(e),this._div.appendChild(e._accessibleDiv)}_dispatchEvent(e,t){const{container:i}=e.target,n=this._renderer.events.rootBoundary,s=Object.assign(new h(n),{target:i});n.rootTarget=this._renderer.lastObjectRendered,t.forEach(e=>n.dispatchEvent(s,e))}_onClick(e){this._dispatchEvent(e,["click","pointertap","tap"])}_onFocus(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive"),this._dispatchEvent(e,["mouseover"])}_onFocusOut(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite"),this._dispatchEvent(e,["mouseout"])}_onKeyDown(e){9===e.keyCode&&this._activateOnTab&&this._activate()}_onMouseMove(e){0===e.movementX&&0===e.movementY||this._deactivate()}destroy(){this._deactivate(),this._destroyTouchHook(),this._canvasObserver?.destroy(),this._canvasObserver=null,this._div=null,this._pool=null,this._children=null,this._renderer=null,this._activateOnTab&&globalThis.removeEventListener("keydown",this._onKeyDown)}setAccessibilityEnabled(e){e?this._activate():this._deactivate()}};f.extension={type:[n.Ag.WebGLSystem,n.Ag.WebGPUSystem],name:"accessibility"},f.defaultOptions={enabledByDefault:!1,debug:!1,activateOnTab:!0,deactivateOnMouseMove:!0};let g=f;n.XO.add(g),n.XO.mixin(s.mc,{accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,accessibleType:"button",accessibleText:null,accessiblePointerEvents:"auto",accessibleChildren:!0,_accessibleActive:!1,_accessibleDiv:null,_renderId:-1});i(8514);var m=i(2551),_=i(9731);const v=new class{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this._tickerAdded=!1,this._pauseUpdate=!0}init(e){this.removeTickerListener(),this.events=e,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this._tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(e){this._pauseUpdate=e}addTickerListener(){!this._tickerAdded&&this.domElement&&(a.R.system.add(this._tickerUpdate,this,r.d.INTERACTION),this._tickerAdded=!0)}removeTickerListener(){this._tickerAdded&&(a.R.system.remove(this._tickerUpdate,this),this._tickerAdded=!1)}pointerMoved(){this._didMove=!0}_update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove)return void(this._didMove=!1);const e=this.events._rootPointerEvent;this.events.supportsTouchEvents&&"touch"===e.pointerType||globalThis.document.dispatchEvent(this.events.supportsPointerEvents?new PointerEvent("pointermove",{clientX:e.clientX,clientY:e.clientY,pointerType:e.pointerType,pointerId:e.pointerId}):new MouseEvent("mousemove",{clientX:e.clientX,clientY:e.clientY}))}_tickerUpdate(e){this._deltaTime+=e.deltaTime,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this._update())}destroy(){this.removeTickerListener(),this.events=null,this.domElement=null,this._deltaTime=0,this._didMove=!1,this._tickerAdded=!1,this._pauseUpdate=!0}};class y extends h{constructor(){super(...arguments),this.client=new l.b,this.movement=new l.b,this.offset=new l.b,this.global=new l.b,this.screen=new l.b}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(e,t,i){return e.worldTransform.applyInverse(i||this.global,t)}getModifierState(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)}initMouseEvent(e,t,i,n,s,r,a,o,l,h,u,c,d,p,f){throw new Error("Method not implemented.")}}class b extends y{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}}class x extends y{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}x.DOM_DELTA_PIXEL=0,x.DOM_DELTA_LINE=1,x.DOM_DELTA_PAGE=2;const T=new l.b,S=new l.b;class A{constructor(e){this.dispatch=new m.A,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=e,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(e,t){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:t,priority:0}),this.mappingTable[e].sort((e,t)=>e.priority-t.priority)}dispatchEvent(e,t){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,t),this.dispatch.emit(t||e.type,e)}mapEvent(e){if(!this.rootTarget)return;const t=this.mappingTable[e.type];if(t)for(let i=0,n=t.length;i<n;i++)t[i].fn(e);else(0,_.R)(`[EventBoundary]: Event mapping not defined for ${e.type}`)}hitTest(e,t){v.pauseUpdate=!0;const i=this[this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive"](this.rootTarget,this.rootTarget.eventMode,T.set(e,t),this.hitTestFn,this.hitPruneFn);return i&&i[0]}propagate(e,t){if(!e.target)return;const i=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(let n=0,s=i.length-1;n<s;n++)if(e.currentTarget=i[n],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,t),!e.propagationStopped&&!e.propagationImmediatelyStopped){e.eventPhase=e.BUBBLING_PHASE;for(let n=i.length-2;n>=0;n--)if(e.currentTarget=i[n],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return}}all(e,t,i=this._allInteractiveElements){if(0===i.length)return;e.eventPhase=e.BUBBLING_PHASE;const n=Array.isArray(t)?t:[t];for(let t=i.length-1;t>=0;t--)n.forEach(n=>{e.currentTarget=i[t],this.notifyTarget(e,n)})}propagationPath(e){const t=[e];for(let i=0;i<2048&&e!==this.rootTarget&&e.parent;i++){if(!e.parent)throw new Error("Cannot find propagation path to disconnected target");t.push(e.parent),e=e.parent}return t.reverse(),t}hitTestMoveRecursive(e,t,i,n,s,r=!1){let a=!1;if(this._interactivePrune(e))return null;if("dynamic"!==e.eventMode&&"dynamic"!==t||(v.pauseUpdate=!1),e.interactiveChildren&&e.children){const o=e.children;for(let l=o.length-1;l>=0;l--){const h=o[l],u=this.hitTestMoveRecursive(h,this._isInteractive(t)?t:h.eventMode,i,n,s,r||s(e,i));if(u){if(u.length>0&&!u[u.length-1].parent)continue;const t=e.isInteractive();(u.length>0||t)&&(t&&this._allInteractiveElements.push(e),u.push(e)),0===this._hitElements.length&&(this._hitElements=u),a=!0}}}const o=this._isInteractive(t),l=e.isInteractive();return l&&l&&this._allInteractiveElements.push(e),r||this._hitElements.length>0?null:a?this._hitElements:o&&!s(e,i)&&n(e,i)?l?[e]:[]:null}hitTestRecursive(e,t,i,n,s){if(this._interactivePrune(e)||s(e,i))return null;if("dynamic"!==e.eventMode&&"dynamic"!==t||(v.pauseUpdate=!1),e.interactiveChildren&&e.children){const r=e.children,a=i;for(let i=r.length-1;i>=0;i--){const o=r[i],l=this.hitTestRecursive(o,this._isInteractive(t)?t:o.eventMode,a,n,s);if(l){if(l.length>0&&!l[l.length-1].parent)continue;const t=e.isInteractive();return(l.length>0||t)&&l.push(e),l}}}const r=this._isInteractive(t),a=e.isInteractive();return r&&n(e,i)?a?[e]:[]:null}_isInteractive(e){return"static"===e||"dynamic"===e}_interactivePrune(e){return!(e&&e.visible&&e.renderable&&e.measurable)||("none"===e.eventMode||"passive"===e.eventMode&&!e.interactiveChildren)}hitPruneFn(e,t){if(e.hitArea&&(e.worldTransform.applyInverse(t,S),!e.hitArea.contains(S.x,S.y)))return!0;if(e.effects&&e.effects.length)for(let i=0;i<e.effects.length;i++){const n=e.effects[i];if(n.containsPoint){if(!n.containsPoint(t,this.hitTestFn))return!0}}return!1}hitTestFn(e,t){return!!e.hitArea||!!e?.containsPoint&&(e.worldTransform.applyInverse(t,S),e.containsPoint(S))}notifyTarget(e,t){if(!e.currentTarget.isInteractive())return;t??(t=e.type);const i=`on${t}`;e.currentTarget[i]?.(e);const n=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?`${t}capture`:t;this._notifyListeners(e,n),e.eventPhase===e.AT_TARGET&&this._notifyListeners(e,t)}mapPointerDown(e){if(!(e instanceof b))return void(0,_.R)("EventBoundary cannot map a non-pointer event as a pointer event");const t=this.createPointerEvent(e);if(this.dispatchEvent(t,"pointerdown"),"touch"===t.pointerType)this.dispatchEvent(t,"touchstart");else if("mouse"===t.pointerType||"pen"===t.pointerType){const e=2===t.button;this.dispatchEvent(t,e?"rightdown":"mousedown")}this.trackingData(e.pointerId).pressTargetsByButton[e.button]=t.composedPath(),this.freeEvent(t)}mapPointerMove(e){if(!(e instanceof b))return void(0,_.R)("EventBoundary cannot map a non-pointer event as a pointer event");this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;const t=this.createPointerEvent(e);this._isPointerMoveEvent=!1;const i="mouse"===t.pointerType||"pen"===t.pointerType,n=this.trackingData(e.pointerId),s=this.findMountedTarget(n.overTargets);if(n.overTargets?.length>0&&s!==t.target){const n="mousemove"===e.type?"mouseout":"pointerout",r=this.createPointerEvent(e,n,s);if(this.dispatchEvent(r,"pointerout"),i&&this.dispatchEvent(r,"mouseout"),!t.composedPath().includes(s)){const n=this.createPointerEvent(e,"pointerleave",s);for(n.eventPhase=n.AT_TARGET;n.target&&!t.composedPath().includes(n.target);)n.currentTarget=n.target,this.notifyTarget(n),i&&this.notifyTarget(n,"mouseleave"),n.target=n.target.parent;this.freeEvent(n)}this.freeEvent(r)}if(s!==t.target){const n="mousemove"===e.type?"mouseover":"pointerover",r=this.clonePointerEvent(t,n);this.dispatchEvent(r,"pointerover"),i&&this.dispatchEvent(r,"mouseover");let a=s?.parent;for(;a&&a!==this.rootTarget.parent&&a!==t.target;)a=a.parent;if(!a||a===this.rootTarget.parent){const e=this.clonePointerEvent(t,"pointerenter");for(e.eventPhase=e.AT_TARGET;e.target&&e.target!==s&&e.target!==this.rootTarget.parent;)e.currentTarget=e.target,this.notifyTarget(e),i&&this.notifyTarget(e,"mouseenter"),e.target=e.target.parent;this.freeEvent(e)}this.freeEvent(r)}const r=[],a=this.enableGlobalMoveEvents??!0;this.moveOnAll?r.push("pointermove"):this.dispatchEvent(t,"pointermove"),a&&r.push("globalpointermove"),"touch"===t.pointerType&&(this.moveOnAll?r.splice(1,0,"touchmove"):this.dispatchEvent(t,"touchmove"),a&&r.push("globaltouchmove")),i&&(this.moveOnAll?r.splice(1,0,"mousemove"):this.dispatchEvent(t,"mousemove"),a&&r.push("globalmousemove"),this.cursor=t.target?.cursor),r.length>0&&this.all(t,r),this._allInteractiveElements.length=0,this._hitElements.length=0,n.overTargets=t.composedPath(),this.freeEvent(t)}mapPointerOver(e){if(!(e instanceof b))return void(0,_.R)("EventBoundary cannot map a non-pointer event as a pointer event");const t=this.trackingData(e.pointerId),i=this.createPointerEvent(e),n="mouse"===i.pointerType||"pen"===i.pointerType;this.dispatchEvent(i,"pointerover"),n&&this.dispatchEvent(i,"mouseover"),"mouse"===i.pointerType&&(this.cursor=i.target?.cursor);const s=this.clonePointerEvent(i,"pointerenter");for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==this.rootTarget.parent;)s.currentTarget=s.target,this.notifyTarget(s),n&&this.notifyTarget(s,"mouseenter"),s.target=s.target.parent;t.overTargets=i.composedPath(),this.freeEvent(i),this.freeEvent(s)}mapPointerOut(e){if(!(e instanceof b))return void(0,_.R)("EventBoundary cannot map a non-pointer event as a pointer event");const t=this.trackingData(e.pointerId);if(t.overTargets){const i="mouse"===e.pointerType||"pen"===e.pointerType,n=this.findMountedTarget(t.overTargets),s=this.createPointerEvent(e,"pointerout",n);this.dispatchEvent(s),i&&this.dispatchEvent(s,"mouseout");const r=this.createPointerEvent(e,"pointerleave",n);for(r.eventPhase=r.AT_TARGET;r.target&&r.target!==this.rootTarget.parent;)r.currentTarget=r.target,this.notifyTarget(r),i&&this.notifyTarget(r,"mouseleave"),r.target=r.target.parent;t.overTargets=null,this.freeEvent(s),this.freeEvent(r)}this.cursor=null}mapPointerUp(e){if(!(e instanceof b))return void(0,_.R)("EventBoundary cannot map a non-pointer event as a pointer event");const t=performance.now(),i=this.createPointerEvent(e);if(this.dispatchEvent(i,"pointerup"),"touch"===i.pointerType)this.dispatchEvent(i,"touchend");else if("mouse"===i.pointerType||"pen"===i.pointerType){const e=2===i.button;this.dispatchEvent(i,e?"rightup":"mouseup")}const n=this.trackingData(e.pointerId),s=this.findMountedTarget(n.pressTargetsByButton[e.button]);let r=s;if(s&&!i.composedPath().includes(s)){let t=s;for(;t&&!i.composedPath().includes(t);){if(i.currentTarget=t,this.notifyTarget(i,"pointerupoutside"),"touch"===i.pointerType)this.notifyTarget(i,"touchendoutside");else if("mouse"===i.pointerType||"pen"===i.pointerType){const e=2===i.button;this.notifyTarget(i,e?"rightupoutside":"mouseupoutside")}t=t.parent}delete n.pressTargetsByButton[e.button],r=t}if(r){const s=this.clonePointerEvent(i,"click");s.target=r,s.path=null,n.clicksByButton[e.button]||(n.clicksByButton[e.button]={clickCount:0,target:s.target,timeStamp:t});const a=n.clicksByButton[e.button];if(a.target===s.target&&t-a.timeStamp<200?++a.clickCount:a.clickCount=1,a.target=s.target,a.timeStamp=t,s.detail=a.clickCount,"mouse"===s.pointerType){const e=2===s.button;this.dispatchEvent(s,e?"rightclick":"click")}else"touch"===s.pointerType&&this.dispatchEvent(s,"tap");this.dispatchEvent(s,"pointertap"),this.freeEvent(s)}this.freeEvent(i)}mapPointerUpOutside(e){if(!(e instanceof b))return void(0,_.R)("EventBoundary cannot map a non-pointer event as a pointer event");const t=this.trackingData(e.pointerId),i=this.findMountedTarget(t.pressTargetsByButton[e.button]),n=this.createPointerEvent(e);if(i){let s=i;for(;s;)n.currentTarget=s,this.notifyTarget(n,"pointerupoutside"),"touch"===n.pointerType?this.notifyTarget(n,"touchendoutside"):"mouse"!==n.pointerType&&"pen"!==n.pointerType||this.notifyTarget(n,2===n.button?"rightupoutside":"mouseupoutside"),s=s.parent;delete t.pressTargetsByButton[e.button]}this.freeEvent(n)}mapWheel(e){if(!(e instanceof x))return void(0,_.R)("EventBoundary cannot map a non-wheel event as a wheel event");const t=this.createWheelEvent(e);this.dispatchEvent(t),this.freeEvent(t)}findMountedTarget(e){if(!e)return null;let t=e[0];for(let i=1;i<e.length&&e[i].parent===t;i++)t=e[i];return t}createPointerEvent(e,t,i){const n=this.allocateEvent(b);return this.copyPointerData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.nativeEvent=e.nativeEvent,n.originalEvent=e,n.target=i??this.hitTest(n.global.x,n.global.y)??this._hitElements[0],"string"==typeof t&&(n.type=t),n}createWheelEvent(e){const t=this.allocateEvent(x);return this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.nativeEvent=e.nativeEvent,t.originalEvent=e,t.target=this.hitTest(t.global.x,t.global.y),t}clonePointerEvent(e,t){const i=this.allocateEvent(b);return i.nativeEvent=e.nativeEvent,i.originalEvent=e.originalEvent,this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.target=e.target,i.path=e.composedPath().slice(),i.type=t??i.type,i}copyWheelData(e,t){t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ}copyPointerData(e,t){e instanceof b&&t instanceof b&&(t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist)}copyMouseData(e,t){e instanceof y&&t instanceof y&&(t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.copyFrom(e.client),t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.copyFrom(e.movement),t.screen.copyFrom(e.screen),t.shiftKey=e.shiftKey,t.global.copyFrom(e.global))}copyData(e,t){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.detail=e.detail,t.view=e.view,t.which=e.which,t.layer.copyFrom(e.layer),t.page.copyFrom(e.page)}trackingData(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}allocateEvent(e){this.eventPool.has(e)||this.eventPool.set(e,[]);const t=this.eventPool.get(e).pop()||new e(this);return t.eventPhase=t.NONE,t.currentTarget=null,t.defaultPrevented=!1,t.path=null,t.target=null,t}freeEvent(e){if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");const t=e.constructor;this.eventPool.has(t)||this.eventPool.set(t,[]),this.eventPool.get(t).push(e)}_notifyListeners(e,t){const i=e.currentTarget._events[t];if(i)if("fn"in i)i.once&&e.currentTarget.removeListener(t,i.fn,void 0,!0),i.fn.call(i.context,e);else for(let n=0,s=i.length;n<s&&!e.propagationImmediatelyStopped;n++)i[n].once&&e.currentTarget.removeListener(t,i[n].fn,void 0,!0),i[n].fn.call(i[n].context,e)}}const E={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},C=class e{constructor(t){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=t,this.rootBoundary=new A(null),v.init(this),this.autoPreventDefault=!0,this._eventsAdded=!1,this._rootPointerEvent=new b(null),this._rootWheelEvent=new x(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...e.defaultEventFeatures},{set:(e,t,i)=>("globalMove"===t&&(this.rootBoundary.enableGlobalMoveEvents=i),e[t]=i,!0)}),this._onPointerDown=this._onPointerDown.bind(this),this._onPointerMove=this._onPointerMove.bind(this),this._onPointerUp=this._onPointerUp.bind(this),this._onPointerOverOut=this._onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(t){const{canvas:i,resolution:n}=this.renderer;this.setTargetElement(i),this.resolution=n,e._defaultEventMode=t.eventMode??"passive",Object.assign(this.features,t.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(e){this.resolution=e}destroy(){v.destroy(),this.setTargetElement(null),this.renderer=null,this._currentCursor=null}setCursor(e){e||(e="default");let t=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(t=!1),this._currentCursor===e)return;this._currentCursor=e;const i=this.cursorStyles[e];if(i)switch(typeof i){case"string":t&&(this.domElement.style.cursor=i);break;case"function":i(e);break;case"object":t&&Object.assign(this.domElement.style,i)}else t&&"string"==typeof e&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}get pointer(){return this._rootPointerEvent}_onPointerDown(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const t=this._normalizeToPointerData(e);if(this.autoPreventDefault&&t[0].isNormalized){(e.cancelable||!("cancelable"in e))&&e.preventDefault()}for(let e=0,i=t.length;e<i;e++){const i=t[e],n=this._bootstrapEvent(this._rootPointerEvent,i);this.rootBoundary.mapEvent(n)}this.setCursor(this.rootBoundary.cursor)}_onPointerMove(e){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,v.pointerMoved();const t=this._normalizeToPointerData(e);for(let e=0,i=t.length;e<i;e++){const i=this._bootstrapEvent(this._rootPointerEvent,t[e]);this.rootBoundary.mapEvent(i)}this.setCursor(this.rootBoundary.cursor)}_onPointerUp(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let t=e.target;e.composedPath&&e.composedPath().length>0&&(t=e.composedPath()[0]);const i=t!==this.domElement?"outside":"",n=this._normalizeToPointerData(e);for(let e=0,t=n.length;e<t;e++){const t=this._bootstrapEvent(this._rootPointerEvent,n[e]);t.type+=i,this.rootBoundary.mapEvent(t)}this.setCursor(this.rootBoundary.cursor)}_onPointerOverOut(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;const t=this._normalizeToPointerData(e);for(let e=0,i=t.length;e<i;e++){const i=this._bootstrapEvent(this._rootPointerEvent,t[e]);this.rootBoundary.mapEvent(i)}this.setCursor(this.rootBoundary.cursor)}onWheel(e){if(!this.features.wheel)return;const t=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(t)}setTargetElement(e){this._removeEvents(),this.domElement=e,v.domElement=e,this._addEvents()}_addEvents(){if(this._eventsAdded||!this.domElement)return;v.addTickerListener();const e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this._onPointerMove,!0),this.domElement.addEventListener("pointerdown",this._onPointerDown,!0),this.domElement.addEventListener("pointerleave",this._onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this._onPointerOverOut,!0),globalThis.addEventListener("pointerup",this._onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this._onPointerMove,!0),this.domElement.addEventListener("mousedown",this._onPointerDown,!0),this.domElement.addEventListener("mouseout",this._onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this._onPointerOverOut,!0),globalThis.addEventListener("mouseup",this._onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this._onPointerDown,!0),this.domElement.addEventListener("touchend",this._onPointerUp,!0),this.domElement.addEventListener("touchmove",this._onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this._eventsAdded=!0}_removeEvents(){if(!this._eventsAdded||!this.domElement)return;v.removeTickerListener();const e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction="")),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this._onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this._onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this._onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this._onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this._onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this._onPointerMove,!0),this.domElement.removeEventListener("mousedown",this._onPointerDown,!0),this.domElement.removeEventListener("mouseout",this._onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this._onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this._onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this._onPointerDown,!0),this.domElement.removeEventListener("touchend",this._onPointerUp,!0),this.domElement.removeEventListener("touchmove",this._onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this._eventsAdded=!1}mapPositionToPoint(e,t,i){const n=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},s=1/this.resolution;e.x=(t-n.left)*(this.domElement.width/n.width)*s,e.y=(i-n.top)*(this.domElement.height/n.height)*s}_normalizeToPointerData(e){const t=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(let i=0,n=e.changedTouches.length;i<n;i++){const n=e.changedTouches[i];void 0===n.button&&(n.button=0),void 0===n.buttons&&(n.buttons=1),void 0===n.isPrimary&&(n.isPrimary=1===e.touches.length&&"touchstart"===e.type),void 0===n.width&&(n.width=n.radiusX||1),void 0===n.height&&(n.height=n.radiusY||1),void 0===n.tiltX&&(n.tiltX=0),void 0===n.tiltY&&(n.tiltY=0),void 0===n.pointerType&&(n.pointerType="touch"),void 0===n.pointerId&&(n.pointerId=n.identifier||0),void 0===n.pressure&&(n.pressure=n.force||.5),void 0===n.twist&&(n.twist=0),void 0===n.tangentialPressure&&(n.tangentialPressure=0),void 0===n.layerX&&(n.layerX=n.offsetX=n.clientX),void 0===n.layerY&&(n.layerY=n.offsetY=n.clientY),n.isNormalized=!0,n.type=e.type,t.push(n)}else if(globalThis.MouseEvent&&(!(e instanceof MouseEvent)||this.supportsPointerEvents&&e instanceof globalThis.PointerEvent))t.push(e);else{const i=e;void 0===i.isPrimary&&(i.isPrimary=!0),void 0===i.width&&(i.width=1),void 0===i.height&&(i.height=1),void 0===i.tiltX&&(i.tiltX=0),void 0===i.tiltY&&(i.tiltY=0),void 0===i.pointerType&&(i.pointerType="mouse"),void 0===i.pointerId&&(i.pointerId=1),void 0===i.pressure&&(i.pressure=.5),void 0===i.twist&&(i.twist=0),void 0===i.tangentialPressure&&(i.tangentialPressure=0),i.isNormalized=!0,t.push(i)}return t}normalizeWheelEvent(e){const t=this._rootWheelEvent;return this._transferMouseData(t,e),t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ,t.deltaMode=e.deltaMode,this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.nativeEvent=e,t.type=e.type,t}_bootstrapEvent(e,t){return e.originalEvent=null,e.nativeEvent=t,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this._transferMouseData(e,t),this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=t.isTrusted,"pointerleave"===e.type&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=E[e.type]||e.type),e}_transferMouseData(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.relatedTarget=null,e.shiftKey=t.shiftKey}};C.extension={name:"events",type:[n.Ag.WebGLSystem,n.Ag.CanvasSystem,n.Ag.WebGPUSystem],priority:-1},C.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0};let w=C;const P={onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,get interactive(){return"dynamic"===this.eventMode||"static"===this.eventMode},set interactive(e){this.eventMode=e?"static":"passive"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??w.defaultEventMode},set eventMode(e){this._internalEventMode=e},isInteractive(){return"static"===this.eventMode||"dynamic"===this.eventMode},interactiveChildren:!0,hitArea:null,addEventListener(e,t,i){const n="boolean"==typeof i&&i||"object"==typeof i&&i.capture,s="object"==typeof i?i.signal:void 0,r="object"==typeof i&&!0===i.once,a="function"==typeof t?void 0:t;e=n?`${e}capture`:e;const o="function"==typeof t?t:t.handleEvent,l=this;s&&s.addEventListener("abort",()=>{l.off(e,o,a)}),r?l.once(e,o,a):l.on(e,o,a)},removeEventListener(e,t,i){const n="function"==typeof t?void 0:t;e="boolean"==typeof i&&i||"object"==typeof i&&i.capture?`${e}capture`:e,t="function"==typeof t?t:t.handleEvent,this.off(e,t,n)},dispatchEvent(e){if(!(e instanceof h))throw new Error("Container cannot propagate events outside of the Federated Events API");return e.defaultPrevented=!1,e.path=null,e.target=this,e.manager.dispatchEvent(e),!e.defaultPrevented}};n.XO.add(w),n.XO.mixin(s.mc,P);class I{constructor(e){this._attachedDomElements=[],this._renderer=e,this._renderer.runners.postrender.add(this),this._renderer.runners.init.add(this),this._domElement=document.createElement("div"),this._domElement.style.position="absolute",this._domElement.style.top="0",this._domElement.style.left="0",this._domElement.style.pointerEvents="none",this._domElement.style.zIndex="1000"}init(){this._canvasObserver=new o({domElement:this._domElement,renderer:this._renderer})}addRenderable(e,t){this._attachedDomElements.includes(e)||this._attachedDomElements.push(e)}updateRenderable(e){}validateRenderable(e){return!0}postrender(){const e=this._attachedDomElements;if(0!==e.length){this._canvasObserver.ensureAttached();for(let t=0;t<e.length;t++){const i=e[t],n=i.element;if(!i.parent||i.globalDisplayStatus<7)n?.remove(),e.splice(t,1),t--;else{this._domElement.contains(n)||(n.style.position="absolute",n.style.pointerEvents="auto",this._domElement.appendChild(n));const e=i.worldTransform,t=i._anchor,s=i.width*t.x,r=i.height*t.y;n.style.transformOrigin=`${s}px ${r}px`,n.style.transform=`matrix(${e.a}, ${e.b}, ${e.c}, ${e.d}, ${e.tx-s}, ${e.ty-r})`,n.style.opacity=i.groupAlpha.toString()}}}else this._domElement.remove()}destroy(){this._renderer.runners.postrender.remove(this);for(let e=0;e<this._attachedDomElements.length;e++){const t=this._attachedDomElements[e];t.element?.remove()}this._attachedDomElements.length=0,this._domElement.remove(),this._canvasObserver.destroy(),this._renderer=null}}I.extension={type:[n.Ag.WebGLPipes,n.Ag.WebGPUPipes,n.Ag.CanvasPipes],name:"dom"},n.XO.add(I);i(4767),i(8594),i(8002),i(7757),i(8036),i(1947),i(7732),i(997),i(8991),i(6209),i(7171)},6286:(e,t,i)=>{"use strict";i.d(t,{xv:()=>n});i(2551);const n="8.13.2"},6371:(e,t,i)=>{"use strict";i.d(t,{T:()=>d,w:()=>c});var n=i(7747),s=i(8192),r=i(8457),a=i(3989);function o(e){return e instanceof a.m}function l(e){return e instanceof r._}function h(e,t,i){return e.fill=t,e.color=16777215,e.texture=t.texture,e.matrix=t.transform,{...i,...e}}function u(e,t,i){return t.buildGradient(),e.fill=t,e.color=16777215,e.texture=t.texture,e.matrix=t.transform,e.textureSpace=t.textureSpace,{...i,...e}}function c(e,t){if(null==e)return null;const i={},r=e;return function(e){return n.Q.isColorLike(e)}(e)?function(e,t,i){const r=n.Q.shared.setValue(t??0);return e.color=r.toNumber(),e.alpha=1===r.alpha?i.alpha:r.alpha,e.texture=s.g.WHITE,{...i,...e}}(i,e,t):function(e){return e instanceof s.g}(e)?function(e,t,i){return e.texture=t,{...i,...e}}(i,e,t):o(e)?h(i,e,t):l(e)?u(i,e,t):r.fill&&o(r.fill)?h(r,r.fill,t):r.fill&&l(r.fill)?u(r,r.fill,t):function(e,t){const i={...t,...e},s=n.Q.shared.setValue(i.color);return i.alpha*=s.alpha,i.color=s.toNumber(),i}(r,t)}function d(e,t){const{width:i,alignment:n,miterLimit:s,cap:r,join:a,pixelLine:o,...l}=t,h=c(e,l);return h?{width:i,alignment:n,miterLimit:s,cap:r,join:a,pixelLine:o,...h}:null}},6399:(e,t,i)=>{"use strict";i.d(t,{l:()=>d});var n=i(6680),s=i(2207),r=i(2874);var a=i(2930),o=i(7797),l=i(5884),h=i(8192),u=i(5524);var c=i(8648);class d{constructor(e){this.rootViewPort=new s.M,this.viewport=new s.M,this.onRenderTargetChange=new a.C("onRenderTargetChange"),this.projectionMatrix=new n.u,this.defaultClearColor=[0,0,0,0],this._renderSurfaceToRenderTargetHash=new Map,this._gpuRenderTargetHash=Object.create(null),this._renderTargetStack=[],this._renderer=e,e.renderableGC.addManagedHash(this,"_gpuRenderTargetHash")}finishRenderPass(){this.adaptor.finishRenderPass(this.renderTarget)}renderStart({target:e,clear:t,clearColor:i,frame:n}){this._renderTargetStack.length=0,this.push(e,t,i,n),this.rootViewPort.copyFrom(this.viewport),this.rootRenderTarget=this.renderTarget,this.renderingToScreen=function(e){const t=e.colorTexture.source.resource;return globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement&&document.body.contains(t)}(this.rootRenderTarget),this.adaptor.prerender?.(this.rootRenderTarget)}postrender(){this.adaptor.postrender?.(this.rootRenderTarget)}bind(e,t=!0,i,n){const s=this.getRenderTarget(e),r=this.renderTarget!==s;this.renderTarget=s,this.renderSurface=e;const a=this.getGpuRenderTarget(s);s.pixelWidth===a.width&&s.pixelHeight===a.height||(this.adaptor.resizeGpuRenderTarget(s),a.width=s.pixelWidth,a.height=s.pixelHeight);const o=s.colorTexture,l=this.viewport,u=o.pixelWidth,c=o.pixelHeight;if(!n&&e instanceof h.g&&(n=e.frame),n){const e=o._resolution;l.x=n.x*e+.5|0,l.y=n.y*e+.5|0,l.width=n.width*e+.5|0,l.height=n.height*e+.5|0}else l.x=0,l.y=0,l.width=u,l.height=c;return function(e,t,i,n,s,r){const a=r?1:-1;e.identity(),e.a=1/n*2,e.d=a*(1/s*2),e.tx=-1-t*e.a,e.ty=-a-i*e.d}(this.projectionMatrix,0,0,l.width/o.resolution,l.height/o.resolution,!s.isRoot),this.adaptor.startRenderPass(s,t,i,l),r&&this.onRenderTargetChange.emit(s),s}clear(e,t=r.u.ALL,i){t&&(e&&(e=this.getRenderTarget(e)),this.adaptor.clear(e||this.renderTarget,t,i,this.viewport))}contextChange(){this._gpuRenderTargetHash=Object.create(null)}push(e,t=r.u.ALL,i,n){const s=this.bind(e,t,i,n);return this._renderTargetStack.push({renderTarget:s,frame:n}),s}pop(){this._renderTargetStack.pop();const e=this._renderTargetStack[this._renderTargetStack.length-1];this.bind(e.renderTarget,!1,null,e.frame)}getRenderTarget(e){return e.isTexture&&(e=e.source),this._renderSurfaceToRenderTargetHash.get(e)??this._initRenderTarget(e)}copyToTexture(e,t,i,n,s){i.x<0&&(n.width+=i.x,s.x-=i.x,i.x=0),i.y<0&&(n.height+=i.y,s.y-=i.y,i.y=0);const{pixelWidth:r,pixelHeight:a}=e;return n.width=Math.min(n.width,r-i.x),n.height=Math.min(n.height,a-i.y),this.adaptor.copyToTexture(e,t,i,n,s)}ensureDepthStencil(){this.renderTarget.stencil||(this.renderTarget.stencil=!0,this.adaptor.startRenderPass(this.renderTarget,!1,null,this.viewport))}destroy(){this._renderer=null,this._renderSurfaceToRenderTargetHash.forEach((e,t)=>{e!==t&&e.destroy()}),this._renderSurfaceToRenderTargetHash.clear(),this._gpuRenderTargetHash=Object.create(null)}_initRenderTarget(e){let t=null;return o.q.test(e)&&(e=(0,u.c)(e).source),e instanceof c.O?t=e:e instanceof l.v&&(t=new c.O({colorTextures:[e]}),e.source instanceof o.q&&(t.isRoot=!0),e.once("destroy",()=>{t.destroy(),this._renderSurfaceToRenderTargetHash.delete(e);const i=this._gpuRenderTargetHash[t.uid];i&&(this._gpuRenderTargetHash[t.uid]=null,this.adaptor.destroyGpuRenderTarget(i))})),this._renderSurfaceToRenderTargetHash.set(e,t),t}getGpuRenderTarget(e){return this._gpuRenderTargetHash[e.uid]||(this._gpuRenderTargetHash[e.uid]=this.adaptor.initGpuRenderTarget(e))}resetState(){this.renderTarget=null,this.renderSurface=null}}},6447:(e,t,i)=>{"use strict";i.d(t,{r:()=>u});var n=i(7747),s=i(6680),r=i(8192),a=i(9731),o=i(8457),l=i(3989);const h=1e5;function u(e,t,i,u=0){if(e.texture===r.g.WHITE&&!e.fill)return n.Q.shared.setValue(e.color).setAlpha(e.alpha??1).toHexa();if(!e.fill){const i=t.createPattern(e.texture.source.resource,"repeat"),n=e.matrix.copyTo(s.u.shared);return n.scale(e.texture.frame.width,e.texture.frame.height),i.setTransform(n),i}if(e.fill instanceof l.m){const i=e.fill,n=t.createPattern(i.texture.source.resource,"repeat"),r=i.transform.copyTo(s.u.shared);return r.scale(i.texture.frame.width,i.texture.frame.height),n.setTransform(r),n}if(e.fill instanceof o._){const s=e.fill,r="linear"===s.type,a="local"===s.textureSpace;let o,l=1,c=1;a&&i&&(l=i.width+u,c=i.height+u);let d=!1;if(r){const{start:e,end:i}=s;o=t.createLinearGradient(e.x*l,e.y*c,i.x*l,i.y*c),d=Math.abs(i.x-e.x)<Math.abs(.1*(i.y-e.y))}else{const{center:e,innerRadius:i,outerCenter:n,outerRadius:r}=s;o=t.createRadialGradient(e.x*l,e.y*c,i*l,n.x*l,n.y*c,r*l)}if(d&&a&&i){const e=i.lineHeight/c;for(let t=0;t<i.lines.length;t++){const r=(t*i.lineHeight+u/2)/c;s.colorStops.forEach(t=>{const i=r+t.offset*e;o.addColorStop(Math.floor(i*h)/h,n.Q.shared.setValue(t.color).toHex())})}}else s.colorStops.forEach(e=>{o.addColorStop(e.offset,n.Q.shared.setValue(e.color).toHex())});return o}return(0,a.R)("FillStyle not recognised",e),"red"}},6456:(e,t,i)=>{"use strict";i.d(t,{E:()=>o,f:()=>r});var n=i(6680),s=i(1675);function r(e,t,i){let r,l;return i.clear(),e.parent?t?r=e.parent.worldTransform:(l=s.u.get().identity(),r=o(e,l)):r=n.u.IDENTITY,a(e,i,r,t),l&&s.u.return(l),i.isValid||i.set(0,0,0,0),i}function a(e,t,i,r){if(!e.visible||!e.measurable)return;let o;r?o=e.worldTransform:(e.updateLocalTransform(),o=s.u.get(),o.appendFrom(e.localTransform,i));const l=t,h=!!e.effects.length;if(h&&(t=s.o.get().clear()),e.boundsArea)t.addRect(e.boundsArea,o);else{const i=e.bounds;i&&!i.isEmpty()&&(t.matrix=o,t.addBounds(i));for(let i=0;i<e.children.length;i++)a(e.children[i],t,o,r)}if(h){for(let i=0;i<e.effects.length;i++)e.effects[i].addBounds?.(t);l.addBounds(t,n.u.IDENTITY),s.o.return(t)}r||s.u.return(o)}function o(e,t){const i=e.parent;return i&&(o(i,t),i.updateLocalTransform(),t.append(i.localTransform)),t}},6479:(e,t,i)=>{"use strict";i.d(t,{n:()=>r});var n=i(9037);const s={};function r(e){let t=s[e];if(t)return t;const i=new Int32Array(e);for(let t=0;t<e;t++)i[t]=t;return t=s[e]=new n.k({uTextures:{value:i,type:"i32",size:e}},{isStatic:!0}),t}},6566:(e,t,i)=>{"use strict";i.d(t,{I:()=>w,v:()=>C});var n=i(3381),s=i(1980),r=i(9731);function a(e,t,i){if(e)for(const n in e){const s=t[n.toLocaleLowerCase()];if(s){let t=e[n];"header"===n&&(t=t.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),i&&s.push(`//----${i}----//`),s.push(t)}else(0,r.R)(`${n} placement hook does not exist in shader`)}}const o=/\{\{(.*?)\}\}/g;function l(e){const t={};return(e.match(o)?.map(e=>e.replace(/[{()}]/g,""))??[]).forEach(e=>{t[e]=[]}),t}function h(e,t){let i;const n=/@in\s+([^;]+);/g;for(;null!==(i=n.exec(e));)t.push(i[1])}function u(e,t,i=!1){const n=[];h(t,n),e.forEach(e=>{e.header&&h(e.header,n)});const s=n;i&&s.sort();const r=s.map((e,t)=>`       @location(${t}) ${e},`).join("\n");let a=t.replace(/@in\s+[^;]+;\s*/g,"");return a=a.replace("{{in}}",`\n${r}\n`),a}function c(e,t){let i;const n=/@out\s+([^;]+);/g;for(;null!==(i=n.exec(e));)t.push(i[1])}function d(e,t){let i=e;for(const e in t){const n=t[e];i=n.join("\n").length?i.replace(`{{${e}}}`,`//-----${e} START-----//\n${n.join("\n")}\n//----${e} FINISH----//`):i.replace(`{{${e}}}`,"")}return i}const p=Object.create(null),f=new Map;let g=0;function m({template:e,bits:t}){const i=v(e,t);if(p[i])return p[i];const{vertex:n,fragment:s}=function(e,t){const i=t.map(e=>e.vertex).filter(e=>!!e),n=t.map(e=>e.fragment).filter(e=>!!e);let s=u(i,e.vertex,!0);s=function(e,t){const i=[];c(t,i),e.forEach(e=>{e.header&&c(e.header,i)});let n=0;const s=i.sort().map(e=>e.indexOf("builtin")>-1?e:`@location(${n++}) ${e}`).join(",\n"),r=i.sort().map(e=>{return`       var ${t=e,t.replace(/@.*?\s+/g,"")};`;var t}).join("\n"),a=`return VSOutput(\n            ${i.sort().map(e=>` ${function(e){const t=/\b(\w+)\s*:/g.exec(e);return t?t[1]:""}(e)}`).join(",\n")});`;let o=t.replace(/@out\s+[^;]+;\s*/g,"");return o=o.replace("{{struct}}",`\n${s}\n`),o=o.replace("{{start}}",`\n${r}\n`),o=o.replace("{{return}}",`\n${a}\n`),o}(i,s);const r=u(n,e.fragment,!0);return{vertex:s,fragment:r}}(e,t);return p[i]=y(n,s,t),p[i]}function _({template:e,bits:t}){const i=v(e,t);return p[i]||(p[i]=y(e.vertex,e.fragment,t)),p[i]}function v(e,t){return t.map(e=>(f.has(e)||f.set(e,g++),f.get(e))).sort((e,t)=>e-t).join("-")+e.vertex+e.fragment}function y(e,t,i){const n=l(e),s=l(t);return i.forEach(e=>{a(e.vertex,n,e.name),a(e.fragment,s,e.name)}),{vertex:d(e,n),fragment:d(t,s)}}const b="\n    @in aPosition: vec2<f32>;\n    @in aUV: vec2<f32>;\n\n    @out @builtin(position) vPosition: vec4<f32>;\n    @out vUV : vec2<f32>;\n    @out vColor : vec4<f32>;\n\n    {{header}}\n\n    struct VSOutput {\n        {{struct}}\n    };\n\n    @vertex\n    fn main( {{in}} ) -> VSOutput {\n\n        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;\n        var modelMatrix = mat3x3<f32>(\n            1.0, 0.0, 0.0,\n            0.0, 1.0, 0.0,\n            0.0, 0.0, 1.0\n          );\n        var position = aPosition;\n        var uv = aUV;\n\n        {{start}}\n\n        vColor = vec4<f32>(1., 1., 1., 1.);\n\n        {{main}}\n\n        vUV = uv;\n\n        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;\n\n        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);\n\n        vColor *= globalUniforms.uWorldColorAlpha;\n\n        {{end}}\n\n        {{return}}\n    };\n",x="\n    @in vUV : vec2<f32>;\n    @in vColor : vec4<f32>;\n\n    {{header}}\n\n    @fragment\n    fn main(\n        {{in}}\n      ) -> @location(0) vec4<f32> {\n\n        {{start}}\n\n        var outColor:vec4<f32>;\n\n        {{main}}\n\n        var finalColor:vec4<f32> = outColor * vColor;\n\n        {{end}}\n\n        return finalColor;\n      };\n",T="\n    in vec2 aPosition;\n    in vec2 aUV;\n\n    out vec4 vColor;\n    out vec2 vUV;\n\n    {{header}}\n\n    void main(void){\n\n        mat3 worldTransformMatrix = uWorldTransformMatrix;\n        mat3 modelMatrix = mat3(\n            1.0, 0.0, 0.0,\n            0.0, 1.0, 0.0,\n            0.0, 0.0, 1.0\n          );\n        vec2 position = aPosition;\n        vec2 uv = aUV;\n\n        {{start}}\n\n        vColor = vec4(1.);\n\n        {{main}}\n\n        vUV = uv;\n\n        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;\n\n        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n\n        vColor *= uWorldColorAlpha;\n\n        {{end}}\n    }\n",S="\n\n    in vec4 vColor;\n    in vec2 vUV;\n\n    out vec4 finalColor;\n\n    {{header}}\n\n    void main(void) {\n\n        {{start}}\n\n        vec4 outColor;\n\n        {{main}}\n\n        finalColor = outColor * vColor;\n\n        {{end}}\n    }\n",A={name:"global-uniforms-bit",vertex:{header:"\n        struct GlobalUniforms {\n            uProjectionMatrix:mat3x3<f32>,\n            uWorldTransformMatrix:mat3x3<f32>,\n            uWorldColorAlpha: vec4<f32>,\n            uResolution: vec2<f32>,\n        }\n\n        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;\n        "}},E={name:"global-uniforms-bit",vertex:{header:"\n          uniform mat3 uProjectionMatrix;\n          uniform mat3 uWorldTransformMatrix;\n          uniform vec4 uWorldColorAlpha;\n          uniform vec2 uResolution;\n        "}};function C({bits:e,name:t}){const i=m({template:{fragment:x,vertex:b},bits:[A,...e]});return s.B.from({name:t,vertex:{source:i.vertex,entryPoint:"main"},fragment:{source:i.fragment,entryPoint:"main"}})}function w({bits:e,name:t}){return new n.M({name:t,..._({template:{vertex:T,fragment:S},bits:[E,...e]})})}},6680:(e,t,i)=>{"use strict";i.d(t,{u:()=>r});var n=i(1851),s=i(1828);class r{constructor(e=1,t=0,i=0,n=1,s=0,r=0){this.array=null,this.a=e,this.b=t,this.c=i,this.d=n,this.tx=s,this.ty=r}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,t,i,n,s,r){return this.a=e,this.b=t,this.c=i,this.d=n,this.tx=s,this.ty=r,this}toArray(e,t){this.array||(this.array=new Float32Array(9));const i=t||this.array;return e?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty,i[8]=1):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0,i[8]=1),i}apply(e,t){t=t||new s.b;const i=e.x,n=e.y;return t.x=this.a*i+this.c*n+this.tx,t.y=this.b*i+this.d*n+this.ty,t}applyInverse(e,t){t=t||new s.b;const i=this.a,n=this.b,r=this.c,a=this.d,o=this.tx,l=this.ty,h=1/(i*a+r*-n),u=e.x,c=e.y;return t.x=a*h*u+-r*h*c+(l*r-o*a)*h,t.y=i*h*c+-n*h*u+(-l*i+o*n)*h,t}translate(e,t){return this.tx+=e,this.ty+=t,this}scale(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this}rotate(e){const t=Math.cos(e),i=Math.sin(e),n=this.a,s=this.c,r=this.tx;return this.a=n*t-this.b*i,this.b=n*i+this.b*t,this.c=s*t-this.d*i,this.d=s*i+this.d*t,this.tx=r*t-this.ty*i,this.ty=r*i+this.ty*t,this}append(e){const t=this.a,i=this.b,n=this.c,s=this.d;return this.a=e.a*t+e.b*n,this.b=e.a*i+e.b*s,this.c=e.c*t+e.d*n,this.d=e.c*i+e.d*s,this.tx=e.tx*t+e.ty*n+this.tx,this.ty=e.tx*i+e.ty*s+this.ty,this}appendFrom(e,t){const i=e.a,n=e.b,s=e.c,r=e.d,a=e.tx,o=e.ty,l=t.a,h=t.b,u=t.c,c=t.d;return this.a=i*l+n*u,this.b=i*h+n*c,this.c=s*l+r*u,this.d=s*h+r*c,this.tx=a*l+o*u+t.tx,this.ty=a*h+o*c+t.ty,this}setTransform(e,t,i,n,s,r,a,o,l){return this.a=Math.cos(a+l)*s,this.b=Math.sin(a+l)*s,this.c=-Math.sin(a-o)*r,this.d=Math.cos(a-o)*r,this.tx=e-(i*this.a+n*this.c),this.ty=t-(i*this.b+n*this.d),this}prepend(e){const t=this.tx;if(1!==e.a||0!==e.b||0!==e.c||1!==e.d){const t=this.a,i=this.c;this.a=t*e.a+this.b*e.c,this.b=t*e.b+this.b*e.d,this.c=i*e.a+this.d*e.c,this.d=i*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this}decompose(e){const t=this.a,i=this.b,s=this.c,r=this.d,a=e.pivot,o=-Math.atan2(-s,r),l=Math.atan2(i,t),h=Math.abs(o+l);return h<1e-5||Math.abs(n.TO-h)<1e-5?(e.rotation=l,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=o,e.skew.y=l),e.scale.x=Math.sqrt(t*t+i*i),e.scale.y=Math.sqrt(s*s+r*r),e.position.x=this.tx+(a.x*t+a.y*s),e.position.y=this.ty+(a.x*i+a.y*r),e}invert(){const e=this.a,t=this.b,i=this.c,n=this.d,s=this.tx,r=e*n-t*i;return this.a=n/r,this.b=-t/r,this.c=-i/r,this.d=e/r,this.tx=(i*this.ty-n*s)/r,this.ty=-(e*this.ty-t*s)/r,this}isIdentity(){return 1===this.a&&0===this.b&&0===this.c&&1===this.d&&0===this.tx&&0===this.ty}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const e=new r;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}equals(e){return e.a===this.a&&e.b===this.b&&e.c===this.c&&e.d===this.d&&e.tx===this.tx&&e.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return o.identity()}static get shared(){return a.identity()}}const a=new r,o=new r},6709:(e,t,i)=>{"use strict";i.d(t,{f:()=>Be,i:()=>Oe});var n=i(8602);class s{constructor(e){this._renderer=e}updateRenderable(){}destroyRenderable(){}validateRenderable(){return!1}addRenderable(e,t){this._renderer.renderPipes.batch.break(t),t.add(e)}execute(e){e.isRenderable&&e.render(this._renderer)}destroy(){this._renderer=null}}s.extension={type:[n.Ag.WebGLPipes,n.Ag.WebGPUPipes,n.Ag.CanvasPipes],name:"customRender"};var r=i(6680),a=i(5148),o=i(3065);function l(e,t){const i=e.instructionSet,n=i.instructions;for(let e=0;e<i.instructionSize;e++){const i=n[e];t[i.renderPipeId].execute(i)}}const h=new r.u;class u{constructor(e){this._renderer=e}addRenderGroup(e,t){e.isCachedAsTexture?this._addRenderableCacheAsTexture(e,t):this._addRenderableDirect(e,t)}execute(e){e.isRenderable&&(e.isCachedAsTexture?this._executeCacheAsTexture(e):this._executeDirect(e))}destroy(){this._renderer=null}_addRenderableDirect(e,t){this._renderer.renderPipes.batch.break(t),e._batchableRenderGroup&&(a.Z.return(e._batchableRenderGroup),e._batchableRenderGroup=null),t.add(e)}_addRenderableCacheAsTexture(e,t){const i=e._batchableRenderGroup??(e._batchableRenderGroup=a.Z.get(o.K));i.renderable=e.root,i.transform=e.root.relativeGroupTransform,i.texture=e.texture,i.bounds=e._textureBounds,t.add(e),this._renderer.renderPipes.blendMode.pushBlendMode(e,e.root.groupBlendMode,t),this._renderer.renderPipes.batch.addToBatch(i,t),this._renderer.renderPipes.blendMode.popBlendMode(t)}_executeCacheAsTexture(e){if(e.textureNeedsUpdate){e.textureNeedsUpdate=!1;const t=h.identity().translate(-e._textureBounds.x,-e._textureBounds.y);this._renderer.renderTarget.push(e.texture,!0,null,e.texture.frame),this._renderer.globalUniforms.push({worldTransformMatrix:t,worldColor:4294967295,offset:{x:0,y:0}}),l(e,this._renderer.renderPipes),this._renderer.renderTarget.finishRenderPass(),this._renderer.renderTarget.pop(),this._renderer.globalUniforms.pop()}e._batchableRenderGroup._batcher.updateElement(e._batchableRenderGroup),e._batchableRenderGroup._batcher.geometry.buffers[0].update()}_executeDirect(e){this._renderer.globalUniforms.push({worldTransformMatrix:e.inverseParentTextureTransform,worldColor:e.worldColorAlpha}),l(e,this._renderer.renderPipes),this._renderer.globalUniforms.pop()}}u.extension={type:[n.Ag.WebGLPipes,n.Ag.WebGPUPipes,n.Ag.CanvasPipes],name:"renderGroup"};var c=i(1862),d=i(1819),p=i(3289);function f(e,t){t||(t=0);for(let i=t;i<e.length&&e[i];i++)e[i]=null}var g=i(3079),m=i(4490);const _=new g.mc,v=g.fR|g.ig|g.u;function y(e,t=!1){!function(e){const t=e.root;let i;if(e.renderGroupParent){const n=e.renderGroupParent;e.worldTransform.appendFrom(t.relativeGroupTransform,n.worldTransform),e.worldColor=(0,m.j)(t.groupColor,n.worldColor),i=t.groupAlpha*n.worldAlpha}else e.worldTransform.copyFrom(t.localTransform),e.worldColor=t.localColor,i=t.localAlpha;i=i<0?0:i>1?1:i,e.worldAlpha=i,e.worldColorAlpha=e.worldColor+(255*i<<24)}(e);const i=e.childrenToUpdate,n=e.updateTick++;for(const t in i){const s=Number(t),r=i[t],a=r.list,o=r.index;for(let t=0;t<o;t++){const i=a[t];i.parentRenderGroup===e&&i.relativeRenderGroupDepth===s&&b(i,n,0)}f(a,o),r.index=0}if(t)for(let i=0;i<e.renderGroupChildren.length;i++)y(e.renderGroupChildren[i],t)}function b(e,t,i){if(t===e.updateTick)return;e.updateTick=t,e.didChange=!1;const n=e.localTransform;e.updateLocalTransform();const s=e.parent;if(s&&!s.renderGroup?(i|=e._updateFlags,e.relativeGroupTransform.appendFrom(n,s.relativeGroupTransform),i&v&&x(e,s,i)):(i=e._updateFlags,e.relativeGroupTransform.copyFrom(n),i&v&&x(e,_,i)),!e.renderGroup){const n=e.children,s=n.length;for(let e=0;e<s;e++)b(n[e],t,i);const r=e.parentRenderGroup,a=e;a.renderPipeId&&!r.structureDidChange&&r.updateRenderable(a)}}function x(e,t,i){if(i&g.ig){e.groupColor=(0,m.j)(e.localColor,t.groupColor);let i=e.localAlpha*t.groupAlpha;i=i<0?0:i>1?1:i,e.groupAlpha=i,e.groupColorAlpha=e.groupColor+(255*i<<24)}i&g.u&&(e.groupBlendMode="inherit"===e.localBlendMode?t.groupBlendMode:e.localBlendMode),i&g.fR&&(e.globalDisplayStatus=e.localDisplayStatus&t.globalDisplayStatus),e._updateFlags=0}const T=new r.u;class S{constructor(e){this._renderer=e}render({container:e,transform:t}){const i=e.parent,n=e.renderGroup.renderGroupParent;e.parent=null,e.renderGroup.renderGroupParent=null;const s=this._renderer,r=T;t&&(r.copyFrom(e.renderGroup.localTransform),e.renderGroup.localTransform.copyFrom(t));const a=s.renderPipes;this._updateCachedRenderGroups(e.renderGroup,null),this._updateRenderGroups(e.renderGroup),s.globalUniforms.start({worldTransformMatrix:t?e.renderGroup.localTransform:e.renderGroup.worldTransform,worldColor:e.renderGroup.worldColorAlpha}),l(e.renderGroup,a),a.uniformBatch&&a.uniformBatch.renderEnd(),t&&e.renderGroup.localTransform.copyFrom(r),e.parent=i,e.renderGroup.renderGroupParent=n}destroy(){this._renderer=null}_updateCachedRenderGroups(e,t){if(e._parentCacheAsTextureRenderGroup=t,e.isCachedAsTexture){if(!e.textureNeedsUpdate)return;t=e}for(let i=e.renderGroupChildren.length-1;i>=0;i--)this._updateCachedRenderGroups(e.renderGroupChildren[i],t);if(e.invalidateMatrices(),e.isCachedAsTexture){if(e.textureNeedsUpdate){const t=e.root.getLocalBounds();t.ceil();const i=e.texture;e.texture&&c.W.returnTexture(e.texture,!0);const n=this._renderer,s=e.textureOptions.resolution||n.view.resolution,r=e.textureOptions.antialias??n.view.antialias,a=e.textureOptions.scaleMode??"linear",o=c.W.getOptimalTexture(t.width,t.height,s,r);o._source.style=new d.n({scaleMode:a}),e.texture=o,e._textureBounds||(e._textureBounds=new p.c),e._textureBounds.copyFrom(t),i!==e.texture&&e.renderGroupParent&&(e.renderGroupParent.structureDidChange=!0)}}else e.texture&&(c.W.returnTexture(e.texture,!0),e.texture=null)}_updateRenderGroups(e){const t=this._renderer,i=t.renderPipes;if(e.runOnRender(t),e.instructionSet.renderPipes=i,e.structureDidChange?f(e.childrenRenderablesToUpdate.list,0):function(e,t){const{list:i,index:n}=e.childrenRenderablesToUpdate;let s=!1;for(let e=0;e<n;e++){const n=i[e];if(s=t[n.renderPipeId].validateRenderable(n),s)break}e.structureDidChange=s}(e,i),y(e),e.structureDidChange?(e.structureDidChange=!1,this._buildInstructions(e,t)):this._updateRenderables(e),e.childrenRenderablesToUpdate.index=0,t.renderPipes.batch.upload(e.instructionSet),!e.isCachedAsTexture||e.textureNeedsUpdate)for(let t=0;t<e.renderGroupChildren.length;t++)this._updateRenderGroups(e.renderGroupChildren[t])}_updateRenderables(e){const{list:t,index:i}=e.childrenRenderablesToUpdate;for(let n=0;n<i;n++){const i=t[n];i.didViewUpdate&&e.updateRenderable(i)}f(t,i)}_buildInstructions(e,t){const i=e.root,n=e.instructionSet;n.reset();const s=t.renderPipes?t:t.batch.renderer,r=s.renderPipes;r.batch.buildStart(n),r.blendMode.buildStart(),r.colorMask.buildStart(),i.sortableChildren&&i.sortChildren(),i.collectRenderablesWithEffects(n,s,null),r.batch.buildEnd(n),r.blendMode.buildEnd(n)}}S.extension={type:[n.Ag.WebGLSystem,n.Ag.WebGPUSystem,n.Ag.CanvasSystem],name:"renderGroup"};class A{constructor(e){this._renderer=e}addRenderable(e,t){const i=this._getGpuSprite(e);e.didViewUpdate&&this._updateBatchableSprite(e,i),this._renderer.renderPipes.batch.addToBatch(i,t)}updateRenderable(e){const t=this._getGpuSprite(e);e.didViewUpdate&&this._updateBatchableSprite(e,t),t._batcher.updateElement(t)}validateRenderable(e){const t=this._getGpuSprite(e);return!t._batcher.checkAndUpdateTexture(t,e._texture)}_updateBatchableSprite(e,t){t.bounds=e.visualBounds,t.texture=e._texture}_getGpuSprite(e){return e._gpuData[this._renderer.uid]||this._initGPUSprite(e)}_initGPUSprite(e){const t=new o.K;return t.renderable=e,t.transform=e.groupTransform,t.texture=e._texture,t.bounds=e.visualBounds,t.roundPixels=this._renderer._roundPixels|e._roundPixels,e._gpuData[this._renderer.uid]=t,t}destroy(){this._renderer=null}}A.extension={type:[n.Ag.WebGLPipes,n.Ag.WebGPUPipes,n.Ag.CanvasPipes],name:"sprite"};var E=i(3902),C=i(4060),w=i(8741);const P=class e{constructor(e,t){this.state=C.U.for2d(),this._batchersByInstructionSet=Object.create(null),this._activeBatches=Object.create(null),this.renderer=e,this._adaptor=t,this._adaptor.init?.(this)}static getBatcher(e){return new this._availableBatchers[e]}buildStart(e){let t=this._batchersByInstructionSet[e.uid];t||(t=this._batchersByInstructionSet[e.uid]=Object.create(null),t.default||(t.default=new w.J({maxTextures:this.renderer.limits.maxBatchableTextures}))),this._activeBatches=t,this._activeBatch=this._activeBatches.default;for(const e in this._activeBatches)this._activeBatches[e].begin()}addToBatch(t,i){if(this._activeBatch.name!==t.batcherName){this._activeBatch.break(i);let n=this._activeBatches[t.batcherName];n||(n=this._activeBatches[t.batcherName]=e.getBatcher(t.batcherName),n.begin()),this._activeBatch=n}this._activeBatch.add(t)}break(e){this._activeBatch.break(e)}buildEnd(e){this._activeBatch.break(e);const t=this._activeBatches;for(const e in t){const i=t[e],n=i.geometry;n.indexBuffer.setDataWithSize(i.indexBuffer,i.indexSize,!0),n.buffers[0].setDataWithSize(i.attributeBuffer.float32View,i.attributeSize,!1)}}upload(e){const t=this._batchersByInstructionSet[e.uid];for(const e in t){const i=t[e],n=i.geometry;i.dirty&&(i.dirty=!1,n.buffers[0].update(4*i.attributeSize))}}execute(e){if("startBatch"===e.action){const t=e.batcher,i=t.geometry,n=t.shader;this._adaptor.start(this,i,n)}this._adaptor.execute(this,e)}destroy(){this.state=null,this.renderer=null,this._adaptor=null;for(const e in this._activeBatches)this._activeBatches[e].destroy();this._activeBatches=null}};P.extension={type:[n.Ag.WebGLPipes,n.Ag.WebGPUPipes,n.Ag.CanvasPipes],name:"batch"},P._availableBatchers=Object.create(null);let I=P;n.XO.handleByMap(n.Ag.Batcher,I._availableBatchers),n.XO.add(w.J);var M=i(9302),R=i(3381),L=i(1980),k=i(9037),D=i(8179),O=i(2245),B="struct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,\n};\n\nstruct MaskUniforms {\n  uFilterMatrix:mat3x3<f32>,\n  uMaskClamp:vec4<f32>,\n  uAlpha:f32,\n  uInverse:f32,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n@group(0) @binding(1) var uTexture: texture_2d<f32>;\n@group(0) @binding(2) var uSampler : sampler;\n\n@group(1) @binding(0) var<uniform> filterUniforms : MaskUniforms;\n@group(1) @binding(1) var uMaskTexture: texture_2d<f32>;\n\nstruct VSOutput {\n    @builtin(position) position: vec4<f32>,\n    @location(0) uv : vec2<f32>,\n    @location(1) filterUv : vec2<f32>,\n};\n\nfn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>\n{\n    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;\n\n    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;\n    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;\n\n    return vec4(position, 0.0, 1.0);\n}\n\nfn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>\n{\n    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);\n}\n\nfn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>\n{\n  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);\n}\n\nfn getFilterCoord(aPosition:vec2<f32> ) -> vec2<f32>\n{\n  return ( filterUniforms.uFilterMatrix * vec3( filterTextureCoord(aPosition), 1.0)  ).xy;\n}\n\nfn getSize() -> vec2<f32>\n{\n  return gfu.uGlobalFrame.zw;\n}\n\n@vertex\nfn mainVertex(\n  @location(0) aPosition : vec2<f32>,\n) -> VSOutput {\n  return VSOutput(\n   filterVertexPosition(aPosition),\n   filterTextureCoord(aPosition),\n   getFilterCoord(aPosition)\n  );\n}\n\n@fragment\nfn mainFragment(\n  @location(0) uv: vec2<f32>,\n  @location(1) filterUv: vec2<f32>,\n  @builtin(position) position: vec4<f32>\n) -> @location(0) vec4<f32> {\n\n    var maskClamp = filterUniforms.uMaskClamp;\n    var uAlpha = filterUniforms.uAlpha;\n\n    var clip = step(3.5,\n      step(maskClamp.x, filterUv.x) +\n      step(maskClamp.y, filterUv.y) +\n      step(filterUv.x, maskClamp.z) +\n      step(filterUv.y, maskClamp.w));\n\n    var mask = textureSample(uMaskTexture, uSampler, filterUv);\n    var source = textureSample(uTexture, uSampler, uv);\n    var alphaMul = 1.0 - uAlpha * (1.0 - mask.a);\n\n    var a: f32 = alphaMul * mask.r * uAlpha * clip;\n\n    if (filterUniforms.uInverse == 1.0) {\n        a = 1.0 - a;\n    }\n\n    return source * a;\n}\n";class G extends O.d{constructor(e){const{sprite:t,...i}=e,n=new D.N(t.texture),s=new k.k({uFilterMatrix:{value:new r.u,type:"mat3x3<f32>"},uMaskClamp:{value:n.uClampFrame,type:"vec4<f32>"},uAlpha:{value:1,type:"f32"},uInverse:{value:e.inverse?1:0,type:"f32"}});super({...i,gpuProgram:L.B.from({vertex:{source:B,entryPoint:"mainVertex"},fragment:{source:B,entryPoint:"mainFragment"}}),glProgram:R.M.from({vertex:"in vec2 aPosition;\n\nout vec2 vTextureCoord;\nout vec2 vMaskCoord;\n\n\nuniform vec4 uInputSize;\nuniform vec4 uOutputFrame;\nuniform vec4 uOutputTexture;\nuniform mat3 uFilterMatrix;\n\nvec4 filterVertexPosition(  vec2 aPosition )\n{\n    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;\n       \n    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;\n    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;\n\n    return vec4(position, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord(  vec2 aPosition )\n{\n    return aPosition * (uOutputFrame.zw * uInputSize.zw);\n}\n\nvec2 getFilterCoord( vec2 aPosition )\n{\n    return  ( uFilterMatrix * vec3( filterTextureCoord(aPosition), 1.0)  ).xy;\n}   \n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition(aPosition);\n    vTextureCoord = filterTextureCoord(aPosition);\n    vMaskCoord = getFilterCoord(aPosition);\n}\n",fragment:"in vec2 vMaskCoord;\nin vec2 vTextureCoord;\n\nuniform sampler2D uTexture;\nuniform sampler2D uMaskTexture;\n\nuniform float uAlpha;\nuniform vec4 uMaskClamp;\nuniform float uInverse;\n\nout vec4 finalColor;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(uMaskClamp.x, vMaskCoord.x) +\n        step(uMaskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, uMaskClamp.z) +\n        step(vMaskCoord.y, uMaskClamp.w));\n\n    // TODO look into why this is needed\n    float npmAlpha = uAlpha;\n    vec4 original = texture(uTexture, vTextureCoord);\n    vec4 masky = texture(uMaskTexture, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    float a = alphaMul * masky.r * npmAlpha * clip;\n\n    if (uInverse == 1.0) {\n        a = 1.0 - a;\n    }\n\n    finalColor = original * a;\n}\n",name:"mask-filter"}),clipToViewport:!1,resources:{filterUniforms:s,uMaskTexture:t.texture.source}}),this.sprite=t,this._textureMatrix=n}set inverse(e){this.resources.filterUniforms.uniforms.uInverse=e?1:0}get inverse(){return 1===this.resources.filterUniforms.uniforms.uInverse}apply(e,t,i,n){this._textureMatrix.texture=this.sprite.texture,e.calculateSpriteMatrix(this.resources.filterUniforms.uniforms.uFilterMatrix,this.sprite).prepend(this._textureMatrix.mapCoord),this.resources.uMaskTexture=this.sprite.texture.source,e.applyFilter(this,t,i,n)}}var F=i(6456),U=i(5337),N=i(8192),z=i(9998);const H=new p.c;class V extends M.a{constructor(){super(),this.filters=[new G({sprite:new U.k(N.g.EMPTY),inverse:!1,resolution:"inherit",antialias:"inherit"})]}get sprite(){return this.filters[0].sprite}set sprite(e){this.filters[0].sprite=e}get inverse(){return this.filters[0].inverse}set inverse(e){this.filters[0].inverse=e}}class W{constructor(e){this._activeMaskStage=[],this._renderer=e}push(e,t,i){const n=this._renderer;if(n.renderPipes.batch.break(i),i.add({renderPipeId:"alphaMask",action:"pushMaskBegin",mask:e,inverse:t._maskOptions.inverse,canBundle:!1,maskedContainer:t}),e.inverse=t._maskOptions.inverse,e.renderMaskToTexture){const t=e.mask;t.includeInBuild=!0,t.collectRenderables(i,n,null),t.includeInBuild=!1}n.renderPipes.batch.break(i),i.add({renderPipeId:"alphaMask",action:"pushMaskEnd",mask:e,maskedContainer:t,inverse:t._maskOptions.inverse,canBundle:!1})}pop(e,t,i){this._renderer.renderPipes.batch.break(i),i.add({renderPipeId:"alphaMask",action:"popMaskEnd",mask:e,inverse:t._maskOptions.inverse,canBundle:!1})}execute(e){const t=this._renderer,i=e.mask.renderMaskToTexture;if("pushMaskBegin"===e.action){const n=a.Z.get(V);if(n.inverse=e.inverse,i){e.mask.mask.measurable=!0;const i=(0,F.f)(e.mask.mask,!0,H);e.mask.mask.measurable=!1,i.ceil();const s=t.renderTarget.renderTarget.colorTexture.source,r=c.W.getOptimalTexture(i.width,i.height,s._resolution,s.antialias);t.renderTarget.push(r,!0),t.globalUniforms.push({offset:i,worldColor:4294967295});const a=n.sprite;a.texture=r,a.worldTransform.tx=i.minX,a.worldTransform.ty=i.minY,this._activeMaskStage.push({filterEffect:n,maskedContainer:e.maskedContainer,filterTexture:r})}else n.sprite=e.mask.mask,this._activeMaskStage.push({filterEffect:n,maskedContainer:e.maskedContainer})}else if("pushMaskEnd"===e.action){const e=this._activeMaskStage[this._activeMaskStage.length-1];i&&(t.type===z.W.WEBGL&&t.renderTarget.finishRenderPass(),t.renderTarget.pop(),t.globalUniforms.pop()),t.filter.push({renderPipeId:"filter",action:"pushFilter",container:e.maskedContainer,filterEffect:e.filterEffect,canBundle:!1})}else if("popMaskEnd"===e.action){t.filter.pop();const e=this._activeMaskStage.pop();i&&c.W.returnTexture(e.filterTexture),a.Z.return(e.filterEffect)}}destroy(){this._renderer=null,this._activeMaskStage=null}}W.extension={type:[n.Ag.WebGLPipes,n.Ag.WebGPUPipes,n.Ag.CanvasPipes],name:"alphaMask"};class j{constructor(e){this._colorStack=[],this._colorStackIndex=0,this._currentColor=0,this._renderer=e}buildStart(){this._colorStack[0]=15,this._colorStackIndex=1,this._currentColor=15}push(e,t,i){this._renderer.renderPipes.batch.break(i);const n=this._colorStack;n[this._colorStackIndex]=n[this._colorStackIndex-1]&e.mask;const s=this._colorStack[this._colorStackIndex];s!==this._currentColor&&(this._currentColor=s,i.add({renderPipeId:"colorMask",colorMask:s,canBundle:!1})),this._colorStackIndex++}pop(e,t,i){this._renderer.renderPipes.batch.break(i);const n=this._colorStack;this._colorStackIndex--;const s=n[this._colorStackIndex-1];s!==this._currentColor&&(this._currentColor=s,i.add({renderPipeId:"colorMask",colorMask:s,canBundle:!1}))}execute(e){this._renderer.colorMask.setMask(e.colorMask)}destroy(){this._renderer=null,this._colorStack=null}}j.extension={type:[n.Ag.WebGLPipes,n.Ag.WebGPUPipes,n.Ag.CanvasPipes],name:"colorMask"};var X=i(2874),Y=i(6954);class K{constructor(e){this._maskStackHash={},this._maskHash=new WeakMap,this._renderer=e}push(e,t,i){var n;const s=e,r=this._renderer;r.renderPipes.batch.break(i),r.renderPipes.blendMode.setBlendMode(s.mask,"none",i),i.add({renderPipeId:"stencilMask",action:"pushMaskBegin",mask:e,inverse:t._maskOptions.inverse,canBundle:!1});const a=s.mask;a.includeInBuild=!0,this._maskHash.has(s)||this._maskHash.set(s,{instructionsStart:0,instructionsLength:0});const o=this._maskHash.get(s);o.instructionsStart=i.instructionSize,a.collectRenderables(i,r,null),a.includeInBuild=!1,r.renderPipes.batch.break(i),i.add({renderPipeId:"stencilMask",action:"pushMaskEnd",mask:e,inverse:t._maskOptions.inverse,canBundle:!1});const l=i.instructionSize-o.instructionsStart-1;o.instructionsLength=l;const h=r.renderTarget.renderTarget.uid;(n=this._maskStackHash)[h]??(n[h]=0)}pop(e,t,i){const n=e,s=this._renderer;s.renderPipes.batch.break(i),s.renderPipes.blendMode.setBlendMode(n.mask,"none",i),i.add({renderPipeId:"stencilMask",action:"popMaskBegin",inverse:t._maskOptions.inverse,canBundle:!1});const r=this._maskHash.get(e);for(let e=0;e<r.instructionsLength;e++)i.instructions[i.instructionSize++]=i.instructions[r.instructionsStart++];i.add({renderPipeId:"stencilMask",action:"popMaskEnd",canBundle:!1})}execute(e){var t;const i=this._renderer,n=i.renderTarget.renderTarget.uid;let s=(t=this._maskStackHash)[n]??(t[n]=0);"pushMaskBegin"===e.action?(i.renderTarget.ensureDepthStencil(),i.stencil.setStencilMode(Y.K.RENDERING_MASK_ADD,s),s++,i.colorMask.setMask(0)):"pushMaskEnd"===e.action?(e.inverse?i.stencil.setStencilMode(Y.K.INVERSE_MASK_ACTIVE,s):i.stencil.setStencilMode(Y.K.MASK_ACTIVE,s),i.colorMask.setMask(15)):"popMaskBegin"===e.action?(i.colorMask.setMask(0),0!==s?i.stencil.setStencilMode(Y.K.RENDERING_MASK_REMOVE,s):(i.renderTarget.clear(null,X.u.STENCIL),i.stencil.setStencilMode(Y.K.DISABLED,s)),s--):"popMaskEnd"===e.action&&(e.inverse?i.stencil.setStencilMode(Y.K.INVERSE_MASK_ACTIVE,s):i.stencil.setStencilMode(Y.K.MASK_ACTIVE,s),i.colorMask.setMask(15)),this._maskStackHash[n]=s}destroy(){this._renderer=null,this._maskStackHash=null,this._maskHash=null}}K.extension={type:[n.Ag.WebGLPipes,n.Ag.WebGPUPipes,n.Ag.CanvasPipes],name:"stencilMask"};var q=i(7747),$=i(9731);const Q=class e{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new q.Q(0),this.color=this._backgroundColor,this.alpha=1}init(t){t={...e.defaultOptions,...t},this.clearBeforeRender=t.clearBeforeRender,this.color=t.background||t.backgroundColor||this._backgroundColor,this.alpha=t.backgroundAlpha,this._backgroundColor.setAlpha(t.backgroundAlpha)}get color(){return this._backgroundColor}set color(e){q.Q.shared.setValue(e).alpha<1&&1===this._backgroundColor.alpha&&(0,$.R)("Cannot set a transparent background on an opaque canvas. To enable transparency, set backgroundAlpha < 1 when initializing your Application."),this._backgroundColor.setValue(e)}get alpha(){return this._backgroundColor.alpha}set alpha(e){this._backgroundColor.setAlpha(e)}get colorRgba(){return this._backgroundColor.toArray()}destroy(){}};Q.extension={type:[n.Ag.WebGLSystem,n.Ag.WebGPUSystem,n.Ag.CanvasSystem],name:"background",priority:0},Q.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0};let Z=Q;var J=i(3797);const ee={};n.XO.handle(n.Ag.BlendMode,e=>{if(!e.name)throw new Error("BlendMode extension must have a name property");ee[e.name]=e.ref},e=>{delete ee[e.name]});class te{constructor(e){this._blendModeStack=[],this._isAdvanced=!1,this._filterHash=Object.create(null),this._renderer=e,this._renderer.runners.prerender.add(this)}prerender(){this._activeBlendMode="normal",this._isAdvanced=!1}pushBlendMode(e,t,i){this._blendModeStack.push(t),this.setBlendMode(e,t,i)}popBlendMode(e){this._blendModeStack.pop();const t=this._blendModeStack[this._activeBlendMode.length-1]??"normal";this.setBlendMode(null,t,e)}setBlendMode(e,t,i){const n=e instanceof J.m;this._activeBlendMode!==t?(this._isAdvanced&&this._endAdvancedBlendMode(i),this._activeBlendMode=t,e&&(this._isAdvanced=!!ee[t],this._isAdvanced&&this._beginAdvancedBlendMode(e,i))):this._isAdvanced&&e&&!n&&this._renderableList?.push(e)}_beginAdvancedBlendMode(e,t){this._renderer.renderPipes.batch.break(t);const i=this._activeBlendMode;if(!ee[i])return void(0,$.R)(`Unable to assign BlendMode: '${i}'. You may want to include: import 'pixi.js/advanced-blend-modes'`);const n=this._ensureFilterEffect(i),s=e instanceof J.m,r={renderPipeId:"filter",action:"pushFilter",filterEffect:n,renderables:s?null:[e],container:s?e.root:null,canBundle:!1};this._renderableList=r.renderables,t.add(r)}_ensureFilterEffect(e){let t=this._filterHash[e];return t||(t=this._filterHash[e]=new M.a,t.filters=[new ee[e]]),t}_endAdvancedBlendMode(e){this._isAdvanced=!1,this._renderableList=null,this._renderer.renderPipes.batch.break(e),e.add({renderPipeId:"filter",action:"popFilter",canBundle:!1})}buildStart(){this._isAdvanced=!1}buildEnd(e){this._isAdvanced&&this._endAdvancedBlendMode(e)}destroy(){this._renderer=null,this._renderableList=null;for(const e in this._filterHash)this._filterHash[e].destroy();this._filterHash=null}}te.extension={type:[n.Ag.WebGLPipes,n.Ag.WebGPUPipes,n.Ag.CanvasPipes],name:"blendMode"};var ie=i(5553);const ne={png:"image/png",jpg:"image/jpeg",webp:"image/webp"},se=class e{constructor(e){this._renderer=e}_normalizeOptions(e,t={}){return e instanceof g.mc||e instanceof N.g?{target:e,...t}:{...t,...e}}async image(e){const t=ie.e.get().createImage();return t.src=await this.base64(e),t}async base64(t){t=this._normalizeOptions(t,e.defaultImageOptions);const{format:i,quality:n}=t,s=this.canvas(t);if(void 0!==s.toBlob)return new Promise((e,t)=>{s.toBlob(i=>{if(!i)return void t(new Error("ICanvas.toBlob failed!"));const n=new FileReader;n.onload=()=>e(n.result),n.onerror=t,n.readAsDataURL(i)},ne[i],n)});if(void 0!==s.toDataURL)return s.toDataURL(ne[i],n);if(void 0!==s.convertToBlob){const e=await s.convertToBlob({type:ne[i],quality:n});return new Promise((t,i)=>{const n=new FileReader;n.onload=()=>t(n.result),n.onerror=i,n.readAsDataURL(e)})}throw new Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(e){const t=(e=this._normalizeOptions(e)).target,i=this._renderer;if(t instanceof N.g)return i.texture.generateCanvas(t);const n=i.textureGenerator.generateTexture(e),s=i.texture.generateCanvas(n);return n.destroy(!0),s}pixels(e){const t=(e=this._normalizeOptions(e)).target,i=this._renderer,n=t instanceof N.g?t:i.textureGenerator.generateTexture(e),s=i.texture.getPixels(n);return t instanceof g.mc&&n.destroy(!0),s}texture(e){return(e=this._normalizeOptions(e)).target instanceof N.g?e.target:this._renderer.textureGenerator.generateTexture(e)}download(e){e=this._normalizeOptions(e);const t=this.canvas(e),i=document.createElement("a");i.download=e.filename??"image.png",i.href=t.toDataURL("image/png"),document.body.appendChild(i),i.click(),document.body.removeChild(i)}log(e){const t=e.width??200;e=this._normalizeOptions(e);const i=this.canvas(e),n=i.toDataURL();console.log(`[Pixi Texture] ${i.width}px ${i.height}px`);const s=["font-size: 1px;",`padding: ${t}px 300px;`,`background: url(${n}) no-repeat;`,"background-size: contain;"].join(" ");console.log("%c ",s)}destroy(){this._renderer=null}};se.extension={type:[n.Ag.WebGLSystem,n.Ag.WebGPUSystem],name:"extract"},se.defaultImageOptions={format:"png",quality:1};let re=se;var ae=i(2207),oe=i(2276),le=i(5884);class he extends N.g{static create(e){return new he({source:new le.v(e)})}resize(e,t,i){return this.source.resize(e,t,i),this}}const ue=new ae.M,ce=new p.c,de=[0,0,0,0];class pe{constructor(e){this._renderer=e}generateTexture(e){e instanceof g.mc&&(e={target:e,frame:void 0,textureSourceOptions:{},resolution:void 0});const t=e.resolution||this._renderer.resolution,i=e.antialias||this._renderer.view.antialias,n=e.target;let s=e.clearColor;if(s){s=Array.isArray(s)&&4===s.length?s:q.Q.shared.setValue(s).toArray()}else s=de;const a=e.frame?.copyTo(ue)||(0,oe.n)(n,ce).rectangle;a.width=0|Math.max(a.width,1/t),a.height=0|Math.max(a.height,1/t);const o=he.create({...e.textureSourceOptions,width:a.width,height:a.height,resolution:t,antialias:i}),l=r.u.shared.translate(-a.x,-a.y);return this._renderer.render({container:n,transform:l,target:o,clearColor:s}),o.source.updateMipmaps(),o}destroy(){this._renderer=null}}pe.extension={type:[n.Ag.WebGLSystem,n.Ag.WebGPUSystem],name:"textureGenerator"};var fe=i(1828),ge=i(1965),me=i(3650);class _e{constructor(e){this._stackIndex=0,this._globalUniformDataStack=[],this._uniformsPool=[],this._activeUniforms=[],this._bindGroupPool=[],this._activeBindGroups=[],this._renderer=e}reset(){this._stackIndex=0;for(let e=0;e<this._activeUniforms.length;e++)this._uniformsPool.push(this._activeUniforms[e]);for(let e=0;e<this._activeBindGroups.length;e++)this._bindGroupPool.push(this._activeBindGroups[e]);this._activeUniforms.length=0,this._activeBindGroups.length=0}start(e){this.reset(),this.push(e)}bind({size:e,projectionMatrix:t,worldTransformMatrix:i,worldColor:n,offset:s}){const a=this._renderer.renderTarget.renderTarget,o=this._stackIndex?this._globalUniformDataStack[this._stackIndex-1]:{projectionData:a,worldTransformMatrix:new r.u,worldColor:4294967295,offset:new fe.b},l={projectionMatrix:t||this._renderer.renderTarget.projectionMatrix,resolution:e||a.size,worldTransformMatrix:i||o.worldTransformMatrix,worldColor:n||o.worldColor,offset:s||o.offset,bindGroup:null},h=this._uniformsPool.pop()||this._createUniforms();this._activeUniforms.push(h);const u=h.uniforms;let c;u.uProjectionMatrix=l.projectionMatrix,u.uResolution=l.resolution,u.uWorldTransformMatrix.copyFrom(l.worldTransformMatrix),u.uWorldTransformMatrix.tx-=l.offset.x,u.uWorldTransformMatrix.ty-=l.offset.y,(0,ge.V)(l.worldColor,u.uWorldColorAlpha,0),h.update(),this._renderer.renderPipes.uniformBatch?c=this._renderer.renderPipes.uniformBatch.getUniformBindGroup(h,!1):(c=this._bindGroupPool.pop()||new me.T,this._activeBindGroups.push(c),c.setResource(h,0)),l.bindGroup=c,this._currentGlobalUniformData=l}push(e){this.bind(e),this._globalUniformDataStack[this._stackIndex++]=this._currentGlobalUniformData}pop(){this._currentGlobalUniformData=this._globalUniformDataStack[--this._stackIndex-1],this._renderer.type===z.W.WEBGL&&this._currentGlobalUniformData.bindGroup.resources[0].update()}get bindGroup(){return this._currentGlobalUniformData.bindGroup}get globalUniformData(){return this._currentGlobalUniformData}get uniformGroup(){return this._currentGlobalUniformData.bindGroup.resources[0]}_createUniforms(){return new k.k({uProjectionMatrix:{value:new r.u,type:"mat3x3<f32>"},uWorldTransformMatrix:{value:new r.u,type:"mat3x3<f32>"},uWorldColorAlpha:{value:new Float32Array(4),type:"vec4<f32>"},uResolution:{value:[0,0],type:"vec2<f32>"}},{isStatic:!0})}destroy(){this._renderer=null,this._globalUniformDataStack.length=0,this._uniformsPool.length=0,this._activeUniforms.length=0,this._bindGroupPool.length=0,this._activeBindGroups.length=0,this._currentGlobalUniformData=null}}_e.extension={type:[n.Ag.WebGLSystem,n.Ag.WebGPUSystem,n.Ag.CanvasSystem],name:"globalUniforms"};var ve=i(379);let ye=1;class be{constructor(){this._tasks=[],this._offset=0}init(){ve.R.system.add(this._update,this)}repeat(e,t,i=!0){const n=ye++;let s=0;return i&&(this._offset+=1e3,s=this._offset),this._tasks.push({func:e,duration:t,start:performance.now(),offset:s,last:performance.now(),repeat:!0,id:n}),n}cancel(e){for(let t=0;t<this._tasks.length;t++)if(this._tasks[t].id===e)return void this._tasks.splice(t,1)}_update(){const e=performance.now();for(let t=0;t<this._tasks.length;t++){const i=this._tasks[t];if(e-i.offset-i.last>=i.duration){const t=e-i.start;i.func(t),i.last=e}}}destroy(){ve.R.system.remove(this._update,this),this._tasks.length=0}}be.extension={type:[n.Ag.WebGLSystem,n.Ag.WebGPUSystem,n.Ag.CanvasSystem],name:"scheduler",priority:0};var xe=i(6286);let Te=!1;class Se{constructor(e){this._renderer=e}init(e){if(e.hello){let e=this._renderer.name;this._renderer.type===z.W.WEBGL&&(e+=` ${this._renderer.context.webGLVersion}`),function(e){if(!Te){if(ie.e.get().getNavigator().userAgent.toLowerCase().indexOf("chrome")>-1){const t=[`%c  %c  %c  %c  %c PixiJS %c v${xe.xv} (${e}) http://www.pixijs.com/\n\n`,"background: #E72264; padding:5px 0;","background: #6CA2EA; padding:5px 0;","background: #B5D33D; padding:5px 0;","background: #FED23F; padding:5px 0;","color: #FFFFFF; background: #E72264; padding:5px 0;","color: #E72264; background: #FFFFFF; padding:5px 0;"];globalThis.console.log(...t)}else globalThis.console&&globalThis.console.log(`PixiJS ${xe.xv} - ${e} - http://www.pixijs.com/`);Te=!0}}(e)}}}function Ae(e){let t=!1;for(const i in e)if(null==e[i]){t=!0;break}if(!t)return e;const i=Object.create(null);for(const t in e){const n=e[t];n&&(i[t]=n)}return i}function Ee(e){let t=0;for(let i=0;i<e.length;i++)null==e[i]?t++:e[i-t]=e[i];return e.length-=t,e}Se.extension={type:[n.Ag.WebGLSystem,n.Ag.WebGPUSystem,n.Ag.CanvasSystem],name:"hello",priority:-2},Se.defaultOptions={hello:!1};let Ce=0;const we=class e{constructor(e){this._managedRenderables=[],this._managedHashes=[],this._managedArrays=[],this._renderer=e}init(t){t={...e.defaultOptions,...t},this.maxUnusedTime=t.renderableGCMaxUnusedTime,this._frequency=t.renderableGCFrequency,this.enabled=t.renderableGCActive}get enabled(){return!!this._handler}set enabled(e){this.enabled!==e&&(e?(this._handler=this._renderer.scheduler.repeat(()=>this.run(),this._frequency,!1),this._hashHandler=this._renderer.scheduler.repeat(()=>{for(const e of this._managedHashes)e.context[e.hash]=Ae(e.context[e.hash])},this._frequency),this._arrayHandler=this._renderer.scheduler.repeat(()=>{for(const e of this._managedArrays)Ee(e.context[e.hash])},this._frequency)):(this._renderer.scheduler.cancel(this._handler),this._renderer.scheduler.cancel(this._hashHandler),this._renderer.scheduler.cancel(this._arrayHandler)))}addManagedHash(e,t){this._managedHashes.push({context:e,hash:t})}addManagedArray(e,t){this._managedArrays.push({context:e,hash:t})}prerender({container:e}){this._now=performance.now(),e.renderGroup.gcTick=Ce++,this._updateInstructionGCTick(e.renderGroup,e.renderGroup.gcTick)}addRenderable(e){this.enabled&&(-1===e._lastUsed&&(this._managedRenderables.push(e),e.once("destroyed",this._removeRenderable,this)),e._lastUsed=this._now)}run(){const e=this._now,t=this._managedRenderables,i=this._renderer.renderPipes;let n=0;for(let s=0;s<t.length;s++){const r=t[s];if(null===r){n++;continue}const a=r.renderGroup??r.parentRenderGroup,o=a?.instructionSet?.gcTick??-1;if((a?.gcTick??0)===o&&(r._lastUsed=e),e-r._lastUsed>this.maxUnusedTime){if(!r.destroyed){const e=i;a&&(a.structureDidChange=!0),e[r.renderPipeId].destroyRenderable(r)}r._lastUsed=-1,n++,r.off("destroyed",this._removeRenderable,this)}else t[s-n]=r}t.length-=n}destroy(){this.enabled=!1,this._renderer=null,this._managedRenderables.length=0,this._managedHashes.length=0,this._managedArrays.length=0}_removeRenderable(e){const t=this._managedRenderables.indexOf(e);t>=0&&(e.off("destroyed",this._removeRenderable,this),this._managedRenderables[t]=null)}_updateInstructionGCTick(e,t){e.instructionSet.gcTick=t;for(const i of e.renderGroupChildren)this._updateInstructionGCTick(i,t)}};we.extension={type:[n.Ag.WebGLSystem,n.Ag.WebGPUSystem],name:"renderableGC",priority:0},we.defaultOptions={renderableGCActive:!0,renderableGCMaxUnusedTime:6e4,renderableGCFrequency:3e4};let Pe=we;const Ie=class e{constructor(e){this._renderer=e,this.count=0,this.checkCount=0}init(t){t={...e.defaultOptions,...t},this.checkCountMax=t.textureGCCheckCountMax,this.maxIdle=t.textureGCAMaxIdle??t.textureGCMaxIdle,this.active=t.textureGCActive}postrender(){this._renderer.renderingToScreen&&(this.count++,this.active&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){const e=this._renderer.texture.managedTextures;for(let t=0;t<e.length;t++){const i=e[t];i.autoGarbageCollect&&i.resource&&i._touched>-1&&this.count-i._touched>this.maxIdle&&(i._touched=-1,i.unload())}}destroy(){this._renderer=null}};Ie.extension={type:[n.Ag.WebGLSystem,n.Ag.WebGPUSystem],name:"textureGC"},Ie.defaultOptions={textureGCActive:!0,textureGCAMaxIdle:null,textureGCMaxIdle:3600,textureGCCheckCountMax:600};let Me=Ie;var Re=i(4303),Le=i(8648),ke=i(5524);const De=class e{get autoDensity(){return this.texture.source.autoDensity}set autoDensity(e){this.texture.source.autoDensity=e}get resolution(){return this.texture.source._resolution}set resolution(e){this.texture.source.resize(this.texture.source.width,this.texture.source.height,e)}init(t){(t={...e.defaultOptions,...t}).view&&((0,Re.t6)(Re.lj,"ViewSystem.view has been renamed to ViewSystem.canvas"),t.canvas=t.view),this.screen=new ae.M(0,0,t.width,t.height),this.canvas=t.canvas||ie.e.get().createCanvas(),this.antialias=!!t.antialias,this.texture=(0,ke.c)(this.canvas,t),this.renderTarget=new Le.O({colorTextures:[this.texture],depth:!!t.depth,isRoot:!0}),this.texture.source.transparent=t.backgroundAlpha<1,this.resolution=t.resolution}resize(e,t,i){this.texture.source.resize(e,t,i),this.screen.width=this.texture.frame.width,this.screen.height=this.texture.frame.height}destroy(e=!1){("boolean"==typeof e?e:!!e?.removeView)&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.texture.destroy()}};De.extension={type:[n.Ag.WebGLSystem,n.Ag.WebGPUSystem,n.Ag.CanvasSystem],name:"view",priority:0},De.defaultOptions={width:800,height:600,autoDensity:!1,antialias:!1};const Oe=[Z,_e,Se,De,S,Me,pe,re,E.d,Pe,be],Be=[te,I,A,u,W,K,j,s]},6820:(e,t,i)=>{"use strict";i.d(t,{i:()=>s});var n=i(6954);function s(e,t){return"no-premultiply-alpha"===t.alphaMode&&n.Q[e]||e}},6888:(e,t,i)=>{"use strict";let n;function s(){if("boolean"==typeof n)return n;try{const e=new Function("param1","param2","param3","return param1[param2] === param3;");n=!0===e({a:"b"},"a","b")}catch(e){n=!1}return n}i.d(t,{f:()=>s})},6954:(e,t,i)=>{"use strict";i.d(t,{K:()=>s,Q:()=>n});const n={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var s=(e=>(e[e.DISABLED=0]="DISABLED",e[e.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",e[e.MASK_ACTIVE=2]="MASK_ACTIVE",e[e.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",e[e.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",e[e.NONE=5]="NONE",e))(s||{})},7025:(e,t,i)=>{"use strict";function n(e,t,i){const{width:n,height:s}=i.orig,r=i.trim;if(r){const i=r.width,a=r.height;e.minX=r.x-t._x*n,e.maxX=e.minX+i,e.minY=r.y-t._y*s,e.maxY=e.minY+a}else e.minX=-t._x*n,e.maxX=e.minX+n,e.minY=-t._y*s,e.maxY=e.minY+s}i.d(t,{y:()=>n})},7171:(e,t,i)=>{"use strict";var n=i(8602);class s{constructor(e){this._renderer=e}push(e,t,i){this._renderer.renderPipes.batch.break(i),i.add({renderPipeId:"filter",canBundle:!1,action:"pushFilter",container:t,filterEffect:e})}pop(e,t,i){this._renderer.renderPipes.batch.break(i),i.add({renderPipeId:"filter",action:"popFilter",canBundle:!1})}execute(e){"pushFilter"===e.action?this._renderer.filter.push(e):"popFilter"===e.action&&this._renderer.filter.pop()}destroy(){this._renderer=null}}s.extension={type:[n.Ag.WebGLPipes,n.Ag.WebGPUPipes,n.Ag.CanvasPipes],name:"filter"};var r=i(6680),a=i(3650),o=i(5178),l=i(9037),h=i(8192),u=i(1862),c=i(9998),d=i(3289);const p=new r.u;var f=i(9731);const g=new o.V({attributes:{aPosition:{buffer:new Float32Array([0,0,1,0,1,1,0,1]),format:"float32x2",stride:8,offset:0}},indexBuffer:new Uint32Array([0,1,2,0,2,3])});class m{constructor(){this.skip=!1,this.inputTexture=null,this.backTexture=null,this.filters=null,this.bounds=new d.c,this.container=null,this.blendRequired=!1,this.outputRenderSurface=null,this.globalFrame={x:0,y:0,width:0,height:0}}}class _{constructor(e){this._filterStackIndex=0,this._filterStack=[],this._filterGlobalUniforms=new l.k({uInputSize:{value:new Float32Array(4),type:"vec4<f32>"},uInputPixel:{value:new Float32Array(4),type:"vec4<f32>"},uInputClamp:{value:new Float32Array(4),type:"vec4<f32>"},uOutputFrame:{value:new Float32Array(4),type:"vec4<f32>"},uGlobalFrame:{value:new Float32Array(4),type:"vec4<f32>"},uOutputTexture:{value:new Float32Array(4),type:"vec4<f32>"}}),this._globalFilterBindGroup=new a.T({}),this.renderer=e}get activeBackTexture(){return this._activeFilterData?.backTexture}push(e){const t=this.renderer,i=e.filterEffect.filters,n=this._pushFilterData();n.skip=!1,n.filters=i,n.container=e.container,n.outputRenderSurface=t.renderTarget.renderSurface;const s=t.renderTarget.renderTarget.colorTexture.source,r=s.resolution,a=s.antialias;if(0===i.length)return void(n.skip=!0);const o=n.bounds;if(this._calculateFilterArea(e,o),this._calculateFilterBounds(n,t.renderTarget.rootViewPort,a,r,1),n.skip)return;const l=this._getPreviousFilterData(),h=this._findFilterResolution(r);let u=0,c=0;l&&(u=l.bounds.minX,c=l.bounds.minY),this._calculateGlobalFrame(n,u,c,h,s.width,s.height),this._setupFilterTextures(n,o,t,l)}generateFilteredTexture({texture:e,filters:t}){const i=this._pushFilterData();this._activeFilterData=i,i.skip=!1,i.filters=t;const n=e.source,s=n.resolution,r=n.antialias;if(0===t.length)return i.skip=!0,e;const a=i.bounds;if(a.addRect(e.frame),this._calculateFilterBounds(i,a.rectangle,r,s,0),i.skip)return e;const o=s;this._calculateGlobalFrame(i,0,0,o,n.width,n.height),i.outputRenderSurface=u.W.getOptimalTexture(a.width,a.height,i.resolution,i.antialias),i.backTexture=h.g.EMPTY,i.inputTexture=e;this.renderer.renderTarget.finishRenderPass(),this._applyFiltersToTexture(i,!0);const l=i.outputRenderSurface;return l.source.alphaMode="premultiplied-alpha",l}pop(){const e=this.renderer,t=this._popFilterData();t.skip||(e.globalUniforms.pop(),e.renderTarget.finishRenderPass(),this._activeFilterData=t,this._applyFiltersToTexture(t,!1),t.blendRequired&&u.W.returnTexture(t.backTexture),u.W.returnTexture(t.inputTexture))}getBackTexture(e,t,i){const n=e.colorTexture.source._resolution,s=u.W.getOptimalTexture(t.width,t.height,n,!1);let r=t.minX,a=t.minY;i&&(r-=i.minX,a-=i.minY),r=Math.floor(r*n),a=Math.floor(a*n);const o=Math.ceil(t.width*n),l=Math.ceil(t.height*n);return this.renderer.renderTarget.copyToTexture(e,s,{x:r,y:a},{width:o,height:l},{x:0,y:0}),s}applyFilter(e,t,i,n){const s=this.renderer,r=this._activeFilterData,a=r.outputRenderSurface===i,o=s.renderTarget.rootRenderTarget.colorTexture.source._resolution,l=this._findFilterResolution(o);let h=0,u=0;if(a){const e=this._findPreviousFilterOffset();h=e.x,u=e.y}this._updateFilterUniforms(t,i,r,h,u,l,a,n),this._setupBindGroupsAndRender(e,t,s)}calculateSpriteMatrix(e,t){const i=this._activeFilterData,n=e.set(i.inputTexture._source.width,0,0,i.inputTexture._source.height,i.bounds.minX,i.bounds.minY),s=t.worldTransform.copyTo(r.u.shared),a=t.renderGroup||t.parentRenderGroup;return a&&a.cacheToLocalTransform&&s.prepend(a.cacheToLocalTransform),s.invert(),n.prepend(s),n.scale(1/t.texture.orig.width,1/t.texture.orig.height),n.translate(t.anchor.x,t.anchor.y),n}destroy(){}_setupBindGroupsAndRender(e,t,i){if(i.renderPipes.uniformBatch){const e=i.renderPipes.uniformBatch.getUboResource(this._filterGlobalUniforms);this._globalFilterBindGroup.setResource(e,0)}else this._globalFilterBindGroup.setResource(this._filterGlobalUniforms,0);this._globalFilterBindGroup.setResource(t.source,1),this._globalFilterBindGroup.setResource(t.source.style,2),e.groups[0]=this._globalFilterBindGroup,i.encoder.draw({geometry:g,shader:e,state:e._state,topology:"triangle-list"}),i.type===c.W.WEBGL&&i.renderTarget.finishRenderPass()}_setupFilterTextures(e,t,i,n){if(e.backTexture=h.g.EMPTY,e.inputTexture=u.W.getOptimalTexture(t.width,t.height,e.resolution,e.antialias),e.blendRequired){i.renderTarget.finishRenderPass();const s=i.renderTarget.getRenderTarget(e.outputRenderSurface);e.backTexture=this.getBackTexture(s,t,n?.bounds)}i.renderTarget.bind(e.inputTexture,!0),i.globalUniforms.push({offset:t})}_calculateGlobalFrame(e,t,i,n,s,r){const a=e.globalFrame;a.x=t*n,a.y=i*n,a.width=s*n,a.height=r*n}_updateFilterUniforms(e,t,i,n,s,r,a,o){const l=this._filterGlobalUniforms.uniforms,u=l.uOutputFrame,c=l.uInputSize,d=l.uInputPixel,p=l.uInputClamp,f=l.uGlobalFrame,g=l.uOutputTexture;a?(u[0]=i.bounds.minX-n,u[1]=i.bounds.minY-s):(u[0]=0,u[1]=0),u[2]=e.frame.width,u[3]=e.frame.height,c[0]=e.source.width,c[1]=e.source.height,c[2]=1/c[0],c[3]=1/c[1],d[0]=e.source.pixelWidth,d[1]=e.source.pixelHeight,d[2]=1/d[0],d[3]=1/d[1],p[0]=.5*d[2],p[1]=.5*d[3],p[2]=e.frame.width*c[2]-.5*d[2],p[3]=e.frame.height*c[3]-.5*d[3];const m=this.renderer.renderTarget.rootRenderTarget.colorTexture;f[0]=n*r,f[1]=s*r,f[2]=m.source.width*r,f[3]=m.source.height*r,t instanceof h.g&&(t.source.resource=null);const _=this.renderer.renderTarget.getRenderTarget(t);this.renderer.renderTarget.bind(t,!!o),t instanceof h.g?(g[0]=t.frame.width,g[1]=t.frame.height):(g[0]=_.width,g[1]=_.height),g[2]=_.isRoot?-1:1,this._filterGlobalUniforms.update()}_findFilterResolution(e){let t=this._filterStackIndex-1;for(;t>0&&this._filterStack[t].skip;)--t;return t>0&&this._filterStack[t].inputTexture?this._filterStack[t].inputTexture.source._resolution:e}_findPreviousFilterOffset(){let e=0,t=0,i=this._filterStackIndex;for(;i>0;){i--;const n=this._filterStack[i];if(!n.skip){e=n.bounds.minX,t=n.bounds.minY;break}}return{x:e,y:t}}_calculateFilterArea(e,t){if(e.renderables?function(e,t){t.clear();const i=t.matrix;for(let i=0;i<e.length;i++){const n=e[i];if(n.globalDisplayStatus<7)continue;const s=n.renderGroup??n.parentRenderGroup;t.matrix=s?.isCachedAsTexture?p.copyFrom(s.textureOffsetInverseTransform).append(n.worldTransform):s?._parentCacheAsTextureRenderGroup?p.copyFrom(s._parentCacheAsTextureRenderGroup.inverseWorldTransform).append(n.groupTransform):n.worldTransform,t.addBounds(n.bounds)}t.matrix=i}(e.renderables,t):e.filterEffect.filterArea?(t.clear(),t.addRect(e.filterEffect.filterArea),t.applyMatrix(e.container.worldTransform)):e.container.getFastGlobalBounds(!0,t),e.container){const i=(e.container.renderGroup||e.container.parentRenderGroup).cacheToLocalTransform;i&&t.applyMatrix(i)}}_applyFiltersToTexture(e,t){const i=e.inputTexture,n=e.bounds,s=e.filters;if(this._globalFilterBindGroup.setResource(i.source.style,2),this._globalFilterBindGroup.setResource(e.backTexture.source,3),1===s.length)s[0].apply(this,i,e.outputRenderSurface,t);else{let i=e.inputTexture;const r=u.W.getOptimalTexture(n.width,n.height,i.source._resolution,!1);let a=r,o=0;for(o=0;o<s.length-1;++o){s[o].apply(this,i,a,!0);const e=i;i=a,a=e}s[o].apply(this,i,e.outputRenderSurface,t),u.W.returnTexture(r)}}_calculateFilterBounds(e,t,i,n,s){const r=this.renderer,a=e.bounds,o=e.filters;let l=1/0,h=0,u=!0,c=!1,d=!1,p=!0;for(let e=0;e<o.length;e++){const t=o[e];l=Math.min(l,"inherit"===t.resolution?n:t.resolution),h+=t.padding,"off"===t.antialias?u=!1:"inherit"===t.antialias&&u&&(u=i),t.clipToViewport||(p=!1);if(!!!(t.compatibleRenderers&r.type)){d=!1;break}if(t.blendRequired&&!(r.backBuffer?.useBackBuffer??1)){(0,f.R)("Blend filter requires backBuffer on WebGL renderer to be enabled. Set `useBackBuffer: true` in the renderer options."),d=!1;break}d=t.enabled||d,c||(c=t.blendRequired)}d?(p&&a.fitBounds(0,t.width/n,0,t.height/n),a.scale(l).ceil().scale(1/l).pad((0|h)*s),a.isPositive?(e.antialias=u,e.resolution=l,e.blendRequired=c):e.skip=!0):e.skip=!0}_popFilterData(){return this._filterStackIndex--,this._filterStack[this._filterStackIndex]}_getPreviousFilterData(){let e,t=this._filterStackIndex-1;for(;t>0&&(t--,e=this._filterStack[t],e.skip););return e}_pushFilterData(){let e=this._filterStack[this._filterStackIndex];return e||(e=this._filterStack[this._filterStackIndex]=new m),this._filterStackIndex++,e}}_.extension={type:[n.Ag.WebGLSystem,n.Ag.WebGPUSystem],name:"filter"},n.XO.add(_),n.XO.add(s)},7313:(e,t,i)=>{"use strict";i.d(t,{o:()=>n});class n{constructor(e,t,i){this._x=t||0,this._y=i||0,this._observer=e}clone(e){return new n(e??this._observer,this._x,this._y)}set(e=0,t=e){return this._x===e&&this._y===t||(this._x=e,this._y=t,this._observer._onUpdate(this)),this}copyFrom(e){return this._x===e.x&&this._y===e.y||(this._x=e.x,this._y=e.y,this._observer._onUpdate(this)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=${this._x} y=${this._y} scope=${this._observer}]`}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this._observer._onUpdate(this))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this._observer._onUpdate(this))}}},7328:(e,t,i)=>{"use strict";i.d(t,{P:()=>r});var n=i(8602),s=i(5884);class r extends s.v{constructor(e){const t=e.resource||new Float32Array(e.width*e.height*4);let i=e.format;i||(i=t instanceof Float32Array?"rgba32float":t instanceof Int32Array||t instanceof Uint32Array?"rgba32uint":t instanceof Int16Array||t instanceof Uint16Array?"rgba16uint":(Int8Array,"bgra8unorm")),super({...e,resource:t,format:i}),this.uploadMethodId="buffer"}static test(e){return e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}r.extension=n.Ag.TextureSource},7384:(e,t,i)=>{"use strict";i.d(t,{A:()=>a});var n=i(5553);function s(e){if("string"!=typeof e)throw new TypeError(`Path must be a string. Received ${JSON.stringify(e)}`)}function r(e){return e.split("?")[0].split("#")[0]}const a={toPosix(e){return t="\\",i="/",e.replace(new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),i);var t,i},isUrl(e){return/^https?:/.test(this.toPosix(e))},isDataUrl:e=>/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(e),isBlobUrl:e=>e.startsWith("blob:"),hasProtocol(e){return/^[^/:]+:/.test(this.toPosix(e))},getProtocol(e){s(e),e=this.toPosix(e);const t=/^file:\/\/\//.exec(e);if(t)return t[0];const i=/^[^/:]+:\/{0,2}/.exec(e);return i?i[0]:""},toAbsolute(e,t,i){if(s(e),this.isDataUrl(e)||this.isBlobUrl(e))return e;const o=r(this.toPosix(t??n.e.get().getBaseUrl())),l=r(this.toPosix(i??this.rootname(o)));if((e=this.toPosix(e)).startsWith("/"))return a.join(l,e.slice(1));return this.isAbsolute(e)?e:this.join(o,e)},normalize(e){if(s(e),0===e.length)return".";if(this.isDataUrl(e)||this.isBlobUrl(e))return e;let t="";const i=(e=this.toPosix(e)).startsWith("/");this.hasProtocol(e)&&(t=this.rootname(e),e=e.slice(t.length));const n=e.endsWith("/");return(e=function(e,t){let i="",n=0,s=-1,r=0,a=-1;for(let o=0;o<=e.length;++o){if(o<e.length)a=e.charCodeAt(o);else{if(47===a)break;a=47}if(47===a){if(s===o-1||1===r);else if(s!==o-1&&2===r){if(i.length<2||2!==n||46!==i.charCodeAt(i.length-1)||46!==i.charCodeAt(i.length-2))if(i.length>2){const e=i.lastIndexOf("/");if(e!==i.length-1){-1===e?(i="",n=0):(i=i.slice(0,e),n=i.length-1-i.lastIndexOf("/")),s=o,r=0;continue}}else if(2===i.length||1===i.length){i="",n=0,s=o,r=0;continue}t&&(i.length>0?i+="/..":i="..",n=2)}else i.length>0?i+=`/${e.slice(s+1,o)}`:i=e.slice(s+1,o),n=o-s-1;s=o,r=0}else 46===a&&-1!==r?++r:r=-1}return i}(e,!1)).length>0&&n&&(e+="/"),i?`/${e}`:t+e},isAbsolute(e){return s(e),e=this.toPosix(e),!!this.hasProtocol(e)||e.startsWith("/")},join(...e){if(0===e.length)return".";let t;for(let i=0;i<e.length;++i){const n=e[i];if(s(n),n.length>0)if(void 0===t)t=n;else{const s=e[i-1]??"";this.joinExtensions.includes(this.extname(s).toLowerCase())?t+=`/../${n}`:t+=`/${n}`}}return void 0===t?".":this.normalize(t)},dirname(e){if(s(e),0===e.length)return".";let t=(e=this.toPosix(e)).charCodeAt(0);const i=47===t;let n=-1,r=!0;const a=this.getProtocol(e),o=e;for(let i=(e=e.slice(a.length)).length-1;i>=1;--i)if(t=e.charCodeAt(i),47===t){if(!r){n=i;break}}else r=!1;return-1===n?i?"/":this.isUrl(o)?a+e:a:i&&1===n?"//":a+e.slice(0,n)},rootname(e){s(e);let t="";if(t=(e=this.toPosix(e)).startsWith("/")?"/":this.getProtocol(e),this.isUrl(e)){const i=e.indexOf("/",t.length);t=-1!==i?e.slice(0,i):e,t.endsWith("/")||(t+="/")}return t},basename(e,t){s(e),t&&s(t),e=r(this.toPosix(e));let i,n=0,a=-1,o=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";let s=t.length-1,r=-1;for(i=e.length-1;i>=0;--i){const l=e.charCodeAt(i);if(47===l){if(!o){n=i+1;break}}else-1===r&&(o=!1,r=i+1),s>=0&&(l===t.charCodeAt(s)?-1===--s&&(a=i):(s=-1,a=r))}return n===a?a=r:-1===a&&(a=e.length),e.slice(n,a)}for(i=e.length-1;i>=0;--i)if(47===e.charCodeAt(i)){if(!o){n=i+1;break}}else-1===a&&(o=!1,a=i+1);return-1===a?"":e.slice(n,a)},extname(e){s(e);let t=-1,i=0,n=-1,a=!0,o=0;for(let s=(e=r(this.toPosix(e))).length-1;s>=0;--s){const r=e.charCodeAt(s);if(47!==r)-1===n&&(a=!1,n=s+1),46===r?-1===t?t=s:1!==o&&(o=1):-1!==t&&(o=-1);else if(!a){i=s+1;break}}return-1===t||-1===n||0===o||1===o&&t===n-1&&t===i+1?"":e.slice(t,n)},parse(e){s(e);const t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;let i=(e=r(this.toPosix(e))).charCodeAt(0);const n=this.isAbsolute(e);let a;t.root=this.rootname(e),a=n||this.hasProtocol(e)?1:0;let o=-1,l=0,h=-1,u=!0,c=e.length-1,d=0;for(;c>=a;--c)if(i=e.charCodeAt(c),47!==i)-1===h&&(u=!1,h=c+1),46===i?-1===o?o=c:1!==d&&(d=1):-1!==o&&(d=-1);else if(!u){l=c+1;break}return-1===o||-1===h||0===d||1===d&&o===h-1&&o===l+1?-1!==h&&(t.base=t.name=0===l&&n?e.slice(1,h):e.slice(l,h)):(0===l&&n?(t.name=e.slice(1,o),t.base=e.slice(1,h)):(t.name=e.slice(l,o),t.base=e.slice(l,h)),t.ext=e.slice(o,h)),t.dir=this.dirname(e),t},sep:"/",delimiter:":",joinExtensions:[".html"]}},7414:(e,t,i)=>{"use strict";i.d(t,{w:()=>a});var n=i(3650),s=i(8192);const r={};function a(e,t,i){let a=2166136261;for(let i=0;i<t;i++)a^=e[i].uid,a=Math.imul(a,16777619),a>>>=0;return r[a]||function(e,t,i,a){const o={};let l=0;for(let i=0;i<a;i++){const n=i<t?e[i]:s.g.EMPTY.source;o[l++]=n.source,o[l++]=n.style}const h=new n.T(o);return r[i]=h,h}(e,t,a,i)}},7467:(e,t,i)=>{"use strict";i.d(t,{W:()=>r});var n=i(5553);let s;function r(){if(!s||s?.isContextLost()){const e=n.e.get().createCanvas();s=e.getContext("webgl",{})}return s}},7605:(e,t,i)=>{"use strict";function n(e,t){if(16777215===e||!t)return t;if(16777215===t||!e)return e;return(((e>>16&255)*(t>>16&255)/255|0)<<16)+(((e>>8&255)*(t>>8&255)/255|0)<<8)+((255&e)*(255&t)/255|0)}i.d(t,{u:()=>n})},7670:(e,t,i)=>{"use strict";i.d(t,{W:()=>a});var n=i(6888),s=i(5662),r=i(2409);class a{constructor(e){this._syncFunctionHash=Object.create(null),this._adaptor=e,this._systemCheck()}_systemCheck(){if(!(0,n.f)())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}ensureUniformGroup(e){const t=this.getUniformGroupData(e);e.buffer||(e.buffer=new s.h({data:new Float32Array(t.layout.size/4),usage:r.S.UNIFORM|r.S.COPY_DST}))}getUniformGroupData(e){return this._syncFunctionHash[e._signature]||this._initUniformGroup(e)}_initUniformGroup(e){const t=e._signature;let i=this._syncFunctionHash[t];if(!i){const n=Object.keys(e.uniformStructures).map(t=>e.uniformStructures[t]),s=this._adaptor.createUboElements(n),r=this._generateUboSync(s.uboElements);i=this._syncFunctionHash[t]={layout:s,syncFunction:r}}return this._syncFunctionHash[t]}_generateUboSync(e){return this._adaptor.generateUboSync(e)}syncUniformGroup(e,t,i){const n=this.getUniformGroupData(e);e.buffer||(e.buffer=new s.h({data:new Float32Array(n.layout.size/4),usage:r.S.UNIFORM|r.S.COPY_DST}));let a=null;return t||(t=e.buffer.data,a=e.buffer.dataInt32),i||(i=0),n.syncFunction(e.uniforms,t,a,i),!0}updateUniformGroup(e){if(e.isStatic&&!e._dirtyId)return!1;e._dirtyId=0;const t=this.syncUniformGroup(e);return e.buffer.update(),t}destroy(){this._syncFunctionHash=null}}},7732:(e,t,i)=>{"use strict";var n=i(8602),s=i(4068),r=i(5231),a=i(8593),o=i(6680),l=i(6566),h=i(9140),u=i(2581),c=i(358),d=i(6479),p=i(9232),f=i(9037);const g={name:"local-uniform-msdf-bit",vertex:{header:"\n            struct LocalUniforms {\n                uColor:vec4<f32>,\n                uTransformMatrix:mat3x3<f32>,\n                uDistance: f32,\n                uRound:f32,\n            }\n\n            @group(2) @binding(0) var<uniform> localUniforms : LocalUniforms;\n        ",main:"\n            vColor *= localUniforms.uColor;\n            modelMatrix *= localUniforms.uTransformMatrix;\n        ",end:"\n            if(localUniforms.uRound == 1)\n            {\n                vPosition = vec4(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);\n            }\n        "},fragment:{header:"\n            struct LocalUniforms {\n                uColor:vec4<f32>,\n                uTransformMatrix:mat3x3<f32>,\n                uDistance: f32\n            }\n\n            @group(2) @binding(0) var<uniform> localUniforms : LocalUniforms;\n         ",main:"\n            outColor = vec4<f32>(calculateMSDFAlpha(outColor, localUniforms.uColor, localUniforms.uDistance));\n        "}},m={name:"local-uniform-msdf-bit",vertex:{header:"\n            uniform mat3 uTransformMatrix;\n            uniform vec4 uColor;\n            uniform float uRound;\n        ",main:"\n            vColor *= uColor;\n            modelMatrix *= uTransformMatrix;\n        ",end:"\n            if(uRound == 1.)\n            {\n                gl_Position.xy = roundPixels(gl_Position.xy, uResolution);\n            }\n        "},fragment:{header:"\n            uniform float uDistance;\n         ",main:"\n            outColor = vec4(calculateMSDFAlpha(outColor, vColor, uDistance));\n        "}},_={name:"msdf-bit",fragment:{header:"\n            fn calculateMSDFAlpha(msdfColor:vec4<f32>, shapeColor:vec4<f32>, distance:f32) -> f32 {\n\n                // MSDF\n                var median = msdfColor.r + msdfColor.g + msdfColor.b -\n                    min(msdfColor.r, min(msdfColor.g, msdfColor.b)) -\n                    max(msdfColor.r, max(msdfColor.g, msdfColor.b));\n\n                // SDF\n                median = min(median, msdfColor.a);\n\n                var screenPxDistance = distance * (median - 0.5);\n                var alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\n                if (median < 0.01) {\n                    alpha = 0.0;\n                } else if (median > 0.99) {\n                    alpha = 1.0;\n                }\n\n                // Gamma correction for coverage-like alpha\n                var luma: f32 = dot(shapeColor.rgb, vec3<f32>(0.299, 0.587, 0.114));\n                var gamma: f32 = mix(1.0, 1.0 / 2.2, luma);\n                var coverage: f32 = pow(shapeColor.a * alpha, gamma);\n\n                return coverage;\n\n            }\n        "}},v={name:"msdf-bit",fragment:{header:"\n            float calculateMSDFAlpha(vec4 msdfColor, vec4 shapeColor, float distance) {\n\n                // MSDF\n                float median = msdfColor.r + msdfColor.g + msdfColor.b -\n                                min(msdfColor.r, min(msdfColor.g, msdfColor.b)) -\n                                max(msdfColor.r, max(msdfColor.g, msdfColor.b));\n\n                // SDF\n                median = min(median, msdfColor.a);\n\n                float screenPxDistance = distance * (median - 0.5);\n                float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);\n\n                if (median < 0.01) {\n                    alpha = 0.0;\n                } else if (median > 0.99) {\n                    alpha = 1.0;\n                }\n\n                // Gamma correction for coverage-like alpha\n                float luma = dot(shapeColor.rgb, vec3(0.299, 0.587, 0.114));\n                float gamma = mix(1.0, 1.0 / 2.2, luma);\n                float coverage = pow(shapeColor.a * alpha, gamma);\n\n                return coverage;\n            }\n        "}};let y,b;class x extends p.M{constructor(e){const t=new f.k({uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uTransformMatrix:{value:new o.u,type:"mat3x3<f32>"},uDistance:{value:4,type:"f32"},uRound:{value:0,type:"f32"}});y??(y=(0,l.v)({name:"sdf-shader",bits:[h.F,(0,u._)(e),g,_,c.b]})),b??(b=(0,l.I)({name:"sdf-shader",bits:[h.a,(0,u.P)(e),m,v,c.m]})),super({glProgram:b,gpuProgram:y,resources:{localUniforms:t,batchSamplers:(0,d.n)(e)}})}}var T=i(3596),S=i(594);class A extends r.A{destroy(){this.context.customShader&&this.context.customShader.destroy(),super.destroy()}}class E{constructor(e){this._renderer=e}validateRenderable(e){const t=this._getGpuBitmapText(e);return this._renderer.renderPipes.graphics.validateRenderable(t)}addRenderable(e,t){const i=this._getGpuBitmapText(e);C(e,i),e._didTextUpdate&&(e._didTextUpdate=!1,this._updateContext(e,i)),this._renderer.renderPipes.graphics.addRenderable(i,t),i.context.customShader&&this._updateDistanceField(e)}updateRenderable(e){const t=this._getGpuBitmapText(e);C(e,t),this._renderer.renderPipes.graphics.updateRenderable(t),t.context.customShader&&this._updateDistanceField(e)}_updateContext(e,t){const{context:i}=t,n=T.c.getFont(e.text,e._style);i.clear(),"none"!==n.distanceField.type&&(i.customShader||(i.customShader=new x(this._renderer.limits.maxBatchableTextures)));const s=a.P.graphemeSegmenter(e.text),r=e._style;let o=n.baseLineOffset;const l=(0,S.Z)(s,r,n,!0),h=r.padding,u=l.scale;let c=l.width,d=l.height+l.offsetY;r._stroke&&(c+=r._stroke.width/u,d+=r._stroke.width/u),i.translate(-e._anchor._x*c-h,-e._anchor._y*d-h).scale(u,u);const p=n.applyFillAsTint?r._fill.color:16777215;let f=n.fontMetrics.fontSize,g=n.lineHeight;r.lineHeight&&(f=r.fontSize/u,g=r.lineHeight/u);let m=(g-f)/2;m-n.baseLineOffset<0&&(m=0);for(let e=0;e<l.lines.length;e++){const t=l.lines[e];for(let e=0;e<t.charPositions.length;e++){const s=t.chars[e],r=n.chars[s];if(r?.texture){const n=r.texture;i.texture(n,p||"black",Math.round(t.charPositions[e]+r.xOffset),Math.round(o+r.yOffset+m),n.orig.width,n.orig.height)}}o+=g}}_getGpuBitmapText(e){return e._gpuData[this._renderer.uid]||this.initGpuText(e)}initGpuText(e){const t=new A;return e._gpuData[this._renderer.uid]=t,this._updateContext(e,t),t}_updateDistanceField(e){const t=this._getGpuBitmapText(e).context,i=e._style.fontFamily,n=s.l.get(`${i}-bitmap`),{a:r,b:a,c:o,d:l}=e.groupTransform,h=Math.sqrt(r*r+a*a),u=Math.sqrt(o*o+l*l),c=(Math.abs(h)+Math.abs(u))/2,d=n.baseRenderedFontSize/e._style.fontSize,p=c*n.distanceField.range*(1/d);t.customShader.resources.localUniforms.uniforms.uDistance=p}destroy(){this._renderer=null}}function C(e,t){t.groupTransform=e.groupTransform,t.groupColorAlpha=e.groupColorAlpha,t.groupColor=e.groupColor,t.groupBlendMode=e.groupBlendMode,t.globalDisplayStatus=e.globalDisplayStatus,t.groupTransform=e.groupTransform,t.localDisplayStatus=e.localDisplayStatus,t.groupAlpha=e.groupAlpha,t._roundPixels=e._roundPixels}E.extension={type:[n.Ag.WebGLPipes,n.Ag.WebGPUPipes,n.Ag.CanvasPipes],name:"bitmapText"},n.XO.add(E)},7747:(e,t,i)=>{"use strict";i.d(t,{Q:()=>L});var n={grad:.9,turn:360,rad:360/(2*Math.PI)},s=function(e){return"string"==typeof e?e.length>0:"number"==typeof e},r=function(e,t,i){return void 0===t&&(t=0),void 0===i&&(i=Math.pow(10,t)),Math.round(i*e)/i+0},a=function(e,t,i){return void 0===t&&(t=0),void 0===i&&(i=1),e>i?i:e>t?e:t},o=function(e){return(e=isFinite(e)?e%360:0)>0?e:e+360},l=function(e){return{r:a(e.r,0,255),g:a(e.g,0,255),b:a(e.b,0,255),a:a(e.a)}},h=function(e){return{r:r(e.r),g:r(e.g),b:r(e.b),a:r(e.a,3)}},u=/^#([0-9a-f]{3,8})$/i,c=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},d=function(e){var t=e.r,i=e.g,n=e.b,s=e.a,r=Math.max(t,i,n),a=r-Math.min(t,i,n),o=a?r===t?(i-n)/a:r===i?2+(n-t)/a:4+(t-i)/a:0;return{h:60*(o<0?o+6:o),s:r?a/r*100:0,v:r/255*100,a:s}},p=function(e){var t=e.h,i=e.s,n=e.v,s=e.a;t=t/360*6,i/=100,n/=100;var r=Math.floor(t),a=n*(1-i),o=n*(1-(t-r)*i),l=n*(1-(1-t+r)*i),h=r%6;return{r:255*[n,o,a,a,l,n][h],g:255*[l,n,n,o,a,a][h],b:255*[a,a,l,n,n,o][h],a:s}},f=function(e){return{h:o(e.h),s:a(e.s,0,100),l:a(e.l,0,100),a:a(e.a)}},g=function(e){return{h:r(e.h),s:r(e.s),l:r(e.l),a:r(e.a,3)}},m=function(e){return p((i=(t=e).s,{h:t.h,s:(i*=((n=t.l)<50?n:100-n)/100)>0?2*i/(n+i)*100:0,v:n+i,a:t.a}));var t,i,n},_=function(e){return{h:(t=d(e)).h,s:(s=(200-(i=t.s))*(n=t.v)/100)>0&&s<200?i*n/100/(s<=100?s:200-s)*100:0,l:s/2,a:t.a};var t,i,n,s},v=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,y=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,b=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,x=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,T={string:[[function(e){var t=u.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:4===e.length?r(parseInt(e[3]+e[3],16)/255,2):1}:6===e.length||8===e.length?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:8===e.length?r(parseInt(e.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(e){var t=b.exec(e)||x.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:l({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:void 0===t[7]?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(e){var t=v.exec(e)||y.exec(e);if(!t)return null;var i,s,r=f({h:(i=t[1],s=t[2],void 0===s&&(s="deg"),Number(i)*(n[s]||1)),s:Number(t[3]),l:Number(t[4]),a:void 0===t[5]?1:Number(t[5])/(t[6]?100:1)});return m(r)},"hsl"]],object:[[function(e){var t=e.r,i=e.g,n=e.b,r=e.a,a=void 0===r?1:r;return s(t)&&s(i)&&s(n)?l({r:Number(t),g:Number(i),b:Number(n),a:Number(a)}):null},"rgb"],[function(e){var t=e.h,i=e.s,n=e.l,r=e.a,a=void 0===r?1:r;if(!s(t)||!s(i)||!s(n))return null;var o=f({h:Number(t),s:Number(i),l:Number(n),a:Number(a)});return m(o)},"hsl"],[function(e){var t=e.h,i=e.s,n=e.v,r=e.a,l=void 0===r?1:r;if(!s(t)||!s(i)||!s(n))return null;var h=function(e){return{h:o(e.h),s:a(e.s,0,100),v:a(e.v,0,100),a:a(e.a)}}({h:Number(t),s:Number(i),v:Number(n),a:Number(l)});return p(h)},"hsv"]]},S=function(e,t){for(var i=0;i<t.length;i++){var n=t[i][0](e);if(n)return[n,t[i][1]]}return[null,void 0]},A=function(e){return"string"==typeof e?S(e.trim(),T.string):"object"==typeof e&&null!==e?S(e,T.object):[null,void 0]},E=function(e,t){var i=_(e);return{h:i.h,s:a(i.s+100*t,0,100),l:i.l,a:i.a}},C=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},w=function(e,t){var i=_(e);return{h:i.h,s:i.s,l:a(i.l+100*t,0,100),a:i.a}},P=function(){function e(e){this.parsed=A(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return null!==this.parsed},e.prototype.brightness=function(){return r(C(this.rgba),2)},e.prototype.isDark=function(){return C(this.rgba)<.5},e.prototype.isLight=function(){return C(this.rgba)>=.5},e.prototype.toHex=function(){return t=(e=h(this.rgba)).r,i=e.g,n=e.b,a=(s=e.a)<1?c(r(255*s)):"","#"+c(t)+c(i)+c(n)+a;var e,t,i,n,s,a},e.prototype.toRgb=function(){return h(this.rgba)},e.prototype.toRgbString=function(){return t=(e=h(this.rgba)).r,i=e.g,n=e.b,(s=e.a)<1?"rgba("+t+", "+i+", "+n+", "+s+")":"rgb("+t+", "+i+", "+n+")";var e,t,i,n,s},e.prototype.toHsl=function(){return g(_(this.rgba))},e.prototype.toHslString=function(){return t=(e=g(_(this.rgba))).h,i=e.s,n=e.l,(s=e.a)<1?"hsla("+t+", "+i+"%, "+n+"%, "+s+")":"hsl("+t+", "+i+"%, "+n+"%)";var e,t,i,n,s},e.prototype.toHsv=function(){return e=d(this.rgba),{h:r(e.h),s:r(e.s),v:r(e.v),a:r(e.a,3)};var e},e.prototype.invert=function(){return I({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},e.prototype.saturate=function(e){return void 0===e&&(e=.1),I(E(this.rgba,e))},e.prototype.desaturate=function(e){return void 0===e&&(e=.1),I(E(this.rgba,-e))},e.prototype.grayscale=function(){return I(E(this.rgba,-1))},e.prototype.lighten=function(e){return void 0===e&&(e=.1),I(w(this.rgba,e))},e.prototype.darken=function(e){return void 0===e&&(e=.1),I(w(this.rgba,-e))},e.prototype.rotate=function(e){return void 0===e&&(e=15),this.hue(this.hue()+e)},e.prototype.alpha=function(e){return"number"==typeof e?I({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):r(this.rgba.a,3);var t},e.prototype.hue=function(e){var t=_(this.rgba);return"number"==typeof e?I({h:e,s:t.s,l:t.l,a:t.a}):r(t.h)},e.prototype.isEqual=function(e){return this.toHex()===I(e).toHex()},e}(),I=function(e){return e instanceof P?e:new P(e)},M=[];!function(e){e.forEach(function(e){M.indexOf(e)<0&&(e(P,T),M.push(e))})}([function(e,t){var i={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},n={};for(var s in i)n[i[s]]=s;var r={};e.prototype.toName=function(t){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var s,a,o=n[this.toHex()];if(o)return o;if(null==t?void 0:t.closest){var l=this.toRgb(),h=1/0,u="black";if(!r.length)for(var c in i)r[c]=new e(i[c]).toRgb();for(var d in i){var p=(s=l,a=r[d],Math.pow(s.r-a.r,2)+Math.pow(s.g-a.g,2)+Math.pow(s.b-a.b,2));p<h&&(h=p,u=d)}return u}},t.string.push([function(t){var n=t.toLowerCase(),s="transparent"===n?"#0000":i[n];return s?new e(s).toRgb():null},"name"])}]);const R=class e{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(t){if(t instanceof e)this._value=this._cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(null===t)throw new Error("Cannot set Color#value to null");null!==this._value&&this._isSourceEqual(this._value,t)||(this._value=this._cloneSource(t),this._normalize(this._value))}}get value(){return this._value}_cloneSource(e){return"string"==typeof e||"number"==typeof e||e instanceof Number||null===e?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):"object"==typeof e&&null!==e?{...e}:e}_isSourceEqual(e,t){const i=typeof e;if(i!==typeof t)return!1;if("number"===i||"string"===i||e instanceof Number)return e===t;if(Array.isArray(e)&&Array.isArray(t)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return e.length===t.length&&e.every((e,i)=>e===t[i]);if(null!==e&&null!==t){const i=Object.keys(e),n=Object.keys(t);return i.length===n.length&&i.every(i=>e[i]===t[i])}return e===t}toRgba(){const[e,t,i,n]=this._components;return{r:e,g:t,b:i,a:n}}toRgb(){const[e,t,i]=this._components;return{r:e,g:t,b:i}}toRgbaString(){const[e,t,i]=this.toUint8RgbArray();return`rgba(${e},${t},${i},${this.alpha})`}toUint8RgbArray(e){const[t,i,n]=this._components;return this._arrayRgb||(this._arrayRgb=[]),e||(e=this._arrayRgb),e[0]=Math.round(255*t),e[1]=Math.round(255*i),e[2]=Math.round(255*n),e}toArray(e){this._arrayRgba||(this._arrayRgba=[]),e||(e=this._arrayRgba);const[t,i,n,s]=this._components;return e[0]=t,e[1]=i,e[2]=n,e[3]=s,e}toRgbArray(e){this._arrayRgb||(this._arrayRgb=[]),e||(e=this._arrayRgb);const[t,i,n]=this._components;return e[0]=t,e[1]=i,e[2]=n,e}toNumber(){return this._int}toBgrNumber(){const[e,t,i]=this.toUint8RgbArray();return(i<<16)+(t<<8)+e}toLittleEndianNumber(){const e=this._int;return(e>>16)+(65280&e)+((255&e)<<16)}multiply(t){const[i,n,s,r]=e._temp.setValue(t)._components;return this._components[0]*=i,this._components[1]*=n,this._components[2]*=s,this._components[3]*=r,this._refreshInt(),this._value=null,this}premultiply(e,t=!0){return t&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this._refreshInt(),this._value=null,this}toPremultiplied(e,t=!0){if(1===e)return(255<<24)+this._int;if(0===e)return t?0:this._int;let i=this._int>>16&255,n=this._int>>8&255,s=255&this._int;return t&&(i=i*e+.5|0,n=n*e+.5|0,s=s*e+.5|0),(255*e<<24)+(i<<16)+(n<<8)+s}toHex(){const e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){const e=Math.round(255*this._components[3]).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(e){return this._components[3]=this._clamp(e),this}_normalize(t){let i,n,s,r;if(("number"==typeof t||t instanceof Number)&&t>=0&&t<=16777215){i=(t>>16&255)/255,n=(t>>8&255)/255,s=(255&t)/255,r=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[i,n,s,r=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[i,n,s,r=255]=t,i/=255,n/=255,s/=255,r/=255;else if("string"==typeof t||"object"==typeof t){if("string"==typeof t){const i=e.HEX_PATTERN.exec(t);i&&(t=`#${i[2]}`)}const a=I(t);a.isValid()&&(({r:i,g:n,b:s,a:r}=a.rgba),i/=255,n/=255,s/=255)}if(void 0===i)throw new Error(`Unable to convert color ${t}`);this._components[0]=i,this._components[1]=n,this._components[2]=s,this._components[3]=r,this._refreshInt()}_refreshInt(){this._clamp(this._components);const[e,t,i]=this._components;this._int=(255*e<<16)+(255*t<<8)+(255*i|0)}_clamp(e,t=0,i=1){return"number"==typeof e?Math.min(Math.max(e,t),i):(e.forEach((n,s)=>{e[s]=Math.min(Math.max(n,t),i)}),e)}static isColorLike(t){return"number"==typeof t||"string"==typeof t||t instanceof Number||t instanceof e||Array.isArray(t)||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Float32Array||void 0!==t.r&&void 0!==t.g&&void 0!==t.b||void 0!==t.r&&void 0!==t.g&&void 0!==t.b&&void 0!==t.a||void 0!==t.h&&void 0!==t.s&&void 0!==t.l||void 0!==t.h&&void 0!==t.s&&void 0!==t.l&&void 0!==t.a||void 0!==t.h&&void 0!==t.s&&void 0!==t.v||void 0!==t.h&&void 0!==t.s&&void 0!==t.v&&void 0!==t.a}};R.shared=new R,R._temp=new R,R.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let L=R},7752:(e,t,i)=>{"use strict";function n(e,t,i){const n=e.length;let s;if(t>=n||0===i)return;const r=n-(i=t+i>n?n-t:i);for(s=t;s<r;++s)e[s]=e[s+i];e.length=r}i.d(t,{d:()=>n})},7757:(e,t,i)=>{"use strict";var n=i(8602),s=i(6680),r=i(3650),a=i(9037),o=i(6820),l=i(1965),h=i(8079);class u{destroy(){}}class c{constructor(e,t){this.localUniforms=new a.k({uTransformMatrix:{value:new s.u,type:"mat3x3<f32>"},uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uRound:{value:0,type:"f32"}}),this.localUniformsBindGroup=new r.T({0:this.localUniforms}),this.renderer=e,this._adaptor=t,this._adaptor.init()}validateRenderable(e){const t=this._getMeshData(e),i=t.batched,n=e.batched;if(t.batched=n,i!==n)return!0;if(n){const i=e._geometry;if(i.indices.length!==t.indexSize||i.positions.length!==t.vertexSize)return t.indexSize=i.indices.length,t.vertexSize=i.positions.length,!0;const n=this._getBatchableMesh(e);return n.texture.uid!==e._texture.uid&&(n._textureMatrixUpdateId=-1),!n._batcher.checkAndUpdateTexture(n,e._texture)}return!1}addRenderable(e,t){const i=this.renderer.renderPipes.batch,n=this._getMeshData(e);if(e.didViewUpdate&&(n.indexSize=e._geometry.indices?.length,n.vertexSize=e._geometry.positions?.length),n.batched){const n=this._getBatchableMesh(e);n.setTexture(e._texture),n.geometry=e._geometry,i.addToBatch(n,t)}else i.break(t),t.add(e)}updateRenderable(e){if(e.batched){const t=this._getBatchableMesh(e);t.setTexture(e._texture),t.geometry=e._geometry,t._batcher.updateElement(t)}}execute(e){if(!e.isRenderable)return;e.state.blendMode=(0,o.i)(e.groupBlendMode,e.texture._source);const t=this.localUniforms;t.uniforms.uTransformMatrix=e.groupTransform,t.uniforms.uRound=this.renderer._roundPixels|e._roundPixels,t.update(),(0,l.V)(e.groupColorAlpha,t.uniforms.uColor,0),this._adaptor.execute(this,e)}_getMeshData(e){var t,i;return(t=e._gpuData)[i=this.renderer.uid]||(t[i]=new u),e._gpuData[this.renderer.uid].meshData||this._initMeshData(e)}_initMeshData(e){return e._gpuData[this.renderer.uid].meshData={batched:e.batched,indexSize:0,vertexSize:0},e._gpuData[this.renderer.uid].meshData}_getBatchableMesh(e){var t,i;return(t=e._gpuData)[i=this.renderer.uid]||(t[i]=new u),e._gpuData[this.renderer.uid].batchableMesh||this._initBatchableMesh(e)}_initBatchableMesh(e){const t=new h.U;return t.renderable=e,t.setTexture(e._texture),t.transform=e.groupTransform,t.roundPixels=this.renderer._roundPixels|e._roundPixels,e._gpuData[this.renderer.uid].batchableMesh=t,t}destroy(){this.localUniforms=null,this.localUniformsBindGroup=null,this._adaptor.destroy(),this._adaptor=null,this.renderer=null}}c.extension={type:[n.Ag.WebGLPipes,n.Ag.WebGPUPipes,n.Ag.CanvasPipes],name:"mesh"},n.XO.add(c)},7797:(e,t,i)=>{"use strict";i.d(t,{q:()=>a});var n=i(5553),s=i(8602),r=i(5884);class a extends r.v{constructor(e){e.resource||(e.resource=n.e.get().createCanvas()),e.width||(e.width=e.resource.width,e.autoDensity||(e.width/=e.resolution)),e.height||(e.height=e.resource.height,e.autoDensity||(e.height/=e.resolution)),super(e),this.uploadMethodId="image",this.autoDensity=e.autoDensity,this.resizeCanvas(),this.transparent=!!e.transparent}resizeCanvas(){this.autoDensity&&"style"in this.resource&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),this.resource.width===this.pixelWidth&&this.resource.height===this.pixelHeight||(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(e=this.width,t=this.height,i=this._resolution){const n=super.resize(e,t,i);return n&&this.resizeCanvas(),n}static test(e){return globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&e instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}a.extension=s.Ag.TextureSource},7867:(e,t,i)=>{"use strict";i.d(t,{T:()=>ee});var n=i(2551),s=i(7747),r=i(6680),a=i(1828),o=i(8192),l=i(198),h=i(4303),u=i(3289),c=i(9731),d=i(8133),p=i.n(d);var f=i(2207);class g{constructor(e=0,t=0,i=0){this.type="circle",this.x=e,this.y=t,this.radius=i}clone(){return new g(this.x,this.y,this.radius)}contains(e,t){if(this.radius<=0)return!1;const i=this.radius*this.radius;let n=this.x-e,s=this.y-t;return n*=n,s*=s,n+s<=i}strokeContains(e,t,i,n=.5){if(0===this.radius)return!1;const s=this.x-e,r=this.y-t,a=this.radius,o=(1-n)*i,l=Math.sqrt(s*s+r*r);return l<=a+o&&l>a-(i-o)}getBounds(e){return e||(e=new f.M),e.x=this.x-this.radius,e.y=this.y-this.radius,e.width=2*this.radius,e.height=2*this.radius,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.radius=e.radius,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class m{constructor(e=0,t=0,i=0,n=0){this.type="ellipse",this.x=e,this.y=t,this.halfWidth=i,this.halfHeight=n}clone(){return new m(this.x,this.y,this.halfWidth,this.halfHeight)}contains(e,t){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let i=(e-this.x)/this.halfWidth,n=(t-this.y)/this.halfHeight;return i*=i,n*=n,i+n<=1}strokeContains(e,t,i,n=.5){const{halfWidth:s,halfHeight:r}=this;if(s<=0||r<=0)return!1;const a=i*(1-n),o=i-a,l=s-o,h=r-o,u=s+a,c=r+a,d=e-this.x,p=t-this.y;return d*d/(l*l)+p*p/(h*h)>1&&d*d/(u*u)+p*p/(c*c)<=1}getBounds(e){return e||(e=new f.M),e.x=this.x-this.halfWidth,e.y=this.y-this.halfHeight,e.width=2*this.halfWidth,e.height=2*this.halfHeight,e}copyFrom(e){return this.x=e.x,this.y=e.y,this.halfWidth=e.halfWidth,this.halfHeight=e.halfHeight,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function _(e,t,i,n,s,r){const a=s-i,o=r-n,l=a*a+o*o;let h,u,c=-1;0!==l&&(c=((e-i)*a+(t-n)*o)/l),c<0?(h=i,u=n):c>1?(h=s,u=r):(h=i+c*a,u=n+c*o);const d=e-h,p=t-u;return d*d+p*p}class v{constructor(...e){this.type="polygon";let t=Array.isArray(e[0])?e[0]:e;if("number"!=typeof t[0]){const e=[];for(let i=0,n=t.length;i<n;i++)e.push(t[i].x,t[i].y);t=e}this.points=t,this.closePath=!0}isClockwise(){let e=0;const t=this.points,i=t.length;for(let n=0;n<i;n+=2){const s=t[n],r=t[n+1];e+=(t[(n+2)%i]-s)*(t[(n+3)%i]+r)}return e<0}containsPolygon(e){const t=this.getBounds(undefined),i=e.getBounds(undefined);if(!t.containsRect(i))return!1;const n=e.points;for(let e=0;e<n.length;e+=2){const t=n[e],i=n[e+1];if(!this.contains(t,i))return!1}return!0}clone(){const e=this.points.slice(),t=new v(e);return t.closePath=this.closePath,t}contains(e,t){let i=!1;const n=this.points.length/2;for(let s=0,r=n-1;s<n;r=s++){const n=this.points[2*s],a=this.points[2*s+1],o=this.points[2*r],l=this.points[2*r+1];a>t!=l>t&&e<(t-a)/(l-a)*(o-n)+n&&(i=!i)}return i}strokeContains(e,t,i,n=.5){const s=i*i,r=s*(1-n),a=s-r,{points:o}=this,l=o.length-(this.closePath?0:2);for(let i=0;i<l;i+=2){const n=o[i],s=o[i+1],l=o[(i+2)%o.length],h=o[(i+3)%o.length];if(_(e,t,n,s,l,h)<=(Math.sign((l-n)*(t-s)-(h-s)*(e-n))<0?a:r))return!0}return!1}getBounds(e){e||(e=new f.M);const t=this.points;let i=1/0,n=-1/0,s=1/0,r=-1/0;for(let e=0,a=t.length;e<a;e+=2){const a=t[e],o=t[e+1];i=a<i?a:i,n=a>n?a:n,s=o<s?o:s,r=o>r?o:r}return e.x=i,e.width=n-i,e.y=s,e.height=r-s,e}copyFrom(e){return this.points=e.points.slice(),this.closePath=e.closePath,this}copyTo(e){return e.copyFrom(this),e}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((e,t)=>`${e}, ${t}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return(0,h.t6)("8.11.0","Polygon.lastX is deprecated, please use Polygon.lastX instead."),this.points[this.points.length-2]}get y(){return(0,h.t6)("8.11.0","Polygon.y is deprecated, please use Polygon.lastY instead."),this.points[this.points.length-1]}get startX(){return this.points[0]}get startY(){return this.points[1]}}const y=(e,t,i,n,s,r,a)=>{const o=e-i,l=t-n,h=Math.sqrt(o*o+l*l);return h>=s-r&&h<=s+a};class b{constructor(e=0,t=0,i=0,n=0,s=20){this.type="roundedRectangle",this.x=e,this.y=t,this.width=i,this.height=n,this.radius=s}getBounds(e){return e||(e=new f.M),e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}clone(){return new b(this.x,this.y,this.width,this.height,this.radius)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.copyFrom(this),e}contains(e,t){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height){const i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(t>=this.y+i&&t<=this.y+this.height-i||e>=this.x+i&&e<=this.x+this.width-i)return!0;let n=e-(this.x+i),s=t-(this.y+i);const r=i*i;if(n*n+s*s<=r)return!0;if(n=e-(this.x+this.width-i),n*n+s*s<=r)return!0;if(s=t-(this.y+this.height-i),n*n+s*s<=r)return!0;if(n=e-(this.x+i),n*n+s*s<=r)return!0}return!1}strokeContains(e,t,i,n=.5){const{x:s,y:r,width:a,height:o,radius:l}=this,h=i*(1-n),u=i-h,c=s+l,d=r+l,p=s+a,f=r+o;return(e>=s-h&&e<=s+u||e>=p-u&&e<=p+h)&&t>=d&&t<=d+(o-2*l)||((t>=r-h&&t<=r+u||t>=f-u&&t<=f+h)&&e>=c&&e<=c+(a-2*l)||(e<c&&t<d&&y(e,t,c,d,l,u,h)||e>p-l&&t<d&&y(e,t,p-l,d,l,u,h)||e>p-l&&t>f-l&&y(e,t,p-l,f-l,l,u,h)||e<c&&t>f-l&&y(e,t,c,f-l,l,u,h)))}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}var x=i(3018);const T=1.1920929e-7;function S(e,t,i,n,s,r,a,o,l,h){let u=(1-Math.min(.99,Math.max(0,h??x.GH.defaultOptions.bezierSmoothness)))/1;return u*=u,function(e,t,i,n,s,r,a,o,l,h){A(e,t,i,n,s,r,a,o,l,h,0),l.push(a,o)}(t,i,n,s,r,a,o,l,e,u),e}function A(e,t,i,n,s,r,a,o,l,h,u){if(u>8)return;Math.PI;const c=(e+i)/2,d=(t+n)/2,p=(i+s)/2,f=(n+r)/2,g=(s+a)/2,m=(r+o)/2,_=(c+p)/2,v=(d+f)/2,y=(p+g)/2,b=(f+m)/2,x=(_+y)/2,S=(v+b)/2;if(u>0){let u=a-e,c=o-t;const d=Math.abs((i-a)*c-(n-o)*u),p=Math.abs((s-a)*c-(r-o)*u);if(d>T&&p>T){if((d+p)*(d+p)<=h*(u*u+c*c))return void l.push(x,S)}else if(d>T){if(d*d<=h*(u*u+c*c))return void l.push(x,S)}else if(p>T){if(p*p<=h*(u*u+c*c))return void l.push(x,S)}else if(u=x-(e+a)/2,c=S-(t+o)/2,u*u+c*c<=h)return void l.push(x,S)}A(e,t,c,d,_,v,x,S,l,h,u+1),A(x,S,y,b,g,m,a,o,l,h,u+1)}function E(e,t,i,n,s,r,a,o){let l=(1-Math.min(.99,Math.max(0,o??x.GH.defaultOptions.bezierSmoothness)))/1;return l*=l,function(e,t,i,n,s,r,a,o){C(a,e,t,i,n,s,r,o,0),a.push(s,r)}(t,i,n,s,r,a,e,l),e}function C(e,t,i,n,s,r,a,o,l){if(l>8)return;Math.PI;const h=(t+n)/2,u=(i+s)/2,c=(n+r)/2,d=(s+a)/2,p=(h+c)/2,f=(u+d)/2;let g=r-t,m=a-i;const _=Math.abs((n-r)*m-(s-a)*g);if(_>1.1920929e-7){if(_*_<=o*(g*g+m*m))return void e.push(p,f)}else if(g=p-(t+r)/2,m=f-(i+a)/2,g*g+m*m<=o)return void e.push(p,f);C(e,t,i,h,u,p,f,o,l+1),C(e,p,f,c,d,r,a,o,l+1)}function w(e,t,i,n,s,r,a,o){let l=Math.abs(s-r);(!a&&s>r||a&&r>s)&&(l=2*Math.PI-l),o||(o=Math.max(6,Math.floor(6*Math.pow(n,1/3)*(l/Math.PI))));let h=l/(o=Math.max(o,3)),u=s;h*=a?-1:1;for(let s=0;s<o+1;s++){const s=t+Math.cos(u)*n,r=i+Math.sin(u)*n;e.push(s,r),u+=h}}const P=2*Math.PI,I={centerX:0,centerY:0,ang1:0,ang2:0},M=({x:e,y:t},i,n,s,r,a,o,l)=>{const h=s*(e*=i)-r*(t*=n),u=r*e+s*t;return l.x=h+a,l.y=u+o,l};function R(e,t){const i=-1.5707963267948966===t?-.551915024494:4/3*Math.tan(t/4),n=1.5707963267948966===t?.551915024494:i,s=Math.cos(e),r=Math.sin(e),a=Math.cos(e+t),o=Math.sin(e+t);return[{x:s-r*n,y:r+s*n},{x:a+o*n,y:o-a*n},{x:a,y:o}]}const L=(e,t,i,n)=>{let s=e*i+t*n;return s>1&&(s=1),s<-1&&(s=-1),(e*n-t*i<0?-1:1)*Math.acos(s)};function k(e,t,i,n,s,r,a,o=0,l=0,h=0){if(0===r||0===a)return;const u=Math.sin(o*P/360),c=Math.cos(o*P/360),d=c*(t-n)/2+u*(i-s)/2,p=-u*(t-n)/2+c*(i-s)/2;if(0===d&&0===p)return;r=Math.abs(r),a=Math.abs(a);const f=Math.pow(d,2)/Math.pow(r,2)+Math.pow(p,2)/Math.pow(a,2);f>1&&(r*=Math.sqrt(f),a*=Math.sqrt(f)),((e,t,i,n,s,r,a,o,l,h,u,c,d)=>{const p=Math.pow(s,2),f=Math.pow(r,2),g=Math.pow(u,2),m=Math.pow(c,2);let _=p*f-p*m-f*g;_<0&&(_=0),_/=p*m+f*g,_=Math.sqrt(_)*(a===o?-1:1);const v=_*s/r*c,y=_*-r/s*u,b=h*v-l*y+(e+i)/2,x=l*v+h*y+(t+n)/2,T=(u-v)/s,S=(c-y)/r,A=(-u-v)/s,E=(-c-y)/r,C=L(1,0,T,S);let w=L(T,S,A,E);0===o&&w>0&&(w-=P),1===o&&w<0&&(w+=P),d.centerX=b,d.centerY=x,d.ang1=C,d.ang2=w})(t,i,n,s,r,a,l,h,u,c,d,p,I);let{ang1:g,ang2:m}=I;const{centerX:_,centerY:v}=I;let y=Math.abs(m)/(P/4);Math.abs(1-y)<1e-7&&(y=1);const b=Math.max(Math.ceil(y),1);m/=b;let x=e[e.length-2],T=e[e.length-1];const A={x:0,y:0};for(let t=0;t<b;t++){const t=R(g,m),{x:i,y:n}=M(t[0],r,a,c,u,_,v,A),{x:s,y:o}=M(t[1],r,a,c,u,_,v,A),{x:l,y:h}=M(t[2],r,a,c,u,_,v,A);S(e,x,T,i,n,s,o,l,h),x=l,T=h,g+=m}}const D=new f.M;class O{constructor(e){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new u.c,this._graphicsPath2D=e,this.signed=e.checkForHoles}moveTo(e,t){return this.startPoly(e,t),this}lineTo(e,t){this._ensurePoly();const i=this._currentPoly.points,n=i[i.length-2],s=i[i.length-1];return n===e&&s===t||i.push(e,t),this}arc(e,t,i,n,s,r){this._ensurePoly(!1);return w(this._currentPoly.points,e,t,i,n,s,r),this}arcTo(e,t,i,n,s){this._ensurePoly();return function(e,t,i,n,s,r){const a=e[e.length-2],o=e[e.length-1]-i,l=a-t,h=s-i,u=n-t,c=Math.abs(o*u-l*h);if(c<1e-8||0===r)return void(e[e.length-2]===t&&e[e.length-1]===i||e.push(t,i));const d=o*o+l*l,p=h*h+u*u,f=o*h+l*u,g=r*Math.sqrt(d)/c,m=r*Math.sqrt(p)/c,_=g*f/d,v=m*f/p,y=g*u+m*l,b=g*h+m*o,x=l*(m+_),T=o*(m+_),S=u*(g+v),A=h*(g+v);w(e,y+t,b+i,r,Math.atan2(T-b,x-y),Math.atan2(A-b,S-y),l*h>u*o)}(this._currentPoly.points,e,t,i,n,s),this}arcToSvg(e,t,i,n,s,r,a){return k(this._currentPoly.points,this._currentPoly.lastX,this._currentPoly.lastY,r,a,e,t,i,n,s),this}bezierCurveTo(e,t,i,n,s,r,a){this._ensurePoly();const o=this._currentPoly;return S(this._currentPoly.points,o.lastX,o.lastY,e,t,i,n,s,r,a),this}quadraticCurveTo(e,t,i,n,s){this._ensurePoly();const r=this._currentPoly;return E(this._currentPoly.points,r.lastX,r.lastY,e,t,i,n,s),this}closePath(){return this.endPoly(!0),this}addPath(e,t){this.endPoly(),t&&!t.isIdentity()&&(e=e.clone(!0)).transform(t);const i=this.shapePrimitives,n=i.length;for(let t=0;t<e.instructions.length;t++){const i=e.instructions[t];this[i.action](...i.data)}if(e.checkForHoles&&i.length-n>1){let e=null;for(let t=n;t<i.length;t++){const n=i[t];if("polygon"===n.shape.type){const s=n.shape,r=e?.shape;r&&r.containsPolygon(s)?(e.holes||(e.holes=[]),e.holes.push(n),i.copyWithin(t,t+1),i.length--,t--):e=n}}}return this}finish(e=!1){this.endPoly(e)}rect(e,t,i,n,s){return this.drawShape(new f.M(e,t,i,n),s),this}circle(e,t,i,n){return this.drawShape(new g(e,t,i),n),this}poly(e,t,i){const n=new v(e);return n.closePath=t,this.drawShape(n,i),this}regularPoly(e,t,i,n,s=0,r){n=Math.max(0|n,3);const a=-1*Math.PI/2+s,o=2*Math.PI/n,l=[];for(let s=0;s<n;s++){const n=a-s*o;l.push(e+i*Math.cos(n),t+i*Math.sin(n))}return this.poly(l,!0,r),this}roundPoly(e,t,i,n,s,r=0,a){if(n=Math.max(0|n,3),s<=0)return this.regularPoly(e,t,i,n,r);const o=i*Math.sin(Math.PI/n)-.001;s=Math.min(s,o);const l=-1*Math.PI/2+r,h=2*Math.PI/n,u=(n-2)*Math.PI/n/2;for(let r=0;r<n;r++){const n=r*h+l,o=e+i*Math.cos(n),c=t+i*Math.sin(n),d=n+Math.PI+u,p=n-Math.PI-u,f=o+s*Math.cos(d),g=c+s*Math.sin(d),m=o+s*Math.cos(p),_=c+s*Math.sin(p);0===r?this.moveTo(f,g):this.lineTo(f,g),this.quadraticCurveTo(o,c,m,_,a)}return this.closePath()}roundShape(e,t,i=!1,n){return e.length<3?this:(i?function(e,t,i,n){const s=(e,t)=>Math.sqrt((e.x-t.x)**2+(e.y-t.y)**2),r=(e,t,i)=>({x:e.x+(t.x-e.x)*i,y:e.y+(t.y-e.y)*i}),a=t.length;for(let o=0;o<a;o++){const l=t[(o+1)%a],h=l.radius??i;if(h<=0){0===o?e.moveTo(l.x,l.y):e.lineTo(l.x,l.y);continue}const u=t[o],c=t[(o+2)%a],d=s(u,l);let p;p=d<1e-4?l:r(l,u,Math.min(d/2,h)/d);const f=s(c,l);let g;g=f<1e-4?l:r(l,c,Math.min(f/2,h)/f),0===o?e.moveTo(p.x,p.y):e.lineTo(p.x,p.y),e.quadraticCurveTo(l.x,l.y,g.x,g.y,n)}}(this,e,t,n):function(e,t,i){const n=(e,t)=>{const i=t.x-e.x,n=t.y-e.y,s=Math.sqrt(i*i+n*n);return{len:s,nx:i/s,ny:n/s}},s=(t,i)=>{0===t?e.moveTo(i.x,i.y):e.lineTo(i.x,i.y)};let r=t[t.length-1];for(let a=0;a<t.length;a++){const o=t[a%t.length],l=o.radius??i;if(l<=0){s(a,o),r=o;continue}const h=t[(a+1)%t.length],u=n(o,r),c=n(o,h);if(u.len<1e-4||c.len<1e-4){s(a,o),r=o;continue}let d=Math.asin(u.nx*c.ny-u.ny*c.nx),p=1,f=!1;u.nx*c.nx-u.ny*-c.ny<0?d<0?d=Math.PI+d:(d=Math.PI-d,p=-1,f=!0):d>0&&(p=-1,f=!0);const g=d/2;let m,_=Math.abs(Math.cos(g)*l/Math.sin(g));_>Math.min(u.len/2,c.len/2)?(_=Math.min(u.len/2,c.len/2),m=Math.abs(_*Math.sin(g)/Math.cos(g))):m=l;const v=o.x+c.nx*_+-c.ny*m*p,y=o.y+c.ny*_+c.nx*m*p,b=Math.atan2(u.ny,u.nx)+Math.PI/2*p,x=Math.atan2(c.ny,c.nx)-Math.PI/2*p;0===a&&e.moveTo(v+Math.cos(b)*m,y+Math.sin(b)*m),e.arc(v,y,m,b,x,f),r=o}}(this,e,t),this.closePath())}filletRect(e,t,i,n,s){if(0===s)return this.rect(e,t,i,n);const r=Math.min(i,n)/2,a=Math.min(r,Math.max(-r,s)),o=e+i,l=t+n,h=a<0?-a:0,u=Math.abs(a);return this.moveTo(e,t+u).arcTo(e+h,t+h,e+u,t,u).lineTo(o-u,t).arcTo(o-h,t+h,o,t+u,u).lineTo(o,l-u).arcTo(o-h,l-h,e+i-u,l,u).lineTo(e+u,l).arcTo(e+h,l-h,e,l-u,u).closePath()}chamferRect(e,t,i,n,s,r){if(s<=0)return this.rect(e,t,i,n);const a=Math.min(s,Math.min(i,n)/2),o=e+i,l=t+n,h=[e+a,t,o-a,t,o,t+a,o,l-a,o-a,l,e+a,l,e,l-a,e,t+a];for(let e=h.length-1;e>=2;e-=2)h[e]===h[e-2]&&h[e-1]===h[e-3]&&h.splice(e-1,2);return this.poly(h,!0,r)}ellipse(e,t,i,n,s){return this.drawShape(new m(e,t,i,n),s),this}roundRect(e,t,i,n,s,r){return this.drawShape(new b(e,t,i,n,s),r),this}drawShape(e,t){return this.endPoly(),this.shapePrimitives.push({shape:e,transform:t}),this}startPoly(e,t){let i=this._currentPoly;return i&&this.endPoly(),i=new v,i.points.push(e,t),this._currentPoly=i,this}endPoly(e=!1){const t=this._currentPoly;return t&&t.points.length>2&&(t.closePath=e,this.shapePrimitives.push({shape:t})),this._currentPoly=null,this}_ensurePoly(e=!0){if(!this._currentPoly&&(this._currentPoly=new v,e)){const e=this.shapePrimitives[this.shapePrimitives.length-1];if(e){let t=e.shape.x,i=e.shape.y;if(e.transform&&!e.transform.isIdentity()){const n=e.transform,s=t;t=n.a*t+n.c*i+n.tx,i=n.b*s+n.d*i+n.ty}this._currentPoly.points.push(t,i)}else this._currentPoly.points.push(0,0)}}buildPath(){const e=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let t=0;t<e.instructions.length;t++){const i=e.instructions[t];this[i.action](...i.data)}this.finish()}get bounds(){const e=this._bounds;e.clear();const t=this.shapePrimitives;for(let i=0;i<t.length;i++){const n=t[i],s=n.shape.getBounds(D);n.transform?e.addRect(s,n.transform):e.addRect(s)}return e}}class B{constructor(e,t=!1){this.instructions=[],this.uid=(0,l.L)("graphicsPath"),this._dirty=!0,this.checkForHoles=t,"string"==typeof e?function(e,t){const i=p()(e),n=[];let s=null,r=0,a=0;for(let e=0;e<i.length;e++){const o=i[e],l=o[0],h=o;switch(l){case"M":r=h[1],a=h[2],t.moveTo(r,a);break;case"m":r+=h[1],a+=h[2],t.moveTo(r,a);break;case"H":r=h[1],t.lineTo(r,a);break;case"h":r+=h[1],t.lineTo(r,a);break;case"V":a=h[1],t.lineTo(r,a);break;case"v":a+=h[1],t.lineTo(r,a);break;case"L":r=h[1],a=h[2],t.lineTo(r,a);break;case"l":r+=h[1],a+=h[2],t.lineTo(r,a);break;case"C":r=h[5],a=h[6],t.bezierCurveTo(h[1],h[2],h[3],h[4],r,a);break;case"c":t.bezierCurveTo(r+h[1],a+h[2],r+h[3],a+h[4],r+h[5],a+h[6]),r+=h[5],a+=h[6];break;case"S":r=h[3],a=h[4],t.bezierCurveToShort(h[1],h[2],r,a);break;case"s":t.bezierCurveToShort(r+h[1],a+h[2],r+h[3],a+h[4]),r+=h[3],a+=h[4];break;case"Q":r=h[3],a=h[4],t.quadraticCurveTo(h[1],h[2],r,a);break;case"q":t.quadraticCurveTo(r+h[1],a+h[2],r+h[3],a+h[4]),r+=h[3],a+=h[4];break;case"T":r=h[1],a=h[2],t.quadraticCurveToShort(r,a);break;case"t":r+=h[1],a+=h[2],t.quadraticCurveToShort(r,a);break;case"A":r=h[6],a=h[7],t.arcToSvg(h[1],h[2],h[3],h[4],h[5],r,a);break;case"a":r+=h[6],a+=h[7],t.arcToSvg(h[1],h[2],h[3],h[4],h[5],r,a);break;case"Z":case"z":t.closePath(),n.length>0&&(s=n.pop(),s?(r=s.startX,a=s.startY):(r=0,a=0)),s=null;break;default:(0,c.R)(`Unknown SVG path command: ${l}`)}"Z"!==l&&"z"!==l&&null===s&&(s={startX:r,startY:a},n.push(s))}}(e,this):this.instructions=e?.slice()??[]}get shapePath(){return this._shapePath||(this._shapePath=new O(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(e,t){return e=e.clone(),this.instructions.push({action:"addPath",data:[e,t]}),this._dirty=!0,this}arc(...e){return this.instructions.push({action:"arc",data:e}),this._dirty=!0,this}arcTo(...e){return this.instructions.push({action:"arcTo",data:e}),this._dirty=!0,this}arcToSvg(...e){return this.instructions.push({action:"arcToSvg",data:e}),this._dirty=!0,this}bezierCurveTo(...e){return this.instructions.push({action:"bezierCurveTo",data:e}),this._dirty=!0,this}bezierCurveToShort(e,t,i,n,s){const r=this.instructions[this.instructions.length-1],o=this.getLastPoint(a.b.shared);let l=0,h=0;if(r&&"bezierCurveTo"===r.action){l=r.data[2],h=r.data[3];const e=o.x,t=o.y;l=e+(e-l),h=t+(t-h)}else l=o.x,h=o.y;return this.instructions.push({action:"bezierCurveTo",data:[l,h,e,t,i,n,s]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...e){return this.instructions.push({action:"ellipse",data:e}),this._dirty=!0,this}lineTo(...e){return this.instructions.push({action:"lineTo",data:e}),this._dirty=!0,this}moveTo(...e){return this.instructions.push({action:"moveTo",data:e}),this}quadraticCurveTo(...e){return this.instructions.push({action:"quadraticCurveTo",data:e}),this._dirty=!0,this}quadraticCurveToShort(e,t,i){const n=this.instructions[this.instructions.length-1],s=this.getLastPoint(a.b.shared);let r=0,o=0;if(n&&"quadraticCurveTo"===n.action){r=n.data[0],o=n.data[1];const e=s.x,t=s.y;r=e+(e-r),o=t+(t-o)}else r=s.x,o=s.y;return this.instructions.push({action:"quadraticCurveTo",data:[r,o,e,t,i]}),this._dirty=!0,this}rect(e,t,i,n,s){return this.instructions.push({action:"rect",data:[e,t,i,n,s]}),this._dirty=!0,this}circle(e,t,i,n){return this.instructions.push({action:"circle",data:[e,t,i,n]}),this._dirty=!0,this}roundRect(...e){return this.instructions.push({action:"roundRect",data:e}),this._dirty=!0,this}poly(...e){return this.instructions.push({action:"poly",data:e}),this._dirty=!0,this}regularPoly(...e){return this.instructions.push({action:"regularPoly",data:e}),this._dirty=!0,this}roundPoly(...e){return this.instructions.push({action:"roundPoly",data:e}),this._dirty=!0,this}roundShape(...e){return this.instructions.push({action:"roundShape",data:e}),this._dirty=!0,this}filletRect(...e){return this.instructions.push({action:"filletRect",data:e}),this._dirty=!0,this}chamferRect(...e){return this.instructions.push({action:"chamferRect",data:e}),this._dirty=!0,this}star(e,t,i,n,s,r,a){s||(s=n/2);const o=-1*Math.PI/2+r,l=2*i,h=2*Math.PI/l,u=[];for(let i=0;i<l;i++){const r=i%2?s:n,a=i*h+o;u.push(e+r*Math.cos(a),t+r*Math.sin(a))}return this.poly(u,!0,a),this}clone(e=!1){const t=new B;if(t.checkForHoles=this.checkForHoles,e)for(let e=0;e<this.instructions.length;e++){const i=this.instructions[e];t.instructions.push({action:i.action,data:i.data.slice()})}else t.instructions=this.instructions.slice();return t}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(e){if(e.isIdentity())return this;const t=e.a,i=e.b,n=e.c,s=e.d,r=e.tx,a=e.ty;let o=0,l=0,h=0,u=0,d=0,p=0,f=0,g=0;for(let m=0;m<this.instructions.length;m++){const _=this.instructions[m],v=_.data;switch(_.action){case"moveTo":case"lineTo":o=v[0],l=v[1],v[0]=t*o+n*l+r,v[1]=i*o+s*l+a;break;case"bezierCurveTo":h=v[0],u=v[1],d=v[2],p=v[3],o=v[4],l=v[5],v[0]=t*h+n*u+r,v[1]=i*h+s*u+a,v[2]=t*d+n*p+r,v[3]=i*d+s*p+a,v[4]=t*o+n*l+r,v[5]=i*o+s*l+a;break;case"quadraticCurveTo":h=v[0],u=v[1],o=v[2],l=v[3],v[0]=t*h+n*u+r,v[1]=i*h+s*u+a,v[2]=t*o+n*l+r,v[3]=i*o+s*l+a;break;case"arcToSvg":o=v[5],l=v[6],f=v[0],g=v[1],v[0]=t*f+n*g,v[1]=i*f+s*g,v[5]=t*o+n*l+r,v[6]=i*o+s*l+a;break;case"circle":v[4]=G(v[3],e);break;case"rect":v[4]=G(v[4],e);break;case"ellipse":v[8]=G(v[8],e);break;case"roundRect":v[5]=G(v[5],e);break;case"addPath":v[0].transform(e);break;case"poly":v[2]=G(v[2],e);break;default:(0,c.R)("unknown transform action",_.action)}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(e){let t=this.instructions.length-1,i=this.instructions[t];if(!i)return e.x=0,e.y=0,e;for(;"closePath"===i.action;){if(t--,t<0)return e.x=0,e.y=0,e;i=this.instructions[t]}switch(i.action){case"moveTo":case"lineTo":e.x=i.data[0],e.y=i.data[1];break;case"quadraticCurveTo":e.x=i.data[2],e.y=i.data[3];break;case"bezierCurveTo":e.x=i.data[4],e.y=i.data[5];break;case"arc":case"arcToSvg":e.x=i.data[5],e.y=i.data[6];break;case"addPath":i.data[0].getLastPoint(e)}return e}}function G(e,t){return e?e.prepend(t):t.clone()}var F=i(8457);function U(e,t,i){const n=e.getAttribute(t);return n?Number(n):i}function N(e){const t=U(e,"x1",0),i=U(e,"y1",0),n=U(e,"x2",1),r=U(e,"y2",0),a=e.getAttribute("gradientUnits")||"objectBoundingBox",o=new F._(t,i,n,r,"objectBoundingBox"===a?"local":"global");for(let t=0;t<e.children.length;t++){const i=e.children[t],n=U(i,"offset",0),r=s.Q.shared.setValue(i.getAttribute("stop-color")).toNumber();o.addColorStop(n,r)}return o}function z(e){return(0,c.R)("[SVG Parser] Radial gradients are not yet supported"),new F._(0,0,1,0)}function H(e){const t=e.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return t?t[1]:""}const V={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function W(e,t){const i=e.getAttribute("style"),n={},s={},r={strokeStyle:n,fillStyle:s,useFill:!1,useStroke:!1};for(const i in V){const n=e.getAttribute(i);n&&j(t,r,i,n.trim())}if(i){const e=i.split(";");for(let i=0;i<e.length;i++){const n=e[i].trim(),[s,a]=n.split(":");V[s]&&j(t,r,s,a.trim())}}return{strokeStyle:r.useStroke?n:null,fillStyle:r.useFill?s:null,useFill:r.useFill,useStroke:r.useStroke}}function j(e,t,i,n){switch(i){case"stroke":if("none"!==n){if(n.startsWith("url(")){const i=H(n);t.strokeStyle.fill=e.defs[i]}else t.strokeStyle.color=s.Q.shared.setValue(n).toNumber();t.useStroke=!0}break;case"stroke-width":t.strokeStyle.width=Number(n);break;case"fill":if("none"!==n){if(n.startsWith("url(")){const i=H(n);t.fillStyle.fill=e.defs[i]}else t.fillStyle.color=s.Q.shared.setValue(n).toNumber();t.useFill=!0}break;case"fill-opacity":t.fillStyle.alpha=Number(n);break;case"stroke-opacity":t.strokeStyle.alpha=Number(n);break;case"opacity":t.fillStyle.alpha=Number(n),t.strokeStyle.alpha=Number(n)}}function X(e){const t=e.match(/[-+]?[0-9]*\.?[0-9]+/g);if(!t||t.length<4)return 0;const i=t.map(Number),n=[],s=[];for(let e=0;e<i.length;e+=2)e+1<i.length&&(n.push(i[e]),s.push(i[e+1]));if(0===n.length||0===s.length)return 0;const r=Math.min(...n),a=Math.max(...n),o=Math.min(...s);return(a-r)*(Math.max(...s)-o)}function Y(e,t){const i=new B(e,!1);for(const e of i.instructions)t.instructions.push(e)}function K(e,t){if("string"==typeof e){const t=document.createElement("div");t.innerHTML=e.trim(),e=t.querySelector("svg")}const i={context:t,defs:{},path:new B};!function(e,t){const i=e.querySelectorAll("defs");for(let e=0;e<i.length;e++){const n=i[e];for(let e=0;e<n.children.length;e++){const i=n.children[e];switch(i.nodeName.toLowerCase()){case"lineargradient":t.defs[i.id]=N(i);break;case"radialgradient":t.defs[i.id]=z()}}}}(e,i);const n=e.children,{fillStyle:s,strokeStyle:r}=W(e,i);for(let e=0;e<n.length;e++){const t=n[e];"defs"!==t.nodeName.toLowerCase()&&q(t,i,s,r)}return t}function q(e,t,i,n){const s=e.children,{fillStyle:r,strokeStyle:a}=W(e,t);r&&i?i={...i,...r}:r&&(i=r),a&&n?n={...n,...a}:a&&(n=a);const o=!i&&!n;let l,h,u,d,p,f,g,m,_,v,y,b,x,T,S,A,E;switch(o&&(i={color:0}),e.nodeName.toLowerCase()){case"path":{T=e.getAttribute("d");const s=e.getAttribute("fill-rule"),r=T.split(/(?=[Mm])/).filter(e=>e.trim().length>0),a="evenodd"===s,o=r.length>1;if(a&&o){const e=r.map(e=>({path:e,area:X(e)}));e.sort((e,t)=>t.area-e.area);const s=r.length>3||!function(e){if(e.length<=2)return!0;const t=e.map(e=>e.area).sort((e,t)=>t-e),[i,n]=t,s=t[t.length-1];return!(i/n>3&&n/s<2)}(e);if(s)for(let s=0;s<e.length;s++){const r=e[s],a=0===s;t.context.beginPath();const o=new B(void 0,!0);Y(r.path,o),t.context.path(o),a?(i&&t.context.fill(i),n&&t.context.stroke(n)):t.context.cut()}else for(let s=0;s<e.length;s++){const r=e[s],a=s%2==1;t.context.beginPath();const o=new B(void 0,!0);Y(r.path,o),t.context.path(o),a?t.context.cut():(i&&t.context.fill(i),n&&t.context.stroke(n))}}else{S=new B(T,!s||"evenodd"===s),t.context.path(S),i&&t.context.fill(i),n&&t.context.stroke(n)}break}case"circle":g=U(e,"cx",0),m=U(e,"cy",0),_=U(e,"r",0),t.context.ellipse(g,m,_,_),i&&t.context.fill(i),n&&t.context.stroke(n);break;case"rect":l=U(e,"x",0),h=U(e,"y",0),A=U(e,"width",0),E=U(e,"height",0),v=U(e,"rx",0),y=U(e,"ry",0),v||y?t.context.roundRect(l,h,A,E,v||y):t.context.rect(l,h,A,E),i&&t.context.fill(i),n&&t.context.stroke(n);break;case"ellipse":g=U(e,"cx",0),m=U(e,"cy",0),v=U(e,"rx",0),y=U(e,"ry",0),t.context.beginPath(),t.context.ellipse(g,m,v,y),i&&t.context.fill(i),n&&t.context.stroke(n);break;case"line":u=U(e,"x1",0),d=U(e,"y1",0),p=U(e,"x2",0),f=U(e,"y2",0),t.context.beginPath(),t.context.moveTo(u,d),t.context.lineTo(p,f),n&&t.context.stroke(n);break;case"polygon":x=e.getAttribute("points"),b=x.match(/\d+/g).map(e=>parseInt(e,10)),t.context.poly(b,!0),i&&t.context.fill(i),n&&t.context.stroke(n);break;case"polyline":x=e.getAttribute("points"),b=x.match(/\d+/g).map(e=>parseInt(e,10)),t.context.poly(b,!1),n&&t.context.stroke(n);break;case"g":case"svg":break;default:(0,c.R)(`[SVG parser] <${e.nodeName}> elements unsupported`)}o&&(i=null);for(let e=0;e<s.length;e++)q(s[e],t,i,n)}var $=i(6371);const Q=new a.b,Z=new r.u,J=class e extends n.A{constructor(){super(...arguments),this.uid=(0,l.L)("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new B,this._transform=new r.u,this._fillStyle={...e.defaultFillStyle},this._strokeStyle={...e.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new u.c,this._boundsDirty=!0}clone(){const t=new e;return t.batchMode=this.batchMode,t.instructions=this.instructions.slice(),t._activePath=this._activePath.clone(),t._transform=this._transform.clone(),t._fillStyle={...this._fillStyle},t._strokeStyle={...this._strokeStyle},t._stateStack=this._stateStack.slice(),t._bounds=this._bounds.clone(),t._boundsDirty=!0,t}get fillStyle(){return this._fillStyle}set fillStyle(t){this._fillStyle=(0,$.w)(t,e.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(t){this._strokeStyle=(0,$.T)(t,e.defaultStrokeStyle)}setFillStyle(t){return this._fillStyle=(0,$.w)(t,e.defaultFillStyle),this}setStrokeStyle(t){return this._strokeStyle=(0,$.w)(t,e.defaultStrokeStyle),this}texture(e,t,i,n,r,a){return this.instructions.push({action:"texture",data:{image:e,dx:i||0,dy:n||0,dw:r||e.frame.width,dh:a||e.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:t?s.Q.shared.setValue(t).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new B,this}fill(t,i){let n;const s=this.instructions[this.instructions.length-1];return n=0===this._tick&&s&&"stroke"===s.action?s.data.path:this._activePath.clone(),n?(null!=t&&(void 0!==i&&"number"==typeof t&&((0,h.t6)(h.lj,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),t={color:t,alpha:i}),this._fillStyle=(0,$.w)(t,e.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:n}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:e,y:t}=this._activePath.getLastPoint(a.b.shared);this._activePath.clear(),this._activePath.moveTo(e,t)}stroke(t){let i;const n=this.instructions[this.instructions.length-1];return i=0===this._tick&&n&&"fill"===n.action?n.data.path:this._activePath.clone(),i?(null!=t&&(this._strokeStyle=(0,$.T)(t,e.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:i}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let e=0;e<2;e++){const t=this.instructions[this.instructions.length-1-e],i=this._activePath.clone();if(t&&("stroke"===t.action||"fill"===t.action)){if(!t.data.hole){t.data.hole=i;break}t.data.hole.addPath(i)}}return this._initNextPathLocation(),this}arc(e,t,i,n,s,r){this._tick++;const a=this._transform;return this._activePath.arc(a.a*e+a.c*t+a.tx,a.b*e+a.d*t+a.ty,i,n,s,r),this}arcTo(e,t,i,n,s){this._tick++;const r=this._transform;return this._activePath.arcTo(r.a*e+r.c*t+r.tx,r.b*e+r.d*t+r.ty,r.a*i+r.c*n+r.tx,r.b*i+r.d*n+r.ty,s),this}arcToSvg(e,t,i,n,s,r,a){this._tick++;const o=this._transform;return this._activePath.arcToSvg(e,t,i,n,s,o.a*r+o.c*a+o.tx,o.b*r+o.d*a+o.ty),this}bezierCurveTo(e,t,i,n,s,r,a){this._tick++;const o=this._transform;return this._activePath.bezierCurveTo(o.a*e+o.c*t+o.tx,o.b*e+o.d*t+o.ty,o.a*i+o.c*n+o.tx,o.b*i+o.d*n+o.ty,o.a*s+o.c*r+o.tx,o.b*s+o.d*r+o.ty,a),this}closePath(){return this._tick++,this._activePath?.closePath(),this}ellipse(e,t,i,n){return this._tick++,this._activePath.ellipse(e,t,i,n,this._transform.clone()),this}circle(e,t,i){return this._tick++,this._activePath.circle(e,t,i,this._transform.clone()),this}path(e){return this._tick++,this._activePath.addPath(e,this._transform.clone()),this}lineTo(e,t){this._tick++;const i=this._transform;return this._activePath.lineTo(i.a*e+i.c*t+i.tx,i.b*e+i.d*t+i.ty),this}moveTo(e,t){this._tick++;const i=this._transform,n=this._activePath.instructions,s=i.a*e+i.c*t+i.tx,r=i.b*e+i.d*t+i.ty;return 1===n.length&&"moveTo"===n[0].action?(n[0].data[0]=s,n[0].data[1]=r,this):(this._activePath.moveTo(s,r),this)}quadraticCurveTo(e,t,i,n,s){this._tick++;const r=this._transform;return this._activePath.quadraticCurveTo(r.a*e+r.c*t+r.tx,r.b*e+r.d*t+r.ty,r.a*i+r.c*n+r.tx,r.b*i+r.d*n+r.ty,s),this}rect(e,t,i,n){return this._tick++,this._activePath.rect(e,t,i,n,this._transform.clone()),this}roundRect(e,t,i,n,s){return this._tick++,this._activePath.roundRect(e,t,i,n,s,this._transform.clone()),this}poly(e,t){return this._tick++,this._activePath.poly(e,t,this._transform.clone()),this}regularPoly(e,t,i,n,s=0,r){return this._tick++,this._activePath.regularPoly(e,t,i,n,s,r),this}roundPoly(e,t,i,n,s,r){return this._tick++,this._activePath.roundPoly(e,t,i,n,s,r),this}roundShape(e,t,i,n){return this._tick++,this._activePath.roundShape(e,t,i,n),this}filletRect(e,t,i,n,s){return this._tick++,this._activePath.filletRect(e,t,i,n,s),this}chamferRect(e,t,i,n,s,r){return this._tick++,this._activePath.chamferRect(e,t,i,n,s,r),this}star(e,t,i,n,s=0,r=0){return this._tick++,this._activePath.star(e,t,i,n,s,r,this._transform.clone()),this}svg(e){return this._tick++,K(e,this),this}restore(){const e=this._stateStack.pop();return e&&(this._transform=e.transform,this._fillStyle=e.fillStyle,this._strokeStyle=e.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(e){return this._transform.rotate(e),this}scale(e,t=e){return this._transform.scale(e,t),this}setTransform(e,t,i,n,s,a){return e instanceof r.u?(this._transform.set(e.a,e.b,e.c,e.d,e.tx,e.ty),this):(this._transform.set(e,t,i,n,s,a),this)}transform(e,t,i,n,s,a){return e instanceof r.u?(this._transform.append(e),this):(Z.set(e,t,i,n,s,a),this._transform.append(Z),this)}translate(e,t=e){return this._transform.translate(e,t),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this._boundsDirty=!0,this.dirty||(this.emit("update",this,16),this.dirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;this._boundsDirty=!1;const e=this._bounds;e.clear();for(let t=0;t<this.instructions.length;t++){const i=this.instructions[t],n=i.action;if("fill"===n){const t=i.data;e.addBounds(t.path.bounds)}else if("texture"===n){const t=i.data;e.addFrame(t.dx,t.dy,t.dx+t.dw,t.dy+t.dh,t.transform)}if("stroke"===n){const t=i.data,n=t.style.alignment,s=t.style.width*(1-n),r=t.path.bounds;e.addFrame(r.minX-s,r.minY-s,r.maxX+s,r.maxY+s)}}return e}containsPoint(e){if(!this.bounds.containsPoint(e.x,e.y))return!1;const t=this.instructions;let i=!1;for(let n=0;n<t.length;n++){const s=t[n],r=s.data,a=r.path;if(!s.action||!a)continue;const o=r.style,l=a.shapePath.shapePrimitives;for(let t=0;t<l.length;t++){const n=l[t].shape;if(!o||!n)continue;const a=l[t].transform,h=a?a.applyInverse(e,Q):e;if("fill"===s.action)i=n.contains(h.x,h.y);else{const e=o;i=n.strokeContains(h.x,h.y,e.width,e.alignment)}const u=r.hole;if(u){const e=u.shapePath?.shapePrimitives;if(e)for(let t=0;t<e.length;t++)e[t].shape.contains(h.x,h.y)&&(i=!1)}if(i)return!0}}return i}destroy(e=!1){this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners();if("boolean"==typeof e?e:e?.texture){const t="boolean"==typeof e?e:e?.textureSource;this._fillStyle.texture&&(this._fillStyle.fill&&"uid"in this._fillStyle.fill?this._fillStyle.fill.destroy():this._fillStyle.texture.destroy(t)),this._strokeStyle.texture&&(this._strokeStyle.fill&&"uid"in this._strokeStyle.fill?this._strokeStyle.fill.destroy():this._strokeStyle.texture.destroy(t))}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};J.defaultFillStyle={color:16777215,alpha:1,texture:o.g.WHITE,matrix:null,fill:null,textureSpace:"local"},J.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:o.g.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let ee=J},7893:(e,t,i)=>{"use strict";function n(e){const t={};for(const i in e)void 0!==e[i]&&(t[i]=e[i]);return t}i.d(t,{S:()=>n})},8002:(e,t,i)=>{"use strict";var n=i(8602),s=i(3018),r=i(4060),a=i(5148),o=i(1965),l=i(4255);class h{constructor(){this.batches=[],this.batched=!1}destroy(){this.batches.forEach(e=>{a.Z.return(e)}),this.batches.length=0}}class u{constructor(e,t){this.state=r.U.for2d(),this.renderer=e,this._adaptor=t,this.renderer.runners.contextChange.add(this)}contextChange(){this._adaptor.contextChange(this.renderer)}validateRenderable(e){const t=e.context,i=!!e._gpuData,n=this.renderer.graphicsContext.updateGpuContext(t);return!(!n.isBatchable&&i===n.isBatchable)}addRenderable(e,t){const i=this.renderer.graphicsContext.updateGpuContext(e.context);e.didViewUpdate&&this._rebuild(e),i.isBatchable?this._addToBatcher(e,t):(this.renderer.renderPipes.batch.break(t),t.add(e))}updateRenderable(e){const t=this._getGpuDataForRenderable(e).batches;for(let e=0;e<t.length;e++){const i=t[e];i._batcher.updateElement(i)}}execute(e){if(!e.isRenderable)return;const t=this.renderer,i=e.context;if(!t.graphicsContext.getGpuContext(i).batches.length)return;const n=i.customShader||this._adaptor.shader;this.state.blendMode=e.groupBlendMode;const s=n.resources.localUniforms.uniforms;s.uTransformMatrix=e.groupTransform,s.uRound=t._roundPixels|e._roundPixels,(0,o.V)(e.groupColorAlpha,s.uColor,0),this._adaptor.execute(this,e)}_rebuild(e){const t=this._getGpuDataForRenderable(e),i=this.renderer.graphicsContext.updateGpuContext(e.context);t.destroy(),i.isBatchable&&this._updateBatchesForRenderable(e,t)}_addToBatcher(e,t){const i=this.renderer.renderPipes.batch,n=this._getGpuDataForRenderable(e).batches;for(let e=0;e<n.length;e++){const s=n[e];i.addToBatch(s,t)}}_getGpuDataForRenderable(e){return e._gpuData[this.renderer.uid]||this._initGpuDataForRenderable(e)}_initGpuDataForRenderable(e){const t=new h;return e._gpuData[this.renderer.uid]=t,t}_updateBatchesForRenderable(e,t){const i=e.context,n=this.renderer.graphicsContext.getGpuContext(i),s=this.renderer._roundPixels|e._roundPixels;t.batches=n.batches.map(t=>{const i=a.Z.get(l.G);return t.copyTo(i),i.renderable=e,i.roundPixels=s,i})}destroy(){this.renderer=null,this._adaptor.destroy(),this._adaptor=null,this.state=null}}u.extension={type:[n.Ag.WebGLPipes,n.Ag.WebGPUPipes,n.Ag.CanvasPipes],name:"graphics"},n.XO.add(u),n.XO.add(s.GH)},8036:(e,t,i)=>{"use strict";var n=i(8602);class s{execute(e,t){const i=e.state,n=e.renderer,s=t.shader||e.defaultShader;s.resources.uTexture=t.texture._source,s.resources.uniforms=e.localUniforms;const r=n.gl,a=e.getBuffers(t);n.shader.bind(s),n.state.set(i),n.geometry.bind(a.geometry,s.glProgram);const o=2===a.geometry.indexBuffer.data.BYTES_PER_ELEMENT?r.UNSIGNED_SHORT:r.UNSIGNED_INT;r.drawElements(r.TRIANGLES,6*t.particleChildren.length,o,0)}}var r=i(6680),a=i(9037),o=i(6820),l=i(4060),h=i(1965),u=i(5662),c=i(2409),d=i(5178),p=i(8605),f=i(4753);function g(e,t=null){const i=6*e;if(i>65535?t||(t=new Uint32Array(i)):t||(t=new Uint16Array(i)),t.length!==i)throw new Error(`Out buffer length is incorrect, got ${t.length} and expected ${i}`);for(let e=0,n=0;e<i;e+=6,n+=4)t[e+0]=n+0,t[e+1]=n+1,t[e+2]=n+2,t[e+3]=n+0,t[e+4]=n+2,t[e+5]=n+3;return t}function m(e,t){const i=[];i.push("\n\n        var index = 0;\n\n        for (let i = 0; i < ps.length; ++i)\n        {\n            const p = ps[i];\n\n            ");let n=0;for(const s in e){const r=e[s];if(t!==r.dynamic)continue;i.push(`offset = index + ${n}`),i.push(r.code);n+=(0,p.m)(r.format).stride/4}i.push("\n            index += stride * 4;\n        }\n    "),i.unshift(`\n        var stride = ${n};\n    `);const s=i.join("\n");return new Function("ps","f32v","u32v",s)}class _{constructor(e){this._size=0,this._generateParticleUpdateCache={};const t=this._size=e.size??1e3,i=e.properties;let n=0,s=0;for(const e in i){const t=i[e],r=(0,p.m)(t.format);t.dynamic?s+=r.stride:n+=r.stride}this._dynamicStride=s/4,this._staticStride=n/4,this.staticAttributeBuffer=new f.u(4*t*n),this.dynamicAttributeBuffer=new f.u(4*t*s),this.indexBuffer=g(t);const r=new d.V;let a=0,o=0;this._staticBuffer=new u.h({data:new Float32Array(1),label:"static-particle-buffer",shrinkToFit:!1,usage:c.S.VERTEX|c.S.COPY_DST}),this._dynamicBuffer=new u.h({data:new Float32Array(1),label:"dynamic-particle-buffer",shrinkToFit:!1,usage:c.S.VERTEX|c.S.COPY_DST});for(const e in i){const t=i[e],n=(0,p.m)(t.format);t.dynamic?(r.addAttribute(t.attributeName,{buffer:this._dynamicBuffer,stride:4*this._dynamicStride,offset:4*a,format:t.format}),a+=n.size):(r.addAttribute(t.attributeName,{buffer:this._staticBuffer,stride:4*this._staticStride,offset:4*o,format:t.format}),o+=n.size)}r.addIndex(this.indexBuffer);const l=this.getParticleUpdate(i);this._dynamicUpload=l.dynamicUpdate,this._staticUpload=l.staticUpdate,this.geometry=r}getParticleUpdate(e){const t=function(e){const t=[];for(const i in e){const n=e[i];t.push(i,n.code,n.dynamic?"d":"s")}return t.join("_")}(e);return this._generateParticleUpdateCache[t]||(this._generateParticleUpdateCache[t]=this.generateParticleUpdate(e)),this._generateParticleUpdateCache[t]}generateParticleUpdate(e){return function(e){return{dynamicUpdate:m(e,!0),staticUpdate:m(e,!1)}}(e)}update(e,t){e.length>this._size&&(t=!0,this._size=Math.max(e.length,1.5*this._size|0),this.staticAttributeBuffer=new f.u(this._size*this._staticStride*4*4),this.dynamicAttributeBuffer=new f.u(this._size*this._dynamicStride*4*4),this.indexBuffer=g(this._size),this.geometry.indexBuffer.setDataWithSize(this.indexBuffer,this.indexBuffer.byteLength,!0));const i=this.dynamicAttributeBuffer;if(this._dynamicUpload(e,i.float32View,i.uint32View),this._dynamicBuffer.setDataWithSize(this.dynamicAttributeBuffer.float32View,e.length*this._dynamicStride*4,!0),t){const t=this.staticAttributeBuffer;this._staticUpload(e,t.float32View,t.uint32View),this._staticBuffer.setDataWithSize(t.float32View,e.length*this._staticStride*4,!0)}}destroy(){this._staticBuffer.destroy(),this._dynamicBuffer.destroy(),this.geometry.destroy()}}var v=i(7747),y=i(3381),b=i(1980),x=i(9232),T=i(8192),S=i(1819),A="\nstruct ParticleUniforms {\n  uTranslationMatrix:mat3x3<f32>,\n  uColor:vec4<f32>,\n  uRound:f32,\n  uResolution:vec2<f32>,\n};\n\nfn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32>\n{\n  return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;\n}\n\n@group(0) @binding(0) var<uniform> uniforms: ParticleUniforms;\n\n@group(1) @binding(0) var uTexture: texture_2d<f32>;\n@group(1) @binding(1) var uSampler : sampler;\n\nstruct VSOutput {\n    @builtin(position) position: vec4<f32>,\n    @location(0) uv : vec2<f32>,\n    @location(1) color : vec4<f32>,\n  };\n@vertex\nfn mainVertex(\n  @location(0) aVertex: vec2<f32>,\n  @location(1) aPosition: vec2<f32>,\n  @location(2) aUV: vec2<f32>,\n  @location(3) aColor: vec4<f32>,\n  @location(4) aRotation: f32,\n) -> VSOutput {\n  \n   let v = vec2(\n       aVertex.x * cos(aRotation) - aVertex.y * sin(aRotation),\n       aVertex.x * sin(aRotation) + aVertex.y * cos(aRotation)\n   ) + aPosition;\n\n   var position = vec4((uniforms.uTranslationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n   if(uniforms.uRound == 1.0) {\n       position = vec4(roundPixels(position.xy, uniforms.uResolution), position.zw);\n   }\n\n    let vColor = vec4(aColor.rgb * aColor.a, aColor.a) * uniforms.uColor;\n\n  return VSOutput(\n   position,\n   aUV,\n   vColor,\n  );\n}\n\n@fragment\nfn mainFragment(\n  @location(0) uv: vec2<f32>,\n  @location(1) color: vec4<f32>,\n  @builtin(position) position: vec4<f32>,\n) -> @location(0) vec4<f32> {\n\n    var sample = textureSample(uTexture, uSampler, uv) * color;\n   \n    return sample;\n}";class E extends x.M{constructor(){super({glProgram:y.M.from({vertex:"attribute vec2 aVertex;\nattribute vec2 aUV;\nattribute vec4 aColor;\n\nattribute vec2 aPosition;\nattribute float aRotation;\n\nuniform mat3 uTranslationMatrix;\nuniform float uRound;\nuniform vec2 uResolution;\nuniform vec4 uColor;\n\nvarying vec2 vUV;\nvarying vec4 vColor;\n\nvec2 roundPixels(vec2 position, vec2 targetSize)\n{       \n    return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;\n}\n\nvoid main(void){\n    float cosRotation = cos(aRotation);\n    float sinRotation = sin(aRotation);\n    float x = aVertex.x * cosRotation - aVertex.y * sinRotation;\n    float y = aVertex.x * sinRotation + aVertex.y * cosRotation;\n\n    vec2 v = vec2(x, y);\n    v = v + aPosition;\n\n    gl_Position = vec4((uTranslationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    if(uRound == 1.0)\n    {\n        gl_Position.xy = roundPixels(gl_Position.xy, uResolution);\n    }\n\n    vUV = aUV;\n    vColor = vec4(aColor.rgb * aColor.a, aColor.a) * uColor;\n}\n",fragment:"varying vec2 vUV;\nvarying vec4 vColor;\n\nuniform sampler2D uTexture;\n\nvoid main(void){\n    vec4 color = texture2D(uTexture, vUV) * vColor;\n    gl_FragColor = color;\n}"}),gpuProgram:b.B.from({fragment:{source:A,entryPoint:"mainFragment"},vertex:{source:A,entryPoint:"mainVertex"}}),resources:{uTexture:T.g.WHITE.source,uSampler:new S.n({}),uniforms:{uTranslationMatrix:{value:new r.u,type:"mat3x3<f32>"},uColor:{value:new v.Q(16777215),type:"vec4<f32>"},uRound:{value:1,type:"f32"},uResolution:{value:[0,0],type:"vec2<f32>"}}}})}}class C{constructor(e,t){this.state=l.U.for2d(),this.localUniforms=new a.k({uTranslationMatrix:{value:new r.u,type:"mat3x3<f32>"},uColor:{value:new Float32Array(4),type:"vec4<f32>"},uRound:{value:1,type:"f32"},uResolution:{value:[0,0],type:"vec2<f32>"}}),this.renderer=e,this.adaptor=t,this.defaultShader=new E,this.state=l.U.for2d()}validateRenderable(e){return!1}addRenderable(e,t){this.renderer.renderPipes.batch.break(t),t.add(e)}getBuffers(e){return e._gpuData[this.renderer.uid]||this._initBuffer(e)}_initBuffer(e){return e._gpuData[this.renderer.uid]=new _({size:e.particleChildren.length,properties:e._properties}),e._gpuData[this.renderer.uid]}updateRenderable(e){}execute(e){const t=e.particleChildren;if(0===t.length)return;const i=this.renderer,n=this.getBuffers(e);e.texture||(e.texture=t[0].texture);const s=this.state;n.update(t,e._childrenDirty),e._childrenDirty=!1,s.blendMode=(0,o.i)(e.blendMode,e.texture._source);const r=this.localUniforms.uniforms,a=r.uTranslationMatrix;e.worldTransform.copyTo(a),a.prepend(i.globalUniforms.globalUniformData.projectionMatrix),r.uResolution=i.globalUniforms.globalUniformData.resolution,r.uRound=i._roundPixels|e._roundPixels,(0,h.V)(e.groupColorAlpha,r.uColor,0),this.adaptor.execute(this,e)}destroy(){this.renderer=null,this.defaultShader&&(this.defaultShader.destroy(),this.defaultShader=null)}}class w extends C{constructor(e){super(e,new s)}}w.extension={type:[n.Ag.WebGLPipes],name:"particle"};class P{execute(e,t){const i=e.renderer,n=t.shader||e.defaultShader;n.groups[0]=i.renderPipes.uniformBatch.getUniformBindGroup(e.localUniforms,!0),n.groups[1]=i.texture.getTextureBindGroup(t.texture);const s=e.state,r=e.getBuffers(t);i.encoder.draw({geometry:r.geometry,shader:t.shader||e.defaultShader,state:s,size:6*t.particleChildren.length})}}class I extends C{constructor(e){super(e,new P)}}I.extension={type:[n.Ag.WebGPUPipes],name:"particle"},n.XO.add(w),n.XO.add(I)},8079:(e,t,i)=>{"use strict";i.d(t,{U:()=>n});class n{constructor(){this.batcherName="default",this.packAsQuad=!1,this.indexOffset=0,this.attributeOffset=0,this.roundPixels=0,this._batcher=null,this._batch=null,this._textureMatrixUpdateId=-1,this._uvUpdateId=-1}get blendMode(){return this.renderable.groupBlendMode}get topology(){return this._topology||this.geometry.topology}set topology(e){this._topology=e}reset(){this.renderable=null,this.texture=null,this._batcher=null,this._batch=null,this.geometry=null,this._uvUpdateId=-1,this._textureMatrixUpdateId=-1}setTexture(e){this.texture!==e&&(this.texture=e,this._textureMatrixUpdateId=-1)}get uvs(){const e=this.geometry.getBuffer("aUV"),t=e.data;let i=t;const n=this.texture.textureMatrix;return n.isSimple||(i=this._transformedUvs,this._textureMatrixUpdateId===n._updateID&&this._uvUpdateId===e._updateID||((!i||i.length<t.length)&&(i=this._transformedUvs=new Float32Array(t.length)),this._textureMatrixUpdateId=n._updateID,this._uvUpdateId=e._updateID,n.multiplyUvs(t,i))),i}get positions(){return this.geometry.positions}get indices(){return this.geometry.indices}get color(){return this.renderable.groupColorAlpha}get groupTransform(){return this.renderable.groupTransform}get attributeSize(){return this.geometry.positions.length/2}get indexSize(){return this.geometry.indices.length}}},8117:(e,t,i)=>{"use strict";i.d(t,{u:()=>r});const n=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function s(e){let t="";for(let i=0;i<e;++i)i>0&&(t+="\nelse "),i<e-1&&(t+=`if(test == ${i}.0){}`);return t}function r(e,t){if(0===e)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const i=t.createShader(t.FRAGMENT_SHADER);try{for(;;){const r=n.replace(/%forloop%/gi,s(e));if(t.shaderSource(i,r),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS))break;e=e/2|0}}finally{t.deleteShader(i)}return e}},8132:(e,t,i)=>{"use strict";i.d(t,{r:()=>r});var n=i(878);let s;function r(e,t,i,r){r||(r=s||(s=new n.p));const{domElement:a,styleElement:o,svgRoot:l}=r;a.innerHTML=`<style>${t.cssStyle};</style><div style='padding:0'>${e}</div>`,a.setAttribute("style","transform-origin: top left; display: inline-block"),i&&(o.textContent=i),document.body.appendChild(l);const h=a.getBoundingClientRect();l.remove();const u=2*t.padding;return{width:h.width-u,height:h.height-u}}},8133:e=>{e.exports=function(e){var s=[];return e.replace(i,function(e,i,r){var a=i.toLowerCase();for(r=function(e){var t=e.match(n);return t?t.map(Number):[]}(r),"m"==a&&r.length>2&&(s.push([i].concat(r.splice(0,2))),a="l",i="m"==i?"l":"L");;){if(r.length==t[a])return r.unshift(i),s.push(r);if(r.length<t[a])throw new Error("malformed path data");s.push([i].concat(r.splice(0,t[a])))}}),s};var t={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},i=/([astvzqmhlc])([^astvzqmhlc]*)/gi;var n=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi},8179:(e,t,i)=>{"use strict";i.d(t,{N:()=>r});var n=i(6680);const s=new n.u;class r{constructor(e,t){this.mapCoord=new n.u,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=void 0===t?e.width<10?0:.5:t,this.isSimple=!1,this.texture=e}get texture(){return this._texture}set texture(e){this.texture!==e&&(this._texture?.removeListener("update",this.update,this),this._texture=e,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(e,t){void 0===t&&(t=e);const i=this.mapCoord;for(let n=0;n<e.length;n+=2){const s=e[n],r=e[n+1];t[n]=s*i.a+r*i.c+i.tx,t[n+1]=s*i.b+r*i.d+i.ty}return t}update(){const e=this._texture;this._updateID++;const t=e.uvs;this.mapCoord.set(t.x1-t.x0,t.y1-t.y0,t.x3-t.x0,t.y3-t.y0,t.x0,t.y0);const i=e.orig,n=e.trim;n&&(s.set(i.width/n.width,0,0,i.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(s));const r=e.source,a=this.uClampFrame,o=this.clampMargin/r._resolution,l=this.clampOffset/r._resolution;return a[0]=(e.frame.x+o+l)/r.width,a[1]=(e.frame.y+o+l)/r.height,a[2]=(e.frame.x+e.frame.width-o+l)/r.width,a[3]=(e.frame.y+e.frame.height-o+l)/r.height,this.uClampOffset[0]=this.clampOffset/r.pixelWidth,this.uClampOffset[1]=this.clampOffset/r.pixelHeight,this.isSimple=e.frame.width===r.width&&e.frame.height===r.height&&0===e.rotate,!0}}},8192:(e,t,i)=>{"use strict";i.d(t,{g:()=>d});var n=i(2551),s=i(6208),r=i(2207),a=i(198),o=i(4303);const l=()=>{};var h=i(7328),u=i(5884),c=i(8179);class d extends n.A{constructor({source:e,label:t,frame:i,orig:n,trim:s,defaultAnchor:o,defaultBorders:l,rotate:h,dynamic:c}={}){if(super(),this.uid=(0,a.L)("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new r.M,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=t,this.source=e?.source??new u.v,this.noFrame=!i,i)this.frame.copyFrom(i);else{const{width:e,height:t}=this._source;this.frame.width=e,this.frame.height=t}this.orig=n||this.frame,this.trim=s,this.rotate=h??0,this.defaultAnchor=o,this.defaultBorders=l,this.destroyed=!1,this.dynamic=c||!1,this.updateUvs()}set source(e){this._source&&this._source.off("resize",this.update,this),this._source=e,e.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new c.N(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:e,frame:t}=this,{width:i,height:n}=this._source,r=t.x/i,a=t.y/n,o=t.width/i,l=t.height/n;let h=this.rotate;if(h){const t=o/2,i=l/2,n=r+t,u=a+i;h=s.E.add(h,s.E.NW),e.x0=n+t*s.E.uX(h),e.y0=u+i*s.E.uY(h),h=s.E.add(h,2),e.x1=n+t*s.E.uX(h),e.y1=u+i*s.E.uY(h),h=s.E.add(h,2),e.x2=n+t*s.E.uX(h),e.y2=u+i*s.E.uY(h),h=s.E.add(h,2),e.x3=n+t*s.E.uX(h),e.y3=u+i*s.E.uY(h)}else e.x0=r,e.y0=a,e.x1=r+o,e.y1=a,e.x2=r+o,e.y2=a+l,e.x3=r,e.y3=a+l}destroy(e=!1){this._source&&e&&(this._source.destroy(),this._source=null),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return(0,o.t6)(o.lj,"Texture.baseTexture is now Texture.source"),this._source}}d.EMPTY=new d({label:"EMPTY",source:new u.v({label:"EMPTY"})}),d.EMPTY.destroy=l,d.WHITE=new d({source:new h.P({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"}),d.WHITE.destroy=l},8390:(e,t,i)=>{"use strict";i.d(t,{b:()=>r});var n=i(8602),s=i(5884);class r extends s.v{constructor(e){super(e),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(e){return globalThis.HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap||globalThis.VideoFrame&&e instanceof VideoFrame}}r.extension=n.Ag.TextureSource},8457:(e,t,i)=>{"use strict";i.d(t,{_:()=>p});var n=i(7747),s=i(5553),r=i(6680),a=i(8390),o=i(8192),l=i(198),h=i(4303),u=i(7893);const c=[{offset:0,color:"white"},{offset:1,color:"black"}],d=class e{constructor(...t){this.uid=(0,l.L)("fillGradient"),this._tick=0,this.type="linear",this.colorStops=[];let i=function(e){let t=e[0]??{};("number"==typeof t||e[1])&&((0,h.t6)("8.5.2","use options object instead"),t={type:"linear",start:{x:e[0],y:e[1]},end:{x:e[2],y:e[3]},textureSpace:e[4],textureSize:e[5]??p.defaultLinearOptions.textureSize});return t}(t);i={..."radial"===i.type?e.defaultRadialOptions:e.defaultLinearOptions,...(0,u.S)(i)},this._textureSize=i.textureSize,this._wrapMode=i.wrapMode,"radial"===i.type?(this.center=i.center,this.outerCenter=i.outerCenter??this.center,this.innerRadius=i.innerRadius,this.outerRadius=i.outerRadius,this.scale=i.scale,this.rotation=i.rotation):(this.start=i.start,this.end=i.end),this.textureSpace=i.textureSpace,this.type=i.type,i.colorStops.forEach(e=>{this.addColorStop(e.offset,e.color)})}addColorStop(e,t){return this.colorStops.push({offset:e,color:n.Q.shared.setValue(t).toHexa()}),this}buildLinearGradient(){if(this.texture)return;let{x:e,y:t}=this.start,{x:i,y:n}=this.end,s=i-e,l=n-t;const h=s<0||l<0;if("clamp-to-edge"===this._wrapMode){if(s<0){const t=e;e=i,i=t,s*=-1}if(l<0){const e=t;t=n,n=e,l*=-1}}const u=this.colorStops.length?this.colorStops:c,d=this._textureSize,{canvas:p,context:m}=g(d,1),_=h?m.createLinearGradient(this._textureSize,0,0,0):m.createLinearGradient(0,0,this._textureSize,0);f(_,u),m.fillStyle=_,m.fillRect(0,0,d,1),this.texture=new o.g({source:new a.b({resource:p,addressMode:this._wrapMode})});const v=Math.sqrt(s*s+l*l),y=Math.atan2(l,s),b=new r.u;b.scale(v/d,1),b.rotate(y),b.translate(e,t),"local"===this.textureSpace&&b.scale(d,d),this.transform=b}buildGradient(){this.texture||this._tick++,"linear"===this.type?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const e=this.colorStops.length?this.colorStops:c,t=this._textureSize,{canvas:i,context:n}=g(t,t),{x:s,y:l}=this.center,{x:h,y:u}=this.outerCenter,d=this.innerRadius,p=this.outerRadius,m=h-p,_=u-p,v=t/(2*p),y=(s-m)*v,b=(l-_)*v,x=n.createRadialGradient(y,b,d*v,(h-m)*v,(u-_)*v,p*v);f(x,e),n.fillStyle=e[e.length-1].color,n.fillRect(0,0,t,t),n.fillStyle=x,n.translate(y,b),n.rotate(this.rotation),n.scale(1,this.scale),n.translate(-y,-b),n.fillRect(0,0,t,t),this.texture=new o.g({source:new a.b({resource:i,addressMode:this._wrapMode})});const T=new r.u;T.scale(1/v,1/v),T.translate(m,_),"local"===this.textureSpace&&T.scale(t,t),this.transform=T}destroy(){this.texture?.destroy(!0),this.texture=null,this.transform=null,this.colorStops=[],this.start=null,this.end=null,this.center=null,this.outerCenter=null}get styleKey(){return`fill-gradient-${this.uid}-${this._tick}`}};d.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256,wrapMode:"clamp-to-edge"},d.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256,wrapMode:"clamp-to-edge"};let p=d;function f(e,t){for(let i=0;i<t.length;i++){const n=t[i];e.addColorStop(n.offset,n.color)}}function g(e,t){const i=s.e.get().createCanvas(e,t),n=i.getContext("2d");return{canvas:i,context:n}}},8514:(e,t,i)=>{"use strict";var n=i(8602);class s{static init(e){Object.defineProperty(this,"resizeTo",{set(e){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this._cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this._cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;let e,t;if(this._cancelResize(),this._resizeTo===globalThis.window)e=globalThis.innerWidth,t=globalThis.innerHeight;else{const{clientWidth:i,clientHeight:n}=this._resizeTo;e=i,t=n}this.renderer.resize(e,t),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this._cancelResize(),this._cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}s.extension=n.Ag.Application;var r=i(3377),a=i(379);class o{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,r.d.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?a.R.shared:new a.R,e.autoStart&&this.start()}static destroy(){if(this._ticker){const e=this._ticker;this.ticker=null,e.destroy()}}}o.extension=n.Ag.Application,n.XO.add(s),n.XO.add(o)},8593:(e,t,i)=>{"use strict";i.d(t,{P:()=>l});var n=i(5957),s=i(5553),r=i(4588);const a={willReadFrequently:!0},o=class e{static get experimentalLetterSpacingSupported(){let t=e._experimentalLetterSpacingSupported;if(void 0===t){const i=s.e.get().getCanvasRenderingContext2D().prototype;t=e._experimentalLetterSpacingSupported="letterSpacing"in i||"textLetterSpacing"in i}return t}constructor(e,t,i,n,s,r,a,o,l){this.text=e,this.style=t,this.width=i,this.height=n,this.lines=s,this.lineWidths=r,this.lineHeight=a,this.maxLineWidth=o,this.fontProperties=l}static measureText(t=" ",i,n=e._canvas,s=i.wordWrap){const a=`${t}-${i.styleKey}-wordWrap-${s}`;if(e._measurementCache.has(a))return e._measurementCache.get(a);const o=(0,r.Z)(i),l=e.measureFont(o);0===l.fontSize&&(l.fontSize=i.fontSize,l.ascent=i.fontSize);const h=e.__context;h.font=o;const u=(s?e._wordWrap(t,i,n):t).split(/(?:\r\n|\r|\n)/),c=new Array(u.length);let d=0;for(let t=0;t<u.length;t++){const n=e._measureText(u[t],i.letterSpacing,h);c[t]=n,d=Math.max(d,n)}const p=i._stroke?.width||0;let f=d+p;i.dropShadow&&(f+=i.dropShadow.distance);const g=i.lineHeight||l.fontSize;let m=Math.max(g,l.fontSize+p)+(u.length-1)*(g+i.leading);i.dropShadow&&(m+=i.dropShadow.distance);const _=new e(t,i,f,m,u,c,g+i.leading,d,l);return e._measurementCache.set(a,_),_}static _measureText(t,i,n){let s=!1;e.experimentalLetterSpacingSupported&&(e.experimentalLetterSpacing?(n.letterSpacing=`${i}px`,n.textLetterSpacing=`${i}px`,s=!0):(n.letterSpacing="0px",n.textLetterSpacing="0px"));const r=n.measureText(t);let a=r.width;const o=-r.actualBoundingBoxLeft;let l=r.actualBoundingBoxRight-o;if(a>0)if(s)a-=i,l-=i;else{const n=(e.graphemeSegmenter(t).length-1)*i;a+=n,l+=n}return Math.max(a,l)}static _wordWrap(t,i,n=e._canvas){const s=n.getContext("2d",a);let r=0,o="",l="";const h=Object.create(null),{letterSpacing:u,whiteSpace:c}=i,d=e._collapseSpaces(c),p=e._collapseNewlines(c);let f=!d;const g=i.wordWrapWidth+u,m=e._tokenize(t);for(let t=0;t<m.length;t++){let n=m[t];if(e._isNewline(n)){if(!p){l+=e._addLine(o),f=!d,o="",r=0;continue}n=" "}if(d){const t=e.isBreakingSpace(n),i=e.isBreakingSpace(o[o.length-1]);if(t&&i)continue}const a=e._getFromCache(n,u,h,s);if(a>g)if(""!==o&&(l+=e._addLine(o),o="",r=0),e.canBreakWords(n,i.breakWords)){const t=e.wordWrapSplit(n);for(let a=0;a<t.length;a++){let c=t[a],d=c,p=1;for(;t[a+p];){const s=t[a+p];if(e.canBreakChars(d,s,n,a,i.breakWords))break;c+=s,d=s,p++}a+=p-1;const m=e._getFromCache(c,u,h,s);m+r>g&&(l+=e._addLine(o),f=!1,o="",r=0),o+=c,r+=m}}else{o.length>0&&(l+=e._addLine(o),o="",r=0);const i=t===m.length-1;l+=e._addLine(n,!i),f=!1,o="",r=0}else a+r>g&&(f=!1,l+=e._addLine(o),o="",r=0),(o.length>0||!e.isBreakingSpace(n)||f)&&(o+=n,r+=a)}return l+=e._addLine(o,!1),l}static _addLine(t,i=!0){return t=e._trimRight(t),t=i?`${t}\n`:t}static _getFromCache(t,i,n,s){let r=n[t];return"number"!=typeof r&&(r=e._measureText(t,i,s)+i,n[t]=r),r}static _collapseSpaces(e){return"normal"===e||"pre-line"===e}static _collapseNewlines(e){return"normal"===e}static _trimRight(t){if("string"!=typeof t)return"";for(let i=t.length-1;i>=0;i--){const n=t[i];if(!e.isBreakingSpace(n))break;t=t.slice(0,-1)}return t}static _isNewline(t){return"string"==typeof t&&e._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,i){return"string"==typeof t&&e._breakingSpaces.includes(t.charCodeAt(0))}static _tokenize(t){const i=[];let n="";if("string"!=typeof t)return i;for(let s=0;s<t.length;s++){const r=t[s],a=t[s+1];e.isBreakingSpace(r,a)||e._isNewline(r)?(""!==n&&(i.push(n),n=""),"\r"===r&&"\n"===a?(i.push("\r\n"),s++):i.push(r)):n+=r}return""!==n&&i.push(n),i}static canBreakWords(e,t){return t}static canBreakChars(e,t,i,n,s){return!0}static wordWrapSplit(t){return e.graphemeSegmenter(t)}static measureFont(t){if(e._fonts[t])return e._fonts[t];const i=e._context;i.font=t;const n=i.measureText(e.METRICS_STRING+e.BASELINE_SYMBOL),s={ascent:n.actualBoundingBoxAscent,descent:n.actualBoundingBoxDescent,fontSize:n.actualBoundingBoxAscent+n.actualBoundingBoxDescent};return e._fonts[t]=s,s}static clearMetrics(t=""){t?delete e._fonts[t]:e._fonts={}}static get _canvas(){if(!e.__canvas){let t;try{const i=new OffscreenCanvas(0,0),n=i.getContext("2d",a);if(n?.measureText)return e.__canvas=i,i;t=s.e.get().createCanvas()}catch(e){t=s.e.get().createCanvas()}t.width=t.height=10,e.__canvas=t}return e.__canvas}static get _context(){return e.__context||(e.__context=e._canvas.getContext("2d",a)),e.__context}};o.METRICS_STRING="|q",o.BASELINE_SYMBOL="M",o.BASELINE_MULTIPLIER=1.4,o.HEIGHT_MULTIPLIER=2,o.graphemeSegmenter=(()=>{if("function"==typeof Intl?.Segmenter){const e=new Intl.Segmenter;return t=>{const i=e.segment(t),n=[];let s=0;for(const e of i)n[s++]=e.segment;return n}}return e=>[...e]})(),o.experimentalLetterSpacing=!1,o._fonts={},o._newlines=[10,13],o._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288],o._measurementCache=(0,n.g)(1e3);let l=o},8594:(e,t,i)=>{"use strict";var n=i(8602),s=i(5337),r=i(3289),a=i(6456);const o=new r.c;function l(e,t,i){const n=o;e.measurable=!0,(0,a.f)(e,i,n),t.addBoundsMask(n),e.measurable=!1}var h=i(2276),u=i(1675),c=i(9731);function d(e,t,i){const n=u.o.get();e.measurable=!0;const s=u.u.get().identity(),r=p(e,i,s);(0,h.n)(e,n,r),e.measurable=!1,t.addBoundsMask(n),u.u.return(s),u.o.return(n)}function p(e,t,i){return e?(e!==t&&(p(e.parent,t,i),e.updateLocalTransform(),i.append(e.localTransform)),i):((0,c.R)("Mask bounds, renderable is not inside the root container"),i)}class f{constructor(e){this.priority=0,this.inverse=!1,this.pipe="alphaMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e,this.renderMaskToTexture=!(e instanceof s.k),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask=null}addBounds(e,t){this.inverse||l(this.mask,e,t)}addLocalBounds(e,t){d(this.mask,e,t)}containsPoint(e,t){return t(this.mask,e)}destroy(){this.reset()}static test(e){return e instanceof s.k}}f.extension=n.Ag.MaskEffect;class g{constructor(e){this.priority=0,this.pipe="colorMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e}destroy(){}static test(e){return"number"==typeof e}}g.extension=n.Ag.MaskEffect;var m=i(3079);class _{constructor(e){this.priority=0,this.pipe="stencilMask",e?.mask&&this.init(e.mask)}init(e){this.mask=e,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null}addBounds(e,t){l(this.mask,e,t)}addLocalBounds(e,t){d(this.mask,e,t)}containsPoint(e,t){return t(this.mask,e)}destroy(){this.reset()}static test(e){return e instanceof m.mc}}_.extension=n.Ag.MaskEffect;var v=i(7328),y=i(7797),b=i(8390),x=i(9764);i(3630);n.XO.add(f,g,_,x.$,b.b,y.q,v.P)},8602:(e,t,i)=>{"use strict";i.d(t,{Ag:()=>n,XO:()=>a});var n=(e=>(e.Application="application",e.WebGLPipes="webgl-pipes",e.WebGLPipesAdaptor="webgl-pipes-adaptor",e.WebGLSystem="webgl-system",e.WebGPUPipes="webgpu-pipes",e.WebGPUPipesAdaptor="webgpu-pipes-adaptor",e.WebGPUSystem="webgpu-system",e.CanvasSystem="canvas-system",e.CanvasPipesAdaptor="canvas-pipes-adaptor",e.CanvasPipes="canvas-pipes",e.Asset="asset",e.LoadParser="load-parser",e.ResolveParser="resolve-parser",e.CacheParser="cache-parser",e.DetectionParser="detection-parser",e.MaskEffect="mask-effect",e.BlendMode="blend-mode",e.TextureSource="texture-source",e.Environment="environment",e.ShapeBuilder="shape-builder",e.Batcher="batcher",e))(n||{});const s=e=>{if("function"==typeof e||"object"==typeof e&&e.extension){if(!e.extension)throw new Error("Extension class must have an extension object");e={..."object"!=typeof e.extension?{type:e.extension}:e.extension,ref:e}}if("object"!=typeof e)throw new Error("Invalid extension type");return"string"==typeof(e={...e}).type&&(e.type=[e.type]),e},r=(e,t)=>s(e).priority??t,a={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...e){return e.map(s).forEach(e=>{e.type.forEach(t=>this._removeHandlers[t]?.(e))}),this},add(...e){return e.map(s).forEach(e=>{e.type.forEach(t=>{const i=this._addHandlers,n=this._queue;i[t]?i[t]?.(e):(n[t]=n[t]||[],n[t]?.push(e))})}),this},handle(e,t,i){const n=this._addHandlers,s=this._removeHandlers;if(n[e]||s[e])throw new Error(`Extension type ${e} already has a handler`);n[e]=t,s[e]=i;const r=this._queue;return r[e]&&(r[e]?.forEach(e=>t(e)),delete r[e]),this},handleByMap(e,t){return this.handle(e,e=>{e.name&&(t[e.name]=e.ref)},e=>{e.name&&delete t[e.name]})},handleByNamedList(e,t,i=-1){return this.handle(e,e=>{t.findIndex(t=>t.name===e.name)>=0||(t.push({name:e.name,value:e.ref}),t.sort((e,t)=>r(t.value,i)-r(e.value,i)))},e=>{const i=t.findIndex(t=>t.name===e.name);-1!==i&&t.splice(i,1)})},handleByList(e,t,i=-1){return this.handle(e,e=>{t.includes(e.ref)||(t.push(e.ref),t.sort((e,t)=>r(t,i)-r(e,i)))},e=>{const i=t.indexOf(e.ref);-1!==i&&t.splice(i,1)})},mixin(e,...t){for(const i of t)Object.defineProperties(e.prototype,Object.getOwnPropertyDescriptors(i))}}},8605:(e,t,i)=>{"use strict";i.d(t,{m:()=>s});const n={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function s(e){return n[e]??n.float32}},8645:(e,t,i)=>{"use strict";i.r(t);i(8514),i(4767),i(8594),i(8002),i(7757),i(8036),i(1947),i(7732),i(997),i(8991),i(6209),i(7171)},8648:(e,t,i)=>{"use strict";i.d(t,{O:()=>o});var n=i(198),s=i(5884),r=i(8192);const a=class e{constructor(t={}){if(this.uid=(0,n.L)("renderTarget"),this.colorTextures=[],this.dirtyId=0,this.isRoot=!1,this._size=new Float32Array(2),this._managedColorTextures=!1,t={...e.defaultOptions,...t},this.stencil=t.stencil,this.depth=t.depth,this.isRoot=t.isRoot,"number"==typeof t.colorTextures){this._managedColorTextures=!0;for(let e=0;e<t.colorTextures;e++)this.colorTextures.push(new s.v({width:t.width,height:t.height,resolution:t.resolution,antialias:t.antialias}))}else{this.colorTextures=[...t.colorTextures.map(e=>e.source)];const e=this.colorTexture.source;this.resize(e.width,e.height,e._resolution)}this.colorTexture.source.on("resize",this.onSourceResize,this),(t.depthStencilTexture||this.stencil)&&(t.depthStencilTexture instanceof r.g||t.depthStencilTexture instanceof s.v?this.depthStencilTexture=t.depthStencilTexture.source:this.ensureDepthStencilTexture())}get size(){const e=this._size;return e[0]=this.pixelWidth,e[1]=this.pixelHeight,e}get width(){return this.colorTexture.source.width}get height(){return this.colorTexture.source.height}get pixelWidth(){return this.colorTexture.source.pixelWidth}get pixelHeight(){return this.colorTexture.source.pixelHeight}get resolution(){return this.colorTexture.source._resolution}get colorTexture(){return this.colorTextures[0]}onSourceResize(e){this.resize(e.width,e.height,e._resolution,!0)}ensureDepthStencilTexture(){this.depthStencilTexture||(this.depthStencilTexture=new s.v({width:this.width,height:this.height,resolution:this.resolution,format:"depth24plus-stencil8",autoGenerateMipmaps:!1,antialias:!1,mipLevelCount:1}))}resize(e,t,i=this.resolution,n=!1){this.dirtyId++,this.colorTextures.forEach((s,r)=>{n&&0===r||s.source.resize(e,t,i)}),this.depthStencilTexture&&this.depthStencilTexture.source.resize(e,t,i)}destroy(){this.colorTexture.source.off("resize",this.onSourceResize,this),this._managedColorTextures&&this.colorTextures.forEach(e=>{e.destroy()}),this.depthStencilTexture&&(this.depthStencilTexture.destroy(),delete this.depthStencilTexture)}};a.defaultOptions={width:0,height:0,resolution:1,colorTextures:1,stencil:!1,depth:!1,antialias:!1,isRoot:!1};let o=a},8741:(e,t,i)=>{"use strict";i.d(t,{J:()=>G});var n=i(8602),s=i(198),r=i(4753),a=i(4303),o=i(9298),l=i(9803),h=i(6820),u=i(7467),c=i(8117);let d=null;class p{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let e=0;e<this.count;e++){const t=this.textures[e];this.textures[e]=null,this.ids[t.uid]=null}this.count=0}}class f{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new p,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const g=[];let m=0;function _(){return m>0?g[--m]:new f}function v(e){g[m++]=e}o.L.register({clear:()=>{if(g.length>0)for(const e of g)e&&e.destroy();g.length=0,m=0}});let y=0;const b=class e{constructor(t){this.uid=(0,s.L)("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],(t={...e.defaultOptions,...t}).maxTextures||((0,a.t6)("v8.8.0","maxTextures is a required option for Batcher now, please pass it in the options"),t.maxTextures=function(){if(d)return d;const e=(0,u.W)();return d=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),d=(0,c.u)(d,e),e.getExtension("WEBGL_lose_context")?.loseContext(),d}());const{maxTextures:i,attributesInitialSize:n,indicesInitialSize:o}=t;this.attributeBuffer=new r.u(4*n),this.indexBuffer=new Uint16Array(o),this.maxTextures=i}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let e=0;e<this.batchIndex;e++)v(this.batches[e]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(e){this._elements[this.elementSize++]=e,e._indexStart=this.indexSize,e._attributeStart=this.attributeSize,e._batcher=this,this.indexSize+=e.indexSize,this.attributeSize+=e.attributeSize*this.vertexSize}checkAndUpdateTexture(e,t){const i=e._batch.textures.ids[t._source.uid];return!(!i&&0!==i)&&(e._textureId=i,e.texture=t,!0)}updateElement(e){this.dirty=!0;const t=this.attributeBuffer;e.packAsQuad?this.packQuadAttributes(e,t.float32View,t.uint32View,e._attributeStart,e._textureId):this.packAttributes(e,t.float32View,t.uint32View,e._attributeStart,e._textureId)}break(e){const t=this._elements;if(!t[this.elementStart])return;let i=_(),n=i.textures;n.clear();const s=t[this.elementStart];let r=(0,h.i)(s.blendMode,s.texture._source),a=s.topology;4*this.attributeSize>this.attributeBuffer.size&&this._resizeAttributeBuffer(4*this.attributeSize),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const o=this.attributeBuffer.float32View,l=this.attributeBuffer.uint32View,u=this.indexBuffer;let c=this._batchIndexSize,d=this._batchIndexStart,p="startBatch";const f=this.maxTextures;for(let s=this.elementStart;s<this.elementSize;++s){const g=t[s];t[s]=null;const m=g.texture._source,v=(0,h.i)(g.blendMode,m),b=r!==v||a!==g.topology;m._batchTick!==y||b?(m._batchTick=y,(n.count>=f||b)&&(this._finishBatch(i,d,c-d,n,r,a,e,p),p="renderBatch",d=c,r=v,a=g.topology,i=_(),n=i.textures,n.clear(),++y),g._textureId=m._textureBindLocation=n.count,n.ids[m.uid]=n.count,n.textures[n.count++]=m,g._batch=i,c+=g.indexSize,g.packAsQuad?(this.packQuadAttributes(g,o,l,g._attributeStart,g._textureId),this.packQuadIndex(u,g._indexStart,g._attributeStart/this.vertexSize)):(this.packAttributes(g,o,l,g._attributeStart,g._textureId),this.packIndex(g,u,g._indexStart,g._attributeStart/this.vertexSize))):(g._textureId=m._textureBindLocation,c+=g.indexSize,g.packAsQuad?(this.packQuadAttributes(g,o,l,g._attributeStart,g._textureId),this.packQuadIndex(u,g._indexStart,g._attributeStart/this.vertexSize)):(this.packAttributes(g,o,l,g._attributeStart,g._textureId),this.packIndex(g,u,g._indexStart,g._attributeStart/this.vertexSize)),g._batch=i)}n.count>0&&(this._finishBatch(i,d,c-d,n,r,a,e,p),d=c,++y),this.elementStart=this.elementSize,this._batchIndexStart=d,this._batchIndexSize=c}_finishBatch(e,t,i,n,s,r,a,o){e.gpuBindGroup=null,e.bindGroup=null,e.action=o,e.batcher=this,e.textures=n,e.blendMode=s,e.topology=r,e.start=t,e.size=i,++y,this.batches[this.batchIndex++]=e,a.add(e)}finish(e){this.break(e)}ensureAttributeBuffer(e){4*e<=this.attributeBuffer.size||this._resizeAttributeBuffer(4*e)}ensureIndexBuffer(e){e<=this.indexBuffer.length||this._resizeIndexBuffer(e)}_resizeAttributeBuffer(e){const t=Math.max(e,2*this.attributeBuffer.size),i=new r.u(t);(0,l.W)(this.attributeBuffer.rawBinaryData,i.rawBinaryData),this.attributeBuffer=i}_resizeIndexBuffer(e){const t=this.indexBuffer;let i=Math.max(e,1.5*t.length);i+=i%2;const n=i>65535?new Uint32Array(i):new Uint16Array(i);if(n.BYTES_PER_ELEMENT!==t.BYTES_PER_ELEMENT)for(let e=0;e<t.length;e++)n[e]=t[e];else(0,l.W)(t.buffer,n.buffer);this.indexBuffer=n}packQuadIndex(e,t,i){e[t]=i+0,e[t+1]=i+1,e[t+2]=i+2,e[t+3]=i+0,e[t+4]=i+2,e[t+5]=i+3}packIndex(e,t,i,n){const s=e.indices,r=e.indexSize,a=e.indexOffset,o=e.attributeOffset;for(let e=0;e<r;e++)t[i++]=n+s[e+a]-o}destroy(){if(null!==this.batches){for(let e=0;e<this.batches.length;e++)v(this.batches[e]);this.batches=null;for(let e=0;e<this._elements.length;e++)this._elements[e]&&(this._elements[e]._batch=null);this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}}};b.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let x=b;var T=i(5662),S=i(2409),A=i(5178);const E=new Float32Array(1),C=new Uint32Array(1);class w extends A.V{constructor(){const e=new T.h({data:E,label:"attribute-batch-buffer",usage:S.S.VERTEX|S.S.COPY_DST,shrinkToFit:!1});super({attributes:{aPosition:{buffer:e,format:"float32x2",stride:24,offset:0},aUV:{buffer:e,format:"float32x2",stride:24,offset:8},aColor:{buffer:e,format:"unorm8x4",stride:24,offset:16},aTextureIdAndRound:{buffer:e,format:"uint16x2",stride:24,offset:20}},indexBuffer:new T.h({data:C,label:"index-batch-buffer",usage:S.S.INDEX|S.S.COPY_DST,shrinkToFit:!1})})}}var P=i(6566),I=i(9140),M=i(2581),R=i(358),L=i(6479),k=i(9232);class D extends k.M{constructor(e){super({glProgram:(0,P.I)({name:"batch",bits:[I.a,(0,M.P)(e),R.m]}),gpuProgram:(0,P.v)({name:"batch",bits:[I.F,(0,M._)(e),R.b]}),resources:{batchSamplers:(0,L.n)(e)}})}}let O=null;const B=class e extends x{constructor(t){super(t),this.geometry=new w,this.name=e.extension.name,this.vertexSize=6,O??(O=new D(t.maxTextures)),this.shader=O}packAttributes(e,t,i,n,s){const r=s<<16|65535&e.roundPixels,a=e.transform,o=a.a,l=a.b,h=a.c,u=a.d,c=a.tx,d=a.ty,{positions:p,uvs:f}=e,g=e.color,m=e.attributeOffset,_=m+e.attributeSize;for(let e=m;e<_;e++){const s=2*e,a=p[s],m=p[s+1];t[n++]=o*a+h*m+c,t[n++]=u*m+l*a+d,t[n++]=f[s],t[n++]=f[s+1],i[n++]=g,i[n++]=r}}packQuadAttributes(e,t,i,n,s){const r=e.texture,a=e.transform,o=a.a,l=a.b,h=a.c,u=a.d,c=a.tx,d=a.ty,p=e.bounds,f=p.maxX,g=p.minX,m=p.maxY,_=p.minY,v=r.uvs,y=e.color,b=s<<16|65535&e.roundPixels;t[n+0]=o*g+h*_+c,t[n+1]=u*_+l*g+d,t[n+2]=v.x0,t[n+3]=v.y0,i[n+4]=y,i[n+5]=b,t[n+6]=o*f+h*_+c,t[n+7]=u*_+l*f+d,t[n+8]=v.x1,t[n+9]=v.y1,i[n+10]=y,i[n+11]=b,t[n+12]=o*f+h*m+c,t[n+13]=u*m+l*f+d,t[n+14]=v.x2,t[n+15]=v.y2,i[n+16]=y,i[n+17]=b,t[n+18]=o*g+h*m+c,t[n+19]=u*m+l*g+d,t[n+20]=v.x3,t[n+21]=v.y3,i[n+22]=y,i[n+23]=b}};B.extension={type:[n.Ag.Batcher],name:"default"};let G=B},8991:(e,t,i)=>{"use strict";var n=i(8602),s=i(6820),r=i(4060),a=i(9998),o=i(1965),l=i(8079),h=i(1047),u=i(6680),c=i(6566),d=i(9922),p=i(358),f=i(9232),g=i(9037),m=i(8192);const _={name:"tiling-bit",vertex:{header:"\n            struct TilingUniforms {\n                uMapCoord:mat3x3<f32>,\n                uClampFrame:vec4<f32>,\n                uClampOffset:vec2<f32>,\n                uTextureTransform:mat3x3<f32>,\n                uSizeAnchor:vec4<f32>\n            };\n\n            @group(2) @binding(0) var<uniform> tilingUniforms: TilingUniforms;\n            @group(2) @binding(1) var uTexture: texture_2d<f32>;\n            @group(2) @binding(2) var uSampler: sampler;\n        ",main:"\n            uv = (tilingUniforms.uTextureTransform * vec3(uv, 1.0)).xy;\n\n            position = (position - tilingUniforms.uSizeAnchor.zw) * tilingUniforms.uSizeAnchor.xy;\n        "},fragment:{header:"\n            struct TilingUniforms {\n                uMapCoord:mat3x3<f32>,\n                uClampFrame:vec4<f32>,\n                uClampOffset:vec2<f32>,\n                uTextureTransform:mat3x3<f32>,\n                uSizeAnchor:vec4<f32>\n            };\n\n            @group(2) @binding(0) var<uniform> tilingUniforms: TilingUniforms;\n            @group(2) @binding(1) var uTexture: texture_2d<f32>;\n            @group(2) @binding(2) var uSampler: sampler;\n        ",main:"\n\n            var coord = vUV + ceil(tilingUniforms.uClampOffset - vUV);\n            coord = (tilingUniforms.uMapCoord * vec3(coord, 1.0)).xy;\n            var unclamped = coord;\n            coord = clamp(coord, tilingUniforms.uClampFrame.xy, tilingUniforms.uClampFrame.zw);\n\n            var bias = 0.;\n\n            if(unclamped.x == coord.x && unclamped.y == coord.y)\n            {\n                bias = -32.;\n            }\n\n            outColor = textureSampleBias(uTexture, uSampler, coord, bias);\n        "}},v={name:"tiling-bit",vertex:{header:"\n            uniform mat3 uTextureTransform;\n            uniform vec4 uSizeAnchor;\n\n        ",main:"\n            uv = (uTextureTransform * vec3(aUV, 1.0)).xy;\n\n            position = (position - uSizeAnchor.zw) * uSizeAnchor.xy;\n        "},fragment:{header:"\n            uniform sampler2D uTexture;\n            uniform mat3 uMapCoord;\n            uniform vec4 uClampFrame;\n            uniform vec2 uClampOffset;\n        ",main:"\n\n        vec2 coord = vUV + ceil(uClampOffset - vUV);\n        coord = (uMapCoord * vec3(coord, 1.0)).xy;\n        vec2 unclamped = coord;\n        coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);\n\n        outColor = texture(uTexture, coord, unclamped == coord ? 0.0 : -32.0);// lod-bias very negative to force lod 0\n\n        "}};let y,b;class x extends f.M{constructor(){y??(y=(0,c.v)({name:"tiling-sprite-shader",bits:[d.Ls,_,p.b]})),b??(b=(0,c.I)({name:"tiling-sprite-shader",bits:[d.mA,v,p.m]}));const e=new g.k({uMapCoord:{value:new u.u,type:"mat3x3<f32>"},uClampFrame:{value:new Float32Array([0,0,1,1]),type:"vec4<f32>"},uClampOffset:{value:new Float32Array([0,0]),type:"vec2<f32>"},uTextureTransform:{value:new u.u,type:"mat3x3<f32>"},uSizeAnchor:{value:new Float32Array([100,100,.5,.5]),type:"vec4<f32>"}});super({glProgram:b,gpuProgram:y,resources:{localUniforms:new g.k({uTransformMatrix:{value:new u.u,type:"mat3x3<f32>"},uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uRound:{value:0,type:"f32"}}),tilingUniforms:e,uTexture:m.g.EMPTY.source,uSampler:m.g.EMPTY.source.style}})}updateUniforms(e,t,i,n,s,r){const a=this.resources.tilingUniforms,o=r.width,l=r.height,h=r.textureMatrix,u=a.uniforms.uTextureTransform;u.set(i.a*o/e,i.b*o/t,i.c*l/e,i.d*l/t,i.tx/e,i.ty/t),u.invert(),a.uniforms.uMapCoord=h.mapCoord,a.uniforms.uClampFrame=h.uClampFrame,a.uniforms.uClampOffset=h.uClampOffset,a.uniforms.uTextureTransform=u,a.uniforms.uSizeAnchor[0]=e,a.uniforms.uSizeAnchor[1]=t,a.uniforms.uSizeAnchor[2]=n,a.uniforms.uSizeAnchor[3]=s,r&&(this.resources.uTexture=r.source,this.resources.uSampler=r.source.style)}}class T extends h.u{constructor(){super({positions:new Float32Array([0,0,1,0,1,1,0,1]),uvs:new Float32Array([0,0,1,0,1,1,0,1]),indices:new Uint32Array([0,1,2,0,2,3])})}}const S=new T;class A{constructor(){this.canBatch=!0,this.geometry=new h.u({indices:S.indices.slice(),positions:S.positions.slice(),uvs:S.uvs.slice()})}destroy(){this.geometry.destroy(),this.shader?.destroy()}}class E{constructor(e){this._state=r.U.default2d,this._renderer=e}validateRenderable(e){const t=this._getTilingSpriteData(e),i=t.canBatch;this._updateCanBatch(e);const n=t.canBatch;if(n&&n===i){const{batchableMesh:i}=t;return!i._batcher.checkAndUpdateTexture(i,e.texture)}return i!==n}addRenderable(e,t){const i=this._renderer.renderPipes.batch;this._updateCanBatch(e);const n=this._getTilingSpriteData(e),{geometry:s,canBatch:r}=n;if(r){n.batchableMesh||(n.batchableMesh=new l.U);const r=n.batchableMesh;e.didViewUpdate&&(this._updateBatchableMesh(e),r.geometry=s,r.renderable=e,r.transform=e.groupTransform,r.setTexture(e._texture)),r.roundPixels=this._renderer._roundPixels|e._roundPixels,i.addToBatch(r,t)}else i.break(t),n.shader||(n.shader=new x),this.updateRenderable(e),t.add(e)}execute(e){const{shader:t}=this._getTilingSpriteData(e);t.groups[0]=this._renderer.globalUniforms.bindGroup;const i=t.resources.localUniforms.uniforms;i.uTransformMatrix=e.groupTransform,i.uRound=this._renderer._roundPixels|e._roundPixels,(0,o.V)(e.groupColorAlpha,i.uColor,0),this._state.blendMode=(0,s.i)(e.groupBlendMode,e.texture._source),this._renderer.encoder.draw({geometry:S,shader:t,state:this._state})}updateRenderable(e){const t=this._getTilingSpriteData(e),{canBatch:i}=t;if(i){const{batchableMesh:i}=t;e.didViewUpdate&&this._updateBatchableMesh(e),i._batcher.updateElement(i)}else if(e.didViewUpdate){const{shader:i}=t;i.updateUniforms(e.width,e.height,e._tileTransform.matrix,e.anchor.x,e.anchor.y,e.texture)}}_getTilingSpriteData(e){return e._gpuData[this._renderer.uid]||this._initTilingSpriteData(e)}_initTilingSpriteData(e){const t=new A;return t.renderable=e,e._gpuData[this._renderer.uid]=t,t}_updateBatchableMesh(e){const t=this._getTilingSpriteData(e),{geometry:i}=t,n=e.texture.source.style;"repeat"!==n.addressMode&&(n.addressMode="repeat",n.update()),function(e,t){const i=e.texture,n=i.frame.width,s=i.frame.height;let r=0,a=0;e.applyAnchorToTexture&&(r=e.anchor.x,a=e.anchor.y),t[0]=t[6]=-r,t[2]=t[4]=1-r,t[1]=t[3]=-a,t[5]=t[7]=1-a;const o=u.u.shared;o.copyFrom(e._tileTransform.matrix),o.tx/=e.width,o.ty/=e.height,o.invert(),o.scale(e.width/n,e.height/s),function(e,t,i,n){let s=0;const r=e.length/(t||2),a=n.a,o=n.b,l=n.c,h=n.d,u=n.tx,c=n.ty;for(i*=t;s<r;){const n=e[i],r=e[i+1];e[i]=a*n+l*r+u,e[i+1]=o*n+h*r+c,i+=t,s++}}(t,2,0,o)}(e,i.uvs),function(e,t){const i=e.anchor.x,n=e.anchor.y;t[0]=-i*e.width,t[1]=-n*e.height,t[2]=(1-i)*e.width,t[3]=-n*e.height,t[4]=(1-i)*e.width,t[5]=(1-n)*e.height,t[6]=-i*e.width,t[7]=(1-n)*e.height}(e,i.positions)}destroy(){this._renderer=null}_updateCanBatch(e){const t=this._getTilingSpriteData(e),i=e.texture;let n=!0;return this._renderer.type===a.W.WEBGL&&(n=this._renderer.context.supports.nonPowOf2wrapping),t.canBatch=i.textureMatrix.isSimple&&(n||i.source.isPowerOfTwo),t.canBatch}}E.extension={type:[n.Ag.WebGLPipes,n.Ag.WebGPUPipes,n.Ag.CanvasPipes],name:"tilingSprite"},n.XO.add(E)},9037:(e,t,i)=>{"use strict";i.d(t,{k:()=>h});var n=i(198),s=i(2349);const r=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],a=r.reduce((e,t)=>(e[t]=!0,e),{});function o(e,t){switch(e){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*t);case"vec3<f32>":return new Float32Array(3*t);case"vec4<f32>":return new Float32Array(4*t);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const l=class e{constructor(t,i){this._touched=0,this.uid=(0,n.L)("uniform"),this._resourceType="uniformGroup",this._resourceId=(0,n.L)("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,i={...e.defaultOptions,...i},this.uniformStructures=t;const l={};for(const e in t){const i=t[e];if(i.name=e,i.size=i.size??1,!a[i.type]){const e=i.type.match(/^array<(\w+(?:<\w+>)?),\s*(\d+)>$/);if(e){const[,t,n]=e;throw new Error(`Uniform type ${i.type} is not supported. Use type: '${t}', size: ${n} instead.`)}throw new Error(`Uniform type ${i.type} is not supported. Supported uniform types are: ${r.join(", ")}`)}i.value??(i.value=o(i.type,i.size)),l[e]=i.value}this.uniforms=l,this._dirtyId=1,this.ubo=i.ubo,this.isStatic=i.isStatic,this._signature=(0,s.X)(Object.keys(l).map(e=>`${e}-${t[e].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};l.defaultOptions={ubo:!1,isStatic:!1};let h=l},9111:(e,t,i)=>{"use strict";i.d(t,{s:()=>s});var n=i(7025);function s(e,t){const{texture:i,bounds:s}=e,r=t._style._getFinalPadding();(0,n.y)(s,t._anchor,i);const a=t._anchor._x*r*2,o=t._anchor._y*r*2;s.minX-=r-a,s.minY-=r-o,s.maxX-=r-a,s.maxY-=r-o}},9140:(e,t,i)=>{"use strict";i.d(t,{F:()=>n,a:()=>s});const n={name:"color-bit",vertex:{header:"\n            @in aColor: vec4<f32>;\n        ",main:"\n            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);\n        "}},s={name:"color-bit",vertex:{header:"\n            in vec4 aColor;\n        ",main:"\n            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);\n        "}}},9232:(e,t,i)=>{"use strict";i.d(t,{M:()=>u});var n=i(2551),s=i(198),r=i(3381),a=i(3650),o=i(1980),l=i(9998),h=i(9037);class u extends n.A{constructor(e){super(),this.uid=(0,s.L)("shader"),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[];let{gpuProgram:t,glProgram:i,groups:n,resources:r,compatibleRenderers:o,groupMap:u}=e;this.gpuProgram=t,this.glProgram=i,void 0===o&&(o=0,t&&(o|=l.W.WEBGPU),i&&(o|=l.W.WEBGL)),this.compatibleRenderers=o;const c={};if(r||n||(r={}),r&&n)throw new Error("[Shader] Cannot have both resources and groups");if(!t&&n&&!u)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!t&&n&&u)for(const e in u)for(const t in u[e]){const i=u[e][t];c[i]={group:e,binding:t,name:i}}else if(t&&n&&!u){const e=t.structsAndGroups.groups;u={},e.forEach(e=>{u[e.group]=u[e.group]||{},u[e.group][e.binding]=e.name,c[e.name]=e})}else if(r){if(n={},u={},t){t.structsAndGroups.groups.forEach(e=>{u[e.group]=u[e.group]||{},u[e.group][e.binding]=e.name,c[e.name]=e})}let e=0;for(const t in r)c[t]||(n[99]||(n[99]=new a.T,this._ownedBindGroups.push(n[99])),c[t]={group:99,binding:e,name:t},u[99]=u[99]||{},u[99][e]=t,e++);for(const e in r){const t=e;let i=r[e];i.source||i._resourceType||(i=new h.k(i));const s=c[t];s&&(n[s.group]||(n[s.group]=new a.T,this._ownedBindGroups.push(n[s.group])),n[s.group].setResource(i,s.binding))}}this.groups=n,this._uniformBindMap=u,this.resources=this._buildResourceAccessor(n,c)}addResource(e,t,i){var n,s;(n=this._uniformBindMap)[t]||(n[t]={}),(s=this._uniformBindMap[t])[i]||(s[i]=e),this.groups[t]||(this.groups[t]=new a.T,this._ownedBindGroups.push(this.groups[t]))}_buildResourceAccessor(e,t){const i={};for(const n in t){const s=t[n];Object.defineProperty(i,s.name,{get:()=>e[s.group].getResource(s.binding),set(t){e[s.group].setResource(t,s.binding)}})}return i}destroy(e=!1){this.emit("destroy",this),e&&(this.gpuProgram?.destroy(),this.glProgram?.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(e=>{e.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null}static from(e){const{gpu:t,gl:i,...n}=e;let s,a;return t&&(s=o.B.from(t)),i&&(a=r.M.from(i)),new u({gpuProgram:s,glProgram:a,...n})}}},9298:(e,t,i)=>{"use strict";i.d(t,{L:()=>n});const n={_registeredResources:new Set,register(e){this._registeredResources.add(e)},unregister(e){this._registeredResources.delete(e)},release(){this._registeredResources.forEach(e=>e.clear())},get registeredCount(){return this._registeredResources.size},isRegistered(e){return this._registeredResources.has(e)},reset(){this._registeredResources.clear()}}},9302:(e,t,i)=>{"use strict";i.d(t,{a:()=>n});class n{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let e=0;e<this.filters.length;e++)this.filters[e].destroy();this.filters=null,this.filterArea=null}}},9550:(e,t,i)=>{"use strict";function n(e){return e+=0===e?1:0,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)+1}function s(e){return!(e&e-1||!e)}i.d(t,{U5:()=>n,f3:()=>s})},9731:(e,t,i)=>{"use strict";i.d(t,{R:()=>r});let n=0;const s=500;function r(...e){n!==s&&(n++,n===s?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...e))}},9745:(e,t,i)=>{"use strict";i.d(t,{k:()=>_});var n=i(7747),s=i(8602);const r=[];async function a(e){if(!e)for(let e=0;e<r.length;e++){const t=r[e];if(t.value.test())return void await t.value.load()}}s.XO.handleByNamedList(s.Ag.Environment,r);var o=i(3079),l=i(6888),h=i(198),u=i(4303),c=i(9298),d=i(2874),p=i(2930),f=i(2551);const g=["init","destroy","contextChange","resolutionChange","resetState","renderEnd","renderStart","render","update","postrender","prerender"],m=class e extends f.A{constructor(e){super(),this.uid=(0,h.L)("renderer"),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=e.type,this.name=e.name,this.config=e;const t=[...g,...this.config.runners??[]];this._addRunners(...t),this._unsafeEvalCheck()}async init(t={}){const i=!0===t.skipExtensionImports||!1===t.manageImports;await a(i),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const e in this._systemsHash){t={...this._systemsHash[e].constructor.defaultOptions,...t}}t={...e.defaultOptions,...t},this._roundPixels=t.roundPixels?1:0;for(let e=0;e<this.runners.init.items.length;e++)await this.runners.init.items[e].init(t);this._initOptions=t}render(e,t){let i=e;if(i instanceof o.mc&&(i={container:i},t&&((0,u.t6)(u.lj,"passing a second argument is deprecated, please use render options instead"),i.target=t.renderTexture)),i.target||(i.target=this.view.renderTarget),i.target===this.view.renderTarget&&(this._lastObjectRendered=i.container,i.clearColor??(i.clearColor=this.background.colorRgba),i.clear??(i.clear=this.background.clearBeforeRender)),i.clearColor){const e=Array.isArray(i.clearColor)&&4===i.clearColor.length;i.clearColor=e?i.clearColor:n.Q.shared.setValue(i.clearColor).toArray()}i.transform||(i.container.updateLocalTransform(),i.transform=i.container.localTransform),i.container.visible&&(i.container.enableRenderGroup(),this.runners.prerender.emit(i),this.runners.renderStart.emit(i),this.runners.render.emit(i),this.runners.renderEnd.emit(i),this.runners.postrender.emit(i))}resize(e,t,i){const n=this.view.resolution;this.view.resize(e,t,i),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),void 0!==i&&i!==n&&this.runners.resolutionChange.emit(i)}clear(e={}){e.target||(e.target=this.renderTarget.renderTarget),e.clearColor||(e.clearColor=this.background.colorRgba),e.clear??(e.clear=d.u.ALL);const{clear:t,clearColor:i,target:s}=e;n.Q.shared.setValue(i??this.background.colorRgba),this.renderTarget.clear(s,t,n.Q.shared.toArray())}get resolution(){return this.view.resolution}set resolution(e){this.view.resolution=e,this.runners.resolutionChange.emit(e)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...e){e.forEach(e=>{this.runners[e]=new p.C(e)})}_addSystems(e){let t;for(t in e){const i=e[t];this._addSystem(i.value,i.name)}}_addSystem(e,t){const i=new e(this);if(this[t])throw new Error(`Whoops! The name "${t}" is already in use`);this[t]=i,this._systemsHash[t]=i;for(const e in this.runners)this.runners[e].add(i);return this}_addPipes(e,t){const i=t.reduce((e,t)=>(e[t.name]=t.value,e),{});e.forEach(e=>{const t=e.value,n=e.name,s=i[n];this.renderPipes[n]=new t(this,s?new s:null),this.runners.destroy.add(this.renderPipes[n])})}destroy(e=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(e),Object.values(this.runners).forEach(e=>{e.destroy()}),(!0===e||"object"==typeof e&&e.releaseGlobalResources)&&c.L.release(),this._systemsHash=null,this.renderPipes=null}generateTexture(e){return this.textureGenerator.generateTexture(e)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!(0,l.f)())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}resetState(){this.runners.resetState.emit()}};m.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let _=m},9764:(e,t,i)=>{"use strict";i.d(t,{$:()=>l});var n=i(8602),s=i(379),r=i(969),a=i(5884);const o=class e extends a.v{constructor(t){super(t),this.isReady=!1,this.uploadMethodId="video",t={...e.defaultOptions,...t},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==t.autoPlay,this.alphaMode=t.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),!1!==t.autoLoad&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const e=s.R.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const e=this.resource,t=this.options;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(t.preload||e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlayThrough),e.addEventListener("error",this._onError,!0)),this.alphaMode=await(0,r.C)(),this._load=new Promise((i,n)=>{this.isValid?i(this):(this._resolve=i,this._reject=n,void 0!==t.preloadTimeoutMs&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${t.preloadTimeoutMs}ms`))})),e.load())}),this._load}_onError(e){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){const e=this.resource;return!e.paused&&!e.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const e=this.resource;this.isValid&&(this.isReady=!0,this.resize(e.videoWidth,e.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const e=this.resource;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlayThrough),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(s.R.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),null===this._videoFrameRequestCallbackHandle&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(null!==this._videoFrameRequestCallbackHandle&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(s.R.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(null!==this._videoFrameRequestCallbackHandle&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(s.R.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(e){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement}};o.extension=n.Ag.TextureSource,o.defaultOptions={...a.v.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1},o.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let l=o},9803:(e,t,i)=>{"use strict";function n(e,t){const i=e.byteLength/8|0,n=new Float64Array(e,0,i);new Float64Array(t,0,i).set(n);const s=e.byteLength-8*i;if(s>0){const n=new Uint8Array(e,8*i,s);new Uint8Array(t,8*i,s).set(n)}}i.d(t,{W:()=>n})},9922:(e,t,i)=>{"use strict";i.d(t,{Ls:()=>n,_Q:()=>s,mA:()=>r});const n={name:"local-uniform-bit",vertex:{header:"\n\n            struct LocalUniforms {\n                uTransformMatrix:mat3x3<f32>,\n                uColor:vec4<f32>,\n                uRound:f32,\n            }\n\n            @group(1) @binding(0) var<uniform> localUniforms : LocalUniforms;\n        ",main:"\n            vColor *= localUniforms.uColor;\n            modelMatrix *= localUniforms.uTransformMatrix;\n        ",end:"\n            if(localUniforms.uRound == 1)\n            {\n                vPosition = vec4(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);\n            }\n        "}},s={...n,vertex:{...n.vertex,header:n.vertex.header.replace("group(1)","group(2)")}},r={name:"local-uniform-bit",vertex:{header:"\n\n            uniform mat3 uTransformMatrix;\n            uniform vec4 uColor;\n            uniform float uRound;\n        ",main:"\n            vColor *= uColor;\n            modelMatrix = uTransformMatrix;\n        ",end:"\n            if(uRound == 1.)\n            {\n                gl_Position.xy = roundPixels(gl_Position.xy, uResolution);\n            }\n        "}}},9998:(e,t,i)=>{"use strict";i.d(t,{W:()=>n});var n=(e=>(e[e.WEBGL=1]="WEBGL",e[e.WEBGPU=2]="WEBGPU",e[e.BOTH=3]="BOTH",e))(n||{})}},t={};function i(n){var s=t[n];if(void 0!==s)return s.exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,i),r.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e=i(2551);class t{constructor(...t){this.eventEmitter=new e.b}addEventListener(e,t){this.eventEmitter.addListener(e,t)}removeAllEventListeners(e){this.eventEmitter.removeAllListeners(e)}removeEventListener(e,t){this.eventEmitter.removeListener(e,t)}dispatchEvent(e,...t){this.eventEmitter.emit(e,...t)}}class n{}n.CHANGE="AssociativeArrayEvent.CHANGE";class s{static copyProps(e,t,i){for(var n,r=!1,a=Object.keys(t),o=a.length,l=0;l<o;l++)if(e[n=a[l]]!=t[n]){let a=!1;(!(null==i?void 0:i.ignoreExistedProperties)||(null==i?void 0:i.ignoreExistedProperties)&&void 0===e[n])&&(a=!0),a&&(null==i?void 0:i.ignoreNotExistedProperties)&&(e.hasOwnProperty(n)||(a=!1)),a&&((null==i?void 0:i.overrideExistedProperties)?e[n]=s.clone(t[n]):s.copySingleProp(e,t,n),r=!0)}return r}static copySingleProp(e,t,i,n){if(Array.isArray(t[i])){let r=t[i],a=e[i];a||(a=[],e[i]=a);let o=r.length;for(let e=0;e<o;e++)s.isObject(a[e])?s.copyProps(a[e],r[e],n):a[e]=s.clone(r[e])}else s.isObject(t[i])?(e[i]||(e[i]={}),s.copyProps(e[i],t[i],n)):e[i]=t[i]}static copySinglePropFromValue(e,t,i,n){s.copyProps(e,{[t]:i},n)}static clone(e){let t;return Array.isArray(e)?(t=[],s.copyProps(t,e)):s.isObject(e)?(t={},s.copyProps(t,e)):t=e,t}static isObject(e){return e===Object(e)}static isSimpleType(e){var t=!1;return Array.isArray(e)||s.isObject(e)||(t=!0),t}static isString(e){return"string"==typeof e}static isNumber(e){return"number"==typeof e}static getObjectConstructorName(e){return e.constructor?s.getConstructorName(e.constructor):""}static getConstructorName(e){return e.name?e.name:""}static checkIfEqual(e,t){let i=!0;if(e!==t)if(!!e!=!!t)i=!1;else{let n=!0;if(Array.isArray(e)&&Array.isArray(t)&&e.length!==t.length&&(n=!1,i=!1),n)for(let n in e){if(!e.hasOwnProperty(n)||!t.hasOwnProperty(n)){i=!1;break}if("object"==typeof e[n]&&"object"==typeof t[n]){if(!s.checkIfEqual(e[n],t[n])){i=!1;break}}else if(e[n]!==t[n]){i=!1;break}}}return i}}class r extends t{constructor(){super(),this.map={},this.list=[]}destruction(){this.map=null,this.list=null}dispatchChangeEvent(){this.dispatchEvent(n.CHANGE)}reset(){for(;this.list.length>0;)this.removeByIndex(0)}push(e,t,i=!0){this.addToIndex(e,t,this.list.length,i)}addToIndex(e,t,i,n=!0){var s=!0;n&&this.containsKey(t)&&(s=!1),s&&(this.list.splice(i,0,e),this.map[t]=e),this.dispatchChangeEvent()}remove(e){if(this.contains(e)){var t=this.indexOf(e);this.removeByIndex(t)}}removeByKey(e){var t=this.getItem(e);this.remove(t)}removeByIndex(e){var t=this.list.splice(e,1)[0],i=this.getItemKey(t);delete this.map[i],this.dispatchChangeEvent()}contains(e){var t=!1;return-1!=this.indexOf(e)&&(t=!0),t}containsKey(e){var t=!1;return this.map[e]&&(t=!0),t}indexOf(e){return this.list.indexOf(e)}getItem(e){return this.map[e]}getItemByIndex(e){var t;return e<this.list.length&&(t=this.list[e]),t}getItemKey(e){var t,i=null;for(t in this.map)if(this.map[t]==e){i=t;break}return i}getAllItems(e=!0){let t=this.list;return e&&(t=this.list.concat()),t}getAllKeys(){return Object.keys(this.map)}get length(){return this.list.length}forEach(e,t){this.list.forEach(e,t)}every(e,t){return this.list.every(e,t)}sort(e){this.list.sort(e)}clone(){let e=new r;return e.list=this.list.concat(),s.copyProps(e.map,this.map),e}}class a{static getRandomFloat(e,t){return Math.random()*(t-e)+e}static getRandomInt(e,t){if(e>t){const i=t;t=e,e=i}return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}static getListOfIntegers(e,t){let i=[];if((e=Math.floor(e))<(t=Math.floor(t)))for(let n=e;n<=t;n++)i.push(n);else console.error("NumberTools | GetListOfIntegers __ WARNING! variable 'from' is not less than 'to'");return i}static roundTo(e,t=10,i=!1,n=!0,s=!1){let r=e,a=1/t;i&&(r=Math.floor(e*a)/a),n&&(r=Math.round(e*a)/a),s&&(r=Math.ceil(e*a)/a);let o=(t.toString().split(".")[1]||[]).length;return o>0&&(r=parseFloat(r.toFixed(o))),r}static getDeltaBetweenNums(e,t,i){i<0?i=0:i>1&&(i=1);return e+i*(t-e)}static getMinMax(e,t,i){return Math.min(Math.max(e,t),i)}static getSign(e){let t=1;return e<0&&(t=-1),t}}a.MAX_SAFE_INTEGER=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:Math.pow(2,53)-1;class o{static removeItem(e,t,i=o.REMOVE_COUNT_ALL){let n=!1;i==o.REMOVE_COUNT_ALL&&(i=Number.MAX_VALUE);let s=0,r=e.indexOf(t);for(;-1!=r&&s<i;)e.splice(r,1),r=e.indexOf(t,r),s++;return s>0&&(n=!0),n}static removeItems(e,t){let i;for(let n=0;n<t.length;n++)i=t[n],o.removeItem(e,i)}static checkIfEqual(e,t){let i=!0;if(!e&&t||e&&!t)i=!1;else if(e&&t)if(e.length!=t.length)i=!1;else{let n=e.length;for(let r=0;r<n;r++)if(!s.checkIfEqual(e[r],t[r])){i=!1;break}}return i}static checkIfSomeEqual(e,t){return t.some(t=>e.indexOf(t)>=0)}static getDifference(e,t){let i=[],n=[...e,...t];for(let s of n)-1!==e.indexOf(s)&&-1!==t.indexOf(s)||i.push(s);return i}static getSimilar(e,t){let i=[];for(let n of e)-1!==t.indexOf(n)&&i.push(n);return i}static changeItemIndex(e,t,i){if(i>=t.length)return;let n=t.indexOf(e);-1!=n&&n!=i&&t.splice(i,0,t.splice(n,1)[0])}static randomizeArray(e){e.sort(o.randomizeSortFunction)}static randomizeSortFunction(e,t){return-1+Math.floor(3*Math.random())}static randomizeItemsInArray(e,t){let i,n,s=e.length;for(let r=0;r<t;r++)i=a.getRandomInt(0,s-1),n=a.getRandomInt(0,s-1),o.swapItemsInArray(e,i,n)}static swapItemsInArray(e,t,i){let n=e[t],s=e[i];e[t]=s,e[i]=n}static getRandomItemBasedOnWeights(e,t){let i;t||(t=Array(e.length).fill(1));const n=e.length;if(t.length<e.length)for(let e=t.length;e<n;e++)t[e]=1;let s=0;for(let e=0;e<n;e++)s+=t[e];const r=Math.random()*s;let a=0;for(let s=0;s<n;s++){if(a+=t[s],r<a){i=e[s];break}}return i}static getRandomItem(e,t=null){let i=null,n=e.concat();if(t&&o.removeItems(n,t),n.length>0){i=n[Math.floor(Math.random()*n.length)]}return i}static getUniqueItems(e){return e.filter(o.removeDuplicatesFilter)}static removeDuplicatesFilter(e,t,i){return 0==t||-1==i.lastIndexOf(e,t-1)}}o.REMOVE_COUNT_ALL=-1;class l{static addEventListener(e,t,i){const n=e;n.addEventListener?n.addEventListener(t,i):e.on(t,i)}static removeEventListener(e,t,i){const n=e;n.removeEventListener?n.removeEventListener(t,i):e.off(t,i)}static dispatch(e,t,...i){const n=e;n.dispatchEvent?n.dispatchEvent(t,...i):e.emit(t,...i)}}class h{}class u{constructor(e){this.listenerThis=e,this.construction()}construction(){this.listenersByTypeMap=new r}destruction(){this.removeAllListeners(),this.listenerThis=null}addEventListener(e,t,i){var n=this.getEventListeners(t),s=new h;s.dispatcher=e,s.type=t,this.listenerThis?s.listener=i.bind(this.listenerThis):s.listener=i,s.sourceListener=i,n.push(s),l.addEventListener(e,t,s.listener)}removeEventListener(e,t,i){let n,s=[],r=this.getEventListeners(t),a=r.length;for(let t=0;t<a;t++)n=r[t],n.dispatcher==e&&n.sourceListener==i&&(l.removeEventListener(n.dispatcher,n.type,n.listener),s.push(n));o.removeItems(r,s)}removeAllListeners(e){let t=this.listenersByTypeMap.getAllItems(),i=t.length;for(let n=0;n<i;n++){let i,s=t[n].concat(),r=s.length;for(let t=0;t<r;t++)i=s[t],e&&i.dispatcher!=e||this.removeEventListener(i.dispatcher,i.type,i.sourceListener)}}getEventListeners(e){return this.listenersByTypeMap.containsKey(e)||this.listenersByTypeMap.push([],e),this.listenersByTypeMap.getItem(e)}}class c extends t{constructor(...e){super(...e),this.construction(...e),this.isConstructed=!0,this.addListeners(),this.commitData()}construction(...e){this.eventListenerHelper=new u(this)}destruction(){this.removeListeners(),this.eventListenerHelper&&(this.eventListenerHelper.destruction(),this.eventListenerHelper=null)}addListeners(){this.removeListeners()}removeListeners(){this.eventListenerHelper&&this.eventListenerHelper.removeAllListeners()}commitData(){}arrange(){}get data(){return this._data}set data(e){this.data!=e&&(this.processDataUnset(this._data),this._data=e,this.processDataSet(this._data),this.commitData())}processDataUnset(e){}processDataSet(e){}}class d{}d.COMPLETE="COMPLETE";class p{}p.TERMINATE="TERMINATE",p.GENERAL_ERROR="GENERAL_ERROR";class f extends c{get isExecuting(){return this._isExecuting}get isCompleted(){return this._isCompleted}constructor(...e){super(...e)}execute(){return this.constructorName=s.getConstructorName(this.constructor),console.log("Command | execute __ name: "+this.constructorName),this.executePrommise=new Promise((e,t)=>{this.promiseResolve=e,this.promiseReject=t,this.isExecuting||this.isCompleted||(this._isExecuting=!0,-1==f.cache.indexOf(this)&&(f.cache.push(this),f.cache.length>f.CACHE_COMMANDS_COUNT_FOR_WARNING&&console.log("Command | execute __WARNING! Too many commands in the cache!")),this.guard()?this.executeInternal():this.notifyComplete())}),this.executePrommise.catch(e=>{console.warn("Command | notifyComplete __ Completed with error! name: ",this.constructorName," | reason: ",e)}),this.executePrommise}guard(){return!0}notifyComplete(e,t){console.log("Command | notifyComplete __ name: ",this.constructorName," | this.success: ",this.success),this._isExecuting=!1,this.isCompleted||(o.removeItem(f.cache,this),this._isCompleted=!0,this.removeListeners(),this.dispatchEvent(d.COMPLETE),this.success?this.promiseResolve(e):this.promiseReject(t)),this.destruction()}terminate(e){return e||(e=p.TERMINATE),this.errorCode=e,this.notifyComplete(null,this.errorCode),this.executePrommise}get success(){var e=!0;return this.errorCode&&(e=!1),e}}f.cache=[],f.CACHE_COMMANDS_COUNT_FOR_WARNING=200;var g,m,_,v=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,o)}l((n=n.apply(e,t||[])).next())})};class y extends f{constructor(e){super(e),this.callback=e}executeInternal(){return v(this,void 0,void 0,function*(){yield this.callback(),this.notifyComplete()})}}class b{}b.COMMAND_COMPLETE="COMMAND_COMPLETE",b.PROGRESS="PROGRESS";class x{}x.QUEUE_COMMAND_ERROR="QUEUE_COMMAND_ERROR";class T extends f{constructor(e=null){super(),e||(e=[]),this.queueCommands=e.concat(),this.curCommandIndex=-1,this._progress=0,this.isNeedCompleteAfterTheLastCommand=!0,this.isNeedChangeProgressByCommandComplete=!0}executeInternal(){this.executeNextCommand()}executeNextCommand(){if(!this.isCompleted&&!this.runningCommand)if(this.curCommandIndex<this.queueCommands.length-1){this.curCommandIndex++;var e=this.queueCommands[this.curCommandIndex];this.runningCommand=e,this.addSingleCommandListeners(this.runningCommand),this.runningCommand.execute()}else this.isNeedCompleteAfterTheLastCommand&&this.notifyComplete()}addSingleCommandListeners(e){this.eventListenerHelper.addEventListener(e,d.COMPLETE,this.onCommandComplete)}removeSingleCommandListeners(e){this.eventListenerHelper&&this.eventListenerHelper.removeEventListener(e,d.COMPLETE,this.onCommandComplete)}onCommandComplete(){this.lastCompleteCommand=this.runningCommand,this.resetRunningCommandData(),this.lastCompleteCommand&&(this.dispatchEvent(b.COMMAND_COMPLETE,this.lastCompleteCommand),this.isNeedChangeProgressByCommandComplete&&this.setProgress(this.curCommandIndex+1),!this.lastCompleteCommand.success&&this.isNeedAbortOnQueueCommandError?(this.errorCode=x.QUEUE_COMMAND_ERROR,this.terminate()):this.executeNextCommand())}dispatchProgressEvent(){this.dispatchEvent(b.PROGRESS,this.progress)}get progress(){return this._progress}setProgress(e){e!=this.progress&&(this._progress=e,this.dispatchProgressEvent())}resetRunningCommandData(){this.runningCommand&&(this.removeSingleCommandListeners(this.runningCommand),this.runningCommand=null)}terminate(e){let t=[];return this.runningCommand&&t.push(this.runningCommand.terminate(e)),Promise.all(t).finally(()=>{super.terminate(e)}),this.executePrommise}notifyComplete(){super.notifyComplete(),this.resetRunningCommandData(),this.queueCommands=[],this.curCommandIndex=0}add(e){this.queueCommands.push(e)}getCurrentRunningCommand(){return this.runningCommand}}class S{static getObjectUniqueId(e){let t;if(s.isObject(e))e.hasOwnProperty(S.UNIQUE_ID_PROP_NAME)||(S.globalUniqueId++,e[S.UNIQUE_ID_PROP_NAME]=S.globalUniqueId.toString()),t=e[S.UNIQUE_ID_PROP_NAME];else{const i=e.toString();S.simpleTypesUniqueValuesMap[i]||(S.globalUniqueId++,S.simpleTypesUniqueValuesMap[i]=S.globalUniqueId.toString()),t=S.simpleTypesUniqueValuesMap[i]}return t}static getUniqueIdForPool(e){return e||(e=S.DEFAULT_POOL_ID),S.uniqueIdByPool[e]||0===S.uniqueIdByPool[e]?S.uniqueIdByPool[e]===a.MAX_SAFE_INTEGER?S.uniqueIdByPool[e]=0:S.uniqueIdByPool[e]++:S.uniqueIdByPool[e]=0,S.uniqueIdByPool[e].toString()}static setCounterForPool(e,t){t||(t=S.DEFAULT_POOL_ID),S.uniqueIdByPool[t]=e}}S.UNIQUE_ID_PROP_NAME="flashistUniqueId",S.DEFAULT_POOL_ID="defaultPoolId",S.globalUniqueId=0,S.uniqueIdByPool={},S.simpleTypesUniqueValuesMap={};class A{constructor(){this.map={},this.keys=[]}getItem(e){var t=S.getObjectUniqueId(e);return this.map[t]}addItem(e,t){var i=S.getObjectUniqueId(e);this.map[i]!==t&&(this.map[i]=t,-1===this.keys.indexOf(e)&&this.keys.push(e))}removeItemByKey(e){var t=S.getObjectUniqueId(e);const i=!!this.map[t];return i&&(delete this.map[t],o.removeItem(this.keys,e)),i}getKeys(){return this.keys.concat()}get length(){return this.keys.length}}!function(e){e.CHANGE="LockEvent.CHANGE"}(g||(g={}));class E extends c{constructor(){super(...arguments),this.lockers=[]}get enabled(){return this.lockers.length>0}add(e){-1===this.lockers.indexOf(e)&&(this.lockers.push(e),this.dispatchEvent(g.CHANGE))}remove(e){const t=this.lockers.indexOf(e);-1!==t&&(this.lockers.splice(t,1),this.dispatchEvent(g.CHANGE))}}class C extends c{constructor(){super()}}class w extends C{constructor(){super()}log(...e){console.log.apply(console,e)}error(...e){console.error.apply(console,e)}debug(...e){console.debug.apply(console,e)}startLogTime(e){console.time(e)}stopLogTime(e){console.timeEnd(e)}}class P{static addLoggerItem(e){P.loggerItems.push(e),P.loggerItemsCount=P.loggerItems.length}static log(...e){for(var t=0;t<P.loggerItemsCount;t++)P.loggerItems[t].log.apply(P.loggerItems[t],e)}static error(...e){for(var t=0;t<P.loggerItemsCount;t++)P.loggerItems[t].error.apply(P.loggerItems[t],e)}static debug(...e){for(var t=0;t<P.loggerItemsCount;t++)P.loggerItems[t].debug.apply(P.loggerItems[t],e)}static logCurrentTime(){var e=new Date;P.log("time: "+e.getTime())}static startLogTime(e){for(var t=0;t<P.loggerItemsCount;t++)P.loggerItems[t].startLogTime.apply(P.loggerItems[t],e)}static stopLogTime(e){for(var t=0;t<P.loggerItemsCount;t++)P.loggerItems[t].stopLogTime.apply(P.loggerItems[t],e)}}P.loggerItems=[],P.loggerItemsCount=0;class I{constructor(){this.objectsToClassMap=new A}addObject(e,t){if(!e)return;let i=this.getObjectsByClass(t);i&&-1==i.indexOf(e)&&i.push(e)}getObject(e,...t){let i,n=this.getObjectsByClass(e);return i=n.length>0?n.shift():this.createNewObject(e,...t),i}createNewObject(e,...t){return new e(...t)}getObjectsByClass(e){let t=this.objectsToClassMap.getItem(e);return t||(t=[],this.objectsToClassMap.addItem(e,t)),t}}class M{static substituteList(e,...t){return M.substitute(e,t)}static substitute(e,t=null){var i,n,r,a=e;if(s.isSimpleType(t)&&(t=[t]),t)for(r in t)i=t[r],n="{"+r+"}",a=M.replaceText(a,n,i);return a}static replaceText(e,t,i){return e.split(t).join(i)}static groupCharacters(e,t=3,i=" ",n=!0){let s=[],r=e.split("");n&&(r=r.reverse());let a=r.length;for(let n=0;n<a;n++)s.push(r[n]),n>0&&n<e.length-1&&(n+1)%t==0&&s.push(i);n&&(s=s.reverse());return s.join("")}static splitByCapitalLetters(e){return e.split(/(?=[A-Z])/)}static capitalizeFirstLetter(e,t=navigator.language){return e.charAt(0).toLocaleUpperCase(t)+e.substring(1)}static count(e,t){let i=e.split(t).length-1;return i<0&&(i=0),i}}class R{static destruction(){R.delayedFunctionInfos=null,R.delayedFunctions=null,clearInterval(R.checkInterval)}static onTimer(){R.callAllDelayedFunctions()}static callAllDelayedFunctions(){if(R.delayedFunctionInfos.length<=0)return;let e;for(let t=0;t<R.delayedFunctionInfos.length;t++)e=R.delayedFunctionInfos[t],e.delayStartTime||(e.delayStartTime=Date.now()),(!e.delayTime||e.delayTime<=Date.now()-e.delayStartTime)&&(e.func.apply(e.thisContext,e.applyArgs),o.removeItem(R.delayedFunctionInfos,e),o.removeItem(R.delayedFunctions,e.func,1))}static addDelayedFunction(e,t,i=null,n=0,s=!1){if(s&&R.checkIsSameFunctionWithSameParamsExist(e,t,i))return;let r={func:e,thisContext:t,applyArgs:i,delayTime:n,delayStartTime:0};R.delayedFunctionInfos.push(r),R.delayedFunctions.push(r.func),R.isDelayedFunctionsChange=!0}static addDelayedUniqueFunction(e,t,i=null,n=0){R.addDelayedFunction(e,t,i,n,!0)}static checkIsSameFunctionWithSameParamsExist(e,t,i=null){let n=!1;if(-1!=R.delayedFunctions.indexOf(e)){let s,r=R.delayedFunctionInfos.length;for(let a=0;a<r;a++)if(s=R.delayedFunctionInfos[a],s&&s.func==e&&s.thisContext===t&&o.checkIfEqual(i,s.applyArgs)){n=!0;break}}return n}}R.checkIntervalTime=16,R.delayedFunctionInfos=[],R.delayedFunctions=[],R.pseudoStaticConstructor=void(R.checkInterval=setInterval(()=>{R.onTimer()},R.checkIntervalTime));class L{}L.KEY_DOWN="keydown",L.KEY_PRESS="keypress",L.KEY_UP="keyup",function(e){e.MOUSE_WHEEL="wheel"}(m||(m={}));!function(e){e.DEFAULT="default",e.EN="en",e.RU="ru"}(_||(_={}));class k{static startInit(e={}){k.config=e}static activate(){let e;const t=k.injectionsMap.getKeys();for(let i of t)e=k.injectionsMap.getItem(i),e.config&&e.config.forceCreation&&k.getInstance(e.item)}static add(e,t){let i=k.getInjection(e);if(t){if(t.toSubstitute){i.toSubstitute=t.toSubstitute;let n=k.getInjection(i.toSubstitute);n.substitution=e,n.config&&(t.activateeConstructors||(t.activateeConstructors=[]),n.config.activateeConstructors&&t.activateeConstructors.push(...n.config.activateeConstructors),s.copyProps(t,n.config,{ignoreExistedProperties:!0}))}}else t={};i.config=t}static getInstance(e,...t){let i,n=k.getInjection(e),s=[];if(t&&(s=t),n.config&&n.config.isSingleton?(n.singletonInstance||(n.singletonInstance=new n.item(...s)),i=n.singletonInstance):i=new n.item(...s),k.config.debug){let t=k.getConstructorName(e);window[t]=i}return i}static getInstanceById(e,...t){let i,n;const s=k.injectionsMap.getKeys();for(let t of s)if(i=k.injectionsMap.getItem(t),i.config&&i.config.id===e){n=i;break}let r=null;return n&&(r=k.getInstance(n.item)),r}static getInjection(e){k.injectionsMap.getItem(e)||k.injectionsMap.addItem(e,{item:e});let t=k.injectionsMap.getItem(e);return t.substitution&&(t=k.getInjection(t.substitution)),t}static processItemOnActivate(e){if(!e.constructor)return;let t=k.getInjection(e.constructor),i=k.getChainActivateesConstructors(t);if(i&&i.length>0){let t=k.activatorToActivateesMap.getItem(e);t||(t=[],k.activatorToActivateesMap.addItem(e,t));let n=i.length;for(let s=0;s<n;s++){let n=i[s],r=k.getInstance(n);r.onActivatorStart(e),t.push(r)}}}static processItemOnDeactivate(e){let t=k.activatorToActivateesMap.getItem(e);if(!t)return;let i=t.length;for(let e=0;e<i;e++){t[e].onActivatorEnd()}k.activatorToActivateesMap.removeItemByKey(e)}static getChainActivateesConstructors(e){let t=[];return e.config&&e.config.activateeConstructors&&t.push(...e.config.activateeConstructors),t}static getConstructorName(e){let t=s.getConstructorName(e);if(!t){var i="class ",n=e.toString().indexOf(i)+6,r=e.toString().indexOf(" extends");t=e.toString().slice(n,r)}return t}}k.config={},k.injectionsMap=new A,k.activatorToActivateesMap=new A;const D=k.getInstance,O=k.add,B=k.processItemOnActivate,G=k.processItemOnDeactivate;window.getInstance=D;class F{constructor(){this.useTextLinks=!0,this.localeToIdMap={},this.bindMethodReplaceRegExpKeyByStrings=this.replaceRegExpKeyByStrings.bind(this),this.defaultLocaleId=_.EN,this.setCurrentLocaleId("")}addLocaleTexts(e,t){let i={texts:{}};this.localeToIdMap[t]&&(i=this.localeToIdMap[t]),Object.assign(i.texts,e.texts),this.localeToIdMap[t]=i,this.commitLocaleData()}getCurrentLocaleId(){return this._currentLocaleId}setCurrentLocaleId(e){e!=this._currentLocaleId&&(this._currentLocaleId=e,this.commitLocaleData())}checkIfLocaleExists(e){return!!this.localeToIdMap[e]}commitLocaleData(){let e=this.localeToIdMap[this._currentLocaleId];e||(e=this.localeToIdMap[this.defaultLocaleId]),this.currentLocaleTexts=e}getText(e,t=null){let i=e;if(this.currentLocaleTexts){const n=e.split(".");let s=this.currentLocaleTexts.texts;const r=n.length;for(let e=0;e<r;e++){const a=n[e];s[a]&&(s=s[a],e===r-1&&(i=s,i=this.format(i,t)))}}return i}format(e,t=null){var i=e;return this.useTextLinks&&(i=i.replace(/@([^@]+)@/gi,this.bindMethodReplaceRegExpKeyByStrings)),e&&t&&(i=M.substitute(i,t)),this.useTextLinks&&(i=i.replace(/@([^@]+)@/gi,this.bindMethodReplaceRegExpKeyByStrings)),i}replaceRegExpKeyByStrings(e,t,...i){return this.getText(t)}findAllUniqueCharactersForCurrentLocale(){const e=[];this.getAllTextsOf(this.currentLocaleTexts.texts,e);let t={},i=[];for(let n of e){const e=Array.from(n);for(let n of e)t[n]||(t[n]=!0,i.push(n))}return i}getAllTextsOf(e,t){for(let i in e){let n=e[i];s.isObject(n)?this.getAllTextsOf(n,t):t.push(n)}}}function U(e,t=null){return D(F).getText(e,t)}var N;!function(e){e.LEFT="left",e.RIGHT="right",e.TOP="top",e.BOTTOM="bottom"}(N||(N={}));const z="KeyP",H="KeyC",V="ArrowUp",W="ArrowDown",j="ArrowLeft",X="ArrowRight";class Y extends I{createNewObject(e,...t){return D(e,...t)}}var K,q,$;!function(e){e.MOBILE="mobile",e.TABLET="tablet",e.DESKTOP="desktop"}(K||(K={})),function(e){e.IOS="iOS",e.ANDROID="Android",e.MAC_OS="Mac OS",e.WINDOWS="Windows",e.LINUX="Linux"}(q||(q={})),function(e){e.CHANGE="change",e.ERROR="error"}($||($={}));class Q{static request(e=document.documentElement,t){return new Promise((i,n)=>{const s=()=>{Q.off("change",s),i()};Q.on("change",s);const r=e[Q.nativeAPI.requestFullscreen](t);r instanceof Promise&&r.then(s).catch(n)})}static exit(){return new Promise((e,t)=>{if(!Q.isFullscreen)return void e();const i=()=>{Q.off("change",i),e()};Q.on("change",i);const n=document[Q.nativeAPI.exitFullscreen]();n instanceof Promise&&n.then(i).catch(t)})}static toggle(e=document.documentElement,t){return Q.isFullscreen?Q.exit():Q.request(e,t)}static onChange(e){Q.on("change",e)}static onError(e){Q.on("error",e)}static on(e,t){const i=Q.eventNameMap[e];i&&document.addEventListener(i,t,!1)}static off(e,t){const i=Q.eventNameMap[e];i&&document.removeEventListener(i,t,!1)}static get isFullscreen(){return document[Q.nativeAPI.fullscreenElement]}static get element(){var e;return null!==(e=document[Q.nativeAPI.fullscreenElement])&&void 0!==e?e:void 0}static get isEnabled(){return!!document[Q.nativeAPI.fullscreenEnabled]}}Q.methodMap=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],Q.nativeAPI=(()=>{if("undefined"==typeof document)return!1;const e=Q.methodMap[0],t={};for(const i of Q.methodMap){if((null==i?void 0:i[1])in document){const n=i.length;for(let s=0;s<n;s++)t[e[s]]=i[s];return t}}return!1})(),Q.eventNameMap={[$.CHANGE]:Q.nativeAPI.fullscreenchange,[$.ERROR]:Q.nativeAPI.fullscreenerror};var Z=i(8602);const J={extension:{type:Z.Ag.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await Promise.resolve().then(i.bind(i,6213))}},ee={extension:{type:Z.Ag.Environment,name:"webworker",priority:0},test:()=>"undefined"!=typeof self&&void 0!==self.WorkerGlobalScope,load:async()=>{await Promise.resolve().then(i.bind(i,8645))}};i(8594),i(4767);var te=i(5553),ie=i(9745);let ne,se;function re(e){return void 0!==ne||(ne=(()=>{const t={stencil:!0,failIfMajorPerformanceCaveat:e??ie.k.defaultOptions.failIfMajorPerformanceCaveat};try{if(!te.e.get().getWebGLRenderingContext())return!1;let e=te.e.get().createCanvas().getContext("webgl",t);const i=!!e?.getContextAttributes()?.stencil;if(e){const t=e.getExtension("WEBGL_lose_context");t&&t.loseContext()}return e=null,i}catch(e){return!1}})()),ne}async function ae(e={}){return void 0!==se||(se=await(async()=>{const t=te.e.get().getNavigator().gpu;if(!t)return!1;try{const i=await t.requestAdapter(e);return await i.requestDevice(),!0}catch(e){return!1}})()),se}const oe=["webgl","webgpu","canvas"];var le=i(3079),he=i(3902),ue=i(4303);const ce=class e{constructor(...e){this.stage=new le.mc,void 0!==e[0]&&(0,ue.t6)(ue.lj,"Application constructor options are deprecated, please use Application.init() instead.")}async init(t){t={...t},this.renderer=await async function(e){let t,n=[];e.preference?(n.push(e.preference),oe.forEach(t=>{t!==e.preference&&n.push(t)})):n=oe.slice();let s={};for(let r=0;r<n.length;r++){const a=n[r];if("webgpu"===a&&await ae()){const{WebGPURenderer:n}=await Promise.resolve().then(i.bind(i,3705));t=n,s={...e,...e.webgpu};break}if("webgl"===a&&re(e.failIfMajorPerformanceCaveat??ie.k.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:n}=await Promise.resolve().then(i.bind(i,3639));t=n,s={...e,...e.webgl};break}if("canvas"===a)throw s={...e},new Error("CanvasRenderer is not yet implemented")}if(delete s.webgpu,delete s.webgl,!t)throw new Error("No available renderer for the current environment");const r=new t;return await r.init(s),r}(t),e._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return(0,ue.t6)(ue.lj,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(t=!1,i=!1){const n=e._plugins.slice(0);n.reverse(),n.forEach(e=>{e.destroy.call(this)}),this.stage.destroy(i),this.stage=null,this.renderer.destroy(t),this.renderer=null}};ce._plugins=[];let de=ce;Z.XO.handleByList(Z.Ag.Application,de._plugins),Z.XO.add(he.M);var pe=i(1002),fe=i(4036),ge=i(7384),me=i(6208),_e=i(2207),ve=i(8192),ye=i(3246),be=i(3596);class xe extends ye.v{constructor(e,t){super();const{textures:i,data:n}=e;Object.keys(n.pages).forEach(e=>{const t=n.pages[parseInt(e,10)],s=i[t.id];this.pages.push({texture:s})}),Object.keys(n.chars).forEach(e=>{const t=n.chars[e],{frame:s,source:r,rotate:a}=i[t.page],o=me.E.transformRectCoords(t,s,a,new _e.M),l=new ve.g({frame:o,orig:new _e.M(0,0,t.width,t.height),source:r,rotate:a});this.chars[e]={id:e.codePointAt(0),xOffset:t.xOffset,yOffset:t.yOffset,xAdvance:t.xAdvance,kerning:t.kerning??{},texture:l}}),this.baseRenderedFontSize=n.fontSize,this.baseMeasurementFontSize=n.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:n.fontSize},this.baseLineOffset=n.baseLineOffset,this.lineHeight=n.lineHeight,this.fontFamily=n.fontFamily,this.distanceField=n.distanceField??{type:"none",range:0},this.url=t}destroy(){super.destroy();for(let e=0;e<this.pages.length;e++){const{texture:t}=this.pages[e];t.destroy(!0)}this.pages=null}static install(e){be.c.install(e)}static uninstall(e){be.c.uninstall(e)}}const Te={test:e=>"string"==typeof e&&e.startsWith("info face="),parse(e){const t=e.match(/^[a-z]+\s+.+$/gm),i={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const e in t){const n=t[e].match(/^[a-z]+/gm)[0],s=t[e].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),r={};for(const e in s){const t=s[e].split("="),i=t[0],n=t[1].replace(/"/gm,""),a=parseFloat(n),o=isNaN(a)?n:a;r[i]=o}i[n].push(r)}const n={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[s]=i.info,[r]=i.common,[a]=i.distanceField??[];a&&(n.distanceField={range:parseInt(a.distanceRange,10),type:a.fieldType}),n.fontSize=parseInt(s.size,10),n.fontFamily=s.face,n.lineHeight=parseInt(r.lineHeight,10);const o=i.page;for(let e=0;e<o.length;e++)n.pages.push({id:parseInt(o[e].id,10)||0,file:o[e].file});const l={};n.baseLineOffset=n.lineHeight-parseInt(r.base,10);const h=i.char;for(let e=0;e<h.length;e++){const t=h[e],i=parseInt(t.id,10);let s=t.letter??t.char??String.fromCharCode(i);"space"===s&&(s=" "),l[i]=s,n.chars[s]={id:i,page:parseInt(t.page,10)||0,x:parseInt(t.x,10),y:parseInt(t.y,10),width:parseInt(t.width,10),height:parseInt(t.height,10),xOffset:parseInt(t.xoffset,10),yOffset:parseInt(t.yoffset,10),xAdvance:parseInt(t.xadvance,10),kerning:{}}}const u=i.kerning||[];for(let e=0;e<u.length;e++){const t=parseInt(u[e].first,10),i=parseInt(u[e].second,10),s=parseInt(u[e].amount,10);n.chars[l[i]].kerning[l[t]]=s}return n}},Se={test(e){const t=e;return"string"!=typeof t&&"getElementsByTagName"in t&&t.getElementsByTagName("page").length&&null!==t.getElementsByTagName("info")[0].getAttribute("face")},parse(e){const t={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},i=e.getElementsByTagName("info")[0],n=e.getElementsByTagName("common")[0],s=e.getElementsByTagName("distanceField")[0];s&&(t.distanceField={type:s.getAttribute("fieldType"),range:parseInt(s.getAttribute("distanceRange"),10)});const r=e.getElementsByTagName("page"),a=e.getElementsByTagName("char"),o=e.getElementsByTagName("kerning");t.fontSize=parseInt(i.getAttribute("size"),10),t.fontFamily=i.getAttribute("face"),t.lineHeight=parseInt(n.getAttribute("lineHeight"),10);for(let e=0;e<r.length;e++)t.pages.push({id:parseInt(r[e].getAttribute("id"),10)||0,file:r[e].getAttribute("file")});const l={};t.baseLineOffset=t.lineHeight-parseInt(n.getAttribute("base"),10);for(let e=0;e<a.length;e++){const i=a[e],n=parseInt(i.getAttribute("id"),10);let s=i.getAttribute("letter")??i.getAttribute("char")??String.fromCharCode(n);"space"===s&&(s=" "),l[n]=s,t.chars[s]={id:n,page:parseInt(i.getAttribute("page"),10)||0,x:parseInt(i.getAttribute("x"),10),y:parseInt(i.getAttribute("y"),10),width:parseInt(i.getAttribute("width"),10),height:parseInt(i.getAttribute("height"),10),xOffset:parseInt(i.getAttribute("xoffset"),10),yOffset:parseInt(i.getAttribute("yoffset"),10),xAdvance:parseInt(i.getAttribute("xadvance"),10),kerning:{}}}for(let e=0;e<o.length;e++){const i=parseInt(o[e].getAttribute("first"),10),n=parseInt(o[e].getAttribute("second"),10),s=parseInt(o[e].getAttribute("amount"),10);t.chars[l[n]].kerning[l[i]]=s}return t}},Ae={test:e=>!("string"!=typeof e||!e.includes("<font>"))&&Se.test(te.e.get().parseXML(e)),parse:e=>Se.parse(te.e.get().parseXML(e))},Ee=[".xml",".fnt"],Ce={extension:{type:Z.Ag.CacheParser,name:"cacheBitmapFont"},test:e=>e instanceof xe,getCacheableAssets(e,t){const i={};return e.forEach(e=>{i[e]=t,i[`${e}-bitmap`]=t}),i[`${t.fontFamily}-bitmap`]=t,i}},we={extension:{type:Z.Ag.LoadParser,priority:pe.T.Normal},name:"loadBitmapFont",id:"bitmap-font",test:e=>Ee.includes(ge.A.extname(e).toLowerCase()),testParse:async e=>Te.test(e)||Ae.test(e),async parse(e,t,i){const n=Te.test(e)?Te.parse(e):Ae.parse(e),{src:s}=t,{pages:r}=n,a=[],o=n.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let e=0;e<r.length;++e){const t=r[e].file;let i=ge.A.join(ge.A.dirname(s),t);i=(0,fe.Y)(i,s),a.push({src:i,data:o})}const l=await i.load(a),h=a.map(e=>l[e.src]);return new xe({data:n,textures:h},s)},async load(e,t){const i=await te.e.get().fetch(e);return await i.text()},async unload(e,t,i){await Promise.all(e.pages.map(e=>i.unload(e.texture.source._sourceOrigin))),e.destroy()}};var Pe=i(9731);class Ie{constructor(e,t=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=t}add(e){e.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const e=[],t=Math.min(this._assetList.length,this._maxConcurrent);for(let i=0;i<t;i++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}var Me=i(4068);const Re={extension:{type:Z.Ag.CacheParser,name:"cacheTextureArray"},test:e=>Array.isArray(e)&&e.every(e=>e instanceof ve.g),getCacheableAssets:(e,t)=>{const i={};return e.forEach(e=>{t.forEach((t,n)=>{i[e+(0===n?"":n+1)]=t})}),i}};async function Le(e){if("Image"in globalThis)return new Promise(t=>{const i=new Image;i.onload=()=>{t(!0)},i.onerror=()=>{t(!1)},i.src=e});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const t=await(await fetch(e)).blob();await createImageBitmap(t)}catch(e){return!1}return!0}return!1}const ke={extension:{type:Z.Ag.DetectionParser,priority:1},test:async()=>Le("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async e=>[...e,"avif"],remove:async e=>e.filter(e=>"avif"!==e)},De=["png","jpg","jpeg"],Oe={extension:{type:Z.Ag.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async e=>[...e,...De],remove:async e=>e.filter(e=>!De.includes(e))},Be="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Ge(e){if(Be)return!1;return""!==document.createElement("video").canPlayType(e)}const Fe={extension:{type:Z.Ag.DetectionParser,priority:0},test:async()=>Ge("video/mp4"),add:async e=>[...e,"mp4","m4v"],remove:async e=>e.filter(e=>"mp4"!==e&&"m4v"!==e)},Ue={extension:{type:Z.Ag.DetectionParser,priority:0},test:async()=>Ge("video/ogg"),add:async e=>[...e,"ogv"],remove:async e=>e.filter(e=>"ogv"!==e)},Ne={extension:{type:Z.Ag.DetectionParser,priority:0},test:async()=>Ge("video/webm"),add:async e=>[...e,"webm"],remove:async e=>e.filter(e=>"webm"!==e)},ze={extension:{type:Z.Ag.DetectionParser,priority:0},test:async()=>Le("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async e=>[...e,"webp"],remove:async e=>e.filter(e=>"webp"!==e)};var He=i(3865),Ve=i(5984);class We{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,t,i)=>(this._parsersValidated=!1,e[t]=i,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,t){const i={promise:null,parser:null};return i.promise=(async()=>{let n=null,s=null;if((t.parser||t.loadParser)&&(s=this._parserHash[t.parser||t.loadParser],t.loadParser&&(0,Pe.R)(`[Assets] "loadParser" is deprecated, use "parser" instead for ${e}`),s||(0,Pe.R)(`[Assets] specified load parser "${t.parser||t.loadParser}" not found while loading ${e}`)),!s){for(let i=0;i<this.parsers.length;i++){const n=this.parsers[i];if(n.load&&n.test?.(e,t,this)){s=n;break}}if(!s)return(0,Pe.R)(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}n=await s.load(e,t,this),i.parser=s;for(let e=0;e<this.parsers.length;e++){const s=this.parsers[e];s.parse&&s.parse&&await(s.testParse?.(n,t,this))&&(n=await s.parse(n,t,this)||n,i.parser=s)}return n})(),i}async load(e,t){this._parsersValidated||this._validateParsers();let i=0;const n={},s=(0,Ve.a)(e),r=(0,He.z)(e,e=>({alias:[e],src:e,data:{}})),a=r.length,o=r.map(async e=>{const s=ge.A.toAbsolute(e.src);if(!n[e.src])try{this.promiseCache[s]||(this.promiseCache[s]=this._getLoadPromiseAndParser(s,e)),n[e.src]=await this.promiseCache[s].promise,t&&t(++i/a)}catch(t){throw delete this.promiseCache[s],delete n[e.src],new Error(`[Loader.load] Failed to load ${s}.\n${t}`)}});return await Promise.all(o),s?n[r[0].src]:n}async unload(e){const t=(0,He.z)(e,e=>({alias:[e],src:e})).map(async e=>{const t=ge.A.toAbsolute(e.src),i=this.promiseCache[t];if(i){const n=await i.promise;delete this.promiseCache[t],await(i.parser?.unload?.(n,e,this))}});await Promise.all(t)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name||e.id).reduce((e,t)=>(t.name||t.id?(e[t.name]||e[t.id])&&(0,Pe.R)(`[Assets] parser id conflict "${t.id}"`):(0,Pe.R)("[Assets] parser should have an id"),e[t.name]=t,t.id&&(e[t.id]=t),e),{})}}function je(e,t){if(Array.isArray(t)){for(const i of t)if(e.startsWith(`data:${i}`))return!0;return!1}return e.startsWith(`data:${t}`)}function Xe(e,t){const i=e.split("?")[0],n=ge.A.extname(i).toLowerCase();return Array.isArray(t)?t.includes(n):n===t}const Ye={extension:{type:Z.Ag.LoadParser,priority:pe.T.Low},name:"loadJson",id:"json",test:e=>je(e,"application/json")||Xe(e,".json"),async load(e){const t=await te.e.get().fetch(e);return await t.json()}},Ke={name:"loadTxt",id:"text",extension:{type:Z.Ag.LoadParser,priority:pe.T.Low,name:"loadTxt"},test:e=>je(e,"text/plain")||Xe(e,".txt"),async load(e){const t=await te.e.get().fetch(e);return await t.text()}},qe=["normal","bold","100","200","300","400","500","600","700","800","900"],$e=[".ttf",".otf",".woff",".woff2"],Qe=["font/ttf","font/otf","font/woff","font/woff2"],Ze=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;const Je=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function et(e){return Je.test(e)?e:encodeURI(e)}const tt={extension:{type:Z.Ag.LoadParser,priority:pe.T.Low},name:"loadWebFont",id:"web-font",test:e=>je(e,Qe)||Xe(e,$e),async load(e,t){const i=te.e.get().getFontFaceSet();if(i){const n=[],s=t.data?.family??function(e){const t=ge.A.extname(e),i=ge.A.basename(e,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1));let n=i.length>0;for(const e of i)if(!e.match(Ze)){n=!1;break}let s=i.join(" ");return n||(s=`"${s.replace(/[\\"]/g,"\\$&")}"`),s}(e),r=t.data?.weights?.filter(e=>qe.includes(e))??["normal"],a=t.data??{};for(let t=0;t<r.length;t++){const o=r[t],l=new FontFace(s,`url(${et(e)})`,{...a,weight:o});await l.load(),i.add(l),n.push(l)}if(Me.l.has(`${s}-and-url`)){Me.l.get(`${s}-and-url`).entries.push({url:e,faces:n})}else Me.l.set(`${s}-and-url`,{entries:[{url:e,faces:n}]});return 1===n.length?n[0]:n}return(0,Pe.R)("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(e){const t=Array.isArray(e)?e:[e],i=t[0].family,n=Me.l.get(`${i}-and-url`),s=n.entries.find(e=>e.faces.some(e=>-1!==t.indexOf(e)));s.faces=s.faces.filter(e=>-1===t.indexOf(e)),0===s.faces.length&&(n.entries=n.entries.filter(e=>e!==s)),t.forEach(e=>{te.e.get().getFontFaceSet().delete(e)}),0===n.entries.length&&Me.l.remove(`${i}-and-url`)}};var it=i(8390),nt=i(7867),st=i(1891);function rt(e,t=1){const i=st.x.RETINA_PREFIX?.exec(e);return i?parseFloat(i[1]):t}function at(e,t,i){e.label=i,e._sourceOrigin=i;const n=new ve.g({source:e,label:i}),s=()=>{delete t.promiseCache[i],Me.l.has(i)&&Me.l.remove(i)};return n.source.once("destroy",()=>{t.promiseCache[i]&&((0,Pe.R)("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),s())}),n.once("destroy",()=>{e.destroyed||((0,Pe.R)("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),s())}),n}const ot={extension:{type:Z.Ag.LoadParser,priority:pe.T.Low,name:"loadSVG"},name:"loadSVG",id:"svg",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test:e=>je(e,"image/svg+xml")||Xe(e,".svg"),async load(e,t,i){return t.data?.parseAsGraphicsContext??this.config.parseAsGraphicsContext?async function(e){const t=await te.e.get().fetch(e),i=await t.text(),n=new nt.T;return n.svg(i),n}(e):async function(e,t,i,n){const s=await te.e.get().fetch(e),r=te.e.get().createImage();r.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(await s.text())}`,r.crossOrigin=n,await r.decode();const a=t.data?.width??r.width,o=t.data?.height??r.height,l=t.data?.resolution||rt(e),h=Math.ceil(a*l),u=Math.ceil(o*l),c=te.e.get().createCanvas(h,u),d=c.getContext("2d");d.imageSmoothingEnabled=!0,d.imageSmoothingQuality="high",d.drawImage(r,0,0,a*l,o*l);const{parseAsGraphicsContext:p,...f}=t.data??{};return at(new it.b({resource:c,alphaMode:"premultiply-alpha-on-upload",resolution:l,...f}),i,e)}(e,t,i,this.config.crossOrigin)},unload(e){e.destroy(!0)}};let lt=null;class ht{constructor(){lt||(lt=URL.createObjectURL(new Blob(['(function () {\n    \'use strict\';\n\n    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";\n    async function checkImageBitmap() {\n      try {\n        if (typeof createImageBitmap !== "function")\n          return false;\n        const response = await fetch(WHITE_PNG);\n        const imageBlob = await response.blob();\n        const imageBitmap = await createImageBitmap(imageBlob);\n        return imageBitmap.width === 1 && imageBitmap.height === 1;\n      } catch (_e) {\n        return false;\n      }\n    }\n    void checkImageBitmap().then((result) => {\n      self.postMessage(result);\n    });\n\n})();\n'],{type:"application/javascript"}))),this.worker=new Worker(lt)}}ht.revokeObjectURL=function(){lt&&(URL.revokeObjectURL(lt),lt=null)};let ut=null;class ct{constructor(){ut||(ut=URL.createObjectURL(new Blob(['(function () {\n    \'use strict\';\n\n    async function loadImageBitmap(url, alphaMode) {\n      const response = await fetch(url);\n      if (!response.ok) {\n        throw new Error(`[WorkerManager.loadImageBitmap] Failed to fetch ${url}: ${response.status} ${response.statusText}`);\n      }\n      const imageBlob = await response.blob();\n      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);\n    }\n    self.onmessage = async (event) => {\n      try {\n        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);\n        self.postMessage({\n          data: imageBitmap,\n          uuid: event.data.uuid,\n          id: event.data.id\n        }, [imageBitmap]);\n      } catch (e) {\n        self.postMessage({\n          error: e,\n          uuid: event.data.uuid,\n          id: event.data.id\n        });\n      }\n    };\n\n})();\n'],{type:"application/javascript"}))),this.worker=new Worker(ut)}}ct.revokeObjectURL=function(){ut&&(URL.revokeObjectURL(ut),ut=null)};let dt,pt=0;const ft=new class{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return void 0!==this._isImageBitmapSupported||(this._isImageBitmapSupported=new Promise(e=>{const{worker:t}=new ht;t.addEventListener("message",i=>{t.terminate(),ht.revokeObjectURL(),e(i.data)})})),this._isImageBitmapSupported}loadImageBitmap(e,t){return this._run("loadImageBitmap",[e,t?.data?.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){void 0===dt&&(dt=navigator.hardwareConcurrency||4);let e=this._workerPool.pop();return!e&&this._createdWorkers<dt&&(this._createdWorkers++,e=(new ct).worker,e.addEventListener("message",e=>{this._complete(e.data),this._returnWorker(e.target),this._next()})),e}_returnWorker(e){this._workerPool.push(e)}_complete(e){void 0!==e.error?this._resolveHash[e.uuid].reject(e.error):this._resolveHash[e.uuid].resolve(e.data),this._resolveHash[e.uuid]=null}async _run(e,t){await this._initWorkers();const i=new Promise((i,n)=>{this._queue.push({id:e,arguments:t,resolve:i,reject:n})});return this._next(),i}_next(){if(!this._queue.length)return;const e=this._getWorker();if(!e)return;const t=this._queue.pop(),i=t.id;this._resolveHash[pt]={resolve:t.resolve,reject:t.reject},e.postMessage({data:t.arguments,uuid:pt++,id:i})}reset(){this._workerPool.forEach(e=>e.terminate()),this._workerPool.length=0,Object.values(this._resolveHash).forEach(({reject:e})=>{e?.(new Error("WorkerManager destroyed"))}),this._resolveHash={},this._queue.length=0,this._initialized=!1,this._createdWorkers=0}},gt=[".jpeg",".jpg",".png",".webp",".avif"],mt=["image/jpeg","image/png","image/webp","image/avif"];const _t={name:"loadTextures",id:"texture",extension:{type:Z.Ag.LoadParser,priority:pe.T.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test:e=>je(e,mt)||Xe(e,gt),async load(e,t,i){let n=null;n=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await ft.isImageBitmapSupported()?await ft.loadImageBitmap(e,t):await async function(e,t){const i=await te.e.get().fetch(e);if(!i.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${e}: ${i.status} ${i.statusText}`);const n=await i.blob();return"premultiplied-alpha"===t?.data?.alphaMode?createImageBitmap(n,{premultiplyAlpha:"none"}):createImageBitmap(n)}(e,t):await new Promise((t,i)=>{n=te.e.get().createImage(),n.crossOrigin=this.config.crossOrigin,n.src=e,n.complete?t(n):(n.onload=()=>{t(n)},n.onerror=i)});return at(new it.b({resource:n,alphaMode:"premultiply-alpha-on-upload",resolution:t.data?.resolution||rt(e),...t.data}),i,e)},unload(e){e.destroy(!0)}};var vt=i(9764),yt=i(969);const bt=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"];let xt,Tt;function St(e,t,i){void 0!==i||t.startsWith("data:")?!1!==i&&(e.crossOrigin="string"==typeof i?i:"anonymous"):e.crossOrigin=function(e,t=globalThis.location){if(e.startsWith("data:"))return"";t||(t=globalThis.location);const i=new URL(e,document.baseURI);if(i.hostname!==t.hostname||i.port!==t.port||i.protocol!==t.protocol)return"anonymous";return""}(t)}const At={name:"loadVideo",id:"video",extension:{type:Z.Ag.LoadParser,name:"loadVideo"},test(e){if(!xt||!Tt){const{validVideoExtensions:e,validVideoMime:t}=function(){const e=[],t=[];for(const i of bt){const n=vt.$.MIME_TYPES[i.substring(1)]||`video/${i.substring(1)}`;Ge(n)&&(e.push(i),t.includes(n)||t.push(n))}return{validVideoExtensions:e,validVideoMime:t}}();xt=e,Tt=t}const t=je(e,Tt),i=Xe(e,xt);return t||i},async load(e,t,i){const n={...vt.$.defaultOptions,resolution:t.data?.resolution||rt(e),alphaMode:t.data?.alphaMode||await(0,yt.C)(),...t.data},s=document.createElement("video"),r={preload:!1!==n.autoLoad?"auto":void 0,"webkit-playsinline":!1!==n.playsinline?"":void 0,playsinline:!1!==n.playsinline?"":void 0,muted:!0===n.muted?"":void 0,loop:!0===n.loop?"":void 0,autoplay:!1!==n.autoPlay?"":void 0};Object.keys(r).forEach(e=>{const t=r[e];void 0!==t&&s.setAttribute(e,t)}),!0===n.muted&&(s.muted=!0),St(s,e,n.crossorigin);const a=document.createElement("source");let o;if(n.mime)o=n.mime;else if(e.startsWith("data:"))o=e.slice(5,e.indexOf(";"));else if(!e.startsWith("blob:")){const t=e.split("?")[0].slice(e.lastIndexOf(".")+1).toLowerCase();o=vt.$.MIME_TYPES[t]||`video/${t}`}return a.src=e,o&&(a.type=o),new Promise(r=>{const o=async()=>{const a=new vt.$({...n,resource:s});var l;s.removeEventListener("canplay",o),t.data.preload&&await(l=s,new Promise((e,t)=>{function i(){s(),e()}function n(e){s(),t(e)}function s(){l.removeEventListener("canplaythrough",i),l.removeEventListener("error",n)}l.addEventListener("canplaythrough",i),l.addEventListener("error",n),l.load()})),r(at(a,i,e))};n.preload&&!n.autoPlay&&s.load(),s.addEventListener("canplay",o),s.appendChild(a)})},unload(e){e.destroy(!0)}},Et={extension:{type:Z.Ag.ResolveParser,name:"resolveTexture"},test:_t.test,parse:e=>({resolution:parseFloat(st.x.RETINA_PREFIX.exec(e)?.[1]??"1"),format:e.split(".").pop(),src:e})},Ct={extension:{type:Z.Ag.ResolveParser,priority:-2,name:"resolveJson"},test:e=>st.x.RETINA_PREFIX.test(e)&&e.endsWith(".json"),parse:Et.parse};const wt=new class{constructor(){this._detections=[],this._initialized=!1,this.resolver=new st.x,this.loader=new We,this.cache=Me.l,this._backgroundLoader=new Ie(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){if(this._initialized)return void(0,Pe.R)("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let t=e.manifest;"string"==typeof t&&(t=await this.load(t)),this.resolver.addManifest(t)}const t=e.texturePreference?.resolution??1,i="number"==typeof t?[t]:t,n=await this._detectFormats({preferredFormats:e.texturePreference?.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:n,resolution:i}}),e.preferences&&this.setPreferences(e.preferences)}add(e){this.resolver.add(e)}async load(e,t){this._initialized||await this.init();const i=(0,Ve.a)(e),n=(0,He.z)(e).map(e=>{if("string"!=typeof e){const t=this.resolver.getAlias(e);return t.some(e=>!this.resolver.hasKey(e))&&this.add(e),Array.isArray(t)?t[0]:t}return this.resolver.hasKey(e)||this.add({alias:e,src:e}),e}),s=this.resolver.resolve(n),r=await this._mapLoadToResolve(s,t);return i?r[n[0]]:r}addBundle(e,t){this.resolver.addBundle(e,t)}async loadBundle(e,t){this._initialized||await this.init();let i=!1;"string"==typeof e&&(i=!0,e=[e]);const n=this.resolver.resolveBundle(e),s={},r=Object.keys(n);let a=0,o=0;const l=()=>{t?.(++a/o)},h=r.map(e=>{const t=n[e],i=Object.values(t),r=[...new Set(i.flat())];return o+=r.length,this._mapLoadToResolve(t,l).then(t=>{s[e]=t})});return await Promise.all(h),i?s[e[0]]:s}async backgroundLoad(e){this._initialized||await this.init(),"string"==typeof e&&(e=[e]);const t=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(t))}async backgroundLoadBundle(e){this._initialized||await this.init(),"string"==typeof e&&(e=[e]);const t=this.resolver.resolveBundle(e);Object.values(t).forEach(e=>{this._backgroundLoader.add(Object.values(e))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if("string"==typeof e)return Me.l.get(e);const t={};for(let i=0;i<e.length;i++)t[i]=Me.l.get(e[i]);return t}async _mapLoadToResolve(e,t){const i=[...new Set(Object.values(e))];this._backgroundLoader.active=!1;const n=await this.loader.load(i,t);this._backgroundLoader.active=!0;const s={};return i.forEach(e=>{const t=n[e.src],i=[e.src];e.alias&&i.push(...e.alias),i.forEach(e=>{s[e]=t}),Me.l.set(i,t)}),s}async unload(e){this._initialized||await this.init();const t=(0,He.z)(e).map(e=>"string"!=typeof e?e.src:e),i=this.resolver.resolve(t);await this._unloadFromResolved(i)}async unloadBundle(e){this._initialized||await this.init(),e=(0,He.z)(e);const t=this.resolver.resolveBundle(e),i=Object.keys(t).map(e=>this._unloadFromResolved(t[e]));await Promise.all(i)}async _unloadFromResolved(e){const t=Object.values(e);t.forEach(e=>{Me.l.remove(e.src)}),await this.loader.unload(t)}async _detectFormats(e){let t=[];e.preferredFormats&&(t=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]);for(const i of e.detections)e.skipDetections||await i.test()?t=await i.add(t):e.skipDetections||(t=await i.remove(t));return t=t.filter((e,i)=>t.indexOf(e)===i),t}get detections(){return this._detections}setPreferences(e){this.loader.parsers.forEach(t=>{t.config&&Object.keys(t.config).filter(t=>t in e).forEach(i=>{t.config[i]=e[i]})})}};Z.XO.handleByList(Z.Ag.LoadParser,wt.loader.parsers).handleByList(Z.Ag.ResolveParser,wt.resolver.parsers).handleByList(Z.Ag.CacheParser,wt.cache.parsers).handleByList(Z.Ag.DetectionParser,wt.detections),Z.XO.add(Re,Oe,ke,ze,Fe,Ue,Ne,Ye,Ke,tt,ot,_t,At,we,Ce,Et,Ct);const Pt={loader:Z.Ag.LoadParser,resolver:Z.Ag.ResolveParser,cache:Z.Ag.CacheParser,detection:Z.Ag.DetectionParser};Z.XO.handle(Z.Ag.Asset,e=>{const t=e.ref;Object.entries(Pt).filter(([e])=>!!t[e]).forEach(([e,i])=>Z.XO.add(Object.assign(t[e],{extension:t[e].extension??i})))},e=>{const t=e.ref;Object.keys(Pt).filter(e=>!!t[e]).forEach(e=>Z.XO.remove(t[e]))});var It=i(7747),Mt=i(1862),Rt=i(9998),Lt=i(2245),kt=i(3381);const Dt={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},Ot=["in vec2 vBlurTexCoords[%size%];","uniform sampler2D uTexture;","out vec4 finalColor;","void main(void)","{","    finalColor = vec4(0.0);","    %blur%","}"].join("\n");function Bt(e,t){const i=function(e,t){const i=Math.ceil(e/2);let n,s="\n    in vec2 aPosition;\n\n    uniform float uStrength;\n\n    out vec2 vBlurTexCoords[%size%];\n\n    uniform vec4 uInputSize;\n    uniform vec4 uOutputFrame;\n    uniform vec4 uOutputTexture;\n\n    vec4 filterVertexPosition( void )\n{\n    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;\n\n    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;\n    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;\n\n    return vec4(position, 0.0, 1.0);\n}\n\n    vec2 filterTextureCoord( void )\n    {\n        return aPosition * (uOutputFrame.zw * uInputSize.zw);\n    }\n\n    void main(void)\n    {\n        gl_Position = filterVertexPosition();\n\n        float pixelStrength = uInputSize.%dimension% * uStrength;\n\n        vec2 textureCoord = filterTextureCoord();\n        %blur%\n    }",r="";n=t?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * pixelStrength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * pixelStrength);";for(let t=0;t<e;t++){let e=n.replace("%index%",t.toString());e=e.replace("%sampleIndex%",t-(i-1)+".0"),r+=e,r+="\n"}return s=s.replace("%blur%",r),s=s.replace("%size%",e.toString()),s=s.replace("%dimension%",t?"z":"w"),s}(t,e),n=function(e){const t=Dt[e],i=t.length;let n,s=Ot,r="";for(let s=0;s<e;s++){let a="finalColor += texture(uTexture, vBlurTexCoords[%index%]) * %value%;".replace("%index%",s.toString());n=s,s>=i&&(n=e-s-1),a=a.replace("%value%",t[n].toString()),r+=a,r+="\n"}return s=s.replace("%blur%",r),s=s.replace("%size%",e.toString()),s}(t);return kt.M.from({vertex:i,fragment:n,name:`blur-${e?"horizontal":"vertical"}-pass-filter`})}var Gt=i(1980);const Ft=class e extends Lt.d{constructor(t){super({glProgram:Bt((t={...e.defaultOptions,...t}).horizontal,t.kernelSize),gpuProgram:function(e,t){const i=Dt[t],n=i.length,s=[],r=[],a=[];for(let o=0;o<t;o++){s[o]=`@location(${o}) offset${o}: vec2<f32>,`,r[o]=e?`filteredCord + vec2(${o-n+1} * pixelStrength, 0.0),`:`filteredCord + vec2(0.0, ${o-n+1} * pixelStrength),`;const l=i[o<n?o:t-o-1].toString();a[o]=`finalColor += textureSample(uTexture, uSampler, offset${o}) * ${l};`}const o=s.join("\n"),l=r.join("\n"),h=a.join("\n"),u="\n\nstruct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,\n};\n\nstruct BlurUniforms {\n  uStrength:f32,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n@group(0) @binding(1) var uTexture: texture_2d<f32>;\n@group(0) @binding(2) var uSampler : sampler;\n\n@group(1) @binding(0) var<uniform> blurUniforms : BlurUniforms;\n\n\nstruct VSOutput {\n    @builtin(position) position: vec4<f32>,\n    %blur-struct%\n  };\n\nfn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>\n{\n    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;\n\n    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;\n    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;\n\n    return vec4(position, 0.0, 1.0);\n}\n\nfn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>\n{\n    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);\n}\n\nfn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>\n{\n  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  \n}\n\nfn getSize() -> vec2<f32>\n{\n  return gfu.uGlobalFrame.zw;\n}\n\n\n@vertex\nfn mainVertex(\n  @location(0) aPosition : vec2<f32>, \n) -> VSOutput {\n\n  let filteredCord = filterTextureCoord(aPosition);\n\n  let pixelStrength = gfu.uInputSize.%dimension% * blurUniforms.uStrength;\n\n  return VSOutput(\n   filterVertexPosition(aPosition),\n    %blur-vertex-out%\n  );\n}\n\n@fragment\nfn mainFragment(\n  @builtin(position) position: vec4<f32>,\n  %blur-fragment-in%\n) -> @location(0) vec4<f32> {\n\n    var   finalColor = vec4(0.0);\n\n    %blur-sampling%\n\n    return finalColor;\n}".replace("%blur-struct%",o).replace("%blur-vertex-out%",l).replace("%blur-fragment-in%",o).replace("%blur-sampling%",h).replace("%dimension%",e?"z":"w");return Gt.B.from({vertex:{source:u,entryPoint:"mainVertex"},fragment:{source:u,entryPoint:"mainFragment"}})}(t.horizontal,t.kernelSize),resources:{blurUniforms:{uStrength:{value:0,type:"f32"}}},...t}),this.horizontal=t.horizontal,this._quality=0,this.quality=t.quality,this.blur=t.strength,this._uniforms=this.resources.blurUniforms.uniforms}apply(e,t,i,n){if(this._uniforms.uStrength=this.strength/this.passes,1===this.passes)e.applyFilter(this,t,i,n);else{const s=Mt.W.getSameSizeTexture(t);let r=t,a=s;this._state.blend=!1;const o=e.renderer.type===Rt.W.WEBGPU;for(let t=0;t<this.passes-1;t++){e.applyFilter(this,r,a,0===t||o);const i=a;a=r,r=i}this._state.blend=!0,e.applyFilter(this,r,i,n),Mt.W.returnTexture(s)}}get blur(){return this.strength}set blur(e){this.padding=1+2*Math.abs(e),this.strength=e}get quality(){return this._quality}set quality(e){this._quality=e,this.passes=e}};Ft.defaultOptions={strength:8,quality:4,kernelSize:5};let Ut=Ft;class Nt extends Lt.d{constructor(...e){let t=e[0]??{};"number"==typeof t&&((0,ue.t6)(ue.lj,"BlurFilter constructor params are now options object. See params: { strength, quality, resolution, kernelSize }"),t={strength:t},void 0!==e[1]&&(t.quality=e[1]),void 0!==e[2]&&(t.resolution=e[2]||"inherit"),void 0!==e[3]&&(t.kernelSize=e[3])),t={...Ut.defaultOptions,...t};const{strength:i,strengthX:n,strengthY:s,quality:r,...a}=t;super({...a,compatibleRenderers:Rt.W.BOTH,resources:{}}),this._repeatEdgePixels=!1,this.blurXFilter=new Ut({horizontal:!0,...t}),this.blurYFilter=new Ut({horizontal:!1,...t}),this.quality=r,this.strengthX=n??i,this.strengthY=s??i,this.repeatEdgePixels=!1}apply(e,t,i,n){const s=Math.abs(this.blurXFilter.strength),r=Math.abs(this.blurYFilter.strength);if(s&&r){const s=Mt.W.getSameSizeTexture(t);this.blurXFilter.blendMode="normal",this.blurXFilter.apply(e,t,s,!0),this.blurYFilter.blendMode=this.blendMode,this.blurYFilter.apply(e,s,i,n),Mt.W.returnTexture(s)}else r?(this.blurYFilter.blendMode=this.blendMode,this.blurYFilter.apply(e,t,i,n)):(this.blurXFilter.blendMode=this.blendMode,this.blurXFilter.apply(e,t,i,n))}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.blur),Math.abs(this.blurYFilter.blur))}get strength(){if(this.strengthX!==this.strengthY)throw new Error("BlurFilter's strengthX and strengthY are different");return this.strengthX}set strength(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(e){this.blurXFilter.quality=this.blurYFilter.quality=e}get strengthX(){return this.blurXFilter.blur}set strengthX(e){this.blurXFilter.blur=e,this.updatePadding()}get strengthY(){return this.blurYFilter.blur}set strengthY(e){this.blurYFilter.blur=e,this.updatePadding()}get blur(){return(0,ue.t6)("8.3.0","BlurFilter.blur is deprecated, please use BlurFilter.strength instead."),this.strength}set blur(e){(0,ue.t6)("8.3.0","BlurFilter.blur is deprecated, please use BlurFilter.strength instead."),this.strength=e}get blurX(){return(0,ue.t6)("8.3.0","BlurFilter.blurX is deprecated, please use BlurFilter.strengthX instead."),this.strengthX}set blurX(e){(0,ue.t6)("8.3.0","BlurFilter.blurX is deprecated, please use BlurFilter.strengthX instead."),this.strengthX=e}get blurY(){return(0,ue.t6)("8.3.0","BlurFilter.blurY is deprecated, please use BlurFilter.strengthY instead."),this.strengthY}set blurY(e){(0,ue.t6)("8.3.0","BlurFilter.blurY is deprecated, please use BlurFilter.strengthY instead."),this.strengthY=e}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(e){this._repeatEdgePixels=e,this.updatePadding()}}Nt.defaultOptions={strength:8,quality:4,kernelSize:5};var zt=i(1828),Ht=(i(3630),i(3289)),Vt=i(5231),Wt=i(5337),jt=i(7313),Xt=i(822);class Yt extends Xt.l{constructor(e,t){const{text:i,resolution:n,style:s,anchor:r,width:a,height:o,roundPixels:l,...h}=e;super({...h}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=t,this.text=i??"",this.style=s,this.resolution=n??null,this.allowChildren=!1,this._anchor=new jt.o({_onUpdate:()=>{this.onViewUpdate()}}),r&&(this.anchor=r),this.roundPixels=l??!1,void 0!==a&&(this.width=a),void 0!==o&&(this.height=o)}get anchor(){return this._anchor}set anchor(e){"number"==typeof e?this._anchor.set(e):this._anchor.copyFrom(e)}set text(e){e=e.toString(),this._text!==e&&(this._text=e,this.onViewUpdate())}get text(){return this._text}set resolution(e){this._autoResolution=null===e,this._resolution=e,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(e){e||(e={}),this._style?.off("update",this.onViewUpdate,this),e instanceof this._styleClass?this._style=e:this._style=new this._styleClass(e),this._style.on("update",this.onViewUpdate,this),this.onViewUpdate()}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(e){this._setWidth(e,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(e){this._setHeight(e,this.bounds.height)}getSize(e){return e||(e={}),e.width=Math.abs(this.scale.x)*this.bounds.width,e.height=Math.abs(this.scale.y)*this.bounds.height,e}setSize(e,t){"object"==typeof e?(t=e.height??e.width,e=e.width):t??(t=e),void 0!==e&&this._setWidth(e,this.bounds.width),void 0!==t&&this._setHeight(t,this.bounds.height)}containsPoint(e){const t=this.bounds.width,i=this.bounds.height,n=-t*this.anchor.x;let s=0;return e.x>=n&&e.x<=n+t&&(s=-i*this.anchor.y,e.y>=s&&e.y<=s+i)}onViewUpdate(){this.didViewUpdate||(this._didTextUpdate=!0),super.onViewUpdate()}destroy(e=!1){super.destroy(e),this.owner=null,this._bounds=null,this._anchor=null,("boolean"==typeof e?e:e?.style)&&this._style.destroy(e),this._style=null,this._text=null}get styleKey(){return`${this._text}:${this._style.styleKey}:${this._resolution}`}}function Kt(e,t){let i=e[0]??{};return("string"==typeof i||e[1])&&((0,ue.t6)(ue.lj,`use new ${t}({ text: "hi!", style }) instead`),i={text:i,style:e[1]}),i}var qt=i(4984);class $t extends Yt{constructor(...e){var t;const i=Kt(e,"BitmapText");i.style??(i.style=i.style||{}),(t=i.style).fill??(t.fill=16777215),super(i,qt.x),this.renderPipeId="bitmapText"}updateBounds(){const e=this._bounds,t=this._anchor,i=be.c.measureText(this.text,this._style),n=i.scale,s=i.offsetY*n;let r=i.width*n,a=i.height*n;const o=this._style._stroke;o&&(r+=o.width,a+=o.width),e.minX=-t._x*r,e.maxX=e.minX+r,e.minY=-t._y*(a+s),e.maxY=e.minY+a}set resolution(e){null!==e&&(0,Pe.R)("[BitmapText] dynamically updating the resolution is not supported. Resolution should be managed by the BitmapFont.")}get resolution(){return this._resolution}}var Qt=i(1819);function Zt(e){const t=e._stroke,i=e._fill,n=[`div { ${[`color: ${It.Q.shared.setValue(i.color).toHex()}`,`font-size: ${e.fontSize}px`,`font-family: ${e.fontFamily}`,`font-weight: ${e.fontWeight}`,`font-style: ${e.fontStyle}`,`font-variant: ${e.fontVariant}`,`letter-spacing: ${e.letterSpacing}px`,`text-align: ${e.align}`,`padding: ${e.padding}px`,`white-space: ${"pre"===e.whiteSpace&&e.wordWrap?"pre-wrap":e.whiteSpace}`,...e.lineHeight?[`line-height: ${e.lineHeight}px`]:[],...e.wordWrap?["word-wrap: "+(e.breakWords?"break-all":"break-word"),`max-width: ${e.wordWrapWidth}px`]:[],...t?[ei(t)]:[],...e.dropShadow?[Jt(e.dropShadow)]:[],...e.cssOverrides].join(";")} }`];return function(e,t){for(const i in e){const n=e[i],s=[];for(const e in n)ii[e]?s.push(ii[e](n[e])):ti[e]&&s.push(ti[e].replace("{{VALUE}}",n[e]));t.push(`${i} { ${s.join(";")} }`)}}(e.tagStyles,n),n.join(" ")}function Jt(e){const t=It.Q.shared.setValue(e.color).setAlpha(e.alpha).toHexa(),i=`${Math.round(Math.cos(e.angle)*e.distance)}px ${Math.round(Math.sin(e.angle)*e.distance)}px`;return e.blur>0?`text-shadow: ${i} ${e.blur}px ${t}`:`text-shadow: ${i} ${t}`}function ei(e){return[`-webkit-text-stroke-width: ${e.width}px`,`-webkit-text-stroke-color: ${It.Q.shared.setValue(e.color).toHex()}`,`text-stroke-width: ${e.width}px`,`text-stroke-color: ${It.Q.shared.setValue(e.color).toHex()}`,"paint-order: stroke"].join(";")}const ti={fontSize:"font-size: {{VALUE}}px",fontFamily:"font-family: {{VALUE}}",fontWeight:"font-weight: {{VALUE}}",fontStyle:"font-style: {{VALUE}}",fontVariant:"font-variant: {{VALUE}}",letterSpacing:"letter-spacing: {{VALUE}}px",align:"text-align: {{VALUE}}",padding:"padding: {{VALUE}}px",whiteSpace:"white-space: {{VALUE}}",lineHeight:"line-height: {{VALUE}}px",wordWrapWidth:"max-width: {{VALUE}}px"},ii={fill:e=>`color: ${It.Q.shared.setValue(e).toHex()}`,breakWords:e=>"word-wrap: "+(e?"break-all":"break-word"),stroke:ei,dropShadow:Jt};class ni extends qt.x{constructor(e={}){super(e),this._cssOverrides=[],this.cssOverrides=e.cssOverrides??[],this.tagStyles=e.tagStyles??{}}set cssOverrides(e){this._cssOverrides=e instanceof Array?e:[e],this.update()}get cssOverrides(){return this._cssOverrides}update(){this._cssStyle=null,super.update()}clone(){return new ni({align:this.align,breakWords:this.breakWords,dropShadow:this.dropShadow?{...this.dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth,cssOverrides:this.cssOverrides,tagStyles:{...this.tagStyles}})}get cssStyle(){return this._cssStyle||(this._cssStyle=Zt(this)),this._cssStyle}addOverride(...e){const t=e.filter(e=>!this.cssOverrides.includes(e));t.length>0&&(this.cssOverrides.push(...t),this.update())}removeOverride(...e){const t=e.filter(e=>this.cssOverrides.includes(e));t.length>0&&(this.cssOverrides=this.cssOverrides.filter(e=>!t.includes(e)),this.update())}set fill(e){"string"!=typeof e&&"number"!=typeof e&&(0,Pe.R)("[HTMLTextStyle] only color fill is not supported by HTMLText"),super.fill=e}set stroke(e){e&&"string"!=typeof e&&"number"!=typeof e&&(0,Pe.R)("[HTMLTextStyle] only color stroke is not supported by HTMLText"),super.stroke=e}}var si=i(8132);class ri extends Yt{constructor(...e){const t=Kt(e,"HtmlText");super(t,ni),this.renderPipeId="htmlText",t.textureStyle&&(this.textureStyle=t.textureStyle instanceof Qt.n?t.textureStyle:new Qt.n(t.textureStyle))}updateBounds(){const e=this._bounds,t=this._anchor,i=(0,si.r)(this.text,this._style),{width:n,height:s}=i;e.minX=-t._x*n,e.maxX=e.minX+n,e.minY=-t._y*s,e.maxY=e.minY+s}get text(){return this._text}set text(e){const t=this._sanitiseText(e.toString());super.text=t}_sanitiseText(e){return this._removeInvalidHtmlTags(e.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;"))}_removeInvalidHtmlTags(e){return e.replace(/<[^>]*?(?=<|$)/g,"")}}var ai=i(4214),oi=i(8593);class li extends Yt{constructor(...e){const t=Kt(e,"Text");super(t,qt.x),this.renderPipeId="text",t.textureStyle&&(this.textureStyle=t.textureStyle instanceof Qt.n?t.textureStyle:new Qt.n(t.textureStyle))}updateBounds(){const e=this._bounds,t=this._anchor;let i=0,n=0;if(this._style.trim){const{frame:e,canvasAndContext:t}=ai.v.getCanvasAndContext({text:this.text,style:this._style,resolution:1});ai.v.returnCanvasAndContext(t),i=e.width,n=e.height}else{const e=oi.P.measureText(this._text,this._style);i=e.width,n=e.height}e.minX=-t._x*i,e.maxX=e.minX+i,e.minY=-t._y*n,e.maxY=e.minY+n}}var hi=i(379);Z.XO.add(J,ee);class ui{static getDocumentSize(){return new zt.b(Math.max(document.documentElement.clientWidth,window.innerWidth),Math.max(document.documentElement.clientHeight,window.innerHeight))}static createElementFromHTMLString(e){var t=document.createElement("div");return t.innerHTML=e.trim(),t.firstChild}static checkIfElementIsParentOf(e,t,i=50){let n=!1,s=0,r=e.parentNode;for(;r;){if(r===t){n=!0;break}if(r=r.parentElement,s++,s>=i)break}return n}static scaleElement(e,t){e.style.transform=`scale(${t})`,e.style["transform-origin"]="0 0",e.style["-ms-zoom"]=t,e.style["-moz-transform"]=`scale(${t})`,e.style["-moz-transform-origin"]="0 0",e.style["-o-transform"]=`scale(${t})`,e.style["-o-transform-origin"]="0 0",e.style["-webkit-transform"]=`scale(${t})`,e.style["-webkit-transform-origin"]="0 0"}}const ci="DATA_CHANGE",di="KEY_DOWN",pi="KEY_UP",fi="STAGE_DOWN",gi="STAGE_UP",mi="MOUSE_WHEEL";class _i{constructor(e){this.nativeEvent=e}}class vi extends c{constructor(...e){super(...e),this.pressedKeyCodes={},this.prevPressedKeyCodes={},this.justPressedKeyCodes={},this.justReleasedKeyCodes={}}addListeners(){super.addListeners();var e=document;this.eventListenerHelper.addEventListener(e,L.KEY_DOWN,this.onKeyDown),this.eventListenerHelper.addEventListener(e,L.KEY_UP,this.onKeyUp),this.eventListenerHelper.addEventListener(e,m.MOUSE_WHEEL,this.onMouseWheel),this.eventListenerHelper.addEventListener(Cn.instance.stage,Dn.DOWN,this.onStageDown),this.eventListenerHelper.addEventListener(Cn.instance.stage,Dn.UP,this.onStageUp),Cn.instance.ticker.add(this.onTick,this)}removeListeners(){super.removeListeners(),Cn.instance.ticker.remove(this.onTick,this)}onMouseWheel(e){this.dispatchEvent(mi,e)}onStageUp(){this.lastGlobalInteractionPos=Cn.instance.getGlobalInteractionPosition(),this.dispatchEvent(gi,this.lastGlobalInteractionPos)}onStageDown(){this.lastGlobalInteractionPos=Cn.instance.getGlobalInteractionPosition(),this.dispatchEvent(fi,this.lastGlobalInteractionPos)}onTick(){this.updateInput()}onKeyDown(e){this.pressedKeyCodes[e.code]||(this.pressedKeyCodes[e.code]=!0,this.isDataChanged=!0),this.updateInput();let t=new _i(e||window.event);t.nativeKeyboardEvent=t.nativeEvent,this.dispatchEvent(di,t)}onKeyUp(e){this.pressedKeyCodes[e.code]&&(this.pressedKeyCodes[e.code]=!1,this.isDataChanged=!0),this.updateInput();let t=new _i(e||window.event);t.nativeKeyboardEvent=t.nativeEvent,this.dispatchEvent(pi,t)}updateInput(){if(this.isDataChanged){var e;for(e in this.isDataChanged=!1,this.pressedKeyCodes)this.pressedKeyCodes[e]&&!this.prevPressedKeyCodes[e]?this.justPressedKeyCodes[e]=!0:this.justPressedKeyCodes[e]=!1,!this.pressedKeyCodes[e]&&this.prevPressedKeyCodes[e]?this.justReleasedKeyCodes[e]=!0:this.justReleasedKeyCodes[e]=!1,this.prevPressedKeyCodes[e]=this.pressedKeyCodes[e];this.dispatchEvent(ci)}}checkIfKeyCodeJustPressed(e){return this.justPressedKeyCodes[e]}checkIfKeyCodeJustReleased(e){return this.justReleasedKeyCodes[e]}checkIfKeyCodeDown(e){return this.pressedKeyCodes[e]}checkIfAnyCodeDown(e){return e.some(e=>!!this.pressedKeyCodes[e])}checkIfAnyCodeJustPressed(e){return e.some(e=>!!this.justPressedKeyCodes[e])}checkIfAnyCodeJustReleased(e){return e.some(e=>!!this.justReleasedKeyCodes[e])}getLastGlobalInteractionPos(){return this.lastGlobalInteractionPos}static get instance(){return vi._instance||(vi._instance=new vi),vi._instance}}const yi="default",bi="font",xi="sound",Ti="image",Si="spritesheet",Ai="spine";class Ei{constructor(){this.fileTypeToLoadItemClassMap={}}createItem(e){return this.prepareConfig(e),this.internalCreateItem(e)}internalCreateItem(e){let t=this.fileTypeToLoadItemClassMap[e.fileType];t||(t=this.fileTypeToLoadItemClassMap[yi]);return new t(e)}prepareConfig(e){e.basePath||this.basePath&&(e.basePath=this.basePath);const t=D(an);e.basePath&&(e.basePath=t.substituteUrlPlaceholders(e.basePath)),e.src&&(e.src=t.substituteUrlPlaceholders(e.src))}}class Ci{static getUniqueLoadingId(e){return e.src+"_"+e.uniqueId}}class wi{constructor(){this.items=new r,this.itemsToLoad=new r,this.loadedItems=new r}add(e){this.isNeedSort=!0,this.items.push(e,Ci.getUniqueLoadingId(e.config)),this.itemsToLoad.push(e,Ci.getUniqueLoadingId(e.config))}get(e){const t=Ci.getUniqueLoadingId(e);return this.items.getItem(t)}getNextToLoad(){return this.isNeedSort&&this.sortItems(),this.itemsToLoad.getItemByIndex(0)}sortItems(){this.itemsToLoad.sort((e,t)=>{let i=0;return e.config.priority&&t.config.priority&&(e.config.priority>t.config.priority?i=-1:e.config.priority<t.config.priority&&(i=1)),i})}onItemLoad(e){-1!==this.items.indexOf(e)&&(this.itemsToLoad.remove(e),this.loadedItems.push(e,Ci.getUniqueLoadingId(e.config)))}}var Pi;!function(e){e.WAIT="WAIT",e.LOADING="LOADING",e.COMPLETE="COMPLETE",e.ERROR="ERROR"}(Pi||(Pi={}));const Ii="LoadStatusEvent.STATUS_CHANGE",Mi="LoadEvent.START",Ri="LoadEvent.PROGRESS",Li="LoadEvent.COMPLETE",ki="LoadEvent.ERROR",Di=(()=>{const e={};return e[Pi.ERROR]=1e3,e[Pi.LOADING]=100,e[Pi.WAIT]=10,e[Pi.COMPLETE]=0,e})();class Oi{static getTopPriorityStatus(e){let t,i;for(let n of e){const e=Di[n];if((!t||e>i)&&(t=n,i=e),t===Pi.ERROR)break}return t}}class Bi extends c{constructor(e){super(),this.name=e,this.items=new r,this._status=Pi.WAIT,this._progress=0}addItem(e){this.items.push(e,e.config.id),this.addItemListeners(e),this.updateItemsData()}getAllItems(){return this.items.getAllItems()}getTopPriorityLoadStatus(){const e=[],t=this.items.getAllItems();for(let i of t)e.push(i.status);return Oi.getTopPriorityStatus(e)}updateItemsData(){this.updateLoadStatus(),this.updateLoadProgress()}updateLoadStatus(){const e=this.getTopPriorityLoadStatus();e!==this.status&&(this._status=e,this.dispatchEvent(Ii),this.status===Pi.ERROR?this.dispatchEvent(ki):this.status===Pi.COMPLETE?this.dispatchEvent(Li):this.status===Pi.LOADING&&this.dispatchEvent(Mi))}updateLoadProgress(){const e=Mn.getProgressForItems(this.items.getAllItems());e.progress!==this._progress&&(this._progress=e.progress,this.dispatchEvent(Ri))}get status(){return this._status}get progress(){return this._progress}addItemListeners(e){this.eventListenerHelper.addEventListener(e,Ii,()=>{this.updateItemsData()}),this.eventListenerHelper.addEventListener(e,Ri,()=>{this.updateLoadProgress()})}}class Gi extends c{constructor(e){super(e),this.stopOnError=!1,this.autoStartOnAdd=!0}construction(e){super.construction(),this.id=e,this.group=new Bi(this.id),this.queue=new wi,this.curItemEventListenerHelper=new u(this)}destruction(){super.destruction(),this.curItemEventListenerHelper&&(this.curItemEventListenerHelper.destruction(),this.curItemEventListenerHelper=null)}addListeners(){super.addListeners(),this.eventListenerHelper.addEventListener(this.group,Ii,this.onGroupStatusChange),this.eventListenerHelper.addEventListener(this.group,Ri,this.onGroupStatusChange)}onGroupStatusChange(){this.dispatchEvent(Ii)}onGroupProgress(){this.dispatchEvent(Ri)}start(){this.loadNext()}stop(){this.curItem&&this.curItem.stop()}add(e){let t=this.queue.get(e);if(!t){const i=[];if(e.dependencies)for(let t of e.dependencies){const e=this.add(t);i.push(e)}t=Ei.instance.createItem(e),t.dependencies=i,this.queue.add(t)}return this.status!==Pi.LOADING&&this.autoStartOnAdd&&this.start(),t}loadNext(){let e=this.queue.getNextToLoad();e?this.load(e):this.curItem=null}load(e){this.curItem=e,this.addCurItemListeners(),this.curItem.start()}addCurItemListeners(){this.removeCurItemListeners(),this.curItem&&(this.curItemEventListenerHelper.addEventListener(this.curItem,Li,this.onItemComplete),this.curItemEventListenerHelper.addEventListener(this.curItem,ki,this.onItemError))}removeCurItemListeners(){this.curItem&&this.curItemEventListenerHelper.removeAllListeners(this.curItem)}onItemComplete(){this.queue.onItemLoad(this.curItem),this.loadNext()}onItemError(){this.queue.onItemLoad(this.curItem),this.stopOnError?this.stop():this.loadNext()}getCurrentLoadingItem(){return this.curItem}get status(){return this.group.status}get progress(){return this.group.progress}}class Fi{constructor(){this.loader=Fi.DEFAULT_LOADER_ID,this.loadWeight=Fi.DEFAULT_LOAD_WEIGHT}static addDefaultData(e){s.copyProps(e,Fi.defaultLoadItem,{ignoreExistedProperties:!0}),e.loadGroups||(e.loadGroups=[]),e.loadGroups&&e.loadGroups.push(Fi.DEFAULT_LOAD_GROUP)}}Fi.DEFAULT_LOADER_ID="default",Fi.DEFAULT_LOAD_WEIGHT=1,Fi.DEFAULT_LOAD_GROUP="default",Fi.defaultLoadItem=new Fi;class Ui extends c{constructor(){super(...arguments),this.substituteUrlParams={}}construction(...e){super.construction(...e),this.loadersToIdMap=new r,this.loadGroupsToNameMap=new r,this.loadItemsToIdMap=new r,this.addLoader(new Gi(Fi.DEFAULT_LOADER_ID))}addLoader(e){this.loadersToIdMap.push(e,e.id)}getLoader(e){let t;return e&&(t=this.loadersToIdMap.getItem(e)),t||(t=this.defaultLoader),t}get defaultLoader(){return this.loadersToIdMap.getItem(Fi.DEFAULT_LOADER_ID)}getAllLoaders(){return this.loadersToIdMap.getAllItems().concat()}load(e){this.loadItemsToIdMap.getItem(e.id)&&console.warn("AbstractLoadManager | add __ WARNING! Item with the same id already exists. item:",e),Fi.addDefaultData(e);const t=this.getLoader(e.loader).add(e);return this.loadItemsToIdMap.push(t,e.id),this.addItemToLoadGroups(t),t}getLoadItem(e){return this.loadItemsToIdMap.getItem(e)}getGroup(e){let t=this.loadGroupsToNameMap.getItem(e);return t||(t=new Bi(e),this.loadGroupsToNameMap.push(t,e)),t}addItemToLoadGroups(e){for(let t of e.config.loadGroups){this.getGroup(t).addItem(e)}}getLoadStatusForGroups(e){const t=[];for(let i of e){const e=this.getGroup(i);t.push(e.status)}return Oi.getTopPriorityStatus(t)}substituteUrlPlaceholders(e){return M.substitute(e,this.substituteUrlParams)}addSubstituteParams(e){s.copyProps(this.substituteUrlParams,e)}}class Ni{static add(e,t){Ni.cache[e]=t}static get(e){return Ni.cache[e]}static remove(e){delete Ni.cache[e]}static reset(){Ni.cache={}}}Ni.cache={};class zi extends c{constructor(e){super(),this.config=e,this._status=Pi.WAIT,this.internalPrepare()}internalPrepare(){this.eventListenerHelper=new u(this),this.dependencies=[]}start(){if(this.startPromise)return this.startPromise;this.startPromise=new Promise((e,t)=>{if(this.startPromiseResolve=e,this.startPromiseReject=t,this.status===Pi.LOADING)return;this.status=Pi.LOADING;const i=[];for(let e of this.dependencies)i.push(e.start());Promise.all(i).then(()=>{this.addLoadingListeners(),this.internalStart()}).catch(e=>{this.processLoadingError(e)})})}internalStart(){}stop(){this.status!==Pi.WAIT&&(this.status=Pi.WAIT,this.removeLoadingListeners(),this.internalStop())}internalStop(){}addLoadingListeners(){}removeLoadingListeners(){this.eventListenerHelper.removeAllListeners()}processLoadingProgress(e){this.progress=e,this.dispatchEvent(Ri)}processLoadingComplete(e,t){this.sourceData=e,this.data=t,this.status=Pi.COMPLETE,Ni.add(this.config.id,t),this.removeLoadingListeners(),this.dispatchEvent(Li),this.startPromiseResolve()}processLoadingError(e){this.errorData=e,this.status=Pi.ERROR,this.removeLoadingListeners(),this.dispatchEvent(ki),this.startPromiseReject()}getIsSuccess(){return!this.errorData}get status(){return this._status}set status(e){e!==this.status&&(this._status=e,this.dispatchEvent(Ii))}}class Hi extends zi{internalPrepare(){let e=this.config.src;if(this.config.basePath){e=new URL(this.config.src,this.config.basePath).href}wt.add({alias:this.config.id,src:e})}internalStart(){super.internalStart(),this.loadPromise=wt.load(this.config.id,e=>{this.listenersEnabled&&this.processLoadingProgress(e/100)}),this.loadPromise.then(e=>{this.listenersEnabled&&this.processLoadingComplete(e,e)}),this.loadPromise.catch(e=>{this.listenersEnabled&&this.processLoadingError({data:e,errorCode:e.toString})})}onLoadingComplete(){}internalStop(){super.internalStop(),console.warn("FileLoadItem | internalStop __ WARNING! Stop loading is not implemented!")}addLoadingListeners(){super.addLoadingListeners(),this.listenersEnabled=!0}removeLoadingListeners(){super.removeLoadingListeners(),this.listenersEnabled=!1}}class Vi extends Hi{onLoaderComplete(e){this.processLoadingComplete(e,e)}}var Wi=i(5371);class ji extends zi{internalPrepare(){super.internalPrepare();let e=document.createElement("style");e.type="text/css";let t=this.generateFontFaceRule();document.getElementsByTagName("head")[0].appendChild(e),e.sheet.insertRule(t),this.fontLoadingConfig={custom:{families:[this.config.fontFace["font-family"]]},timeout:this.config.timeout||1e4}}internalStart(){super.internalStart(),Wi.load(this.fontLoadingConfig)}internalStop(){super.internalStop()}addLoadingListeners(){super.addLoadingListeners(),this.fontLoadingConfig.fontloading=(e,t)=>{console.log("FontLoadItem | fontloading __ familyName: ",e);var i=document.createElement("p");i.style.fontFamily=this.config.fontFace["font-family"],i.style.fontWeight=this.config.fontFace["font-weight"],i.style.fontStyle=this.config.fontFace["font-style"],i.style.fontSize="0px",i.style.visibility="hidden",i.innerHTML=".",document.body.appendChild(i)},this.fontLoadingConfig.fontactive=(e,t)=>{console.log("FontLoadItem | fontactive __ familyName: ",e),setTimeout(()=>{this.processLoadingComplete(e,e)},500)},this.fontLoadingConfig.fontinactive=(e,t)=>{console.log("FontLoadItem | fontinactive __ familyName: ",e),this.processLoadingError({data:e})}}generateFontFaceRule(){let e=this.config.src,t=e.lastIndexOf(".");t>=0&&(e=e.substring(0,t));let i=e.split("/").pop(),n=`@font-face {\n            src: url('${e}.eot');\n            src: url('${e}.woff2') format('woff2'),\n                url('${e}.woff') format('woff'),\n                url('${e}.ttf') format('truetype'),\n                url('${e}.svg#${i}') format('svg'),\n                url('${e}.eot?#iefix') format('embedded-opentype');`;for(let e in this.config.fontFace)n+="font-family"==e?`${e}: "${this.config.fontFace[e]}";\n`:`${e}: ${this.config.fontFace[e]};\n`;return n+="}",n}}var Xi=i(4196),Yi=i(2556),Ki=i.n(Yi);class qi extends c{constructor(e){super(e)}construction(e){super.construction(),this.mutedLock=new E,this.config=e}setVolume(e){Yi.gsap.killTweensOf(this),this.internalSetVolume(e)}tweenVolume(e,t,i){this.tweenVolumeValue=this.getVolume(),Yi.gsap.killTweensOf(this),Yi.gsap.to(this,{duration:t,tweenVolumeValue:e,onComplete:()=>{i&&i()}})}get tweenVolumeValue(){return this._tweenVolumeValue}set tweenVolumeValue(e){e!==this._tweenVolumeValue&&(this._tweenVolumeValue=e,this.internalSetVolume(this._tweenVolumeValue))}calculateMuted(){const e=this.muted,t=this.mutedLock.enabled;t!==e&&(this._muted=t),this.commitData()}addMutedLock(e){this.mutedLock.add(e),this.calculateMuted()}removeMutedLock(e){this.mutedLock.remove(e),this.calculateMuted()}get muted(){return this._muted}}class $i extends qi{constructor(e){super(e)}construction(e){super.construction(e),this.engineSound=new Xi.Howl({src:this.config.src,preload:this.config.preload})}destruction(){super.destruction(),this.engineSound&&(this.engineSound.unload(),this.engineSound=null)}getVolume(){return this.engineSound.volume()}internalSetVolume(e){this.engineSound.volume(e)}play(e){e||(e={}),this.engineSound.loop(e.loop),this.engineSound.play()}stop(){this.engineSound.stop()}commitData(){super.commitData(),this.engineSound&&this.engineSound.mute(this.muted)}}const Qi="load",Zi="loaderror";class Ji extends zi{}class en extends Ji{constructor(){super(...arguments),this.soundsManager=D(Tn)}internalPrepare(){super.internalPrepare();let e=this.config.src;if(this.config.extensions&&this.config.extensions.length){e=[];let t=this.config.extensions.length;for(let i=0;i<t;i++)e.push(M.substitute(this.config.src,{extension:this.config.extensions[i]}))}this.sound=new $i({id:this.config.id,src:e,preload:!1,tags:this.config.tags})}internalStart(){super.internalStart(),this.sound.engineSound.load()}internalStop(){super.internalStop(),this.sound&&this.sound.destruction()}addLoadingListeners(){super.addLoadingListeners(),this.sound.engineSound.on(Qi,()=>{this.processLoadingComplete(this.sound.engineSound,this.sound.engineSound)}),this.sound.engineSound.on(Zi,(e,t)=>{this.processLoadingError({errorCode:t,data:t})})}removeLoadingListeners(){super.removeLoadingListeners(),this.sound&&(this.sound.engineSound.off(Qi),this.sound.engineSound.off(Zi))}processLoadingComplete(e,t){this.soundsManager.registerSound(this.config.id,this.sound),super.processLoadingComplete(e,t)}}class tn extends Hi{processLoadingComplete(e,t){super.processLoadingComplete(e,e.spineData)}}class nn extends Ei{constructor(){super(),this.fileTypeToLoadItemClassMap[yi]=Hi,this.fileTypeToLoadItemClassMap[bi]=ji,this.fileTypeToLoadItemClassMap[xi]=en,this.fileTypeToLoadItemClassMap[Ti]=Vi,this.fileTypeToLoadItemClassMap[Si]=Vi,this.fileTypeToLoadItemClassMap[Ai]=tn}}class sn extends nn{}class rn extends Ui{constructor(){super(),Ei.instance=new nn}}class an extends rn{}var on;!function(e){e.UPDATE="update",e.REMOVE="remove"}(on||(on={}));const ln="GenericObjectsModelEvent.CHANGE";class hn extends c{construction(...e){super.construction(...e),this.items=new r,this.reset()}reset(){this.items.reset(),this.dispatchChangeEvent()}dispatchChangeEvent(){this.dispatchEvent(ln)}parseSource(e){if(e.action===on.REMOVE)this.removeItem(e.id);else this.updateItem(this.getItem(e.id),e);this.dispatchChangeEvent()}getItem(e,t=!0){let i=this.items.getItem(e);return i||t&&(i=this.createEmpty(e),this.items.push(i,i.id)),i}removeItem(e){this.items.removeByKey(e)}get itemsCount(){return this.items.length}createEmpty(e){let t;const i={id:e,type:this.itemsType};return t=this.DefaultItemClass?new this.DefaultItemClass:i,this.updateItem(t,i),t}updateItem(e,t){e.update?e.update(t):Object.assign(e,t)}getAllItems(e=!0){return this.items.getAllItems(e)}}class un{constructor(){this.modelsToTypeMap=new r,cn=this.getItem.bind(this),dn=this.getItemsForType.bind(this),pn=this.commitItems.bind(this),window.getItem=cn,window.getItemsForType=dn,window.commitItems=pn}commitItems(e){let t;for(let i of e)t=this.getModelForType(i.type),t.parseSource(i)}getModelForType(e){let t=this.modelsToTypeMap.getItem(e);return t||(t=new hn,t.itemsType=e,this.mapModelToType(t,e)),t}getItem(e,t){return this.getModelForType(e).getItem(t)}getItemsForType(e,t=!0){return this.getModelForType(e).getAllItems(t)}mapModelToType(e,t){this.modelsToTypeMap.push(e,t)}}let cn,dn,pn;var fn,gn;!function(e){e.NONE="none",e.LEFT="left",e.CENTER="center",e.RIGHT="right"}(fn||(fn={})),function(e){e.NONE="none",e.TOP="top",e.MIDDLE="middle",e.BOTTOM="bottom"}(gn||(gn={}));class mn{}mn.DRAG_START="UserActionsCheckerEvent_DRAG_START",mn.DRAG_END="UserActionsCheckerEvent_DRAG_END",mn.DRAG_UPDATE="UserActionsCheckerEvent_DRAG_UPDATE";class _n extends c{constructor(){super(),this.startDragGlobalX=0,this.startDragGlobalY=0,this.lastDragGlobalX=0,this.lastDragGlobalY=0,this.changeDragGlobalX=0,this.changeDragGlobalY=0,this.startDragLocalPoint=new zt.b,this.lastDragLocalPoint=new zt.b,this.startDragViewShiftPoint=new zt.b,this.dragUpdateDelay=0,this.dragStartTime=0}construction(){super.construction(),this.hitAreaEventListenerHelper=new u(this)}destruction(){super.destruction(),this.hitAreaEventListenerHelper&&(this.hitAreaEventListenerHelper.destruction(),this.hitAreaEventListenerHelper=null)}removeListeners(){super.removeListeners(),this.removeHitAreaListeners()}updateHitAreaListeners(){this.removeHitAreaListeners();let e=this.view;this.hitArea&&(e=this.hitArea),this.addHitAreaListeners(e)}addHitAreaListeners(e){e&&(this.hitAreaEventListenerHelper.addEventListener(e,Dn.DOWN,this.onMouseDown),this.hitAreaEventListenerHelper.addEventListener(e,Dn.UP,this.onMouseUp),this.hitAreaEventListenerHelper.addEventListener(e,Dn.UP_OUTSIDE,this.onMouseUp),Cn.instance.ticker.add(this.onTick,this))}removeHitAreaListeners(){this.hitAreaEventListenerHelper.removeAllListeners(),Cn.instance.ticker.remove(this.onTick,this)}onMouseDown(){this.startDrag()}onMouseUp(){this.stopDrag()}onTick(){this.isDragStarted&&this.checkIsNeedUpdateDrag()&&this.updateDrag()}dispatchDragStartEvent(){this.dispatchEvent(mn.DRAG_START)}dispatchDragUpdateEvent(){this.dispatchEvent(mn.DRAG_UPDATE)}dispatchDragEndEvent(){this.dispatchEvent(mn.DRAG_END)}startDrag(){if(this.isDragStarted)return;this.isDragStarted=!0;const e=Cn.instance.getGlobalInteractionPosition();this.startDragGlobalX=e.x,this.startDragGlobalY=e.y,this.view.parent.toLocal({x:this.startDragGlobalX,y:this.startDragGlobalY},null,this.startDragLocalPoint),this.startDragViewShiftPoint.x=this.startDragLocalPoint.x-this.view.x,this.startDragViewShiftPoint.y=this.startDragLocalPoint.y-this.view.y,this.lastDragGlobalX=this.startDragGlobalX,this.lastDragGlobalY=this.startDragGlobalY,this.lastDragLocalPoint.x=this.startDragLocalPoint.x,this.lastDragLocalPoint.y=this.startDragLocalPoint.y,this.changeDragGlobalX=0,this.changeDragGlobalY=0,this.dispatchDragStartEvent()}stopDrag(){this.isDragStarted&&(this.isDragStarted=!1,this.updateDrag(),this.dispatchDragEndEvent())}updateDrag(){const e=Cn.instance.getGlobalInteractionPosition();this.lastDragGlobalX==e.x&&this.lastDragGlobalY==e.y||(this.lastDragGlobalX=e.x,this.lastDragGlobalY=e.y,this.changeDragGlobalX=this.lastDragGlobalX-this.startDragGlobalX,this.changeDragGlobalY=this.lastDragGlobalY-this.startDragGlobalY,console.log("this.lastDragGlobalX:",this.lastDragGlobalX," | this.lastDragGlobalY:",this.lastDragGlobalY),console.log("this.startDragGlobalX:",this.startDragGlobalX," | this.startDragGlobalY:",this.startDragGlobalY),this.view.parent.toLocal({x:this.lastDragGlobalX,y:this.lastDragGlobalY},null,this.lastDragLocalPoint),this.dispatchDragUpdateEvent())}get isDragStarted(){return this._isDragStarted}set isDragStarted(e){e!=this.isDragStarted&&(this._isDragStarted=e,this.isDragStarted&&(this.dragStartTime=Date.now()))}get view(){return this._view}set view(e){e!=this.view&&(this._view=e,this.updateHitAreaListeners())}get hitArea(){return this._hitArea}set hitArea(e){e!=this.hitArea&&(this._hitArea=e,this.updateHitAreaListeners())}checkIsNeedUpdateDrag(){var e;return Date.now()>=this.dragStartTime+this.dragUpdateDelay&&(e=!0),e}get startDragLocalX(){return this.startDragLocalPoint.x}get startDragLocalY(){return this.startDragLocalPoint.y}get lastDragLocalX(){return this.lastDragLocalPoint.x}get lastDragLocalY(){return this.lastDragLocalPoint.y}get changeDragLocalX(){return this.lastDragLocalPoint.x-this.startDragLocalPoint.x}get changeDragLocalY(){return this.lastDragLocalPoint.y-this.startDragLocalPoint.y}get lastDragWithShiftLocalX(){return this.lastDragLocalPoint.x-this.startDragViewShiftPoint.x}get lastDragWithShiftLocalY(){return this.lastDragLocalPoint.y-this.startDragViewShiftPoint.y}}var vn,yn;!function(e){e.VOLUME_CHANGE="SoundsManagerEvent.VOLUME_CHANGE",e.ENABLED_CHANGE="SoundsManagerEvent.ENABLED_CHANGE",e.IS_MUTED_CHANGE="SoundsManagerEvent.MUTED_CHANGE",e.TAGS_IS_MUTED_CHANGE="SoundsManagerEvent.TAGS_IS_MUTED_CHANGE"}(vn||(vn={}));class bn extends c{construction(...e){super.construction(...e),this.soundsToIdMap=new r,this._enabled=!1,this.disableLock=new E,this.defaultTweenTime=.5,this.volume=1,this.isMutedToTagsMap={},this.setVolume(this.volume),this.calculateEnabled()}registerSound(e,t){this.soundsToIdMap.push(t,e),this.commitTagsData()}getSound(e){return this.soundsToIdMap.getItem(e)}get enabled(){return this._enabled}calculateEnabled(){const e=this.enabled,t=!this.disableLock.enabled;this._enabled=t,t!==e&&this.dispatchEvent(vn.ENABLED_CHANGE),this.commitData()}addDisableLock(e){this.disableLock.add(e),this.calculateEnabled()}removeDisableLock(e){this.disableLock.remove(e),this.calculateEnabled()}get isActivated(){return this._isActivated}activate(){this._isActivated=!0,this.commitData()}get isMuted(){return this._isMuted}set isMuted(e){e!==this.isMuted&&(this._isMuted=e,this.dispatchEvent(vn.IS_MUTED_CHANGE),this.commitData())}commitData(){super.commitData();let e=this.getVolume();this.isActivated||(e=0),this.isMuted&&(e=0),this.enabled||(e=0);try{this.internalSetVolume(e)}catch(e){console.log("AbstractSoundsManager | commitData __ error: ",e)}this.commitTagsData()}commitTagsData(){this.soundsToIdMap.forEach(e=>{let t=!1;if(e.config.tags)for(let i of e.config.tags)if(this.getTagIsMuted(i)){t=!0;break}t?e.addMutedLock(this):e.removeMutedLock(this)})}getVolume(){return this.volume}setVolume(e){Yi.gsap.killTweensOf(this),this.volume=e,this.dispatchEvent(vn.VOLUME_CHANGE),this.commitData()}tweenVolume(e,t,i){t||0===t||(t=this.defaultTweenTime),this.tweenVolumeValue=this.getVolume(),Yi.gsap.killTweensOf(this),Yi.gsap.to(this,{duration:t,tweenVolumeValue:e,onComplete:()=>{i&&i()}})}get tweenVolumeValue(){return this._tweenVolumeValue}set tweenVolumeValue(e){e!==this._tweenVolumeValue&&(this._tweenVolumeValue=e,this.setVolume(this._tweenVolumeValue))}getTagIsMuted(e){return!!this.isMutedToTagsMap[e]}setTagIsMuted(e,t){this.getTagIsMuted(e)!==t&&(this.isMutedToTagsMap[e]=t,this.dispatchEvent(vn.TAGS_IS_MUTED_CHANGE),this.commitTagsData())}getTagsMuted(){let e=[];const t=Object.keys(this.isMutedToTagsMap);for(let i of t)this.getTagIsMuted(i)&&e.push(i);return e}}!function(e){e.SOUNDS="sounds",e.BG_MUSIC="bgMusic"}(yn||(yn={}));class xn extends bn{internalSetVolume(e){Xi.Howler.volume(e)}}class Tn extends xn{}var Sn,An=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,o)}l((n=n.apply(e,t||[])).next())})};class En{static asyncTimeout(e){return An(this,void 0,void 0,function*(){return new Promise(t=>{setTimeout(()=>{t()},e)})})}}class Cn extends de{constructor(){super(),this.lastTimeRendered=0,Cn._instance=this,this.stage.isFStage=!0}getGlobalInteractionPosition(){return this.renderer.events.pointer.screen.clone()}static get instance(){return Cn._instance}}!function(e){e.PRERENDER="prerender",e.POSTRENDER="postrender",e.RESIZE="resize"}(Sn||(Sn={}));class wn extends f{constructor(e){super(),this.loadConfig=e}executeInternal(){let e=D(an);this.loadItem=e.load(this.loadConfig),this.eventListenerHelper.addEventListener(this.loadItem,Ii,()=>{this.processFinalStatus()}),this.processFinalStatus()}processFinalStatus(){this.loadItem.status===Pi.COMPLETE?this.processComplete():this.loadItem.status===Pi.ERROR&&this.processError()}processComplete(){this.notifyComplete(this.loadItem.data)}processError(){this.errorCode=p.GENERAL_ERROR,this.terminate()}}class Pn extends f{constructor(e){super(),this.items=e}executeInternal(){let e=[];for(let t of this.items){let i=new wn(t).execute();e.push(i)}Promise.all(e).then(()=>{this.notifyComplete()},()=>{this.errorCode=p.GENERAL_ERROR,this.terminate()})}}class In extends f{constructor(e){super(),this.groupName=e}executeInternal(){let e=D(an).getGroup(this.groupName);e.status===Pi.COMPLETE?this.notifyComplete():e.status===Pi.WAIT&&e.getAllItems().length<=0?(console.log("WaitGroupLoadingCompleteCommand | executeInternal __ Group is not in the loading status! this.groupName: ",this.groupName," | tempGroup.status: ",e.status),this.notifyComplete()):this.eventListenerHelper.addEventListener(e,Ii,()=>{e.status===Pi.COMPLETE&&this.notifyComplete()})}}class Mn{static getProgressForItems(e){let t,i=0,n=0;for(let s of e)t=s.config.loadWeight,t||(t=1),i+=t,s.status!==Pi.COMPLETE&&s.status!==Pi.ERROR||(n+=t);return{progress:n/i,loadedWeight:n,totalWeight:i}}}class Rn extends le.mc{constructor(...e){super(),this.isFContainer=!0,this.isNeedToDestructOnRemoveFromStage=!1,this.eventListenerHelper=new u(this),this.stageListenerHelper=new u(this),this.construction(...e),this.isConstructed=!0,this.onConstructedComplete(),this.stageListenerHelper.addEventListener(this,kn.ADDED,()=>{this.stage=Kn.findStageInDisplayList(this)}),this.stageListenerHelper.addEventListener(this,kn.REMOVED,e=>{this.stage=null}),this.stageListenerHelper.addEventListener(this,zn.ADDED_TO_STAGE,this.onAddedToStage),this.stageListenerHelper.addEventListener(this,zn.REMOVED_FROM_STAGE,this.onRemovedFromStage)}construction(...e){}destruction(){this.destroy({children:!0}),this.eventListenerHelper&&(this.eventListenerHelper.destruction(),this.eventListenerHelper=null),this.stageListenerHelper&&(this.stageListenerHelper.destruction(),this.stageListenerHelper=null),this.removeListeners()}addListeners(){this.removeListeners()}removeListeners(){this.eventListenerHelper&&this.eventListenerHelper.removeAllListeners()}onConstructedComplete(){}onAddedToStage(){B(this),this.addListeners(),this.commitData(),this.processDataSet(this.data)}onRemovedFromStage(){G(this),this.removeListeners(),this.isNeedToDestructOnRemoveFromStage&&this.destruction()}forceCommitData(){this.commitData()}commitData(){this.arrange()}forceArrange(){this.arrange()}arrange(){}addChildBefore(e,t){const i=this.getChildIndex(t);if(-1===i)return;let n=i-1;n<0&&(n=0),this.addChildAt(e,n)}addChildAfter(e,t){const i=this.getChildIndex(t);if(-1===i)return;let n=i+1;n>this.children.length&&(n=this.children.length),this.addChildAt(e,n)}get data(){return this._data}set data(e){this.data!=e&&(this.processDataUnset(this._data),this._data=e,this.processDataSet(this._data),this.commitData())}processDataUnset(e){}processDataSet(e){}get stage(){return this._stage}set stage(e){e!==this._stage&&(this._stage&&e?P.error("FContainer | set stage __ The stage param can't be set to different value, before being empty!"):(this._stage=e,this.updateChildrenStage(),this.stage?this.emit(zn.ADDED_TO_STAGE):this.emit(zn.REMOVED_FROM_STAGE)))}updateChildrenStage(){for(const e of this.children)Rn.isFContainer(e)&&(e.stage=this.stage)}static isFContainer(e){return e.isFContainer}}class Ln extends le.mc{constructor(){super(...arguments),this.isFStage=!0}static isFStage(e){return e.isFStage}}const kn={ADDED:"added",REMOVED:"removed"},Dn={DOWN:"pointerdown",CANCEL:"pointercancel",UP:"pointerup",TAP:"pointertap",UP_OUTSIDE:"pointerupoutside",MOVE:"pointermove",OVER:"pointerover",OUT:"pointerout"};class On{static alignWith(e,t,i,n=!0){let s=t.x;switch(i){case fn.CENTER:s=t.x+.5*(t.width-e.width);break;case fn.RIGHT:s=t.x+(t.width-e.width)}n&&(s=Math.floor(s)),e.x=s}static valignWith(e,t,i,n=!0){let s=t.y;switch(i){case gn.MIDDLE:s=t.y+.5*(t.height-e.height);break;case gn.BOTTOM:s=t.y+(t.height-e.height)}n&&(s=Math.floor(s)),e.y=s}}var Bn,Gn;!function(e){e.NONE="none",e.WIDTH="width",e.HEIGHT="height"}(Bn||(Bn={}));class Fn{static scaleObject(e,t,i,n){let s=Fn.getScale(e.width,e.height,t,i,n);e.scale.set(s,s)}static getScale(e,t,i,n,s){let r=1;if(s||(s={}),i>0&&n>0&&(s.upscaleAllowed||e>i||t>n)){const a=i/n,o=e/t;r=o<=a&&s.scaleByMinSide||o>a&&!s.scaleByMinSide?i/e:n/t}return r}static getScaleSide(e,t,i,n,s){let r=Bn.NONE;if(s||(s={}),i>0&&n>0&&(s.upscaleAllowed||e>i||t>n)){const a=i/n,o=e/t;r=o<=a&&s.scaleByMinSide||o>a&&!s.scaleByMinSide?Bn.WIDTH:Bn.HEIGHT}return r}}class Un{static removeAllChildren(e){for(;e.children.length>0;)e.removeChildAt(0)}static childRemoveItselfFromParent(e){e&&e.parent&&e.parent.removeChild(e)}static moveObjectToTopLayer(e){e&&e.parent&&e.parent.setChildIndex(e,e.parent.children.length-1)}static safeAddChildAt(e,t,i){i<0?i=0:i>e.children.length&&(i=e.children.length),e.addChildAt(t,i)}static addChildBefore(e,t,i){if(i.parent!==e)return void console.error("DisplayTools | addChildBefore __ ERROR! beforeTarget is not a child of the container!");const n=e.getChildIndex(i)-1;Un.safeAddChildAt(e,t,n)}static findParentInDisplayList(e,t,i=null){let n,s=e.parent;for(;s&&(!i||i(s));){if(t(s)){n=s;break}s=s.parent}return n}}class Nn{static changeFontSizeToFit(e,t){if(t||(t={}),(!t.maxWidth||e.fieldMaskWidth<=t.maxWidth)&&(t.maxWidth=e.fieldMaskWidth),(!t.maxHeight||e.fieldMaskHeight<=t.maxHeight)&&(t.maxHeight=e.fieldMaskHeight),!e.text||e.textWidth<=t.maxWidth&&e.textHeight<=t.maxHeight)return;const i=t.maxStepsCount||100,n=t.stepChange||-1;let s=0;for(;e.size>0&&(e.textWidth>t.maxWidth||e.textHeight>t.maxHeight);)if(e.changeConfig({nativeTextStyle:{fontSize:e.size+n}}),s++,s>=i){P.error("FLabelTools | changeFontSizeToFit __ ERROR! Max steps count!");break}}static truncateToFit(e,t,i,n=Gn.FROM_RIGHT,s="..."){if((!t||e.width<=t)&&(t=e.width),(!i||e.height<=i)&&(i=e.height),!e.text||e.textWidth<=t&&e.textHeight<=i)return!1;for(var r=e.text,a=r,o=0;r.length>0&&(e.textWidth>t||e.textHeight>i);)if(n===Gn.FROM_LEFT?(r=r.substring(1,r.length),e.text=s+r):(r=r.substring(0,r.length-1),e.text=r+s),++o>=1e3){P.error("FLabelTools | truncateToFit __ ERROR! Max steps count!");break}return r!==a}}!function(e){e.FROM_LEFT="FROM_LEFT",e.FROM_RIGHT="FROM_RIGHT"}(Gn||(Gn={}));const zn={ADDED_TO_STAGE:"ADDED_TO_STAGE",REMOVED_FROM_STAGE:"REMOVED_FROM_STAGE"};var Hn,Vn;!function(e){e.WIDTH="width",e.HEIGHT="height",e.BOTH="both"}(Hn||(Hn={}));!function(e){e.TEXT="text",e.HTML_TEXT="htmlText",e.BITMAP="bitmap"}(Vn||(Vn={}));class Wn extends Rn{constructor(e){super(e)}construction(e){super.construction(),this.fieldLocalBounds=new Ht.c,this._text="",Object.defineProperty(this,"width",{get(){return this._width},set(e){e!==this._width&&(this._width=e,this.applyStyle())}}),Object.defineProperty(this,"height",{get(){return this._height},set(e){e!==this._height&&(this._height=e,this.applyStyle())}}),e||(e={}),e.nativeTextStyle||(e.nativeTextStyle={}),this.config=e,s.copyProps(this.config,Wn.DEFAULT_CONFIG,{ignoreExistedProperties:!0}),this.bg=new Vt.A,this.addChild(this.bg),this.fieldMask=new Vt.A,this.fieldMask.rect(0,0,10,10),this.fieldMask.fill({color:65280,alpha:1}),this.fieldMask.alpha=0,this.createField(),this._width=this.field.width,this._height=this.field.height,this.updateBg()}destruction(){super.destruction(),this.field&&this.field.destroy()}onAddedToStage(){super.onAddedToStage(),this.applyText()}createField(){this.field&&(this.field.parent.removeChild(this.field),this.field=null),this.config.textType===Vn.BITMAP?this.field=new $t:this.config.textType===Vn.HTML_TEXT?this.field=new ri:this.field=new li,this.applyStyle(),this.addChild(this.field)}applyStyle(){this.config.nativeTextStyle&&(this.field.style=this.config.nativeTextStyle),this.arrange()}commitData(){super.commitData(),this.arrange()}arrange(){super.arrange(),this.field.scale.set(1),this.fieldLocalBounds=this.field.getLocalBounds(),this.autosize&&(this.autosizeType&&this.autosizeType!==Hn.BOTH&&this.autosizeType!==Hn.WIDTH||(this._width=this.textWidth+2*this.fieldPaddingX,this.maxAutosizeWidth&&(this._width=Math.min(this._width,this.maxAutosizeWidth))),this.autosizeType&&this.autosizeType!==Hn.BOTH&&this.autosizeType!==Hn.HEIGHT||(this._height=this.textHeight+2*this.fieldPaddingY,this.maxAutosizeHeight&&(this._height=Math.min(this._height,this.maxAutosizeHeight))));let e=1;this.fitToSize&&(this.changeFontSizeToFit?(this.config.fitToSize=!1,this.config.nativeTextStyle.fontSize=this.config.changeFontSizeToFitStartSize,this.applyStyle(),Nn.changeFontSizeToFit(this,{stepChange:this.config.changeFontSizeStepChange}),this.config.fitToSize=!0):e=Fn.getScale(this.textWidth,this.textHeight,this.textAvailableWidth,this.textAvailableHeight)),this.field.scale.set(e),this.fieldLocalBounds=this.field.getLocalBounds(),this.updateBg();let t=this.fieldPaddingX;switch(this.config.nativeTextStyle.align){case fn.CENTER:t=Math.floor(.5*(this._width-this.textWidth*this.field.scale.x));break;case fn.RIGHT:t=Math.floor(this._width-this.textWidth*this.field.scale.x)-this.fieldPaddingX}this.field.x=t;let i=this.fieldPaddingY;switch(this.valign){case gn.MIDDLE:i=Math.floor(.5*(this._height-this.textHeight*this.field.scale.y));break;case gn.BOTTOM:i=Math.floor(this._height-this.textHeight*this.field.scale.y)-this.fieldPaddingY}this.field.y=i,this.fieldMask.x=this.fieldPaddingX,this.fieldMask.y=this.fieldPaddingY,this.fieldMask.width=this.fieldMaskWidth,this.fieldMask.height=this.fieldMaskHeight}get fieldMaskWidth(){return this._width-2*this.fieldPaddingX+this.maskToFieldShiftWidth}get fieldMaskHeight(){return this._height-2*this.fieldPaddingY+this.maskToFieldShiftHeight}get valign(){return this.config.valign}get size(){return this.config.nativeTextStyle.fontSize}get bgAlpha(){return this.config.bgAlpha}get bgColor(){return this.config.bgColor}get bgStrokeStyle(){return this.config.bgStrokeStyle}updateBg(){const e=this.config.bgColor?this.config.bgColor:0,t=this.config.bgAlpha?this.config.bgAlpha:0;this.bg.clear(),this.bgStrokeStyle&&this.bg.setStrokeStyle(this.bgStrokeStyle),this.bg.rect(0,0,this._width,this._height),this.bg.fill({color:e,alpha:1}),this.bg.alpha=t}get text(){return this._text}set text(e){void 0===e&&(e=""),e!==this.field.text&&(this._text=e,this.emit(jn.TEXT_CHANGE),this.applyText())}applyText(){this.field.text=this._text,this.commitData()}get autosize(){return this.config.autosize}get autosizeType(){return this.config.autosizeType}get maxAutosizeWidth(){return this.config.maxAutosizeWidth||0}get maxAutosizeHeight(){return this.config.maxAutosizeHeight||0}get fitToSize(){return this.config.fitToSize}get changeFontSizeToFit(){return this.config.changeFontSizeToFit}get textWidth(){return this.config.textType===Vn.BITMAP?this.fieldLocalBounds.x+this.fieldLocalBounds.width:this.field.width/this.field.scale.x}get textHeight(){return this.config.textType===Vn.BITMAP?this.fieldLocalBounds.y+this.fieldLocalBounds.height:this.field.height/this.field.scale.y}get textAvailableWidth(){return this.width-2*this.fieldPaddingX}get textAvailableHeight(){return this.height-2*this.fieldPaddingY}get fieldPaddingX(){return this.config.fieldPaddingX||0}get fieldPaddingY(){return this.config.fieldPaddingY||0}get maskToFieldShiftWidth(){return this.config.maskToFieldShiftWidth||0}get maskToFieldShiftHeight(){return this.config.maskToFieldShiftHeight||0}get nativeField(){return this.field}changeConfig(e){let t=e.nativeTextStyle;delete e.nativeTextStyle,s.copyProps(this.config,e),t&&s.copyProps(this.config.nativeTextStyle,t),this.applyStyle()}}Wn.DEFAULT_CONFIG=new class{constructor(){this.autosize=!0}};const jn={TEXT_CHANGE:"FLabelEvent.TEXT_CHANGE"};var Xn,Yn;!function(e){e.NORMAL="normal",e.BOLD="bold",e.BOLDER="bolder",e.LIGHTER="lighter",e.WEIGHT_100="100",e.WEIGHT_200="200",e.WEIGHT_300="300",e.WEIGHT_400="400",e.WEIGHT_500="500",e.WEIGHT_600="600",e.WEIGHT_700="700",e.WEIGHT_800="800",e.WEIGHT_900="900",e.THIN="100",e.EXTRA_LIGHT="200",e.LIGHT="300",e.REGULAR="400",e.MEDIUM="500",e.SEMI_BOLD="600",e.EXTRA_BOLD="800",e.BLACK="900"}(Xn||(Xn={})),function(e){e.LEFT="left",e.RIGHT="right",e.CENTER="center",e.JUSTIFY="jistify"}(Yn||(Yn={}));class Kn{static findStageInDisplayList(e){let t,i=e.parent;for(;i;){if(Ln.isFStage(i)){t=i;break}i=i.parent}return t}static getObjectsUnderPoint(e,t,i,n=null){let s;if(e.visible&&e.renderable){let r=e;if(r.children&&r.children.length>0){let a,o,l=[],h=r.children.length;for(let e=0;e<h;e++)a=r.children[e],n&&!n(a)||(o=this.getObjectsUnderPoint(a,t,i,n),o&&l.push(o));l.length>0&&(s={object:e,children:l})}else{let n=!1;if(e.containsPoint)this.cachedPoint.x=t,this.cachedPoint.y=i,e.containsPoint(this.cachedPoint)&&(n=!0);else{e.getBounds().containsPoint(t,i)&&(n=!0)}n&&(s={object:e})}}return s}static iterateThroughUnderPointData(e,t){if(e&&e.object&&e.children&&e.children.length>0){let i=e.children.length;for(let n=0;n<i;n++){const i=e.children[n];t(i),this.iterateThroughUnderPointData(i,t)}}}}Kn.cachedPoint=new zt.b;class qn extends c{init(){}initCompleteHook(){}activateCompleteHook(){}}const $n="GlobalEventDispatcherEvent.PRE_DISPATCH_EVENT ",Qn="GlobalEventDispatcherEvent.POST_DISPATCH_EVENT ";class Zn extends c{dispatchEvent(e,...t){super.dispatchEvent(this.getModifiedEventType(e,$n),...t),super.dispatchEvent(e,...t),super.dispatchEvent(this.getModifiedEventType(e,Qn),...t)}addPreEventListener(e,t){this.addEventListener(this.getModifiedEventType(e,$n),t)}addPostEventListener(e,t){this.addEventListener(this.getModifiedEventType(e,Qn),t)}removePreEventListener(e,t){this.removeEventListener(this.getModifiedEventType(e,$n),t)}removePostEventListener(e,t){this.removeEventListener(this.getModifiedEventType(e,Qn),t)}getModifiedEventType(e,t){return t+e}}class Jn extends c{construction(...e){super.construction(...e),this.globalDispatcher=D(Zn)}dispatchEvent(e,...t){super.dispatchEvent(e,...t),this.globalDispatcher.dispatchEvent(e,...t)}}class es{static getChangeEvent(e){return`appStateChange:${e.toString()}`}}class ts{static prepareDeepKeyHelperData(e,t=null){const i={splitDeepKeyParts:[],dispatchingChangePaths:[],dispatchingChangePathsMap:{}};let n="";const r=e.split(".");for(let e of r)i.splitDeepKeyParts.push(e),n&&(n+="."),n+=e,i.dispatchingChangePaths.push(n),i.dispatchingChangePathsMap[n]=!0;if(t&&!s.isSimpleType(t.value)){const n=(e,t)=>{let i=[t];if(!s.isSimpleType(e)){const s=Object.keys(e);for(let r of s){const s=e[r],a=n(s,`${t}.${r}`);i.push(...a)}}return i},r=n(t.value,e);for(let e of r){const t=ts.splitDeepKeyIntoEvents(e);for(let e of t.dispatchingChangePaths)i.dispatchingChangePathsMap[e]||(i.dispatchingChangePathsMap[e]=!0,i.dispatchingChangePaths.push(e))}}return i}static splitDeepKeyIntoEvents(e){const t={splitDeepKeyParts:[],dispatchingChangePaths:[],dispatchingChangePathsMap:{}};let i="";const n=e.split(".");for(let e of n)t.splitDeepKeyParts.push(e),i&&(i+="."),i+=e,t.dispatchingChangePaths.push(i),t.dispatchingChangePathsMap[i]=!0;return t}}var is;!function(e){e.DELETE="delete",e.CHANGE="change",e.SUBSTITUTE="substitute",e.SPLICE="splice",e.PUSH="push"}(is||(is={}));class ns extends Jn{constructor(){super(...arguments),this.isInitialized=!1,this.state={},this.pathsHelperDataCache={},this.preChangeHooks=[]}changePropertyWrapper(){return e=>(t,i)=>{this.innerChange({},`${e}.${t}`,i)}}initializeWith(e){this.isInitialized||s.copyProps(this.state,e)}initializeComplete(){this.isInitialized=!0}getState(){return this.state}getMutableState(){return this.state}dispatchChangeEvents(e){for(let t of e.dispatchingChangePaths){const e=es.getChangeEvent(t);this.dispatchEvent(e)}}getPathsHelperData(e,t=null){let i=null;return t&&s.isSimpleType(t.value)?(i=this.pathsHelperDataCache[e],i||(i=ts.prepareDeepKeyHelperData(e,t),this.pathsHelperDataCache[e]=i)):i=ts.prepareDeepKeyHelperData(e,t),i}triggerPreChangeHooks(e,t,i){this.preChangeHooks.length<=0||this.preChangeHooks.forEach(n=>{n(e,t,i)})}getValue(){return e=>this.innerGetValue({},e)}innerGetValue(e,t){let i;const n=this.getPathsHelperData(t,null);let s=this.state,r=n.splitDeepKeyParts.length;for(let e=0;e<r;e++){const t=n.splitDeepKeyParts[e];e===r-1?i=s[t]:s=s[t]}return i}processStateAction(e,t,i){let n;const r=this.getPathsHelperData(t,i);let a=this.state,o=r.splitDeepKeyParts.length;for(let e=0;e<o;e++){const t=r.splitDeepKeyParts[e];e===o-1?i.changeType===is.SUBSTITUTE?(delete a[t],s.copySinglePropFromValue(a,t,i.value)):i.changeType===is.CHANGE?s.copySinglePropFromValue(a,t,i.value):i.changeType===is.DELETE?(n=a[t],delete a[t]):i.changeType===is.PUSH?a[t].push(...i.elements):i.changeType===is.SPLICE&&(n=a[t].splice(i.start,i.deleteCount)):a=a[t]}return this.dispatchChangeEvents(r),n}substitute(){return(e,t)=>{this.innerSubstitute({},e,t)}}innerSubstitute(e,t,i){const n={changeType:is.SUBSTITUTE,value:i};this.triggerPreChangeHooks(e,t,n),this.processStateAction(e,t,n)}change(){return(e,t)=>{this.innerChange({},e,t)}}innerChange(e,t,i){const n={changeType:is.CHANGE,value:i};this.triggerPreChangeHooks(e,t,n),this.processStateAction(e,t,n)}delete(){return e=>this.innerDelete({},e)}innerDelete(e,t){const i={changeType:is.DELETE};return this.triggerPreChangeHooks(e,t,i),this.processStateAction(e,t,i)}push(){return(e,...t)=>this.innerPush({},e,...t)}innerPush(e,t,...i){const n={changeType:is.PUSH,elements:i};this.triggerPreChangeHooks(e,t,n),this.processStateAction(e,t,n)}splice(){return(e,t,i)=>this.innerSplice({},e,t,i)}innerSplice(e,t,i,n){void 0===n&&(n=Number.MAX_SAFE_INTEGER);const s={changeType:is.SPLICE,start:i,deleteCount:n};return this.triggerPreChangeHooks(e,t,s),this.processStateAction(e,t,s)}}class ss extends qn{init(){super.init(),O(ns,{isSingleton:!0})}initCompleteHook(){super.initCompleteHook(),D(ns).initializeComplete()}}const rs=()=>D(ns),as=()=>e=>es.getChangeEvent(e);window.appStateStorage=rs,window.appStateStorageChangeEvent=as;const os={app:{debug:!1,curLaunchTimestamp:0,prevLaunchTimestamp:0,appLaunchesCount:0,appDaysLaunchesCount:0,appDaysLaunchesCount_consequent_withMaxBreaks_Day1:0,appDaysLaunchesCount_consequent_withMaxBreaks_Day3:0,appDaysLaunchesCount_consequent_withMaxBreaks_Day7:0,sessionDuration:0,totalUsageDuration:0,prevSessionTotalUsageDuration:0,config:{appName:null,appVersion:null,files:null,supportedLocales:null,sizeArea:{x:0,y:0,width:1280,height:1920}}}};class ls extends Jn{}const hs="__flashistAppFramework__",us={storageId:`${hs}defaultStorageId`};class cs extends c{construction(){super.construction(),this.storageId=us.storageId,this.prepareStorage(),this.createStorage()}getStorageId(){return this.storageId}getWindowStorageObject(){let e=localStorage.getItem(this.storageId);return e||(e="{}"),JSON.parse(e)}setParam(e,t){this.storageData[e]!==t&&(this.storageData[e]=t,this.writeSaves())}getParam(e){return this.storageData[e]}writeSaves(){let e=JSON.stringify(this.storageData);localStorage.setItem(this.storageId,e)}createStorage(){this.storageData=this.getWindowStorageObject(),this.storageData.isCreated&&this.initializeStorageData()}initializeStorageData(){this.storageData.isCreated=!0,this.writeSaves()}clearSaves(){this.initializeStorageData()}prepareStorage(){window.localStorage||Object.defineProperty(window,"localStorage",new function(){var e=[],t={};Object.defineProperty(t,"getItem",{value:function(e){return this[e]?this[e]:null},writable:!1,configurable:!1,enumerable:!1}),Object.defineProperty(t,"key",{value:function(t){return e[t]},writable:!1,configurable:!1,enumerable:!1}),Object.defineProperty(t,"setItem",{value:function(e,t){e&&(document.cookie=escape(e)+"="+escape(t)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/")},writable:!1,configurable:!1,enumerable:!1}),Object.defineProperty(t,"length",{get:function(){return e.length},configurable:!1,enumerable:!1}),Object.defineProperty(t,"removeItem",{value:function(e){e&&(document.cookie=escape(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/")},writable:!1,configurable:!1,enumerable:!1}),Object.defineProperty(t,"clear",{value:function(){if(e.length)for(var i in t)document.cookie=escape(i)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/"},writable:!1,configurable:!1,enumerable:!1}),this.get=function(){var i;for(var n in t)-1===(i=e.indexOf(n))?t.setItem(n,t[n]):e.splice(i,1),delete t[n];for(;e.length>0;e.splice(0,1))t.removeItem(e[0]);for(var s,r,a=0,o=document.cookie.split(/\s*;\s*/);a<o.length;a++)(s=o[a].split(/\s*=\s*/)).length>1&&(t[r=unescape(s[0])]=unescape(s[1]),e.push(r));return t},this.configurable=!1,this.enumerable=!0})}}const ds="appModel",ps="assets/app-config.json",fs="assetsConfigFile",gs="localeConfigFile",ms="staticItemsFile",_s=6e4,vs=864e5;class ys extends ls{construction(...e){super.construction(e),this.storageManager=D(cs),this.appState=rs().getState();const t=this.storageManager.getParam(ds);this.applyStorageData(t),rs().change()("app",{prevLaunchTimestamp:this.appState.app.curLaunchTimestamp});let i=Date.now();(null===flashistGlobalVars||void 0===flashistGlobalVars?void 0:flashistGlobalVars.openTime)&&(i=null===flashistGlobalVars||void 0===flashistGlobalVars?void 0:flashistGlobalVars.openTime),rs().change()("app",{prevSessionTotalUsageDuration:this.appState.app.totalUsageDuration,curLaunchTimestamp:i,appLaunchesCount:this.appState.app.appLaunchesCount+1});let n=i;if(this.appState.app.prevLaunchTimestamp){let e=0,t=n-this.appState.app.prevLaunchTimestamp,i=Math.floor(t/vs),s=t%vs;e=i;let r=new Date(this.appState.app.prevLaunchTimestamp),a=60*r.getHours()*60*1e3+60*r.getMinutes()*1e3+1e3*r.getSeconds()+r.getMilliseconds();s>=vs-a&&(e+=1),e>0&&rs().change()("app",{appDaysLaunchesCount:this.appState.app.appDaysLaunchesCount+1});let o=this.appState.app.appDaysLaunchesCount_consequent_withMaxBreaks_Day1;0<e&&e<=1?o=this.appState.app.appDaysLaunchesCount_consequent_withMaxBreaks_Day1+1:e>1&&(o=0);let l=this.appState.app.appDaysLaunchesCount_consequent_withMaxBreaks_Day3;0<e&&e<=3?l=this.appState.app.appDaysLaunchesCount_consequent_withMaxBreaks_Day3+1:e>3&&(l=0);let h=0;0<e&&e<=7?h=this.appState.app.appDaysLaunchesCount_consequent_withMaxBreaks_Day7+1:e>7&&(h=0),rs().change()("app",{appDaysLaunchesCount_consequent_withMaxBreaks_Day1:o,appDaysLaunchesCount_consequent_withMaxBreaks_Day3:l,appDaysLaunchesCount_consequent_withMaxBreaks_Day7:h})}this.updateUsageTime(),this.updateTimeInterval=setInterval(()=>{this.updateUsageTime()},1e3/60),this.updateStorageData(),this.updateStorageInterval=setInterval(()=>{this.updateStorageData()},6e4)}updateUsageTime(){let e=Date.now()-this.appState.app.curLaunchTimestamp;rs().change()("app",{sessionDuration:e,totalUsageDuration:this.appState.app.prevSessionTotalUsageDuration+e}),this.updateStorageData()}applyStorageData(e){e&&rs().change()("app",Object.assign({},e))}updateStorageData(){const e=this.generateStorageData();this.storageManager.setParam(ds,e)}generateStorageData(){return{appLaunchesCount:this.appState.app.appLaunchesCount,totalUsageDuration:this.appState.app.totalUsageDuration,curLaunchTimestamp:this.appState.app.curLaunchTimestamp,prevLaunchTimestamp:this.appState.app.prevLaunchTimestamp,appDaysLaunchesCount:this.appState.app.appDaysLaunchesCount,appDaysLaunchesCount_consequent_withMaxBreaks_Day1:this.appState.app.appDaysLaunchesCount_consequent_withMaxBreaks_Day1,appDaysLaunchesCount_consequent_withMaxBreaks_Day3:this.appState.app.appDaysLaunchesCount_consequent_withMaxBreaks_Day3,appDaysLaunchesCount_consequent_withMaxBreaks_Day7:this.appState.app.appDaysLaunchesCount_consequent_withMaxBreaks_Day7}}}class bs extends qn{constructor(e){super(),this.debug=e}init(){super.init();const e=s.clone(os);s.copyProps(e,{app:{debug:this.debug}}),rs().initializeWith(e),O(ys,{isSingleton:!0,forceCreation:!0})}}class xs extends Rn{construction(...e){super.construction(...e),this.dataEventListenerHelper=new u(this)}processDataUnset(e){super.processDataUnset(e),this.dataEventListenerHelper.removeAllListeners()}}class Ts extends xs{construction(...e){super.construction(...e),this._minSize=new zt.b,this._maxSize=new zt.b,this._resizeSize=new zt.b}resize(e,t){this._minSize.x&&(e=Math.max(e,this._minSize.x)),this._maxSize.x&&(e=Math.min(e,this._maxSize.x)),this._minSize.y&&(t=Math.max(e,this._minSize.y)),this._maxSize.y&&(t=Math.min(t,this._maxSize.y)),this.resizeSize.x=e,this.resizeSize.y=t,this.isConstructed&&this.arrange()}get minSize(){return this._minSize}set minSize(e){e&&(e.x===this._minSize.x&&e.y===this._minSize.y||(this._minSize=e.clone(),this.resize(this.resizeSize.x,this.resizeSize.y)))}get maxSize(){return this._maxSize}set maxSize(e){e&&(e.x===this._maxSize.x&&e.y===this._maxSize.y||(this._maxSize=e.clone(),this.resize(this.resizeSize.x,this.resizeSize.y)))}get resizeSize(){return this._resizeSize}}class Ss extends Ts{construction(...e){super.construction(...e),this.globalDispatcher=D(Zn)}addGlobalEventListener(e,t){this.eventListenerHelper.addEventListener(this.globalDispatcher,e,t)}}class As extends Ts{construction(...e){super.construction(...e),this.viewToIdMap=new r}addView(e,t){this.viewToIdMap.push(e,t)}removeView(e){this.viewToIdMap.remove(e)}get selectedId(){return this._selectedId}set selectedId(e){e!=this.selectedId&&(this.selectedItem&&(this.selectedItem.parent.removeChild(this._selectedItem),this._selectedItem=null),this._selectedId=e,this._selectedItem=this.getViewById(this.selectedId),this.selectedItem&&this.addChild(this.selectedItem),this.commitData(),this.arrange())}getViewById(e){return this.viewToIdMap.getItem(e)}get selectedItem(){return this._selectedItem}commitData(){if(super.commitData(),this.selectedItem){this._selectedItem.data=this.data}}arrange(){if(super.arrange(),this._selectedItem&&this.resizeSize&&0!==this.resizeSize.x&&0!==this.resizeSize.y){const e=this._selectedItem;e.resize?e.resize(this.resizeSize.x,this.resizeSize.y):(this._selectedItem.width=this.resizeSize.x,this._selectedItem.height=this.resizeSize.y)}}}class Es extends As{construction(...e){super.construction(...e),this.viewClassToIdMap=new r}addViewClass(e,t){this.viewClassToIdMap.push(e,t)}removeViewClass(e){this.viewClassToIdMap.remove(e)}getViewById(e){return super.getViewById(e)||this.addView(this.getNewInstance(e),e),super.getViewById(e)}getNewInstance(e){let t,i=this.viewClassToIdMap.getItem(e);return i&&(t=new i),t}}class Cs extends Es{getNewInstance(e){let t,i=this.viewClassToIdMap.getItem(e);return i&&(t=D(i)),t}}class ws extends Ts{construction(...e){super.construction(e),this.viewStack=new Cs,this.addChild(this.viewStack);const t=rs().getMutableState();let i=Object.keys(t.pages.pageIdToViewClassMap);for(let e of i){let i=t.pages.pageIdToViewClassMap[e];this.viewStack.addViewClass(i,e)}this.commitPagesData()}addListeners(){super.addListeners()}commitPagesData(){this.viewStack.selectedId=rs().getState().pages.pageId,this.arrange()}arrange(){super.arrange(),this.viewStack.resize(this.resizeSize.x,this.resizeSize.y),this.viewStack.selectedItem&&this.viewStack.selectedItem.contentScale&&rs().change()("pages.activePageContentScale",{x:this.viewStack.selectedItem.contentScale.x,y:this.viewStack.selectedItem.contentScale.y})}}var Ps;!function(e){e.PRE_RESIZE="AppMainContainerEvent.PRE_RESIZE",e.POST_RESIZE="AppMainContainerEvent.POST_RESIZE"}(Ps||(Ps={}));class Is extends Ss{construction(...e){super.construction(...e),this.bg=this.createBg(),this.addChild(this.bg),this.pagesView=new ws,this.addChild(this.pagesView)}arrange(){super.arrange(),this.globalDispatcher.dispatchEvent(Ps.PRE_RESIZE),this.bg.width=this.resizeSize.x+2,this.bg.height=this.resizeSize.y+2,this.pagesView.resize(this.resizeSize.x,this.resizeSize.y),this.globalDispatcher.dispatchEvent(Ps.POST_RESIZE)}createBg(){let e=new Vt.A;return e.rect(0,0,10,10),e.fill({color:16777215,alpha:1e-7}),e}}var Ms,Rs=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,o)}l((n=n.apply(e,t||[])).next())})};class Ls{constructor(){this.modules=[]}destroy(){this.modules=[]}addModule(e){this.modules.push(e)}removeModule(e){o.removeItem(this.modules,e)}initModules(){return Rs(this,void 0,void 0,function*(){let e=this.modules.length;for(let t=0;t<e;t++)this.modules[t].init();for(let t=0;t<e;t++)yield this.modules[t].initCompleteHook()})}activateModules(){return Rs(this,void 0,void 0,function*(){let e=this.modules.length;for(let t=0;t<e;t++)yield this.modules[t].activateCompleteHook()})}}class ks extends ls{constructor(){super(...arguments),this.containersMap={}}addContainer(e,t){this.containersMap[t]=e}removeContainer(e){delete this.containersMap[e]}getContainer(e){let t;return this.containersMap[e]&&(t=this.containersMap[e]),t}}class Ds extends qn{init(){super.init(),O(ks,{isSingleton:!0})}}class Os extends c{construction(){super.construction(),this._text="",this.view=new Rn,this.view.interactive=!0,this.view.cursor="pointer",this.field=new Wn({autosize:!0,nativeTextStyle:{fill:$s.config.btnSettings.labelColor,fontSize:$s.config.btnSettings.labelSize}}),this.view.addChild(this.field),this.commitData(),this.onOut()}addListeners(){super.addListeners(),this.eventListenerHelper.addEventListener(this.view,Dn.OVER,this.onOver),this.eventListenerHelper.addEventListener(this.view,Dn.OUT,this.onOut),this.eventListenerHelper.addEventListener(this.view,Dn.TAP,this.onClick),this.eventListenerHelper.addEventListener(this.view,Dn.UP_OUTSIDE,this.onOut)}onOver(){this.view.alpha=1,this.tooltipData&&$s.tooltipManager.show(this.tooltipData)}onOut(){this.view.alpha=.75,$s.tooltipManager.hide()}onClick(){this.onOut()}commitData(){super.commitData(),this.field.text=this.text,this.arrange()}arrange(){super.arrange()}get text(){return this._text}set text(e){e!=this.text&&(this._text=e,this.commitData())}}class Bs{}Bs.CAPTURE_KEY_PRESS="CAPTURE_KEY_PRESS";class Gs extends Os{addListeners(){super.addListeners(),this.eventListenerHelper.addEventListener(vi.instance,pi,this.onKeyUp)}onClick(){super.onClick(),this.isClicked=!this.isClicked,this.isClicked||(this.captureKeyCode=null)}onKeyUp(e){this.view.visible&&(this.isClicked?(this.isClicked=!1,this.captureKey=e.nativeKeyboardEvent.key,this.captureKeyCode=e.nativeKeyboardEvent.code,this.commitData()):this.captureKeyCode&&this.captureKeyCode===e.nativeKeyboardEvent.code&&this.dispatchEvent(Bs.CAPTURE_KEY_PRESS))}commitData(){super.commitData(),this.isClicked?this.text=$s.config.localization.captureKeyBtnPressedLabel:this.captureKeyCode?this.text=M.substitute($s.config.localization.captureKeyBtnNormalLabel,{key:this.captureKey}):this.text=M.substituteList($s.config.localization.captureKeyBtnNormalLabel,{key:$s.config.localization.captureKeyBtnNoKeyHelpText})}arrange(){super.arrange()}get isClicked(){return this._isClicked}set isClicked(e){e!=this.isClicked&&(this._isClicked=e,this.commitData())}get captureKeyCode(){return this._captureKeyCode}set captureKeyCode(e){e!==this._captureKeyCode&&(this._captureKeyCode=e,this.commitData())}}class Fs extends c{constructor(){super(...arguments),this.lastBgWidth=0,this.lastBgHeight=0}construction(){super.construction(),this._titleVisible=!0,this._captureVisible=!1,this.topLevelElements=[],this.titleBtns=[],this.view=new Rn,this.bgGraphics=new Vt.A,this.view.addChild(this.bgGraphics),this.bgGraphics.interactive=!0,this.dragHelper=new _n,this.dragHelper.view=this.bgGraphics,this.contentCont=new Rn,this.view.addChild(this.contentCont),this.titleCont=new Rn,this.contentCont.addChild(this.titleCont),this.titleLabel=new Wn({autosize:!0,nativeTextStyle:{fill:$s.config.viewSettings.titleLabelColor,fontSize:$s.config.viewSettings.titleLabelSize}}),this.titleCont.addChild(this.titleLabel),this.titleLabel.text="Test Title",this.topLevelCont=new Rn,this.titleCont.addChild(this.topLevelCont),this.captureClickBtn=new Os,this.titleCont.addChild(this.captureClickBtn.view),this.captureClickBtn.view.y=this.titleLabel.y+this.titleLabel.height+10,this.captureClickBtn.tooltipData={title:$s.config.localization.captureClickBtnTooltip},this.captureClickBtn.text=$s.config.localization.captureClickBtnLabel,this.captureKeyBtn=new Gs,this.titleCont.addChild(this.captureKeyBtn.view),this.captureKeyBtn.view.y=this.captureClickBtn.view.y+this.captureClickBtn.view.height,this.captureKeyBtn.tooltipData={title:$s.config.localization.captureKeyBtnTooltipTitle},this.insideContentCont=new Rn,this.contentCont.addChild(this.insideContentCont)}addListeners(){super.addListeners(),this.eventListenerHelper.addEventListener(this.dragHelper,mn.DRAG_START,this.onDragStart),this.eventListenerHelper.addEventListener(this.dragHelper,mn.DRAG_UPDATE,this.onDragUpdate),this.eventListenerHelper.addEventListener(this.captureKeyBtn,Bs.CAPTURE_KEY_PRESS,this.onCapture),this.eventListenerHelper.addEventListener(this.captureClickBtn.view,Dn.TAP,this.onCapture)}onDragStart(){this.viewDragStartX=this.view.x,this.viewDragStartY=this.view.y,$s.moveViewToTopLayer(this)}onDragUpdate(){this.view.x=this.viewDragStartX+this.dragHelper.changeDragGlobalX,this.view.y=this.viewDragStartY+this.dragHelper.changeDragGlobalY}onClose(){$s.hideView(this)}onCapture(){}get visible(){return this._visible}set visible(e){e!=this.visible&&(this._visible=e,this.commitData())}commitData(){super.commitData(),this.view.visible=this.visible,this.titleLabel.visible=this.titleVisible,this.captureClickBtn.view.visible=this.captureVisible,this.captureKeyBtn.view.visible=this.captureVisible,this.arrange()}arrange(){let e,t,i=this.topLevelElements.length;for(let n=0;n<i;n++)e=this.topLevelElements[n],t&&(e.x=t.x+t.width+5),t=e;this.titleVisible?this.topLevelCont.x=this.titleLabel.x+this.titleLabel.width+10:this.topLevelCont.x=this.titleLabel.x,this.insideContentCont.visible?this.insideContentCont.y=this.titleCont.y+this.titleCont.height:this.insideContentCont.y=0;let n=this.contentCont.width+$s.config.viewSettings.bgToContentShift.x,s=this.contentCont.height+$s.config.viewSettings.bgToContentShift.y;n==this.lastBgWidth&&s==this.lastBgHeight||(this.lastBgWidth=n,this.lastBgHeight=s,this.bgGraphics.clear(),this.bgGraphics.rect(0,0,n,s),this.bgGraphics.setStrokeStyle({width:$s.config.viewSettings.borderWidth,color:$s.config.viewSettings.borderColor,alpha:$s.config.viewSettings.borderAlpha}),this.bgGraphics.fill({color:$s.config.viewSettings.bgColor,alpha:$s.config.viewSettings.bgAlpha}),this.bgGraphics.endFill()),this.contentCont.x=this.bgGraphics.x+(this.bgGraphics.width-this.contentCont.width>>1),this.contentCont.y=this.bgGraphics.y+(this.bgGraphics.height-this.contentCont.height>>1)}createTitleBtn(e,t,i){let n=new Os;return n.text=e,n.tooltipData=t,n.data=i,this.titleBtns.push(n),this.addTitleElement(n.view),n}addTitleElement(e){this.topLevelCont.addChild(e),this.topLevelElements.push(e)}get titleVisible(){return this._titleVisible}set titleVisible(e){e!=this.titleVisible&&(this._titleVisible=e,this.commitData())}get captureVisible(){return this._captureVisible}set captureVisible(e){e!=this.captureVisible&&(this._captureVisible=e,this.commitData())}}class Us extends Rn{constructor(){super(...arguments),this.prevTime=0,this.time=0,this.stepFps=0,this.fpsValues=[],this.cumulativeFpsValue=0}construction(...e){super.construction(e),this.border=new Vt.A,this.addChild(this.border),this.border.rect(0,0,$s.config.fpsSettings.borderWidth,$s.config.fpsSettings.borderHeight),this.border.fill({color:0,alpha:.5}),this.border.alpha=0,this.field=new Wn({nativeTextStyle:{fill:$s.config.fpsSettings.labelColor,fontSize:$s.config.fpsSettings.labelSize}}),this.addChild(this.field),this.field.text=M.substituteList($s.config.localization.fpsText,"00"),this.field.x=$s.config.fpsSettings.fieldToBorderPadding,this.field.y=$s.config.fpsSettings.fieldToBorderPadding,this.field.width=this.border.width-2*$s.config.fpsSettings.fieldToBorderPadding,this.field.height=this.border.height-2*$s.config.fpsSettings.fieldToBorderPadding}onAddedToStage(){super.onAddedToStage(),this.checkFps()}checkFps(){if(!this.stage)return;this.time=Date.now();let e=this.time-this.prevTime;if(this.stepFps=a.roundTo(1e3/e,.1),this.fpsValues.length>=$s.config.fpsSettings.cumulativeFpsCount){let e=this.fpsValues.shift();this.cumulativeFpsValue-=e}this.fpsValues.push(this.stepFps),this.cumulativeFpsValue+=this.stepFps,(!this.cumulativeFpsValue||this.cumulativeFpsValue<0)&&(this.cumulativeFpsValue=0),this.visible&&(this.field.text=M.substituteList($s.config.localization.fpsText,Math.floor(this.cumulativeFpsValue/this.fpsValues.length))),this.prevTime=this.time,requestAnimationFrame(()=>{this.checkFps()})}}!function(e){e.CUSTOM_BTN_CLICK="ConsoleViewEvent.CUSTOM_BTN_CLICK"}(Ms||(Ms={}));class Ns extends Fs{construction(){if(super.construction(),this.titleVisible=!1,this.displayListBtn=this.createTitleBtn($s.config.localization.displayListBtnLabel,{title:$s.config.localization.displayListBtnTooltipTitle,text:$s.config.localization.displayListBtnTooltipText}),this.addTitleElement(new Us),$s.config.customBtns)for(let e of $s.config.customBtns)this.createTitleBtn(e.label,{title:e.tooltip},e);this.closeBtn=this.createTitleBtn($s.config.localization.closeBtnLabel,{title:$s.config.localization.closeBtnTooltipTitle})}addListeners(){super.addListeners(),this.eventListenerHelper.addEventListener(this.displayListBtn.view,Dn.TAP,this.onDisplayListClick),this.eventListenerHelper.addEventListener(this.closeBtn.view,Dn.TAP,this.onClose);const e=e=>{this.eventListenerHelper.addEventListener(e.view,Dn.TAP,()=>{const t=e.data;t&&this.dispatchEvent(Ms.CUSTOM_BTN_CLICK,t)})};for(let t of this.titleBtns)e(t)}onDisplayListClick(){$s.toggleView($s.displayListView)}}class zs extends c{constructor(e){super(e)}construction(e){super.construction(),this.tooltip=e,this.mouseShift=new zt.b,this.tooltipInsideCont=new Rn,this.tooltipInsideCont.addChild(this.tooltip.view),this.hide()}addListeners(){super.addListeners(),Cn.instance.ticker.add(this.onTick,this)}removeListeners(){super.removeListeners(),Cn.instance.ticker.remove(this.onTick,this)}onTick(){this.update()}show(e){this.visible=!0,this.tooltip.data=e,this.update()}hide(){this.visible=!1}update(){if(!this.visible)return;if(!this.tooltipCont)return;this.tooltip;let e=Cn.instance.getGlobalInteractionPosition().clone();e.x+=this.mouseShift.x,e.y+=this.mouseShift.y,e.x<0?e.x=0:e.x+this.tooltip.view.width>Cn.instance.renderer.width&&(e.x=Cn.instance.renderer.width-this.tooltip.view.width),e.y<0?e.y=0:e.y+this.tooltip.view.height>Cn.instance.renderer.height&&(e.y=Cn.instance.renderer.height-this.tooltip.view.height),e=this.tooltip.view.parent.toLocal(e),this.moveTooltipTo(e.x,e.y)}moveTooltipTo(e,t){this.tooltip.view.x=e,this.tooltip.view.y=t}get tooltipCont(){return this._tooltipCont}set tooltipCont(e){this.tooltipCont!=e&&(this._tooltipCont=e,this.tooltipCont&&this.tooltipCont.addChild(this.tooltipInsideCont),this.update())}get mouseShift(){return this._mouseShift}set mouseShift(e){this._mouseShift=e.clone(),this.update()}get visible(){return this._visible}set visible(e){this._visible=e,this.tooltipInsideCont.visible=this.visible}}zs.SHOW_DELAY=.5;class Hs extends c{construction(){super.construction(),this.view=new Rn}commitData(){super.commitData(),this.tooltipData=this.data}}class Vs extends Hs{constructor(){super()}construction(){super.construction(),this.bg=new Vt.A,this.view.addChild(this.bg),this.contentCont=new Rn,this.view.addChild(this.contentCont),this.titleLabel=new Wn({autosize:!0,nativeTextStyle:{fill:$s.config.tooltipSettings.titleLabelColor,fontSize:$s.config.tooltipSettings.titleLabelSize,align:fn.CENTER}}),this.contentCont.addChild(this.titleLabel),this.textLabel=new Wn({autosize:!0,nativeTextStyle:{fill:$s.config.tooltipSettings.textLabelColor,fontSize:$s.config.tooltipSettings.textLabelSize,align:fn.CENTER}}),this.contentCont.addChild(this.textLabel)}commitData(){super.commitData(),this.tooltipData&&(this.titleLabel.text=this.tooltipData.title,this.textLabel.text=this.tooltipData.text,this.tooltipData.text?this.textLabel.visible=!0:this.textLabel.visible=!1,this.arrange())}arrange(){if(super.arrange(),this.textLabel.visible){let e=Math.max(this.titleLabel.width,this.textLabel.width);this.titleLabel.x=e-this.titleLabel.width>>1,this.textLabel.x=e-this.textLabel.width>>1,this.textLabel.y=this.titleLabel.y+this.titleLabel.height}else this.titleLabel.x=0;this.bg.clear(),this.bg.rect(0,0,this.contentCont.width+$s.config.tooltipSettings.bgToContentShift.x,this.contentCont.height+$s.config.tooltipSettings.bgToContentShift.y),this.bg.setStrokeStyle({width:$s.config.tooltipSettings.borderWidth,color:$s.config.tooltipSettings.borderColor,alpha:$s.config.tooltipSettings.borderAlpha}),this.bg.fill({color:$s.config.tooltipSettings.bgColor,alpha:$s.config.tooltipSettings.bgAlpha}),this.contentCont.x=this.bg.x+(this.bg.width-this.contentCont.width>>1),this.contentCont.y=this.bg.y+(this.bg.height-this.contentCont.height>>1)}}class Ws extends Rn{}class js{static getNextGlobalVarName(){const e=S.getUniqueIdForPool($s.config.displayListSettings.globalVarPoolId);return M.substituteList($s.config.displayListSettings.globalVarNamePattern,e)}static storeObjectAsGlobalVar(e){const t=js.getNextGlobalVarName();console.log(t),window[t]=e}}class Xs extends Rn{constructor(){super(),this._text="",this.isVisualControlsEnabled=!1}construction(){super.construction(),this.contentCont=new Rn,this.addChild(this.contentCont),this.contentCont.interactive=!0,this.contentCont.cursor="pointer",this.field=new Wn({autosize:!0,nativeTextStyle:{fill:$s.config.displayListSettings.hierarchyLabelColor,fontSize:$s.config.displayListSettings.hierarchyLabelSize}}),this.contentCont.addChild(this.field),this.tooltipData={title:$s.config.localization.displayListItemTooltipTitle},this.commitData(),this.onOut()}addListeners(){super.addListeners(),this.eventListenerHelper.addEventListener(this.contentCont,Dn.OVER,this.onOver),this.eventListenerHelper.addEventListener(this.contentCont,Dn.OUT,this.onOut),this.eventListenerHelper.addEventListener(this.contentCont,Dn.TAP,this.onClick),this.eventListenerHelper.addEventListener(this.contentCont,Dn.UP_OUTSIDE,this.onOut)}onOver(){this.field.changeConfig({nativeTextStyle:{fill:$s.config.displayListSettings.hierarchyLabelColorOver}}),$s.tooltipManager.show(this.tooltipData)}onOut(){this.field.changeConfig({nativeTextStyle:{fill:$s.config.displayListSettings.hierarchyLabelColor}}),$s.tooltipManager.hide()}onClick(){this.onOut(),console.log(this.data.object),js.storeObjectAsGlobalVar(this.data.object),this.isVisualControlsEnabled&&(this.data.object.visible=!this.data.object.visible)}commitData(){super.commitData(),this.field.text=this.text,this.arrange()}arrange(){super.arrange()}get text(){return this._text}set text(e){e!=this.text&&(this._text=e,this.commitData())}}class Ys extends Os{addListeners(){super.addListeners(),this.eventListenerHelper.addEventListener(vi.instance,pi,this.onKeyUp),Cn.instance.ticker.add(this.onTick,this)}onTick(){this.isClicked}onClick(){super.onClick(),this.isClicked=!this.isClicked,this.isClicked&&(this.pauseKeyCode=null,this.isActivated=!1)}onKeyUp(e){this.view.visible&&(this.isClicked?(this.isClicked=!1,this.pauseKey=e.nativeKeyboardEvent.key,this.pauseKeyCode=e.nativeKeyboardEvent.code,this.commitData()):this.pauseKeyCode&&this.pauseKeyCode===e.nativeKeyboardEvent.code&&(this.isActivated=!this.isActivated))}commitData(){super.commitData(),this.isClicked?this.text=$s.config.localization.pauseUpdateKeyBtnPressedLabel:this.pauseKeyCode?this.isActivated?this.text=M.substitute($s.config.localization.pauseUpdateKeyBtnNormalLabel,{key:this.pauseKey,status:$s.config.localization.onStatus}):this.text=M.substitute($s.config.localization.pauseUpdateKeyBtnNormalLabel,{key:this.pauseKey,status:$s.config.localization.offStatus}):this.text=M.substitute($s.config.localization.pauseUpdateKeyBtnNormalLabel,{key:$s.config.localization.pauseUpdateKeyBtnNoKeyHelpText})}arrange(){super.arrange()}get isClicked(){return this._isClicked}set isClicked(e){e!=this.isClicked&&(this._isClicked=e,this.commitData())}get pauseKeyCode(){return this._pauseKeyCode}set pauseKeyCode(e){e!==this._pauseKeyCode&&(this._pauseKeyCode=e,this.commitData())}get isActivated(){return this._isActivated}set isActivated(e){e!==this.isActivated&&(this._isActivated=e,this.commitData())}}class Ks extends Fs{constructor(){super()}construction(){super.construction(),this.captureVisible=!0,this.pauseVisible=!0,this.lastCheckedPos=new zt.b,this.moveObjectIndex=-1,this.titleLabel.text=$s.config.localization.displayListTitle,this.insideContentCont.visible=!0,this.pauseKeyBtn=new Ys,this.insideContentCont.addChild(this.pauseKeyBtn.view),this.pauseKeyBtn.view.y=5,this.pauseKeyBtn.tooltipData={title:$s.config.localization.pauseUpdateKeyBtnTooltipTitle},this.ignoreConsoleBtn=new Os,this.insideContentCont.addChild(this.ignoreConsoleBtn.view),this.ignoreConsoleBtn.tooltipData={title:$s.config.localization.ignoreInfoBtnTooltipTitle,text:$s.config.localization.ignoreInfoBtnTooltipText},this.ignoreConsoleBtn.field.changeConfig({nativeTextStyle:{fontSize:$s.config.btnSettings.smallSize}}),this.ignoreConsoleBtn.view.y=this.pauseKeyBtn.view.y+this.pauseKeyBtn.view.height+5,this.additionalInfoBtn=new Os,this.insideContentCont.addChild(this.additionalInfoBtn.view),this.additionalInfoBtn.tooltipData={title:$s.config.localization.additionalInfoBtnTooltipTitle,text:$s.config.localization.additionalInfoBtnTooltipText},this.additionalInfoBtn.field.changeConfig({nativeTextStyle:{fontSize:$s.config.btnSettings.smallSize}}),this.additionalInfoBtn.view.y=this.ignoreConsoleBtn.view.y+this.ignoreConsoleBtn.view.height,this.visualControlsBtn=new Os,this.insideContentCont.addChild(this.visualControlsBtn.view),this.visualControlsBtn.tooltipData={title:$s.config.localization.visualControlsBtnTooltipTitle,text:$s.config.localization.visualControlsBtnTooltipText},this.visualControlsBtn.field.changeConfig({nativeTextStyle:{fontSize:$s.config.btnSettings.smallSize}}),this.visualControlsBtn.view.y=this.additionalInfoBtn.view.y+this.additionalInfoBtn.view.height,this.moveHelperBtn=new Os,this.insideContentCont.addChild(this.moveHelperBtn.view),this.moveHelperBtn.tooltipData={title:$s.config.localization.moveHelperTooltipTitle,text:$s.config.localization.moveHelperTooltipText},this.moveHelperBtn.field.changeConfig({nativeTextStyle:{fontSize:$s.config.btnSettings.smallSize}}),this.moveHelperBtn.view.y=this.visualControlsBtn.view.y+this.visualControlsBtn.view.height,this.displayListField=new Wn({autosize:!0,nativeTextStyle:{fill:$s.config.displayListSettings.hierarchyLabelColor,fontSize:$s.config.displayListSettings.hierarchyLabelSize}}),this.insideContentCont.addChild(this.displayListField),this.displayListField.y=this.moveHelperBtn.view.y+this.moveHelperBtn.view.height+5,this.displayListField.visible=!1,this.displayListItemsPool=new I,this.displayListItemsCont=new Rn,this.insideContentCont.addChild(this.displayListItemsCont),this.displayListItemsCont.y=this.moveHelperBtn.view.y+this.moveHelperBtn.view.height+5,this.closeBtn=this.createTitleBtn($s.config.localization.closeBtnLabel,{title:$s.config.localization.closeBtnTooltipTitle}),this.captureKeyBtn.tooltipData.text=$s.config.localization.captureKeyBtnTooltipText,$s.config.displayListSettings.defaultCaptureKeyCode&&(this.captureKeyBtn.captureKey=$s.config.displayListSettings.defaultCaptureKey,this.captureKeyBtn.captureKeyCode=$s.config.displayListSettings.defaultCaptureKeyCode),$s.config.displayListSettings.defaultPauseKeyCode&&(this.pauseKeyBtn.pauseKey=$s.config.displayListSettings.defaultPauseKey,this.pauseKeyBtn.pauseKeyCode=$s.config.displayListSettings.defaultPauseKeyCode),this.isIgnoreConsoleEnabled=$s.config.displayListSettings.defaultIgnoreConsoleEnabled,this.isAdditionalInfoEnabled=$s.config.displayListSettings.defaultAdditionalInfoEnabled,this.isVisualControlsEnabled=$s.config.displayListSettings.defaultVisualControlsEnabled,this.isMoveHelperEnabled=$s.config.displayListSettings.defaultMoveHelperEnabled}destruction(){super.destruction(),this.lastUnderPointData=null,this.lastAllObjectsUnderPointList=null,this.moveObject&&(this.moveObject=null),this.prevMoveObject=null}addListeners(){super.addListeners(),Cn.instance.ticker.add(this.onTick,this),this.eventListenerHelper.addEventListener(this.closeBtn.view,Dn.TAP,this.onClose),this.eventListenerHelper.addEventListener(this.additionalInfoBtn.view,Dn.TAP,this.onAdditionalInfo),this.eventListenerHelper.addEventListener(this.visualControlsBtn.view,Dn.TAP,this.onVisualControls),this.eventListenerHelper.addEventListener(this.ignoreConsoleBtn.view,Dn.TAP,this.onIgnoreConsole),this.eventListenerHelper.addEventListener(this.moveHelperBtn.view,Dn.TAP,this.onMoveHelper),this.eventListenerHelper.addEventListener(vi.instance,di,this.onKeyDown)}removeListeners(){super.removeListeners(),Cn.instance.ticker.remove(this.onTick,this)}onTick(){if(!this.paused&&!this.pauseKeyBtn.isActivated&&this.visible){const e=Cn.instance.getGlobalInteractionPosition();this.lastCheckedPos.x=e.x,this.lastCheckedPos.y=e.y;let t=null;this.isIgnoreConsoleEnabled&&(t=e=>!(e instanceof Ws));let i=Kn.getObjectsUnderPoint(Cn.instance.stage,e.x,e.y,t);!this.forceUpdateUnderPointView&&this.checkUnderPointDataEqual(i,this.lastUnderPointData)||(this.forceUpdateUnderPointView=!1,this.lastUnderPointData=i,this.lastAllObjectsUnderPointList=[],this.parseUnderPointDataToSingleList(this.lastUnderPointData,this.lastAllObjectsUnderPointList),this.commitDisplayListData())}}onCapture(){super.onCapture(),console.group($s.config.localization.displayListStructureLogTitle),this.groupLogUnderPointData(this.lastUnderPointData),console.groupEnd()}onIgnoreConsole(){this.isIgnoreConsoleEnabled=!this.isIgnoreConsoleEnabled}onAdditionalInfo(){this.isAdditionalInfoEnabled=!this.isAdditionalInfoEnabled}onVisualControls(){this.isVisualControlsEnabled=!this.isVisualControlsEnabled}onMoveHelper(){this.isMoveHelperEnabled=!this.isMoveHelperEnabled}onKeyDown(e){if(this.isMoveHelperEnabled){let t=e.nativeKeyboardEvent.code;if(e.nativeKeyboardEvent.ctrlKey)this.moveObjectIndex--,this.commitData();else if(-1!=Ks.ARROW_KEY_CODES.indexOf(t)&&this.moveObject){let i=0,n=0;t==j?i=-1:t==X&&(i=1),t==V?n=-1:t==W&&(n=1),e.nativeKeyboardEvent.shiftKey&&(i*=10,n*=10),this.moveObject.x+=i,this.moveObject.y+=n,console.log("Movable object: ",this.moveObject),console.log("x: "+this.moveObject.x+", y: "+this.moveObject.y)}}}parseUnderPointDataToText(e,t=""){let i="";if(e&&e.object){let n=e.object.toString();if(e.object.constructor&&(n=s.getConstructorName(e.object.constructor)),i+=t+" "+n,$s.config.displayListSettings.nameParamName&&e.object[$s.config.displayListSettings.nameParamName]&&(i+=" ("+e.object[$s.config.displayListSettings.nameParamName]+")"),this.isMoveHelperEnabled&&e.object==this.moveObject&&(i+=" "+$s.config.localization.movableObjectText),this.isAdditionalInfoEnabled&&$s.config.displayListSettings.additionalInfoParams){let t,n;i+=" - { ";let s,r,a=Object.keys($s.config.displayListSettings.additionalInfoParams),o=a.length;for(let l=0;l<o;l++)s=a[l],void 0!==e.object[s]&&(l>0&&(i+=", "),t=e.object[s],n=$s.config.displayListSettings.additionalInfoParams[s],(n.toFixed||0===n.toFixed)&&t!==Math.floor(t)&&(t=t.toFixed(n.toFixed)),r=s,n.visualName&&(r=n.visualName),i+=r+": "+t);i+=" }"}if(e.children&&e.children.length>0){let n="- "+t,s=e.children.length;for(let t=0;t<s;t++)i+="\n"+this.parseUnderPointDataToText(e.children[t],n)}}return i}parseUnderPointDataToVisualItemsList(e,t=""){let i=[];if(e&&e.object){let n=e.object.toString();e.object.constructor&&(n=s.getConstructorName(e.object.constructor));let r=t+" "+n;if($s.config.displayListSettings.nameParamName&&e.object[$s.config.displayListSettings.nameParamName]&&(r+=" ("+e.object[$s.config.displayListSettings.nameParamName]+")"),this.isMoveHelperEnabled&&e.object==this.moveObject&&(r+=" "+$s.config.localization.movableObjectText),this.isAdditionalInfoEnabled&&$s.config.displayListSettings.additionalInfoParams){let t,i;r+=" - { ";let n,s,a=Object.keys($s.config.displayListSettings.additionalInfoParams),o=a.length;for(let l=0;l<o;l++)n=a[l],void 0!==e.object[n]&&(l>0&&(r+=", "),t=e.object[n],i=$s.config.displayListSettings.additionalInfoParams[n],(i.toFixed||0===i.toFixed)&&t!==Math.floor(t)&&(t=t.toFixed(i.toFixed)),s=n,i.visualName&&(s=i.visualName),r+=s+": "+t);r+=" }"}let a=this.displayListItemsPool.getObject(Xs);if(a.data=e,a.text=r,a.isVisualControlsEnabled=this.isVisualControlsEnabled,i.push(a),e.children&&e.children.length>0){let n="- "+t,s=e.children.length;for(let t=0;t<s;t++)i.push(...this.parseUnderPointDataToVisualItemsList(e.children[t],n))}}return i}groupLogUnderPointData(e,t=""){if(e&&e.object){const i=s.getConstructorName(e.object);let n=t;if(i&&(n=t+" "+i),console.log(n,e.object),e.children&&e.children.length>0){let i=e.children.length;for(let n=0;n<i;n++)this.groupLogUnderPointData(e.children[n],"    "+t)}}}checkUnderPointDataEqual(e,t){let i=!0;if(!!e!=!!t)i=!1;else if(e&&t)if(e.object!=t.object)i=!1;else if(!!e.children!=!!t.children)i=!1;else if(e.children&&t.children)if(e.children.length!=t.children.length)i=!1;else{let n=e.children.length;for(let s=0;s<n;s++)if(!this.checkUnderPointDataEqual(e.children[s],t.children[s])){i=!1;break}}return i}parseUnderPointDataToSingleList(e,t){if(e&&e.object&&(t.push(e.object),e.children&&e.children.length>0)){let i=e.children.length;for(let n=0;n<i;n++)this.parseUnderPointDataToSingleList(e.children[n],t)}}get isAdditionalInfoEnabled(){return this._isAdditionalInfoEnabled}set isAdditionalInfoEnabled(e){e!=this._isAdditionalInfoEnabled&&(this._isAdditionalInfoEnabled=e,this.commitData())}get isVisualControlsEnabled(){return this._isVisualControlsEnabled}set isVisualControlsEnabled(e){e!=this._isVisualControlsEnabled&&(this._isVisualControlsEnabled=e,this.commitData())}get isMoveHelperEnabled(){return this._isMoveHelperEnabled}set isMoveHelperEnabled(e){e!=this._isMoveHelperEnabled&&(this._isMoveHelperEnabled=e,this.commitData())}get isIgnoreConsoleEnabled(){return this._isIgnoreConsoleEnabled}set isIgnoreConsoleEnabled(e){e!=this._isIgnoreConsoleEnabled&&(this._isIgnoreConsoleEnabled=e,this.commitData())}commitData(){super.commitData(),this.commitDisplayListData(),this.visible||(this.isAdditionalInfoEnabled=!1,this.isMoveHelperEnabled=!1,this.isVisualControlsEnabled=!1),this.pauseKeyBtn&&(this.pauseKeyBtn.view.visible=this.pauseVisible),this.ignoreConsoleBtn&&(this.isIgnoreConsoleEnabled?this.ignoreConsoleBtn.text=$s.config.localization.ignoreInfoBtnPressedLabel:this.ignoreConsoleBtn.text=$s.config.localization.ignorelInfoBtnNormalLabel),this.additionalInfoBtn&&(this.isAdditionalInfoEnabled?this.additionalInfoBtn.text=$s.config.localization.additionalInfoBtnPressedLabel:this.additionalInfoBtn.text=$s.config.localization.additionalInfoBtnNormalLabel),this.visualControlsBtn&&(this.isVisualControlsEnabled?this.visualControlsBtn.text=$s.config.localization.visualControlsBtnPressedLabel:this.visualControlsBtn.text=$s.config.localization.visualControlsBtnNormalLabel),this.moveHelperBtn&&(this.isMoveHelperEnabled?(this.moveHelperBtn.text=$s.config.localization.moveHelperBtnPressedLabel,(this.moveObjectIndex<-1||this.moveObjectIndex>=this.lastAllObjectsUnderPointList.length)&&(this.moveObjectIndex=this.lastAllObjectsUnderPointList.length-1),this.lastAllObjectsUnderPointList[this.moveObjectIndex]?this.moveObject=this.lastAllObjectsUnderPointList[this.moveObjectIndex]:this.moveObject=null):(this.moveHelperBtn.text=$s.config.localization.moveHelperBtnNormalLabel,this.moveObject=null,this.moveObjectIndex=-1),this.prevMoveObject!==this.moveObject&&(this.forceUpdateUnderPointView=!0),this.prevMoveObject=this.moveObject)}commitDisplayListData(){if(!this.lastUnderPointData)return;let e=this.parseUnderPointDataToText(this.lastUnderPointData);this.displayListField.text=e,this.clearDisplayListItems();let t=this.parseUnderPointDataToVisualItemsList(this.lastUnderPointData);this.createDisplayListItems(t),this.arrange()}get pauseVisible(){return this._pauseVisible}set pauseVisible(e){e!=this.pauseVisible&&(this._pauseVisible=e,this.commitData())}clearDisplayListItems(){let e=this.displayListItemsCont.children.length;for(let t=0;t<e;t++){let e=this.displayListItemsCont.children[t];this.displayListItemsPool.addObject(e,Xs)}Un.removeAllChildren(this.displayListItemsCont)}createDisplayListItems(e){let t,i=e.length;for(let n=0;n<i;n++){let i=e[n];this.displayListItemsCont.addChild(i),i.y=t?t.y+t.height:0,t=i}}}Ks.ARROW_KEY_CODES=[j,X,V,W];class qs{constructor(){this.password="`",this.localization={closeBtnTooltipTitle:"Close",onStatus:"on",offStatus:"off",closeBtnLabel:"X",displayListBtnLabel:"DL",displayListBtnTooltipTitle:"Display List Inspector",displayListBtnTooltipText:"Map the display list\nunder your mouse",captureClickBtnLabel:"Capture",captureClickBtnTooltip:"Click to show the display list data in the dev console",captureKeyBtnTooltipTitle:"Assign a key to copy display data into dev console",captureKeyBtnTooltipText:"Press an assinged key\nto add display list hierarchy\nto the browser console",captureKeyBtnNormalLabel:"Capture key: {key}",captureKeyBtnPressedLabel:"Press a key",captureKeyBtnNoKeyHelpText:"(click to add)",pauseUpdateKeyBtnTooltipTitle:"Assign a key to pause display list data update",pauseUpdateKeyBtnNormalLabel:"Pause key: {key} ({status})",pauseUpdateKeyBtnPressedLabel:"Press a key",pauseUpdateKeyBtnNoKeyHelpText:"(click to add)",displayListItemTooltipTitle:"Click to show the display item data in the dev console",displayListTitle:"Display List Inspector",displayListStructureLogTitle:"Display List Structure:",additionalInfoBtnNormalLabel:"Additional Info: off",additionalInfoBtnPressedLabel:"Additional Info: on",additionalInfoBtnTooltipTitle:"Additional visual objects info",additionalInfoBtnTooltipText:"Position, width, height, etc. (configurable)",visualControlsBtnNormalLabel:"Visual Controls: off",visualControlsBtnPressedLabel:"Visual Controls: on",visualControlsBtnTooltipTitle:"Visual Controls",visualControlsBtnTooltipText:"Click on object to switch visibility of objects",ignorelInfoBtnNormalLabel:"Ignore Console: off",ignoreInfoBtnPressedLabel:"Ignore Console: on",ignoreInfoBtnTooltipTitle:"Ignore console classes",ignoreInfoBtnTooltipText:"Console-related classes\nwon't be shown in the inspector",moveHelperBtnNormalLabel:"Move Helper: off",moveHelperBtnPressedLabel:"Move Helper: on",moveHelperTooltipTitle:"Move Helper",moveHelperTooltipText:"Enable Move Helper and press CTRL\nfor choosing an object to move\nwith arrow keys (   )",movableObjectText:"[MOVABLE]",fpsText:"FPS: {0}"},this.console={aboveAll:!0,defaultVisible:!1},this.btnSettings={labelSize:14,labelColor:16750848,smallSize:12},this.viewSettings={bgColor:0,bgAlpha:.75,bgToContentShift:{x:10,y:10},borderWidth:1,borderColor:6684672,borderAlpha:.75,titleLabelColor:16777215,titleLabelSize:14},this.displayListSettings={defaultVisible:!1,defaultCaptureKeyCode:H,defaultCaptureKey:"c",defaultPauseKeyCode:z,defaultPauseKey:"p",defaultIgnoreConsoleEnabled:!0,defaultAdditionalInfoEnabled:!1,defaultVisualControlsEnabled:!1,defaultMoveHelperEnabled:!1,hierarchyLabelColor:13421772,hierarchyLabelColorOver:16750848,hierarchyLabelSize:14,nameParamName:"name",additionalInfoParams:{x:{toFixed:2},y:{toFixed:2},width:{visualName:"w",toFixed:2},height:{visualName:"h",toFixed:2}},globalVarPoolId:"fconsole_globalVarPool",globalVarNamePattern:"fconsoleTemp{0}"},this.tooltipSettings={bgColor:0,bgAlpha:.75,bgToContentShift:{x:10,y:10},borderWidth:1,borderColor:6684672,borderAlpha:.75,titleLabelColor:16750848,titleLabelSize:14,textLabelColor:13421772,textLabelSize:12},this.fpsSettings={labelSize:12,labelColor:16750848,borderColor:16750848,borderWidth:50,borderHeight:16,fieldToBorderPadding:2,cumulativeFpsCount:60},this.customBtns=[]}}class $s{static startInit(e,t){P.log("FConsole Class (FC): ",$s);const i=new qs;t&&s.copyProps(i,t),$s.config=i,$s.eventListenerHelper=new u($s),$s.contentCont=new Ws,$s.viewsCont=new Rn,$s.contentCont.addChild($s.viewsCont),$s.tooltipsCont=new Rn,$s.contentCont.addChild($s.tooltipsCont);let n=new Vs;$s.tooltipManager=new zs(n),$s.tooltipManager.tooltipCont=$s.tooltipsCont,$s.tooltipManager.mouseShift=new zt.b(10,15),$s.view=new Ns,$s.hideView($s.view),$s.displayListView=new Ks,$s.eventListenerHelper.addEventListener(vi.instance,di,e=>{let t=e.nativeKeyboardEvent.key;t&&t.toUpperCase()===$s.config.password.charAt($s.passwordInputIndex).toUpperCase()?($s.passwordInputIndex++,$s.passwordInputIndex>=$s.config.password.length&&($s.onPasswordInput(),$s.passwordInputIndex=0)):$s.passwordInputIndex=0}),Cn.instance.ticker.add($s.onTicker),$s.root=e,$s.visible=$s.config.console.defaultVisible}static onTicker(){$s.visible&&$s.config.console.aboveAll&&Un.moveObjectToTopLayer($s.contentCont)}static onPasswordInput(){$s.visible=!$s.visible}static get visible(){return $s.view.visible}static set visible(e){e?($s.showView($s.view,!1),Un.moveObjectToTopLayer($s.viewsCont),Un.moveObjectToTopLayer($s.tooltipsCont),$s.config.displayListSettings.defaultVisible&&$s.showView($s.displayListView)):$s.hideView($s.view)}static showView(e,t=!0){if($s.viewsCont.addChild(e.view),e.visible=!0,$s.moveViewToTopLayer(e),t){const t=Cn.instance.getGlobalInteractionPosition();let i=e.view.parent.toLocal(new zt.b(t.x+1,t.y+1));e.view.x=i.x,e.view.y=i.y}}static hideView(e){e.view.parent&&e.view.parent.removeChild(e.view),e.visible=!1}static toggleView(e,t=!0){e.visible?$s.hideView(e):$s.showView(e,t)}static moveViewToTopLayer(e){Un.moveObjectToTopLayer(e.view)}static get root(){return $s._root}static set root(e){$s.root&&$s.root.removeChild($s.contentCont),$s._root=e,$s.root&&$s.root.addChild($s.contentCont)}}$s.passwordInputIndex=0;const Qs={debug:{fconsole:{console:{defaultVisible:!1}}}};class Zs extends qn{init(){super.init(),rs().initializeWith(Qs)}activateCompleteHook(){super.activateCompleteHook();const e=rs().getState();$s.startInit(Cn.instance.stage,e.debug.fconsole),P.addLoggerItem(new w)}}const Js={device:class{static getDeviceInfo(e){var t,i;let n=K.DESKTOP;if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))n=K.MOBILE;else{/(ipad|tablet|(android(?!.*mobile))|(windows(?!.*phone)(.*touch))|kindle|playbook|silk|(puffin(?!.*(IP|AP|WP))))/.test(e)&&(n=K.TABLET)}let s=1;window.devicePixelRatio&&(s=window.devicePixelRatio);const r=(null===(i=null===(t=window.navigator)||void 0===t?void 0:t.userAgentData)||void 0===i?void 0:i.platform)||window.navigator.platform,a=[];navigator.languages&&a.push(...navigator.languages),navigator.language&&-1===a.indexOf(navigator.language)&&a.push(navigator.language);let o,l="";if(a.length>0){l=a[0].split("-")[0].toLowerCase()}-1!==["Macintosh","MacIntel","MacPPC","Mac68K"].indexOf(r)?o=q.MAC_OS:-1!==["iPhone","iPad","iPod"].indexOf(r)?o=q.IOS:-1!==["Win32","Win64","Windows","WinCE"].indexOf(r)?o=q.WINDOWS:/Android/.test(e)?o=q.ANDROID:/Linux/.test(r)&&(o=q.LINUX);let h={deviceType:n,pixelRatio:s,isFullScreenApiAvailable:!1,osType:o,mainLocale:l,languages:a};try{h.isFullScreenApiAvailable=Q.isEnabled}catch(e){console.log("ERROR! DeviceTools | getDeviceInfo __ error: ",e)}return h}}.getDeviceInfo(navigator.userAgent)};class er extends qn{init(){super.init(),rs().initializeWith(Js)}}class tr extends ls{bindCommand(e,t,i){this.eventListenerHelper.addEventListener(this.globalDispatcher,e,(...e)=>{i&&!i(...e)||D(t,...e).execute()})}}class ir extends qn{init(){super.init(),O(Zn,{isSingleton:!0}),O(tr,{isSingleton:!0})}}var nr,sr;!function(e){e.FOCUS_RECEIVED="HTMLManagerEvent.FOCUS_RECEIVED",e.FOCUS_LOST="HTMLManagerEvent.FOCUS_LOST"}(nr||(nr={}));class rr extends ls{constructor(){super(...arguments),this.soundsManager=D(Tn),this.isFirstClickComplete=!1,this.blurLocker={id:"HTMLManager.blurLocker"},this.visibilityLocker={id:"HTMLManager.visibilityLocker"}}addListeners(){if(super.addListeners(),this.eventListenerHelper.addEventListener(document,"click",this.onInteraction),this.eventListenerHelper.addEventListener(document,"touchend",this.onInteraction),void 0!==document.hidden?this.documentHiddenPropertyName="hidden":void 0!==document.mozHidden?this.documentHiddenPropertyName="mozHidden":void 0!==document.msHidden?this.documentHiddenPropertyName="msHidden":void 0!==document.webkitHidden&&(this.documentHiddenPropertyName="webkitHidden"),this.documentHiddenPropertyName){const e=["visibilitychange","mozvisibilitychange","msvisibilitychange","webkitvisibilitychange","qbrowserVisibilityChange"];for(let t of e)this.eventListenerHelper.addEventListener(document,t,this.onVisibilityChange)}else this.eventListenerHelper.addEventListener(window,"focus",this.onFocus),this.eventListenerHelper.addEventListener(window,"blur",this.onBlur)}onInteraction(){this.isFirstClickComplete||(this.isFirstClickComplete=!0,this.soundsManager.activate(),this.onFocus())}onVisibilityChange(e){console.log("HTML MANAGER | onVisibilityChange __ this.documentHiddenPropertyName: "+this.documentHiddenPropertyName," | document[this.documentHiddenPropertyName]: ",document[this.documentHiddenPropertyName]," | event.hidden: ",e.hidden),this.documentHiddenPropertyName&&(document[this.documentHiddenPropertyName]||e.hidden?(this.soundsManager.addDisableLock(this.visibilityLocker),this.onBlur()):(this.soundsManager.removeDisableLock(this.visibilityLocker),this.onFocus()))}onFocus(e){console.log("HTML MANAGER | onFocus"),this.soundsManager.removeDisableLock(this.blurLocker),this.dispatchEvent(nr.FOCUS_RECEIVED)}onBlur(e){console.log("HTML MANAGER | onBlur"),this.soundsManager.addDisableLock(this.blurLocker),this.dispatchEvent(nr.FOCUS_LOST)}}class ar extends qn{init(){super.init(),O(rr,{isSingleton:!0,forceCreation:!0})}}class or extends f{construction(...e){super.construction(...e),this.globalDispatcher=D(Zn)}dispatchEvent(e,...t){super.dispatchEvent(e,...t),this.globalDispatcher.dispatchEvent(e,...t)}}class lr extends or{executeInternal(){new wn({src:ps,id:ps}).execute().then(e=>{console.log("LoadAppConfigCommand | executeInternal __ data: ",e),rs().change()("app.config",e);const t=rs().getMutableState(),i=rs().getState();D(an).addSubstituteParams({locale:t.device.mainLocale}),e.files&&new Pn(i.app.config.files).execute(),this.notifyComplete()},()=>{const e="LoadAppConfigCommand | executeInternal __ ERROR! Can't load the app-config.json file!";console.error(e),alert(e),this.errorCode=p.GENERAL_ERROR,this.terminate()})}}!function(e){e.CONFIG="config",e.PRELOAD="preload",e.INIT="init"}(sr||(sr={}));class hr extends or{constructor(e){super(),this.pageId=e}executeInternal(){rs().change()("pages.pageId",this.pageId),this.notifyComplete()}}const ur="InitApplicationDataEvent.INTI_APPLICATION_DATA_COMPLETE";class cr extends or{executeInternal(){this.notifyComplete()}notifyComplete(e,t){this.dispatchEvent(ur),super.notifyComplete(e,t)}}var dr;!function(e){e.UPDATE="TimeManagerEvent.UPDATE"}(dr||(dr={}));const pr="EntitiesQueryEvent.ENTITY_ADDED",fr="EntitiesQueryEvent.ENTITY_REMOVED";class gr extends c{constructor(e,t=[]){super(),this.includeTypes=e,this.excludeTypes=t,this._entities=[]}get entities(){return this._entities}addEntity(e){-1===this._entities.indexOf(e)&&(this._entities.push(e),this.dispatchEvent(pr,e))}removeEntity(e){-1!==this._entities.indexOf(e)&&(o.removeItem(this._entities,e),this.dispatchEvent(fr,e))}}class mr extends ls{constructor(){super(...arguments),this.entitiesList=[],this.entitiesToIdMap={},this.queriesToTypesMap={},this.queriesList=[],this.systemsList=[],this.entitiesUniquePoolId="ecsEntitiesUniquePool",this.entities={get:e=>this.entitiesToIdMap[e],getAll:()=>this.entitiesList.concat(),create:e=>{const t=Object.assign(Object.assign({},e),{id:S.getUniqueIdForPool(this.entitiesUniquePoolId)});return this.entities.add(t),t},add:e=>{-1===this.entitiesList.indexOf(e)&&(this.entitiesList.push(e),this.entitiesToIdMap[e.id]=e,this.addEntityToQueries(e))},remove:e=>{o.removeItem(this.entitiesList,e),delete this.entitiesToIdMap[e.id],this.removeEntityFromAllQueries(e)},addComponents:(e,...t)=>{for(let i of t)e.components[i.type]=i;this.updateAllQueriesForEntity(e)},removeComponents:(e,...t)=>{for(let i of t)delete e.components[i];this.updateAllQueriesForEntity(e)}},this.queries={get:(e,t)=>{var i;const n=e.concat().sort().join();let s="";t&&(s=t.concat().sort().join());let r=null===(i=this.queriesToTypesMap[n])||void 0===i?void 0:i[s];return r||(r=new gr(e,t),this.queriesToTypesMap[n]||(this.queriesToTypesMap[n]={}),this.queriesToTypesMap[n][s]=r,this.queriesList.push(r),this.updateAllEntitiesForQuery(r)),r}},this.systems={add:e=>{-1===this.systemsList.indexOf(e)&&this.systemsList.push(e)}}}construction(...e){super.construction(...e),this.timeState=rs().getState()}addListeners(){super.addListeners(),this.eventListenerHelper.addEventListener(this.globalDispatcher,dr.UPDATE,this.onTimeUpdate)}onTimeUpdate(){this.update(this.timeState.time.lastTimeDelta)}addEntityToQueries(e,t){t||(t=this.queriesList);for(let i of t)if(-1===i.entities.indexOf(e)){let t=!0;for(let n of i.includeTypes)if(!e.components[n]){t=!1;break}let n=!1;if(t)for(let t of i.excludeTypes)if(e.components[t]){n=!0;break}t&&!n&&i.addEntity(e)}}removeEntityFromAllQueries(e){for(let t of this.queriesList)t.removeEntity(e)}updateAllQueriesForEntity(e){this.removeEntityFromAllQueries(e),this.addEntityToQueries(e)}updateAllEntitiesForQuery(e){for(let t of this.entitiesList)this.addEntityToQueries(t,[e])}update(e){for(let t of this.systemsList)t.update(e)}}class _r extends qn{init(){super.init(),O(mr,{isSingleton:!0,forceCreation:!0})}}class vr extends Jn{constructor(e,t=[]){super(e,t),this.ecsManager=D(mr)}construction(e,t=[]){super.construction(),this.ecsManager=D(mr),this.includeTypes=e,this.excludeTypes=t,this.query=this.ecsManager.queries.get(this.includeTypes,this.excludeTypes)}addListeners(){super.addListeners(),this.eventListenerHelper.addEventListener(this.query,pr,this.onEntityAdded),this.eventListenerHelper.addEventListener(this.query,fr,this.onEntityRemoved)}onEntityAdded(e){}onEntityRemoved(e){}update(e){}}const yr="render";class br extends vr{constructor(){super([yr])}construction(e,t){super.construction(e,t),this.rootContainer=new Rn,this.containersManager=D(ks),this.containersManager.addContainer(this.rootContainer,"renderRootContainer")}onEntityAdded(e){super.onEntityAdded(e);this.getContainer(e.components.render.containerId).addChild(e.components.render.view)}onEntityRemoved(e){super.onEntityAdded(e),Un.childRemoveItselfFromParent(e.components.render.view)}getContainer(e){let t;return e&&(t=this.containersManager.getContainer(e)),t||(t=this.rootContainer),t}}class xr extends qn{init(){super.init(),O(br,{isSingleton:!0})}activateCompleteHook(){super.activateCompleteHook();const e=D(br);D(mr).systems.add(e)}}class Tr extends qn{constructor(e=""){super(),this.basePath=e}init(){super.init(),O(an,{isSingleton:!0,forceCreation:!0})}activateCompleteHook(){super.activateCompleteHook(),sn.instance.basePath=this.basePath}}class Sr extends qn{init(){super.init(),O(cs,{isSingleton:!0,forceCreation:!0})}}class Ar extends qn{init(){super.init(),O(F,{isSingleton:!0})}}class Er extends Jn{onActivatorStart(e){this.activator=e}onActivatorEnd(){this.destruction()}addActivatorListener(e,t){this.eventListenerHelper.addEventListener(this.activator,e,t)}}class Cr extends Er{onActivatorStart(e){super.onActivatorStart(e),this.eventListenerHelper.addEventListener(this.globalDispatcher,as()("pages.pageId"),this.onPageIdChange)}onPageIdChange(){this.activator.commitPagesData()}}const wr={pages:{pageId:"",pageIdToViewClassMap:{},activePageContentScale:{x:0,y:0}}};class Pr extends qn{init(){super.init(),rs().initializeWith(wr),O(ws,{activateeConstructors:[Cr]})}}class Ir extends qn{init(){super.init(),O(I,{isSingleton:!0}),O(Y,{toSubstitute:I})}}class Mr{constructor(){this.antialias=!0,this.backgroundAlpha=0,this.canvasCss={position:"absolute",top:"0px",left:"0px"}}}const Rr="RendererManagerEvent.PRE_RESIZE_HOOK",Lr="RendererManagerEvent.RESIZE";var kr=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,o)}l((n=n.apply(e,t||[])).next())})};class Dr extends ls{construction(){super.construction(),this.config=D(Mr),this.padding={top:0,bottom:0,left:0,right:0},this.activateApp()}activateApp(){return kr(this,void 0,void 0,function*(){const e=Object.assign({},this.config);if(ca.instance.app=new Cn,this._activateAppPromise=ca.instance.app.init(e),yield this.activateAppPromise,ca.instance.app.stage.interactive=!0,this.config.canvasCss){const e=Object.keys(this.config.canvasCss);for(let t of e)ca.instance.app.renderer.view.canvas.style[t]=this.config.canvasCss[t]}let t=document.body;this.config.canvasParentElementId&&(t=document.getElementById(this.config.canvasParentElementId)),t.appendChild(ca.instance.app.view)})}get activateAppPromise(){return this._activateAppPromise}resize(e,t,i){let n=0;this.padding.left&&(n+=this.padding.left),this.padding.right&&(n+=this.padding.right);let s=0;this.padding.top&&(s+=this.padding.top),this.padding.bottom&&(s+=this.padding.bottom);let r=e-n,a=t-s;this.dispatchEvent(Rr,new zt.b(r,a)),ca.instance.app.renderer.resize(r*i,a*i),ca.instance.app.renderer.view.canvas.style.width=r+"px",ca.instance.app.renderer.view.canvas.style.height=a+"px",this.padding.top&&(ca.instance.app.renderer.view.canvas.style.top=this.padding.top+"px"),this.padding.bottom&&(ca.instance.app.renderer.view.canvas.style.bottom=this.padding.bottom+"px"),this.padding.left&&(ca.instance.app.renderer.view.canvas.style.left=this.padding.left+"px"),this.padding.right&&(ca.instance.app.renderer.view.canvas.style.right=this.padding.right+"px"),this.dispatchEvent(Lr)}get rendererWidth(){return ca.instance.app.renderer.width}get rendererHeight(){return ca.instance.app.renderer.height}showView(){delete ca.instance.app.renderer.view.canvas.style.display}hideView(){ca.instance.app.renderer.view.canvas.style.display="none"}}var Or=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,o)}l((n=n.apply(e,t||[])).next())})};class Br extends qn{init(){super.init(),O(Mr,{isSingleton:!0}),O(Dr,{isSingleton:!0,forceCreation:!0})}activateCompleteHook(){const e=Object.create(null,{activateCompleteHook:{get:()=>super.activateCompleteHook}});return Or(this,void 0,void 0,function*(){e.activateCompleteHook.call(this);const t=D(Dr);yield t.activateAppPromise})}}class Gr extends c{constructor(){super(...arguments),this.soundsManager=D(Tn),this.fadeInTime=.5,this.fadeOutTime=.5}changeMusic(e){this.currentMusicId!==e&&(this.stopMusic(),this.currentMusicId=e,this.currentMusic=this.soundsManager.getSound(e),this.currentMusic&&(this.currentMusic.play({loop:!0}),this.currentMusic.tweenVolume(1,this.fadeInTime)))}stopMusic(){if(!this.currentMusic)return;const e=this.currentMusic;this.currentMusic=null,this.currentMusicId=null,e.tweenVolume(0,this.fadeOutTime,()=>{e.stop()})}}const Fr={isMutedParamId:"SoundsSettings.isMutedParamId",mutedTags:"SoundsSettings.mutedTags"};class Ur extends c{construction(...e){this.soundsManager=D(Tn),this.storageManager=D(cs),super.construction(...e)}addListeners(){super.addListeners(),this.eventListenerHelper.addEventListener(this.soundsManager,vn.IS_MUTED_CHANGE,this.onSoundsDataChange),this.eventListenerHelper.addEventListener(this.soundsManager,vn.TAGS_IS_MUTED_CHANGE,this.onSoundsDataChange)}onSoundsDataChange(){this.commitSoundsData()}activateCompleteHook(){const e=this.storageManager.getParam(Fr.isMutedParamId);!0!==e&&!1!==e||(this.soundsManager.isMuted=e);const t=this.storageManager.getParam(Fr.mutedTags);if(t)for(let e of t)this.soundsManager.setTagIsMuted(e,!0);this.commitSoundsData()}commitSoundsData(){this.storageManager.setParam(Fr.isMutedParamId,this.soundsManager.isMuted),this.storageManager.setParam(Fr.mutedTags,this.soundsManager.getTagsMuted())}}class Nr extends qn{init(){super.init(),O(Tn,{isSingleton:!0}),O(Gr,{isSingleton:!0}),O(Ur,{isSingleton:!0,forceCreation:!0})}activateCompleteHook(){super.activateCompleteHook();D(Ur).activateCompleteHook();const e=D(Zn),t=D(Tn),i=Object.keys(vn);for(let n of i){const i=vn[n];this.eventListenerHelper.addEventListener(t,i,(...t)=>{e.dispatchEvent(i,...t)})}}}const zr={time:{startTime:0,curTime:0,lastTimeDelta:0,lastTimeDeltaSec:0,minTimeDelta:0,maxTimeDelta:0}};class Hr extends ls{constructor(){super(...arguments),this.appStateStorage=rs(),this.timeModuleState=rs().getState()}addListeners(){super.addListeners(),hi.R.shared.add(this.onTick,this)}removeListeners(){super.removeListeners(),hi.R.shared.remove(this.onTick,this)}onTick(){const e=Date.now();let t=e-this.timeModuleState.time.curTime;this.timeModuleState.time.minTimeDelta&&t<this.timeModuleState.time.minTimeDelta||(this.timeModuleState.time.maxTimeDelta&&t>this.timeModuleState.time.maxTimeDelta&&(t=this.timeModuleState.time.maxTimeDelta),this.appStateStorage.change()("time.curTime",e),this.appStateStorage.change()("time.lastTimeDelta",t),this.appStateStorage.change()("time.lastTimeDeltaSec",t/1e3),this.dispatchEvent(dr.UPDATE))}}class Vr extends qn{init(){super.init(),rs().initializeWith(zr),O(Hr,{isSingleton:!0,forceCreation:!0})}}class Wr extends or{executeInternal(){let e=D(an).getLoadItem(fs);e&&e.data?(e.data.files&&new Pn(e.data.files).execute(),this.notifyComplete()):(console.error("ParseAssetsConfigCommand | executeInternal __ ERROR! Can't find config file!"),this.terminate())}}class jr extends f{constructor(e){super(),this.event=e,this.globalDispatcher=D(Zn)}executeInternal(){this.globalDispatcher.dispatchEvent(this.event),this.notifyComplete()}}const Xr="InitApplicationEvent.READY_TO_INIT_VIEW";class Yr extends or{executeInternal(){let e=D(an).getLoadItem(gs);if(e&&e.data){let t=e.data,i=D(F);rs().getState();let n=Object.keys(t);for(let e of n){const n=t[e];i.addLocaleTexts(n,e)}this.notifyComplete()}else console.error("ParseLocalizationCommand | executeInternal __ ERROR! Can't find config file!"),this.terminate()}}class Kr extends or{executeInternal(){const e=rs().getState();D(F).setCurrentLocaleId(e.device.mainLocale),this.notifyComplete()}}class qr extends Ss{construction(...e){super.construction(e),this.sizeAreaColor=255,this.sizeAreaColorAlpha=.5,this.resizeConfig={upscaleAllowed:!1},this.contentContReversedResizeSize=new _e.M,this.contentContLocalPosOfGlobalZero=new zt.b,this.contentCont=new Rn,this.addChild(this.contentCont),this.contentCont.interactive=!0,this.sizeAreaView=new Vt.A,this.contentCont.addChild(this.sizeAreaView),this.sizeAreaView.visible=!1,this._sizeArea=new _e.M;const t=rs().getState();t.app.config.sizeArea&&(this._sizeArea=new _e.M(t.app.config.sizeArea.x||0,t.app.config.sizeArea.y||0,t.app.config.sizeArea.width||0,t.app.config.sizeArea.height||0)),this.updateSizeAreaView()}get sizeArea(){return this._sizeArea}set sizeArea(e){e.x===this.sizeArea.x&&e.y===this.sizeArea.y&&e.width===this.sizeArea.width&&e.height===this.sizeArea.height||(this.sizeArea.copyFrom(e),this.updateSizeAreaView())}updateSizeAreaView(){this.sizeAreaView.clear(),this.sizeAreaView.rect(this.sizeArea.x,this.sizeArea.y,this.sizeArea.width,this.sizeArea.height),this.sizeAreaView.fill({color:this.sizeAreaColor,alpha:this.sizeAreaColorAlpha})}arrange(){super.arrange(),this.contentCont.scale.set(1,1);let e=Fn.getScale(this.sizeArea.width,this.sizeArea.height,this.resizeSize.x,this.resizeSize.y,this.resizeConfig);this.contentCont.scale.set(e),this.contentCont.toLocal({x:0,y:0},null,this.contentContLocalPosOfGlobalZero),this.contentContReversedResizeSize.x=this.contentContLocalPosOfGlobalZero.x,this.contentContReversedResizeSize.y=this.contentContLocalPosOfGlobalZero.y,this.contentContReversedResizeSize.width=Math.floor(this.resizeSize.x/this.contentCont.scale.x),this.contentContReversedResizeSize.height=Math.floor(this.resizeSize.y/this.contentCont.scale.y)}get contentScale(){return this.contentCont.scale.clone()}}const $r="preloaderPage";class Qr extends Jn{activate(){P.log("BaseStrategy | activate __ this: ",this),-1==Qr.cache.indexOf(this)&&Qr.cache.push(this)}deactivate(){this.eventListenerHelper.removeAllListeners(),o.removeItem(Qr.cache,this)}}Qr.cache=[];class Zr{}Zr.NORMAL="normal",Zr.OVER="over",Zr.PRESS="press",Zr.DISABLED="disabled",Zr.SELECTED_NORMAL="selected_normal",Zr.SELECTED_OVER="selected_over",Zr.SELECTED_PRESS="selected_press",Zr.SELECTED_DISABLED="selected_disabled",Zr.NORMAL_TO_SELECTED_MAP=(()=>{let e={};return e[Zr.NORMAL]=Zr.SELECTED_NORMAL,e[Zr.OVER]=Zr.SELECTED_OVER,e[Zr.PRESS]=Zr.SELECTED_PRESS,e[Zr.DISABLED]=Zr.SELECTED_DISABLED,e})(),Zr.SELECTED_TO_NORMAL_MAP=(()=>{let e={};return e[Zr.SELECTED_NORMAL]=Zr.NORMAL,e[Zr.SELECTED_OVER]=Zr.OVER,e[Zr.SELECTED_PRESS]=Zr.PRESS,e[Zr.SELECTED_DISABLED]=Zr.DISABLED,e})();const Jr="STATE_CHANGE",ea="SELECTED_CHANGE";class ta extends c{construction(){super.construction(),this.interactiveEventHelper=new u(this),this.state=Zr.NORMAL,this.enabled=!0}destruction(){super.destruction(),this.interactiveEventHelper&&(this.interactiveEventHelper.destruction(),this.interactiveEventHelper=null)}removeListeners(){super.removeListeners(),this.removeMouseListeners()}addMouseListeners(e){e&&(this.removeMouseListeners(),this.interactiveEventHelper.addEventListener(e,Dn.OVER,this.onOver),this.interactiveEventHelper.addEventListener(e,Dn.OUT,this.onOut),this.interactiveEventHelper.addEventListener(e,Dn.DOWN,this.onMouseDown),this.interactiveEventHelper.addEventListener(e,Dn.TAP,this.onTap))}removeMouseListeners(){this.isConstructed&&this.interactiveEventHelper.removeAllListeners()}onOver(){this._enabled&&(this.state=this.findStateValue(Zr.OVER),this.redispatchEvent(Dn.OVER))}onOut(){this._enabled&&(this.state=this.findStateValue(Zr.NORMAL),this.redispatchEvent(Dn.OUT))}onMouseDown(){this._enabled&&(this.state=this.findStateValue(Zr.PRESS),this.redispatchEvent(Dn.DOWN))}onTap(){this._enabled&&(this.autoToggleSelected&&(this.selected=!this.selected),this.state=this.findStateValue(Zr.OVER),this.redispatchEvent(Dn.TAP))}redispatchEvent(e){this.dispatchEvent(e)}commitStateData(){this.isConstructed&&this.commitEnabledData()}commitEnabledData(){this.hitArea&&(this.enabled?(this.hitArea.interactive=!0,this.hitArea.cursor="pointer"):(this.hitArea.interactive=!1,this.hitArea.cursor=null))}get state(){return this._state}set state(e){e!=this.state&&(this._state=e,this.commitStateData(),this.dispatchEvent(Jr))}get selected(){return this._selected}set selected(e){e!=this.selected&&(this._selected=e,this._selected?this.state=Zr.SELECTED_NORMAL:this.state=Zr.NORMAL,this.dispatchEvent(ea))}get enabled(){return this._enabled}set enabled(e){e!=this.enabled&&(this._enabled=e,this._enabled?this.state=this.findStateValue(Zr.NORMAL):this.state=this.findStateValue(Zr.DISABLED),this.commitEnabledData())}commitData(){super.commitData(),this.isConstructed&&this.commitStateData()}get hitArea(){return this._hitArea}set hitArea(e){e!=this.hitArea&&(this.removeMouseListeners(),this._hitArea=e,this.addMouseListeners(this.hitArea),this.commitData())}findStateValue(e){let t;return t=this.selected?Zr.NORMAL_TO_SELECTED_MAP[e]:Zr.SELECTED_TO_NORMAL_MAP[e],t||(t=e),t}}class ia extends Ts{constructor(e){super(e)}construction(e){super.construction(e),this._config=e,this._config||(this._config=ia.DEFAULT_CONFIG),s.copyProps(this._config,ia.DEFAULT_CONFIG,{ignoreExistedProperties:!0}),this.contentCont=new Rn,this.addChild(this.contentCont),this.bg=new Vt.A,this.contentCont.addChild(this.bg),this.bg.rect(0,0,10,10),this.bg.fill({color:0}),this.bg.alpha=0,this.pressView=new Wt.k,this.contentCont.addChild(this.pressView),this.overView=new Wt.k,this.contentCont.addChild(this.overView),this.icon=new Wt.k,this.contentCont.addChild(this.icon),this.btn=new ta,this.btn.hitArea=this,e.size?this.resize(e.size.x,e.size.y):this.resize(ia.DEFAULT_SIZE.x,ia.DEFAULT_SIZE.y),this.commitStateData()}destruction(){super.destruction(),this.btn&&this.btn.destruction()}addListeners(){super.addListeners(),this.eventListenerHelper.addEventListener(this.btn,Jr,this.onBtnStateChange),this.eventListenerHelper.addEventListener(this.btn,ea,this.onBtnSelectedChange)}onBtnStateChange(){this.commitStateData(),this.emit(Jr)}onBtnSelectedChange(){this.emit(ea)}commitData(){super.commitData(),this.config.pressTextureId&&(this.pressView.texture=ve.g.from(this.config.pressTextureId)),this.config.overTextureId&&(this.overView.texture=ve.g.from(this.config.overTextureId)),this.config.iconTextureId&&(this.icon.texture=ve.g.from(this.config.iconTextureId)),this.commitStateData()}commitStateData(){this.contentCont.visible=!0,this.pressView.visible=!1,this.overView.visible=!1;let e=1;switch(this.btn.state){case Zr.NORMAL:this.config.alphaNormal&&(e=this.config.alphaNormal);break;case Zr.OVER:this.config.alphaOver&&(e=this.config.alphaOver),this.overView.visible=!0;break;case Zr.PRESS:this.pressView.visible=!0;break;case Zr.SELECTED_NORMAL:this.config.alphaNormal&&(e=this.config.alphaNormal),this.pressView.visible=!0;break;case Zr.SELECTED_OVER:this.config.alphaOver&&(e=this.config.alphaOver),this.overView.visible=!0,this.pressView.visible=!0;break;case Zr.SELECTED_PRESS:this.pressView.visible=!0;break;default:this.contentCont.visible=!0}this.alpha=e,this.isConstructed&&this.arrange()}get selected(){return this.btn.selected}set selected(e){e!==this.btn.selected&&(this.btn.selected=e)}arrange(){super.arrange(),this.bg.width=this.resizeSize.x,this.bg.height=this.resizeSize.y,this.icon.scale.set(1,1),Fn.scaleObject(this.icon,this.resizeSize.x-2*this.config.iconPadding.x,this.resizeSize.y-2*this.config.iconPadding.y),this.overView.scale.set(1,1),Fn.scaleObject(this.overView,this.resizeSize.x,this.resizeSize.y),this.pressView.scale.set(1,1),Fn.scaleObject(this.pressView,this.resizeSize.x,this.resizeSize.y),this.overView.x=Math.floor(this.bg.x+(this.bg.width-this.overView.width)/2),this.overView.y=Math.floor(this.bg.y+(this.bg.height-this.overView.height)/2),this.pressView.x=Math.floor(this.bg.x+(this.bg.width-this.pressView.width)/2),this.pressView.y=Math.floor(this.bg.y+(this.bg.height-this.pressView.height)/2),this.icon.x=Math.floor(this.bg.x+(this.bg.width-this.icon.width)/2),this.icon.y=Math.floor(this.bg.y+(this.bg.height-this.icon.height)/2)}get config(){return this._config}set config(e){this._config=e,this.commitData()}}ia.DEFAULT_CONFIG=new class{constructor(){this.iconPadding=new zt.b,this.iconTextureId="",this.pressTextureId="tools_press_bg.png",this.overTextureId="tools_over_bg.png"}},ia.DEFAULT_SIZE=new zt.b(30,24);const na={labelConfig:{autosize:!0},bgConfig:{bgAlpha:.001,bgColor:0,bgLineWidth:0,bgLineColor:0,bgLineAlpha:0,bgCornerRadius:0,contentToBgPaddingX:0,contentToBgPaddingY:0,contentToBgShiftX:0,contentToBgShiftY:0},states:{normal:{alpha:.75},over:{alpha:1},press:{alpha:1},disabled:{alpha:.5}}};var sa;!function(e){e.NORMAL="normal",e.OVER="over",e.PRESS="press",e.DISABLED="disabled",e.SELECTED_NORMAL="selected_normal",e.SELECTED_OVER="selected_over",e.SELECTED_PRESS="selected_press",e.SELECTED_DISABLED="selected_disabled"}(sa||(sa={}));class ra extends Ts{constructor(e){super(e)}construction(e){var t;super.construction(),this.config=s.clone(na);const i={states:{}};if(e.states){const t=Object.keys(e.states);for(let n of t)e.states[n].externalView&&(i.states[n]={externalView:e.states[n].externalView},delete e.states[n].externalView)}if(s.copyProps(this.config,e),e.states){const n=Object.keys(e.states);for(let s of n)(null===(t=i.states[s])||void 0===t?void 0:t.externalView)&&(this.config.states[s].externalView=i.states[s].externalView,e.states[s].externalView=i.states[s].externalView)}this.bg=new Vt.A,this.addChild(this.bg),this.contentCont=new Rn,this.addChild(this.contentCont),this.layoutableCont=new oa,this.contentCont.addChild(this.layoutableCont),this.icon=new Wt.k,this.layoutableCont.addChild(this.icon),this.fLabel=new Wn(this.config.labelConfig),this.layoutableCont.addChild(this.fLabel),this.fLabel.text="",this.state=sa.NORMAL,this.enabled=!0}addListeners(){super.addListeners(),this.eventListenerHelper.addEventListener(this,Dn.OVER,this.onOver),this.eventListenerHelper.addEventListener(this,Dn.OUT,this.onOut),this.eventListenerHelper.addEventListener(this,Dn.DOWN,this.onDown),this.eventListenerHelper.addEventListener(this,Dn.UP,this.onUp),this.eventListenerHelper.addEventListener(this,Dn.TAP,this.onTap),this.eventListenerHelper.addEventListener(this,Dn.UP_OUTSIDE,this.onUpOutside)}onUpOutside(){this.state=this.findStateValue(sa.NORMAL)}onOver(){this.state=this.findStateValue(sa.OVER)}onOut(){this.state=this.findStateValue(sa.NORMAL)}onDown(){this.state=this.findStateValue(sa.PRESS)}onUp(){this.state=this.findStateValue(sa.OVER)}onTap(){this.onOut()}arrange(){if(super.arrange(),this.contentLayout&&this.contentLayout.arrange(this.layoutableCont),this.resizeSize.x&&this.resizeSize.y){this.contentCont.scale.set(1);const e=Fn.getScale(this.contentCont.width,this.contentCont.height,this.resizeSize.x,this.resizeSize.y);this.contentCont.scale.set(e)}this.updateBg(),this.contentCont.x=this.bg.x+Math.floor((this.bgCalculatedWidth-this.contentCont.width)/2),this.contentCont.y=this.bg.y+Math.floor((this.bgCalculatedHeight-this.contentCont.height)/2)}get enabled(){return this._enabled}set enabled(e){e!==this._enabled&&(this._enabled=e,this._enabled?this.state=this.findStateValue(sa.NORMAL):this.state=this.findStateValue(sa.DISABLED),this.commitData())}get text(){return this.fLabel.text}set text(e){this.fLabel.text=e,this.arrange()}get state(){return this._state}set state(e){e!=this.state&&(this._state=e,this.commitData())}getCurrentActiveState(){let e=this.state;return this.config.states[e]||this.selected&&(e=ra.SELECTED_TO_NORMAL_MAP[this.state]),this.config.states[e]||(e=sa.NORMAL),e}getCurrentActiveStateConfig(){let e=this.getCurrentActiveState();return this.config.states[e]}commitData(){super.commitData();let e=this.getCurrentActiveStateConfig();(e.alpha||0===e.alpha)&&(this.alpha=e.alpha),e.icon&&(this.icon.texture=ve.g.from(e.icon)),e.labelConfig&&this.fLabel.changeConfig(e.labelConfig),e.externalView!==this.curStateExternalView&&Un.childRemoveItselfFromParent(this.curStateExternalView),e.externalView&&this.contentCont.addChild(e.externalView),this.enabled?(this.interactive=!0,this.cursor="pointer"):(this.interactive=!1,this.cursor=null),this.arrange()}get selected(){return this._selected}set selected(e){e!=this.selected&&(this._selected=e,this.state=this.findStateValue(sa.NORMAL))}findStateValue(e){let t;return this.selected&&(t=ra.NORMAL_TO_SELECTED_MAP[e]),t||(t=e),t}addExternalView(e,t){t||0===t?this.layoutableCont.addChildAt(e,t):this.layoutableCont.addChild(e),this.arrange()}getCurActiveCombinedBgConfig(){let e={};this.config.bgConfig&&s.copyProps(e,this.config.bgConfig);let t=this.getCurrentActiveStateConfig();return t.bgConfig&&s.copyProps(e,t.bgConfig),e}get bgCalculatedWidth(){return this.resizeSize.x||this.contentCont.width}get bgCalculatedHeight(){return this.resizeSize.y||this.contentCont.height}updateBg(){let e=this.getCurActiveCombinedBgConfig();this.bg.clear(),this.bg.rect(0,0,this.bgCalculatedWidth,this.bgCalculatedHeight),this.bg.stroke({color:e.bgLineColor,alpha:e.bgLineAlpha,width:e.bgLineWidth,alignment:1}),this.bg.fill({color:e.bgColor,alpha:e.bgAlpha})}get contentLayout(){return this._contentLayout}set contentLayout(e){this._contentLayout=e,this.arrange()}}ra.NORMAL_TO_SELECTED_MAP=(()=>{let e={};return e[sa.NORMAL]=sa.SELECTED_NORMAL,e[sa.OVER]=sa.SELECTED_OVER,e[sa.PRESS]=sa.SELECTED_PRESS,e[sa.DISABLED]=sa.SELECTED_DISABLED,e})(),ra.SELECTED_TO_NORMAL_MAP=(()=>{let e={};return e[sa.SELECTED_NORMAL]=sa.NORMAL,e[sa.SELECTED_OVER]=sa.OVER,e[sa.SELECTED_PRESS]=sa.PRESS,e[sa.SELECTED_DISABLED]=sa.DISABLED,e})();var aa;!function(e){e.NORMAL="normal",e.OVER="over",e.PRESS="press",e.DISABLED="disabled",e.SELECTED_NORMAL="selected_normal",e.SELECTED_OVER="selected_over",e.SELECTED_PRESS="selected_press",e.SELECTED_DISABLED="selected_disabled"}(aa||(aa={}));aa.NORMAL,aa.SELECTED_NORMAL,aa.OVER,aa.SELECTED_OVER,aa.PRESS,aa.SELECTED_PRESS,aa.DISABLED,aa.SELECTED_DISABLED,aa.SELECTED_NORMAL,aa.NORMAL,aa.SELECTED_OVER,aa.OVER,aa.SELECTED_PRESS,aa.PRESS,aa.SELECTED_DISABLED,aa.DISABLED;class oa extends Rn{layoutGetChildrenNum(){return this.layoutableChildren.length}layoutGetChildAt(e){return this.layoutableChildren[e]}}class la extends or{executeInternal(){let e=D(an).getLoadItem(ms);if(e&&e.data){if(e.data){if(e.data.entities){const t=D(mr);for(let i of e.data.entities)t.entities.add(i)}if(e.data.items){D(un).commitItems(e.data.items)}if(e.data.state){const t=Object.keys(e.data.state);for(let i of t)rs().change()(i,e.data.state[i])}}this.notifyComplete()}else console.error("ParseStaticItemsCommand | executeInternal __ ERROR! Can't find config file!"),this.errorCode=p.GENERAL_ERROR,this.terminate()}}class ha extends T{constructor(){super([D(lr),D(In,sr.CONFIG),D(Kr),D(Yr),D(Wr),D(la),D(In,sr.PRELOAD),D(jr,Xr),D(cr),D(hr,$r)])}}var ua=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,o)}l((n=n.apply(e,t||[])).next())})};class ca extends c{constructor(e){super(e)}construction(e){const t=Object.create(null,{construction:{get:()=>super.construction}});return ua(this,void 0,void 0,function*(){t.construction.call(this,e),this.options=e,ca._instance=this,this.options.debug&&(window.Facade=this),k.startInit({debug:this.options.debug}),this.addModules(),yield this.activateModules(),this.rendererManager=D(Dr),this.initApp()})}addModules(){this.modulesManager=new Ls,this.addSingleModule(new ir),this.addSingleModule(new ss),this.addSingleModule(new bs(this.options.debug)),this.addSingleModule(new Ir),this.addSingleModule(new er),this.addSingleModule(new Br),this.addSingleModule(new Sr),this.addSingleModule(new Tr),this.addSingleModule(new Nr),this.addSingleModule(new ar),this.addSingleModule(new Ar),this.addSingleModule(new Pr),this.addSingleModule(new Vr),this.addSingleModule(new Ds),this.options.debug&&this.addSingleModule(new Zs)}activateModules(){return ua(this,void 0,void 0,function*(){this.modulesManager.initModules(),k.activate(),yield this.modulesManager.activateModules()})}addSingleModule(e){this.modulesManager.addModule(e)}onReadyToInitView(){this.initView()}initView(){this.mainContainer=D(Is),Cn.instance.stage.addChild(this.mainContainer),this.onWindowResize(),this.onRendererResize()}addListeners(){super.addListeners(),this.resizeListener=()=>{this.onWindowResize(),setTimeout(()=>{this.onWindowResize()},100)},window.addEventListener("resize",this.resizeListener);const e=D(Zn);this.eventListenerHelper.addEventListener(e,Lr,this.onRendererResize),this.eventListenerHelper.addEventListener(e,Xr,this.onReadyToInitView)}removeListeners(){super.removeListeners(),window.removeEventListener("resize",this.resizeListener)}onWindowResize(){const e=ui.getDocumentSize(),t=rs().getState();this.rendererManager&&this.rendererManager.resize(e.x,e.y,t.device.pixelRatio)}onRendererResize(){this.arrange()}initApp(){return ua(this,void 0,void 0,function*(){yield D(ha).execute()})}readyToInitView(){this.initView()}arrange(){this.mainContainer&&this.rendererManager&&this.mainContainer.resize(this.rendererManager.rendererWidth,this.rendererManager.rendererHeight)}static init(e){e||(e={});let t=e.FacadeClass;t||(t=ca),new t(e)}static get instance(){if(ca._instance)return ca._instance;console.error("ERROR! Facade should be prepared via the Facade.init method before used via Facade.instance!")}}const da={sizeArea:{x:0,y:0,width:1080,height:1575},colors:{white:16777215,black:0,wordwall:{yellow:15911503}},fonts:{main:"OpenSans"},gameplay:{lettersGrid:{size:{x:6,y:8},cell:{size:{x:80,y:80},padding:{x:10,y:10}}}}},pa={app:{config:{sizeArea:da.sizeArea}}},fa="tutorialCont";class ga extends Is{construction(...e){super.construction(...e);const t=D(ks),i=new Rn;this.addChild(i),t.addContainer(i,fa);const n=new Rn;this.addChild(n),t.addContainer(n,"effectsContainer"),this.resizeSizeArea=new Vt.A,this.resizeSizeArea.rect(0,0,da.sizeArea.width,da.sizeArea.height),this.resizeSizeArea.fill({color:16711680,alpha:.5})}arrange(){super.arrange(),this.bg.scale.set(1),Fn.scaleObject(this.bg,this.resizeSize.x,this.resizeSize.y,{scaleByMinSide:!0,upscaleAllowed:!0}),this.bg.x=(this.resizeSize.x-this.bg.width)/2,this.bg.y=(this.resizeSize.y-this.bg.height)/2;let e=Fn.getScale(da.sizeArea.width,da.sizeArea.height,this.resizeSize.x,this.resizeSize.y,{upscaleAllowed:!0});this.resizeSizeArea.scale.set(e),this.resizeSizeArea.x=(this.resizeSize.x-this.resizeSizeArea.width)/2,this.resizeSizeArea.y=(this.resizeSize.y-this.resizeSizeArea.height)/2}}class ma extends qn{init(){super.init(),rs().initializeWith(pa),O(ga,{toSubstitute:Is})}}const _a={gameLogic:{score:0,stars:0,openCombinations:[]}};class va extends qn{init(){super.init(),rs().initializeWith(_a)}activateCompleteHook(){super.activateCompleteHook()}}var ya,ba;!function(e){e.YANDEX_GAMES="yandexGames",e.YANDEX_WEB_RU="yandexWebRu",e.YANDEX_WEB_EN="yandexWebEn",e.VK_PLAY="vkPlay",e.ANDROID="android"}(ya||(ya={})),function(e){e.GAME_ANALYTICS="gameAnalytics",e.YANDEX_METRIKA="yandexMetrika"}(ba||(ba={}));var xa,Ta,Sa,Aa=i(3196);class Ea extends c{constructor(e,t,...i){super(e,t,...i)}construction(e,t,...i){super.construction(e,t,...i),this.toolConfig=e,this.analyticsConfig=t}}class Ca extends Ea{construction(e,t,...i){super.construction(e,t,...i),Aa.GameAnalytics.setEnabledInfoLog(!0),Aa.GameAnalytics.setEnabledVerboseLog(!0),Aa.GameAnalytics.configureBuild(this.analyticsConfig.buildId),Aa.GameAnalytics.initialize(this.toolConfig.key,this.toolConfig.secretKey)}logGoal(e){}logEvent(e,t){try{Aa.GameAnalytics.addDesignEvent(e,t)}catch(e){console.log("ERROR! GameAnalyticsTool | logEvent __ error: ",e)}}logProgressionEvent(e,t,i,n){try{Aa.GameAnalytics.addProgressionEvent(e,t,i,n)}catch(e){console.log("ERROR! GameAnalyticsTool | addProgressionEvent __ error: ",e)}}logBusinessEvent(e,t,i){try{Aa.GameAnalytics.addBusinessEvent(i,t,"default",e,"default")}catch(e){console.log("ERROR! GameAnalyticsTool | logBusinessEvent __ error: ",e)}}logError(e,t){try{Aa.GameAnalytics.addErrorEvent(e,t)}catch(e){console.log("ERROR! GameAnalyticsTool | logErrorEvent __ error: ",e)}}}class wa extends Ea{construction(e,t,...i){super.construction(e,t,...i)}logGoal(e){ym(this.toolConfig.key,"reachGoal",e)}logProgressionEvent(e,t,i,n){let s="progress:"+t;i&&(s+=":"+i),n&&(s+=":"+n),this.logEvent(s,e)}logEvent(e,t){try{let i=t;i||0===i||(i=!0),ym(this.toolConfig.key,"params",{[e]:i})}catch(i){console.log("YandexMetrikaAnalyticsTools | logEvent __ name: ",e," | value: ",t," | error: ",i)}}logBusinessEvent(e,t,i){this.logEvent("iap:complete",e)}logError(e,t){this.logEvent("error:"+e,t)}}class Pa{static init(e,t){if(console.log("WARNING! Analytics | init __ config: ",e," | userProps: ",t),Pa.isInitialized)return;Pa.isInitialized=!0,Pa.analyticTools=[];let i=Object.keys(e.tools);for(let t of i){let i=e.tools[t];try{let n=null;switch(t){case ba.GAME_ANALYTICS:n=new Ca(i,e);break;case ba.YANDEX_METRIKA:n=new wa(i,e)}n&&Pa.analyticTools.push(n)}catch(e){console.log("Analytics | init __ error: ",e)}}Pa.analyticTools.length<=0&&console.log("WARNING! Analytics | init __ NO ANALYTICS TOOLS CREATED!")}static logGoal(e){if(Pa.isInitialized)for(let t of Pa.analyticTools)try{t.logGoal(e)}catch(t){console.log("Analytics | logGoal __ goalName: ",e," | error: ",t)}}static logEvent(e,t){if(console.log("Analytics | logEvent __ eventName: ",e," | value: ",t," | Analytics.isInitialized: ",Pa.isInitialized),Pa.isInitialized)for(let i of Pa.analyticTools)try{i.logEvent(e,t)}catch(i){console.log("ERROR! Analytics | logEvent __ eventName: ",e," | value: ",t," | error: ",i)}}static logProgressionEvent(e,t,i,n){if(console.log("Analytics | logProgressEvent __ status: ",e," | id1: ",t," | id2: ",i," | id3: ",n," | Analytics.isInitialized: ",Pa.isInitialized),Pa.isInitialized)for(let s of Pa.analyticTools)try{s.logProgressionEvent(e,t,i,n)}catch(t){console.log("ERROR! Analytics | logProgressEvent __ status: ",e," | error: ",t)}}static logBusinessEvent(e,t,i){if(Pa.isInitialized)for(let n of Pa.analyticTools)try{n.logBusinessEvent(e,t,i)}catch(n){console.log("ERROR! Analytics | logBusinessEvent __ iapId: ",e," | iapPrice: ",t," | currencyCode: ",i," | error: ",n)}}static logErrorEvent(e,t){if(Pa.isInitialized)for(let i of Pa.analyticTools)try{i.logError(e,t)}catch(e){console.log("Analytics | logErrorEvent __ error: ",e)}}}!function(e){e.GAME_OPEN="gameOpen",e.APP_FRAMEWORK_INITILIZED="appFrameworkInitialized",e.GAME_START_AFTER_LOADING="gameStartAfterLoading",e.NEW_USER="newUser",e.RETURNED_USER="returnedUser",e.PRELOADER_PROGRESS="preloaderProgress",e.GAME_LOADED="gameLoaded",e.APP_LAUNCHES_COUNT_FIRST_PART="appLaunchesCount:",e.APP_CONSEQUENT_LAUNCHES_COUNT_MAX_BREAKS_DAY1_FIRST_PART="appConsequentLaunchesCountMaxBreaksDay1:",e.APP_CONSEQUENT_LAUNCHES_COUNT_MAX_BREAKS_DAY3_FIRST_PART="appConsequentLaunchesCountMaxBreaksDay3:",e.APP_CONSEQUENT_LAUNCHES_COUNT_MAX_BREAKS_DAY7_FIRST_PART="appConsequentLaunchesCountMaxBreaksDay7:",e.SESSION_DURATION_FIRST_PART="sessionDuration:",e.TOTAL_USAGE_DURATION_FIRST_PART="sessionDuration:",e.VIEW_ELEMENT="viewElement"}(xa||(xa={})),function(e){e.TOTAL_SCORE="totalScore",e.DEATH="death",e.RESTART="restart",e.LEVEL_START_APPROVE="levelStartApprove"}(Ta||(Ta={})),function(e){e.ASK_TO_REVIEW_SHOW="platform:askToReview:show",e.ASK_TO_REVIEW_SUCCESS="platform:askToReview:success",e.ASK_TO_REVIEW_FAIL="platform:askToReview:fail",e.ASK_TO_REVIEW_ERROR="platform:askToReview:error",e.ASK_TO_INSTALL_SHOW="platform:askToInstall:show",e.ASK_TO_INSTALL_SUCCESS="platform:askToInstall:success",e.ASK_TO_INSTALL_FAIL="platform:askToInstall:fail",e.ASK_TO_INSTALL_ERROR="platform:askToInstall:error"}(Sa||(Sa={}));var Ia=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,o)}l((n=n.apply(e,t||[])).next())})};class Ma extends ls{constructor(){super(...arguments),this.playerDataAppStorageId=`${hs}platformAdapter__playerDataApp`,this.playerDataTimestampStorageId=`${hs}platformAdapter__playerDataTimestamp`,this.defaultLeaderboardId="default",this.minDelayBetweenSetSdkPlayerData=1e4,this.minDelayBetweenSetLeaderboardScore=1e4}construction(e){super.construction(e),this.localStorageManager=D(cs),this.init(e)}init(e){return Ia(this,void 0,void 0,function*(){return this.initPromise||(this.initPromise=new Promise(t=>Ia(this,void 0,void 0,function*(){yield this.internalInit(e);let i=this.getPlayerAppData();const n=yield this.getSdkPlayerData();if(n){const e=n[this.playerDataTimestampStorageId];if(e){const t=this.getLocalPlayerDataTimestamp();if(!t||e>t){i=n[this.playerDataAppStorageId]}}}this.setPlayerAppData(i),t()}))),this.initPromise})}internalInit(e){return Ia(this,void 0,void 0,function*(){})}waitInitPromise(){return Ia(this,void 0,void 0,function*(){return yield this.initPromise,null})}gameIsReadyCallback(){return Ia(this,void 0,void 0,function*(){console.log("PlatformAdapter | gameIsReadyCallback")})}checkIfLeaderboardAvailable(){return Ia(this,void 0,void 0,function*(){return!1})}setLeaderboardScoreWithCheck(e,t,i){return Ia(this,arguments,void 0,function*(e,t,i,n=!0){return new Promise(s=>{let r=!1,a=0;if(this.lastTimeLeaderboardScoreSetTimestamp){const e=Date.now()-this.lastTimeLeaderboardScoreSetTimestamp;a=this.minDelayBetweenSetLeaderboardScore-e,a<=0&&(r=!0)}else r=!0;clearTimeout(this.delayLeaderboardScoreTimeout);const o=()=>{this.setLeaderboardScore(e,t,i,n),this.lastTimeLeaderboardScoreSetTimestamp=Date.now(),s()};r?o():this.delayLeaderboardScoreTimeout=setTimeout(()=>{o()},a)})})}setLeaderboardScore(e,t,i){return Ia(this,arguments,void 0,function*(e,t,i,n=!0){return Promise.resolve(!1)})}checkIfAskToReviewAvailable(){return Ia(this,void 0,void 0,function*(){return!1})}askToReview(){return Ia(this,void 0,void 0,function*(){Pa.logEvent(Sa.ASK_TO_REVIEW_SHOW);const e=this.internalAskToReview();return e.then(e=>{e?Pa.logEvent(Sa.ASK_TO_REVIEW_SUCCESS):Pa.logEvent(Sa.ASK_TO_REVIEW_FAIL)}),e.catch(e=>{Pa.logEvent(Sa.ASK_TO_REVIEW_ERROR)}),e})}internalAskToReview(){return Ia(this,void 0,void 0,function*(){return confirm("TEST! Do you want to review app?")})}checkIfAskToInstallAvailable(){return Ia(this,void 0,void 0,function*(){return!1})}askToInstall(){return Ia(this,void 0,void 0,function*(){Pa.logEvent(Sa.ASK_TO_INSTALL_SHOW);const e=this.internalAskToInstall();return e.then(e=>{e?Pa.logEvent(Sa.ASK_TO_INSTALL_SUCCESS):Pa.logEvent(Sa.ASK_TO_INSTALL_FAIL)}),e.catch(e=>{Pa.logEvent(Sa.ASK_TO_INSTALL_ERROR)}),e})}internalAskToInstall(){return Ia(this,void 0,void 0,function*(){return confirm("TEST! Do you want to install app?")})}getPlayerAppData(){return this.localStorageManager.getParam(this.playerDataAppStorageId)}getSdkPlayerData(){return Ia(this,void 0,void 0,function*(){return Promise.resolve(null)})}getLocalPlayerDataTimestamp(){return this.localStorageManager.getParam(this.playerDataTimestampStorageId)}setPlayerAppData(e){if(!e)return;e[this.playerDataAppStorageId]&&delete e[this.playerDataAppStorageId],e[this.playerDataTimestampStorageId]&&delete e[this.playerDataTimestampStorageId];const t=this.localStorageManager.getStorageId();e[t]&&delete e[t];const i=Date.now();this.localStorageManager.setParam(this.playerDataTimestampStorageId,i),this.localStorageManager.setParam(this.playerDataAppStorageId,e);const n={[this.playerDataAppStorageId]:e,[this.playerDataTimestampStorageId]:i};this.setSdkPlayerDataWithCheck(n)}setSdkPlayerDataWithCheck(e){let t=!1,i=0;if(this.lastTimeSdkPlayerDataSetTimestamp){const e=Date.now()-this.lastTimeSdkPlayerDataSetTimestamp;i=this.minDelayBetweenSetSdkPlayerData-e,i<=0&&(t=!0)}else t=!0;clearTimeout(this.delaySetSdkPlayerDataTimeout);const n=()=>{this.setSdkPlayerData(e),this.lastTimeSdkPlayerDataSetTimestamp=Date.now()};t?n():this.delaySetSdkPlayerDataTimeout=setTimeout(()=>{n()},i)}setSdkPlayerData(e){return Ia(this,void 0,void 0,function*(){return Promise.resolve(!0)})}getExperimentFlags(){return Ia(this,void 0,void 0,function*(){return Promise.resolve(null)})}}var Ra=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,o)}l((n=n.apply(e,t||[])).next())})};class La extends Ma{get playerSdk(){return this._playerSdk}get iapSdk(){return this._iapSdk}getExperimentFlags(){return Ra(this,void 0,void 0,function*(){let e=null;return this.sdk&&(e=yield this.sdk.getFlags()),e})}internalInit(e){return Ra(this,void 0,void 0,function*(){yield YaGames.init(e).then(e=>{console.log("YandexGamesPlatformAdapter | internalInit __ then"),this.sdk=e}).catch(e=>{console.log("YandexGamesPlatformAdapter | internalInit __ catch __ error: ",e)}).finally(()=>Ra(this,void 0,void 0,function*(){console.log("YandexGamesPlatformAdapter | internalInit __ finally")})),yield this.initPlayer(),yield this.initIap()})}gameIsReadyCallback(){return Ra(this,void 0,void 0,function*(){var e;this.sdk?null===(e=this.sdk.features.LoadingAPI)||void 0===e||e.ready():console.error("ERROR! The method should be called only after SDK is initialized (see the init method)!")})}checkIfLeaderboardAvailable(){return Ra(this,void 0,void 0,function*(){return yield this.sdk.isAvailableMethod("leaderboards.setScore")})}setLeaderboardScore(e,t,i){return Ra(this,arguments,void 0,function*(e,t,i,n=!0){let s=!0;if(n){let i=0;try{t||(t=this.defaultLeaderboardId);i=(yield this.sdk.leaderboards.getPlayerEntry(t)).score}catch(e){console.error("YandexGamesPlatformAdapter | setLeaderboardScore __ error: ",e)}i>=e&&(s=!1)}let r=!1;return s&&(r=yield this.sdk.leaderboards.setScore(t,e,i)),r})}checkIfAskToReviewAvailable(){return Ra(this,void 0,void 0,function*(){return new Promise(e=>{this.sdk.feedback.canReview().then(t=>{console.log("YandexGamesPlatformAdapter | checkIfAskToReviewAvailable __ result: ",t),e(t.value)}).catch(t=>{console.log("Error! YandexGamesPlatformAdapter | checkIfAskToReviewAvailable __ catch __ error: ",t),e(!1)})})})}internalAskToReview(){return Ra(this,void 0,void 0,function*(){return new Promise(e=>{this.checkIfAskToReviewAvailable().then(t=>{t?this.sdk.feedback.requestReview().then(t=>{let i=!1;(null==t?void 0:t.feedbackSent)&&(i=!0),e(i)}):e(!1)})})})}checkIfAskToInstallAvailable(){return Ra(this,void 0,void 0,function*(){return new Promise(e=>{this.sdk.shortcut.canShowPrompt().then(t=>{e(t.canShow)}).catch(t=>{console.log("Error! YandexGamesPlatformAdapter | checkIfAskToInstallAvailable __ catch __ error: ",t),e(!1)})})})}internalAskToInstall(){return Ra(this,void 0,void 0,function*(){return new Promise(e=>{this.checkIfAskToInstallAvailable().then(t=>{t?this.sdk.shortcut.showPrompt().then(t=>{let i=!1;"accepted"===(null==t?void 0:t.outcome)&&(i=!0),e(i)}):e(!1)})})})}initPlayer(){return Ra(this,void 0,void 0,function*(){try{this._playerSdk=yield this.sdk.getPlayer(),console.log("YandexGamesPlatformAdapter | initPlayer __ _playerSdk received")}catch(e){console.error("YandexGamesPlatformAdapter | initPlayer __ catch __ error: ",e)}})}initIap(){return Ra(this,void 0,void 0,function*(){return new Promise((e,t)=>{this.sdk.getPayments().then(t=>{console.log("YandexGamesPlatformAdapter | initIap __ then __ _payments: ",t),this._iapSdk=t,e(!0)}).catch(t=>{console.error("YandexGamesPlatformAdapter | initIap __ catch __ error: ",t),e(!1)})})})}getSdkPlayerData(){return Ra(this,void 0,void 0,function*(){return new Promise(e=>Ra(this,void 0,void 0,function*(){if(this._playerSdk){const t=yield this._playerSdk.getData();console.log("YandexGamesPlatformAdapter | getSdkPlayerData __ _playerSdkData: ",t),e(t)}else console.log("YandexGamesPlatformAdapter | getSdkPlayerData __ WARNING! this._playerSdk: ",this._playerSdk),e(null)}))})}setSdkPlayerData(e){return Ra(this,void 0,void 0,function*(){return console.log("YandexGamesPlatformAdapter | setPlayerAppData __ data: ",e),new Promise(t=>{this._playerSdk.setData(e,!0).then(()=>{console.log("YandexGamesPlatformAdapter | setPlayerAppData __ SUCCESS!"),t(!0)}).catch(e=>{console.error("YandexGamesPlatformAdapter | setPlayerAppData __ error: ",e),t(!1)})})})}}let ka={};ka={indexPage:"index.html",buildType:{prod:{bundlePath:"bundle.js",iframeAppIndexPath:"geoconflict/iframe.html"},dev:{bundlePath:"dist/bundle.js",iframeAppIndexPath:"geoconflict/iframe.html"}},analytics:{tools:{gameAnalytics:{key:"a1f0fb4335fe32696c3b76eb49612ead",secretKey:"ba57db678bc9a1181bde9430bad83c6fa3b71862"},yandexMetrika:{key:"105112563",headTag:'\x3c!-- Yandex.Metrika counter --\x3e<script type="text/javascript">(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document,\'script\',\'https://mc.yandex.ru/metrika/tag.js?id=105112563\', \'ym\');  ym(105112563, \'init\', {ssr:true, webvisor:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});<\/script><noscript><div><img src="https://mc.yandex.ru/watch/105112563" style="position:absolute; left:-9999px;" alt="" /></div></noscript>\x3c!-- /Yandex.Metrika counter --\x3e'}}},platforms:{yandexGames:{appId:475929}}},console.log("IS_DEV: ",!1),console.log("BUILD_PLATFORM: ","yandexGames"),console.log("VERSION: ","0.0.0-geoconflictWrapper.4"),console.log("CUR_BUILD_CONFIG:",ka);const Da="yandexGames"===ya.YANDEX_GAMES;ya.YANDEX_WEB_EN,ya.YANDEX_WEB_EN;var Oa,Ba,Ga=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,o)}l((n=n.apply(e,t||[])).next())})};class Fa extends qn{activateCompleteHook(){const e=Object.create(null,{activateCompleteHook:{get:()=>super.activateCompleteHook}});return Ga(this,void 0,void 0,function*(){var t,i,n,s,r,a;e.activateCompleteHook.call(this);const o=rs().getMutableState();let l=o.device.mainLocale;if(console.log("GameDeviceModule | activateCompleteHook __ IS_DEV: ",!1," | isYandexGames: ",Da),Da){const e=D(La);try{yield e.waitInitPromise(),console.log("GameDeviceModule | activateCompleteHook __ yandexPlatform?.sdk?.environment?.i18n?.lang: ",null===(n=null===(i=null===(t=null==e?void 0:e.sdk)||void 0===t?void 0:t.environment)||void 0===i?void 0:i.i18n)||void 0===n?void 0:n.lang),(null===(a=null===(r=null===(s=null==e?void 0:e.sdk)||void 0===s?void 0:s.environment)||void 0===r?void 0:r.i18n)||void 0===a?void 0:a.lang)&&(l=e.sdk.environment.i18n.lang)}catch(e){console.error("GameDeviceModule | activateCompleteHook __ ERROR! error: ",e)}}const h={default:"en",ru:"ru",be:"ru",kk:"ru",uk:"ru",uz:"ru"};l=h[l]?h[l]:h.default,o.device.mainLocale=l})}}class Ua extends ls{constructor(){super(...arguments),this.messageIdToCallbackMap={}}addListeners(){super.addListeners(),window.onmessage=e=>{const t=e.data,i=this.messageIdToCallbackMap[t.messageId];i&&i(t)}}sendMessageToIframe(e,t){var i;const n=D(za),s={messageId:e,data:t};(null===(i=null==n?void 0:n.iframeAppElement)||void 0===i?void 0:i.contentWindow)&&n.iframeAppElement.contentWindow.postMessage(s,"*")}addMessageCallback(e,t){this.messageIdToCallbackMap[e]?console.error("IFrameGameCommunicationManager | addMessageCallback __ ERROR! There is already a callback for the messageId: ",e):this.messageIdToCallbackMap[e]=t}removeMessageCallback(e){this.messageIdToCallbackMap[e]&&delete this.messageIdToCallbackMap[e]}}!function(e){e.INFO="Info",e.DEBUG="Debug",e.WARNING="Warning",e.ERROR="Error",e.CRITICAL="Critical"}(Oa||(Oa={})),function(e){e.CHILD_IFRAME_TO_PARENT_APP_INIT="childIframeToParent_appInit",e.CHILD_IFRAME_TO_PARENT_LOAD_PROGRESS="childIframeToParent_LoadProgress",e.CHILD_IFRAME_TO_PARENT_ANALYTICS="childIframeToParent_Analytics",e.CHILD_IFRAME_TO_PARENT_PROGRESSION_ANALYTICS="childIframeToParent_ProgressionAnalytics",e.CHILD_IFRAME_TO_PARENT_ERROR_ANALYTICS="childIframeToParent_ErrorAnalytics",e.PARENT_IFRAME_TO_CHILD_PAUSE="parentIframeToChild_Pause",e.PARENT_IFRAME_TO_CHILD_RESUME="parentIframeToChild_Resume",e.PARENT_IFRAME_TO_CHILD_MUTE="parentIframeToChild_Mute",e.PARENT_IFRAME_TO_CHILD_UNMUTE="parentIframeToChild_Unmute",e.CHILD_IFRAME_TO_PARENT_WAIT_APPROVE="childIframeToParent_waitApprove",e.PARENT_IFRAME_TO_CHILD_WAIT_APPROVE_RESULT="parentIframeToChild_waitApproveResult",e.CHILD_IFRAME_TO_PARENT_SET_TOTAL_SCORE="childIframeToParent_setTotalScore",e.CHILD_IFRAME_TO_PARENT_SET_PLAYER_APP_DATA="childIframeToParent_setPlayerAppData",e.CHILD_IFRAME_TO_PARENT_IAP_CHECK_IF_AVAILABLE="childIframeToParent_iapCheckIfAvailable",e.PARENT_IFRAME_TO_CHILD_IAP_CHECK_IF_AVAILABLE_RESULT="parentIframeToChild_iapCheckIfAvailableResult",e.CHILD_IFRAME_TO_PARENT_IAP_GET_CATALOG="childIframeToParent_iapGetCatalog",e.PARENT_IFRAME_TO_CHILD_IAP_GET_CATALOG_RESULT="parentIframeToChild_iapGetCatalogResult",e.CHILD_IFRAME_TO_PARENT_IAP_PURCHASE="childIframeToParent_iapPurchase",e.PARENT_IFRAME_TO_CHILD_IAP_PURCHASE_RESULT="parentIframeToChild_iapPurchaseResult",e.CHILD_IFRAME_TO_PARENT_IAP_CONSUME="childIframeToParent_iapConsume",e.PARENT_IFRAME_TO_CHILD_IAP_CONSUME_RESULT="parentIframeToChild_iapConsumeResult",e.CHILD_IFRAME_TO_PARENT_IAP_GET_UNCONSUMED="childIframeToParent_iapGetUnconsumed",e.PARENT_IFRAME_TO_PARENT_IAP_GET_UNCONSUMED_RESULT="parentIframeToChild_iapGetUnconsumedResult"}(Ba||(Ba={}));const Na="iframeApp";class za extends ls{constructor(){super(...arguments),this.pauseLock=new E,this.muteLock=new E}construction(...e){super.construction(...e),this.localStorageManager=D(cs),this.iframeAppState=rs().getState();const t=this.localStorageManager.getParam(Na);t&&rs().change()("iframeApp",t.iframeApp),this.updateStorageData(),this.updateLocalStorageInterval=setInterval(()=>{this.updateStorageData()},6e4)}addListeners(){super.addListeners();const e=D(Ua);e.addMessageCallback(Ba.CHILD_IFRAME_TO_PARENT_ANALYTICS,e=>{Pa.logEvent(e.data.analyticEventId,e.data.value)}),e.addMessageCallback(Ba.CHILD_IFRAME_TO_PARENT_PROGRESSION_ANALYTICS,e=>{Pa.logProgressionEvent(e.data.status,e.data.id1,e.data.id2,e.data.id3)}),e.addMessageCallback(Ba.CHILD_IFRAME_TO_PARENT_ERROR_ANALYTICS,e=>{Pa.logErrorEvent(e.data.message,e.data.severity)}),e.addMessageCallback(Ba.CHILD_IFRAME_TO_PARENT_APP_INIT,e=>{this.commitPauseChangeData(),this.commitMuteChangeData()})}get iframeAppElement(){return this._iframeAppElement}createIframeApp(e,t){return this._iframeAppElement=ui.createElementFromHTMLString(e),t.appendChild(this._iframeAppElement),this._iframeAppElement}hideIframeApp(){this._iframeAppElement&&(this._iframeAppElement.style.opacity="0")}showIframeApp(){this._iframeAppElement&&(this._iframeAppElement.style.opacity="1")}updateStorageData(){this.localStorageManager.setParam(Na,this.iframeAppState)}addPauseLock(e){const t=this.pauseLock.enabled;this.pauseLock.add(e),t!==this.pauseLock.enabled&&this.commitPauseChangeData()}removePauseLock(e){const t=this.pauseLock.enabled;this.pauseLock.remove(e),t!==this.pauseLock.enabled&&this.commitPauseChangeData()}commitPauseChangeData(){console.log("IframeAppManager __ commitPauseChangeData __ this.pauseLock.enabled: ",this.pauseLock.enabled);const e=D(Ua);this.pauseLock.enabled?e.sendMessageToIframe(Ba.PARENT_IFRAME_TO_CHILD_PAUSE):e.sendMessageToIframe(Ba.PARENT_IFRAME_TO_CHILD_RESUME)}addMuteLock(e){const t=this.muteLock.enabled;this.muteLock.add(e),t!==this.muteLock.enabled&&this.commitMuteChangeData()}removeMuteLock(e){const t=this.muteLock.enabled;this.muteLock.remove(e),t!==this.muteLock.enabled&&this.commitMuteChangeData()}commitMuteChangeData(){console.log("IframeAppManager __ commitMuteChangeData __ this.muteLock.enabled: ",this.muteLock.enabled);const e=D(Ua);this.muteLock.enabled?e.sendMessageToIframe(Ba.PARENT_IFRAME_TO_CHILD_MUTE):e.sendMessageToIframe(Ba.PARENT_IFRAME_TO_CHILD_UNMUTE)}}class Ha extends rr{constructor(){super(...arguments),this.iframeAppManager=D(za)}addListeners(){super.addListeners()}workaraundCheckOfFocus(){var e,t;let i=!1;if(console.log("GameHTMLManager | workaraundCheckOfFocus __ "," document.hasFocus: ",document.hasFocus," | this.iframeAppManager.iframeAppElement?.contentDocument: ",null===(e=this.iframeAppManager.iframeAppElement)||void 0===e?void 0:e.contentDocument),document.hasFocus&&(null===(t=this.iframeAppManager.iframeAppElement)||void 0===t?void 0:t.contentDocument)&&(i=!0),console.log("GameHTMLManager | workaraundCheckOfFocus __ "," canDoWorkaroundCheck: ",i),i){let e=!1;console.log("GameHTMLManager | workaraundCheckOfFocus __ "," document.hasFocus(): ",document.hasFocus()," this.iframeAppManager.iframeAppElement.contentDocument.hasFocus(): ",this.iframeAppManager.iframeAppElement.contentDocument.hasFocus()),(document.hasFocus()||this.iframeAppManager.iframeAppElement.contentDocument.hasFocus())&&(e=!0),console.log("GameHTMLManager | workaraundCheckOfFocus __ "," newFocus: ",e," this.lastFocus: ",this.lastFocus),this.lastFocus=e,e&&this.onFocus(),this.iframeAppManager.commitMuteChangeData(),this.iframeAppManager.commitPauseChangeData()}}removeListeners(){super.removeListeners(),(this.iframeFocusWorkaroundInterval||0===this.iframeFocusWorkaroundInterval)&&(clearInterval(this.iframeFocusWorkaroundInterval),this.iframeFocusWorkaroundInterval=null)}onBlur(e){super.onBlur(e),this.workaraundCheckOfFocus()}}var Va,Wa=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,o)}l((n=n.apply(e,t||[])).next())})};class ja extends qn{init(){const e=Object.create(null,{init:{get:()=>super.init}});return Wa(this,void 0,void 0,function*(){e.init.call(this),O(Ha,{toSubstitute:rr})})}}!function(e){e.PREPARE_IFRAME_APP="prepareIframeApp"}(Va||(Va={}));const Xa="gamePage";var Ya,Ka;!function(e){e.START="gameScreen",e.PLAY="playScreen"}(Ya||(Ya={})),function(e){e.WAIT_USER_ACTION="waitUserAction",e.PROCESSING="processing",e.PROCESSING_ERROR="processingError",e.RESULT="result"}(Ka||(Ka={}));const qa={gamePage:{screen:Ya.START,state:Ka.WAIT_USER_ACTION,letters:[],foundWords:[]}};class $a extends Er{constructor(){super(...arguments),this.gamePageState=rs().getState()}onActivatorStart(e){super.onActivatorStart(e),this.eventListenerHelper.addEventListener(this.globalDispatcher,as()("gamePage"),this.commitActivatorData),this.commitActivatorData(),rs().change()("gamePage.screen",Ya.PLAY)}commitActivatorData(){this.activator.changeScreen(this.gamePageState.gamePage.screen)}}var Qa="in vec2 aPosition;\nout vec2 vTextureCoord;\n\nuniform vec4 uInputSize;\nuniform vec4 uOutputFrame;\nuniform vec4 uOutputTexture;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;\n    \n    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;\n    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;\n\n    return vec4(position, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aPosition * (uOutputFrame.zw * uInputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n",Za="struct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n\nstruct VSOutput {\n    @builtin(position) position: vec4<f32>,\n    @location(0) uv : vec2<f32>\n  };\n\nfn filterVertexPosition(aPosition:vec2<f32>) -> vec4<f32>\n{\n    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;\n\n    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;\n    position.y = position.y * (2.0*gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;\n\n    return vec4(position, 0.0, 1.0);\n}\n\nfn filterTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>\n{\n    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);\n}\n\nfn globalTextureCoord( aPosition:vec2<f32> ) -> vec2<f32>\n{\n  return  (aPosition.xy / gfu.uGlobalFrame.zw) + (gfu.uGlobalFrame.xy / gfu.uGlobalFrame.zw);  \n}\n\nfn getSize() -> vec2<f32>\n{\n  return gfu.uGlobalFrame.zw;\n}\n  \n@vertex\nfn mainVertex(\n  @location(0) aPosition : vec2<f32>, \n) -> VSOutput {\n  return VSOutput(\n   filterVertexPosition(aPosition),\n   filterTextureCoord(aPosition)\n  );\n}",Ja=Object.defineProperty,eo=(e,t,i)=>(((e,t,i)=>{t in e?Ja(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i})(e,"symbol"!=typeof t?t+"":t,i),i);const to=class e extends Lt.d{constructor(...t){let i=t[0]??{};("number"==typeof i||Array.isArray(i))&&((0,ue.t6)("6.0.0","KawaseBlurFilter constructor params are now options object. See params: { strength, quality, clamp, pixelSize }"),i={strength:i},void 0!==t[1]&&(i.quality=t[1]),void 0!==t[2]&&(i.clamp=t[2])),i={...e.DEFAULT_OPTIONS,...i};super({gpuProgram:Gt.B.from({vertex:{source:Za,entryPoint:"mainVertex"},fragment:{source:i?.clamp?"struct KawaseBlurUniforms {\n  uOffset:vec2<f32>,\n};\n\nstruct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> kawaseBlurUniforms : KawaseBlurUniforms;\n\n@fragment\nfn mainFragment(\n  @builtin(position) position: vec4<f32>,\n  @location(0) uv : vec2<f32>\n) -> @location(0) vec4<f32> {\n  let uOffset = kawaseBlurUniforms.uOffset;\n  var color: vec4<f32> = vec4(0.0);\n\n  // Sample top left pixel\n  color += textureSample(uTexture, uSampler, clamp(vec2<f32>(uv.x - uOffset.x, uv.y + uOffset.y), gfu.uInputClamp.xy, gfu.uInputClamp.zw));\n  // Sample top right pixel\n  color += textureSample(uTexture, uSampler, clamp(vec2<f32>(uv.x + uOffset.x, uv.y + uOffset.y), gfu.uInputClamp.xy, gfu.uInputClamp.zw));\n  // Sample bottom right pixel\n  color += textureSample(uTexture, uSampler, clamp(vec2<f32>(uv.x + uOffset.x, uv.y - uOffset.y), gfu.uInputClamp.xy, gfu.uInputClamp.zw));\n  // Sample bottom left pixel\n  color += textureSample(uTexture, uSampler, clamp(vec2<f32>(uv.x - uOffset.x, uv.y - uOffset.y), gfu.uInputClamp.xy, gfu.uInputClamp.zw));\n  // Average\n  color *= 0.25;\n    \n  return color;\n}":"struct KawaseBlurUniforms {\n  uOffset:vec2<f32>,\n};\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> kawaseBlurUniforms : KawaseBlurUniforms;\n\n@fragment\nfn mainFragment(\n  @builtin(position) position: vec4<f32>,\n  @location(0) uv : vec2<f32>\n) -> @location(0) vec4<f32> {\n  let uOffset = kawaseBlurUniforms.uOffset;\n  var color: vec4<f32> = vec4<f32>(0.0);\n\n  // Sample top left pixel\n  color += textureSample(uTexture, uSampler, vec2<f32>(uv.x - uOffset.x, uv.y + uOffset.y));\n  // Sample top right pixel\n  color += textureSample(uTexture, uSampler, vec2<f32>(uv.x + uOffset.x, uv.y + uOffset.y));\n  // Sample bottom right pixel\n  color += textureSample(uTexture, uSampler, vec2<f32>(uv.x + uOffset.x, uv.y - uOffset.y));\n  // Sample bottom left pixel\n  color += textureSample(uTexture, uSampler, vec2<f32>(uv.x - uOffset.x, uv.y - uOffset.y));\n  // Average\n  color *= 0.25;\n\n  return color;\n}",entryPoint:"mainFragment"}}),glProgram:kt.M.from({vertex:Qa,fragment:i?.clamp?"\nprecision highp float;\nin vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform vec2 uOffset;\n\nuniform vec4 uInputClamp;\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n\n    // Sample top left pixel\n    color += texture(uTexture, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y), uInputClamp.xy, uInputClamp.zw));\n\n    // Sample top right pixel\n    color += texture(uTexture, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y), uInputClamp.xy, uInputClamp.zw));\n\n    // Sample bottom right pixel\n    color += texture(uTexture, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y), uInputClamp.xy, uInputClamp.zw));\n\n    // Sample bottom left pixel\n    color += texture(uTexture, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y), uInputClamp.xy, uInputClamp.zw));\n\n    // Average\n    color *= 0.25;\n\n    finalColor = color;\n}\n":"\nin vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform vec2 uOffset;\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n\n    // Sample top left pixel\n    color += texture(uTexture, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y));\n\n    // Sample top right pixel\n    color += texture(uTexture, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y));\n\n    // Sample bottom right pixel\n    color += texture(uTexture, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y));\n\n    // Sample bottom left pixel\n    color += texture(uTexture, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y));\n\n    // Average\n    color *= 0.25;\n\n    finalColor = color;\n}",name:"kawase-blur-filter"}),resources:{kawaseBlurUniforms:{uOffset:{value:new Float32Array(2),type:"vec2<f32>"}}}}),eo(this,"uniforms"),eo(this,"_pixelSize",{x:0,y:0}),eo(this,"_clamp"),eo(this,"_kernels",[]),eo(this,"_blur"),eo(this,"_quality"),this.uniforms=this.resources.kawaseBlurUniforms.uniforms,this.pixelSize=i.pixelSize??{x:1,y:1},Array.isArray(i.strength)?this.kernels=i.strength:"number"==typeof i.strength&&(this._blur=i.strength,this.quality=i.quality??3),this._clamp=!!i.clamp}apply(e,t,i,n){const s=this.pixelSizeX/t.source.width,r=this.pixelSizeY/t.source.height;let a;if(1===this._quality||0===this._blur)a=this._kernels[0]+.5,this.uniforms.uOffset[0]=a*s,this.uniforms.uOffset[1]=a*r,e.applyFilter(this,t,i,n);else{const o=Mt.W.getSameSizeTexture(t);let l,h=t,u=o;const c=this._quality-1;for(let t=0;t<c;t++)a=this._kernels[t]+.5,this.uniforms.uOffset[0]=a*s,this.uniforms.uOffset[1]=a*r,e.applyFilter(this,h,u,!0),l=h,h=u,u=l;a=this._kernels[c]+.5,this.uniforms.uOffset[0]=a*s,this.uniforms.uOffset[1]=a*r,e.applyFilter(this,h,i,n),Mt.W.returnTexture(o)}}get strength(){return this._blur}set strength(e){this._blur=e,this._generateKernels()}get quality(){return this._quality}set quality(e){this._quality=Math.max(1,Math.round(e)),this._generateKernels()}get kernels(){return this._kernels}set kernels(e){Array.isArray(e)&&e.length>0?(this._kernels=e,this._quality=e.length,this._blur=Math.max(...e)):(this._kernels=[0],this._quality=1)}get pixelSize(){return this._pixelSize}set pixelSize(e){if("number"!=typeof e)return Array.isArray(e)?(this.pixelSizeX=e[0],void(this.pixelSizeY=e[1])):void(this._pixelSize=e);this.pixelSizeX=this.pixelSizeY=e}get pixelSizeX(){return this.pixelSize.x}set pixelSizeX(e){this.pixelSize.x=e}get pixelSizeY(){return this.pixelSize.y}set pixelSizeY(e){this.pixelSize.y=e}get clamp(){return this._clamp}_updatePadding(){this.padding=Math.ceil(this._kernels.reduce((e,t)=>e+t+.5,0))}_generateKernels(){const e=this._blur,t=this._quality,i=[e];if(e>0){let n=e;const s=e/t;for(let e=1;e<t;e++)n-=s,i.push(n)}this._kernels=i,this._updatePadding()}};eo(to,"DEFAULT_OPTIONS",{strength:4,quality:3,clamp:!1,pixelSize:{x:1,y:1}});let io=to;var no=Object.defineProperty,so=(e,t,i)=>(((e,t,i)=>{t in e?no(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i})(e,"symbol"!=typeof t?t+"":t,i),i);const ro=class e extends Lt.d{constructor(t){t={...e.DEFAULT_OPTIONS,...t};super({gpuProgram:Gt.B.from({vertex:{source:Za,entryPoint:"mainVertex"},fragment:{source:"struct DropShadowUniforms {\n  uAlpha: f32,\n  uColor: vec3<f32>,\n  uOffset: vec2<f32>,\n};\n\nstruct GlobalFilterUniforms {\n  uInputSize:vec4<f32>,\n  uInputPixel:vec4<f32>,\n  uInputClamp:vec4<f32>,\n  uOutputFrame:vec4<f32>,\n  uGlobalFrame:vec4<f32>,\n  uOutputTexture:vec4<f32>,\n};\n\n@group(0) @binding(0) var<uniform> gfu: GlobalFilterUniforms;\n\n@group(0) @binding(1) var uTexture: texture_2d<f32>; \n@group(0) @binding(2) var uSampler: sampler;\n@group(1) @binding(0) var<uniform> dropShadowUniforms : DropShadowUniforms;\n\n@fragment\nfn mainFragment(\n  @builtin(position) position: vec4<f32>,\n  @location(0) uv : vec2<f32>\n) -> @location(0) vec4<f32> {\n  var color: vec4<f32> = textureSample(uTexture, uSampler, uv - dropShadowUniforms.uOffset * gfu.uInputSize.zw);\n\n  // Premultiply alpha\n  color = vec4<f32>(vec3<f32>(dropShadowUniforms.uColor.rgb * color.a), color.a);\n  // alpha user alpha\n  color *= dropShadowUniforms.uAlpha;\n\n  return color;\n}",entryPoint:"mainFragment"}}),glProgram:kt.M.from({vertex:Qa,fragment:"precision highp float;\nin vec2 vTextureCoord;\nout vec4 finalColor;\n\nuniform sampler2D uTexture;\nuniform float uAlpha;\nuniform vec3 uColor;\nuniform vec2 uOffset;\n\nuniform vec4 uInputSize;\n\nvoid main(void){\n    vec4 sample = texture(uTexture, vTextureCoord - uOffset * uInputSize.zw);\n\n    // Premultiply alpha\n    sample.rgb = uColor.rgb * sample.a;\n\n    // alpha user alpha\n    sample *= uAlpha;\n\n    finalColor = sample;\n}",name:"drop-shadow-filter"}),resources:{dropShadowUniforms:{uAlpha:{value:t.alpha,type:"f32"},uColor:{value:new Float32Array(3),type:"vec3<f32>"},uOffset:{value:t.offset,type:"vec2<f32>"}}},resolution:t.resolution}),so(this,"uniforms"),so(this,"shadowOnly",!1),so(this,"_color"),so(this,"_blurFilter"),so(this,"_basePass"),this.uniforms=this.resources.dropShadowUniforms.uniforms,this._color=new It.Q,this.color=t.color??0,this._blurFilter=new io({strength:t.kernels??t.blur,quality:t.kernels?void 0:t.quality}),this._basePass=new Lt.d({gpuProgram:Gt.B.from({vertex:{source:Za,entryPoint:"mainVertex"},fragment:{source:"\n                    @group(0) @binding(1) var uTexture: texture_2d<f32>; \n                    @group(0) @binding(2) var uSampler: sampler;\n                    @fragment\n                    fn mainFragment(\n                        @builtin(position) position: vec4<f32>,\n                        @location(0) uv : vec2<f32>\n                    ) -> @location(0) vec4<f32> {\n                        return textureSample(uTexture, uSampler, uv);\n                    }\n                    ",entryPoint:"mainFragment"}}),glProgram:kt.M.from({vertex:Qa,fragment:"\n                in vec2 vTextureCoord;\n                out vec4 finalColor;\n                uniform sampler2D uTexture;\n\n                void main(void){\n                    finalColor = texture(uTexture, vTextureCoord);\n                }\n                ",name:"drop-shadow-filter"}),resources:{}}),Object.assign(this,t)}apply(e,t,i,n){const s=Mt.W.getSameSizeTexture(t);e.applyFilter(this,t,s,!0),this._blurFilter.apply(e,s,i,n),this.shadowOnly||e.applyFilter(this._basePass,t,i,!1),Mt.W.returnTexture(s)}get offset(){return this.uniforms.uOffset}set offset(e){this.uniforms.uOffset=e,this._updatePadding()}get offsetX(){return this.offset.x}set offsetX(e){this.offset.x=e,this._updatePadding()}get offsetY(){return this.offset.y}set offsetY(e){this.offset.y=e,this._updatePadding()}get color(){return this._color.value}set color(e){this._color.setValue(e);const[t,i,n]=this._color.toArray();this.uniforms.uColor[0]=t,this.uniforms.uColor[1]=i,this.uniforms.uColor[2]=n}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}get blur(){return this._blurFilter.strength}set blur(e){this._blurFilter.strength=e,this._updatePadding()}get quality(){return this._blurFilter.quality}set quality(e){this._blurFilter.quality=e,this._updatePadding()}get kernels(){return this._blurFilter.kernels}set kernels(e){this._blurFilter.kernels=e}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(e){"number"==typeof e&&(e={x:e,y:e}),Array.isArray(e)&&(e={x:e[0],y:e[1]}),this._blurFilter.pixelSize=e}get pixelSizeX(){return this._blurFilter.pixelSizeX}set pixelSizeX(e){this._blurFilter.pixelSizeX=e}get pixelSizeY(){return this._blurFilter.pixelSizeY}set pixelSizeY(e){this._blurFilter.pixelSizeY=e}_updatePadding(){const e=Math.max(Math.abs(this.offsetX),Math.abs(this.offsetY));this.padding=e+2*this.blur+4*this.quality}};so(ro,"DEFAULT_OPTIONS",{offset:{x:4,y:4},color:0,alpha:.5,shadowOnly:!1,kernels:void 0,blur:2,quality:3,pixelSize:{x:1,y:1},resolution:1});let ao=ro;class oo{static interactableFilter(e){return new ao({offset:{x:e,y:e},color:da.colors.black,alpha:.1,blur:0})}}class lo extends Ss{construction(...e){super.construction(...e),this.titleCont=new Rn,this.addChild(this.titleCont),this.titleCont.alpha=.5,this.titleAnimCont=new Rn,this.titleCont.addChild(this.titleAnimCont);const t={nativeTextStyle:{fontFamily:da.fonts.main,fill:da.colors.white,fontSize:164,fontWeight:Xn.EXTRA_BOLD},autosize:!0};this.title1Label=new Wn(s.clone(t)),this.titleAnimCont.addChild(this.title1Label),this.title1Label.text="WORDWALLWORDWALLWORDWALL",this.title2Label=new Wn(s.clone(t)),this.titleAnimCont.addChild(this.title2Label),this.title2Label.text=this.title1Label.text,this.title2Label.x=this.title1Label.x+this.title1Label.width,this.playBtnExternalView=new Rn;let i=[new zt.b(0,0),new zt.b(0,285),new zt.b(247,142)];this.playBtnNormalView=new Vt.A,this.playBtnExternalView.addChild(this.playBtnNormalView),this.playBtnNormalView.roundShape(i,18),this.playBtnNormalView.fill({color:da.colors.white}),this.playBtnNormalView.filters=[oo.interactableFilter(25)],this.playBtn=new ra({states:{normal:{alpha:1,externalView:this.playBtnExternalView}},bgConfig:{bgAlpha:.5}}),this.addChild(this.playBtn),this.playNextInfo=new Wn({nativeTextStyle:{fontFamily:da.fonts.main,fontWeight:Xn.EXTRA_BOLD,fontSize:32,fill:da.colors.white},autosize:!0}),this.addChild(this.playNextInfo),this.playNextInfo.alpha=.75,this.playNextInfo.text="DAILY #15 (FREE)",this.restartTitleAnim()}destruction(){super.destruction,this.stopTitleAnim()}addListeners(){super.addListeners(),this.eventListenerHelper.addEventListener(this.playBtn,Dn.DOWN,()=>{rs().change()("gamePage.screen",Ya.PLAY)})}stopTitleAnim(){Ki().killTweensOf(this.titleAnimCont),this.titleAnimCont.x=0}restartTitleAnim(){this.stopTitleAnim(),Ki().to(this.titleAnimCont,{x:-this.title1Label.width,duration:60,ease:"none",onComplete:()=>{this.restartTitleAnim()}})}arrange(){super.arrange(),this.titleCont.x=0,this.titleCont.y=-12,this.playBtn.forceArrange(),this.playBtn.x=Math.round((this.resizeSize.x-this.playBtn.width)/2),this.playBtn.y=227,On.alignWith(this.playNextInfo,this.playBtn,fn.CENTER,!0),this.playNextInfo.y=530}}const ho=" ,    .",uo=[["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""]];class co extends ra{}class po extends Rn{construction(...e){super.construction(...e),this.simpleBtn=new co({labelConfig:{nativeTextStyle:{fontFamily:da.fonts.main,fontSize:56,fontWeight:Xn.SEMI_BOLD,fill:da.colors.black},autosize:!0},bgConfig:{bgColor:da.colors.white,bgAlpha:0,bgLineColor:da.colors.white,bgLineWidth:5,bgLineAlpha:1},states:{normal:{alpha:.5},selected_normal:{alpha:1,bgConfig:{bgAlpha:1,bgLineAlpha:0}}}}),this.addChild(this.simpleBtn),this.simpleBtn.filters=[oo.interactableFilter(6)],this.simpleBtn.resize(da.gameplay.lettersGrid.cell.size.x,da.gameplay.lettersGrid.cell.size.y),Math.random()<=.25&&(this.simpleBtn.selected=!0)}commitData(){super.commitData(),this.simpleBtn.text=this.data,this.arrange()}}class fo extends Ss{construction(...e){super.construction(...e),this.gridSize=da.gameplay.lettersGrid.size,this.cellSize=da.gameplay.lettersGrid.cell.size,this.cellsPadding=da.gameplay.lettersGrid.cell.padding,this.letters=[],this.gridLettersList=[],this.gridLettersPool=new Y,this.lettersCont=new Rn,this.addChild(this.lettersCont),this.setLetters(uo)}setLetters(e){this.letters=e.concat(),this.updateLettersView()}clearAllLetters(){for(let e of this.gridLettersList)Un.childRemoveItselfFromParent(e),this.gridLettersPool.addObject(e,po);this.gridLettersList=[]}updateLettersView(){this.clearAllLetters();for(let e=0;e<this.gridSize.x;e++){let t=this.letters[e],i=t.length,n=i-this.gridSize.y;n<0&&(n=0);let s=this.gridSize.y-i;s<0&&(s=0);for(let i=0;i<this.gridSize.y;i++){if(i<s)continue;let r=t[i+n],a=this.gridLettersPool.getObject(po);this.lettersCont.addChild(a),a.data=r;let o=e*this.cellSize.x;e>0&&(o+=e*this.cellsPadding.x);let l=i*this.cellSize.y;i>0&&(l+=i*this.cellsPadding.y),a.x=o,a.y=l}}}}class go extends Ss{construction(...e){super.construction(...e),this.topBarBg=new Vt.A,this.addChild(this.topBarBg),this.topBarBg.rect(0,0,10,10),this.topBarBg.fill(da.colors.black),this.topBarBg.alpha=.25;const t=Wt.k.from("IconArrowLeft");this.backBtn=new ra({states:{normal:{alpha:1,externalView:t}}}),this.addChild(this.backBtn),this.backBtn.filters=[oo.interactableFilter(6)];const i=Wt.k.from("IconSettings");this.settingsBtn=new ra({states:{normal:{alpha:1,externalView:i}}}),this.addChild(this.settingsBtn),this.settingsBtn.filters=[oo.interactableFilter(6)],this.titleLabel=new Wn({nativeTextStyle:{fontFamily:da.fonts.main,fill:da.colors.white,fontSize:48,fontWeight:Xn.BOLD},autosize:!0}),this.addChild(this.titleLabel),this.titleLabel.text="DAILY #15",this.themeLabel=new Wn({nativeTextStyle:{fontFamily:da.fonts.main,fill:da.colors.black,fontSize:32,fontWeight:Xn.BOLD,wordWrap:!0},autosize:!0}),this.addChild(this.themeLabel),this.themeLabel.alpha=.5,this.themeLabel.text=`: ${ho} (0/5)`,this.lettersGridView=new fo,this.addChild(this.lettersGridView)}addListeners(){super.addListeners(),this.eventListenerHelper.addEventListener(this.backBtn,Dn.DOWN,()=>{rs().change()("gamePage.screen",Ya.START)})}arrange(){super.arrange(),this.topBarBg.width=this.resizeSize.x,this.topBarBg.height=60,this.backBtn.x=this.topBarBg.x+30,On.valignWith(this.backBtn,this.topBarBg,gn.MIDDLE),this.settingsBtn.x=this.topBarBg.x+this.topBarBg.width-this.settingsBtn.width-30,On.valignWith(this.settingsBtn,this.topBarBg,gn.MIDDLE);this.titleLabel.x=this.topBarBg.x+100,this.titleLabel.y=this.topBarBg.y+2;const e=this.resizeSize.x-200;this.themeLabel.changeConfig({nativeTextStyle:{wordWrapWidth:e},maxAutosizeWidth:e}),this.themeLabel.x=this.titleLabel.x,this.themeLabel.y=75,this.lettersGridView.x=this.themeLabel.x,this.lettersGridView.y=Math.floor(this.resizeSize.y-this.lettersGridView.height-5)}}class mo extends qr{construction(...e){super.construction(...e),this.resizeConfig.upscaleAllowed=!0,this.screenViewStack=new Cs,this.contentCont.addChild(this.screenViewStack),this.screenViewStack.addViewClass(lo,Ya.START),this.screenViewStack.addViewClass(go,Ya.PLAY)}destruction(){super.destruction,this.screenViewStack&&(this.screenViewStack.destruction(),this.screenViewStack=null)}arrange(){super.arrange(),this.screenViewStack.x=this.contentContReversedResizeSize.x,this.screenViewStack.y=this.contentContReversedResizeSize.y,this.screenViewStack.resize(this.contentContReversedResizeSize.width,this.contentContReversedResizeSize.height)}changeScreen(e){this.screenViewStack.selectedId=e,this.arrange()}}class _o extends qn{init(){super.init(),rs().initializeWith(qa),O(mo,{activateeConstructors:[$a]})}activateCompleteHook(){super.activateCompleteHook(),rs().change()(`pages.pageIdToViewClassMap.${Xa}`,mo)}}class vo{}class yo extends vo{constructor(){super()}}class bo extends qn{init(){super.init(),O(yo,{toSubstitute:vo})}}var xo,To=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,o)}l((n=n.apply(e,t||[])).next())})};class So extends or{constructor(){super(...arguments),this.gameLogicState=rs().getState()}executeInternal(){return To(this,void 0,void 0,function*(){yield D(hr,Xa).execute(),this.notifyComplete()})}}!function(e){e.MAIN_EXTRABOLD_256_WHITE="MAIN_EXTRABOLD_256_WHITE",e.MAIN_EXTRABOLD_128_WHITE="MAIN_EXTRABOLD_128_WHITE",e.MAIN_SEMIBOLD_80_WHITE="MAIN_SEMIBOLD_80_WHITE",e.MAIN_SEMIBOLD_128_WHITE="MAIN_SEMIBOLD_128_WHITE",e.MAIN_SEMIBOLD_160_WHITE="MAIN_SEMIBOLD_160_WHITE",e.MAIN_SEMIBOLD_240_WHITE="MAIN_SEMIBOLD_240_WHITE",e.MAIN_SEMIBOLD_256_WHITE="MAIN_SEMIBOLD_256_WHITE",e.MAIN_BOLD_80_WHITE="MAIN_BOLD_80_WHITE",e.MAIN_SEMIBOLD_15_WHITE="MAIN_SEMIBOLD_15_WHITE",e.MAIN_LIGHT_25_WHITE="MAIN_LIGHT_25_WHITE",e.MAIN_REGULAR_20_WHITE="MAIN_REGULAR_20_WHITE",e.MAIN_REGULAR_25_WHITE="MAIN_REGULAR_25_WHITE",e.MAIN_SEMIBOLD_25_WHITE="MAIN_SEMIBOLD_25_WHITE",e.MAIN_SEMIBOLD_25_BLACK="MAIN_SEMIBOLD_25_BLACK"}(xo||(xo={}));var Ao=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,o)}l((n=n.apply(e,t||[])).next())})};class Eo extends or{constructor(){super(...arguments),this.localeManager=D(F),this.deviceState=rs().getState()}executeInternal(){return Ao(this,void 0,void 0,function*(){this.notifyComplete()})}prepareFonts(){return Ao(this,void 0,void 0,function*(){const e=this.localeManager.findAllUniqueCharactersForCurrentLocale();if(e.push(...be.c.ALPHANUMERIC,...be.c.ASCII),"ru"===this.deviceState.device.mainLocale){const t=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""];e.push(...t)}const t=[];let i;i={label:new Wn({nativeTextStyle:{fontFamily:da.fonts.main,fontSize:128,fontWeight:Xn.EXTRA_BOLD,fill:da.colors.white},autosize:!0}),bitmapFontId:xo.MAIN_EXTRABOLD_128_WHITE,textureWidth:1024,textureHeight:1024,padding:10},t.push(i),i={label:new Wn({nativeTextStyle:{fontFamily:da.fonts.main,fontSize:256,fontWeight:Xn.EXTRA_BOLD,fill:da.colors.white},autosize:!0}),bitmapFontId:xo.MAIN_EXTRABOLD_256_WHITE,textureWidth:1024,textureHeight:1024,padding:10},t.push(i);for(let i of t)be.c.install({name:i.bitmapFontId,style:i.label.nativeField.style,chars:e,padding:i.padding}),yield En.asyncTimeout(250)})}}var Co=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,o)}l((n=n.apply(e,t||[])).next())})};class wo extends or{executeInternal(){return Co(this,void 0,void 0,function*(){this.notifyComplete()})}}var Po,Io;!function(e){e.INTERSTITIAL_ADV_SHOW="adv:interstitial:show",e.INTERSTITIAL_ADV_SUCCESS="adv:interstitial:success",e.INTERSTITIAL_ADV_ERROR="adv:interstitial:error",e.REWARDED_ADV_SHOW="adv:rewarded:show",e.REWARDED_ADV_SUCCESS="adv:rewarded:success",e.REWARDED_ADV_ERROR="adv:rewarded:error",e.BANNER_ADV_SHOW="adv:banner:show",e.BANNER_ADV_SUCCESS="adv:banner:success",e.BANNER_ADV_ERROR="adv:banner:error"}(Po||(Po={})),function(e){e.INTERSTITIAL_ADV_SHOW="AdvAdapterEvent.INTERSTITIAL_ADV_SHOW",e.INTERSTITIAL_ADV_SUCCESS="AdvAdapterEvent.INTERSTITIAL_ADV_SUCCESS",e.INTERSTITIAL_ADV_ERROR="AdvAdapterEvent.INTERSTITIAL_ADV_ERROR",e.REWARDED_ADV_SHOW="AdvAdapterEvent.REWARDED_ADV_SHOW",e.REWARDED_ADV_SUCCESS="AdvAdapterEvent.REWARDED_ADV_SUCCESS",e.REWARDED_ADV_ERROR="AdvAdapterEvent.REWARDED_ADV_ERROR",e.BANNER_ADV_SHOW="AdvAdapterEvent.BANNER_ADV_SHOW",e.BANNER_ADV_SUCCESS="AdvAdapterEvent.BANNER_ADV_SUCCESS",e.BANNER_ADV_ERROR="AdvAdapterEvent.BANNER_ADV_ERROR"}(Io||(Io={}));const Mo="iapAdapter";var Ro;!function(e){e.IAP_COMPLETE="iapComplete"}(Ro||(Ro={}));var Lo=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,o)}l((n=n.apply(e,t||[])).next())})};class ko extends ls{construction(...e){super.construction(e),this.storageManager=D(cs),this.iapState=rs().getState();const t=this.storageManager.getParam(Mo);this.applyStorageData(t)}applyStorageData(e){e&&rs().change()("iapAdapter",e)}updateStorageData(){const e=this.generateStorageData();this.storageManager.setParam(Mo,e)}generateStorageData(){return{completedIapIds:this.iapState.iapAdapter.completedIapIds.concat()}}addCompleteIap(e){rs().push()("iapAdapter.completedIapIds",e),this.updateStorageData();let t=this.getIapById(e);t?(Pa.logBusinessEvent(t.id,t.priceValue,t.priceCurrencyCode),Pa.logGoal(Ro.IAP_COMPLETE)):Pa.logEvent("error:iap:complete:"+t.id)}checkIfNoAdsIapActivated(){let e=!1;if(this.iapState.iapAdapter.noAdsIapIds)for(let t of this.iapState.iapAdapter.completedIapIds)if(-1!==this.iapState.iapAdapter.noAdsIapIds.indexOf(t)){e=!0;break}return e}checkIfIapAvailable(){return Lo(this,void 0,void 0,function*(){return!0})}getCatalog(){return Lo(this,void 0,void 0,function*(){let e=[];return this.lastRetrievedCatalog=e,Promise.resolve(e)})}getIapById(e){let t=null;if(this.lastRetrievedCatalog)for(let i of this.lastRetrievedCatalog)if(i.id===e){t=i;break}return t}getUnconsumedPurchases(){return Lo(this,void 0,void 0,function*(){return Promise.resolve(null)})}purchase(e,t){return Lo(this,void 0,void 0,function*(){return Promise.resolve(null)})}consume(e){return Promise.resolve(!1)}}var Do=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,o)}l((n=n.apply(e,t||[])).next())})};class Oo extends ls{constructor(){super(...arguments),this.soundsManager=D(Tn),this.appState=rs().getState(),this.advAdapterState=rs().getState(),this.muteSoundsDuringAdv=!0,this.anyAdvLastTimeShown=0,this.interstitialAdvLastTimeShown=0,this.rewardedAdvMinInterval=0,this.rewardedAdvLastTimeShown=0}setLastTimeShownValuesToCurrentTime(){this.interstitialAdvLastTimeShown=this.appState.app.sessionDuration,this.anyAdvLastTimeShown=this.appState.app.sessionDuration,this.rewardedAdvLastTimeShown=this.appState.app.sessionDuration}checkIfInterstitialAdvAvailable(e){let t=!0;if(e&&this.appState.app.appLaunchesCount<this.advAdapterState.advAdapter.interstitial.midLevelMinAppLaunchesCount&&(t=!1),t){this.getInterstitialAdvTimeToAvailable(e)>0&&(t=!1)}if(t){const e=D(ko);e&&e.checkIfNoAdsIapActivated()&&(t=!1)}return t}getInterstitialAdvTimeToAvailable(e){let t=0,i=0;if(0!==this.interstitialAdvLastTimeShown){let t=this.advAdapterState.advAdapter.interstitial.minInterval;e&&(t=this.advAdapterState.advAdapter.interstitial.midLevelMinInterval),i=this.interstitialAdvLastTimeShown+t-this.appState.app.sessionDuration}let n=0;0!==this.anyAdvLastTimeShown&&(n=this.anyAdvLastTimeShown+this.advAdapterState.advAdapter.interstitial.minIntervalToAnyOtherAdv-this.appState.app.sessionDuration);const s=Math.max(i,n);return s>0&&(t=s),t}showInterstitialAdv(){return Do(this,void 0,void 0,function*(){this.interstitialAdvLastTimeShown=this.appState.app.sessionDuration,this.anyAdvLastTimeShown=this.interstitialAdvLastTimeShown,this.muteSoundsDuringAdv&&this.addDisableSoundsLock(),Pa.logEvent(Po.INTERSTITIAL_ADV_SHOW),this.dispatchEvent(Io.INTERSTITIAL_ADV_SHOW);const e=this.internalShowInterstitialAdv();return e.then(()=>{Pa.logEvent(Po.INTERSTITIAL_ADV_SUCCESS),this.dispatchEvent(Io.INTERSTITIAL_ADV_SUCCESS)}),e.catch(e=>{console.log("AdvAdapter | showInterstitialAdv __ catch __ error: ",e),Pa.logEvent(Po.INTERSTITIAL_ADV_ERROR),this.dispatchEvent(Io.INTERSTITIAL_ADV_ERROR)}),e.finally(()=>{this.removeDisalbeSoundsLock()}),e})}internalShowInterstitialAdv(){return Do(this,void 0,void 0,function*(){return new Promise(e=>{console.log("AdvAdapter | internalShowInterstitialAdv __ Start Showing Interstitial Adv");setTimeout(()=>{console.log("AdvAdapter | internalShowInterstitialAdv __ Stop Showing Interstitial Adv"),e({})},100)})})}checkIfRewardedAdvAvailable(){let e=!1;return(0===this.rewardedAdvLastTimeShown||this.appState.app.sessionDuration>=this.rewardedAdvLastTimeShown+this.rewardedAdvMinInterval)&&(e=!0),e}showRewardedAdv(){return Do(this,void 0,void 0,function*(){this.rewardedAdvLastTimeShown=this.appState.app.sessionDuration,this.anyAdvLastTimeShown=this.rewardedAdvLastTimeShown,this.muteSoundsDuringAdv&&this.addDisableSoundsLock(),Pa.logEvent(Po.REWARDED_ADV_SHOW),this.dispatchEvent(Io.REWARDED_ADV_SHOW);const e=yield this.internalShowRewardedAdv();return e?(Pa.logEvent(Po.REWARDED_ADV_SUCCESS),this.dispatchEvent(Io.REWARDED_ADV_SUCCESS)):(Pa.logEvent(Po.REWARDED_ADV_ERROR),this.dispatchEvent(Io.REWARDED_ADV_ERROR)),this.removeDisalbeSoundsLock(),e})}internalShowRewardedAdv(){return Do(this,void 0,void 0,function*(){return new Promise(e=>Do(this,void 0,void 0,function*(){console.log("AdvAdapter | internalShowRewardedAdv __ Start Showing Rewarded Adv");let t=!0;yield En.asyncTimeout(100),console.log("AdvAdapter | internalShowRewardedAdv __ End Showing Rewarded Adv __ result: ",t),e(t)}))})}checkIfBannerAdvAvailable(){return!0}showBannerAdv(){return Do(this,void 0,void 0,function*(){Pa.logEvent(Po.BANNER_ADV_SHOW),this.dispatchEvent(Io.BANNER_ADV_SHOW);const e=this.internalShowBannerAdv();return e.then(()=>{rs().change()("advAdapter.banner.shown",!0),this.updateBannerData(),Pa.logEvent(Po.BANNER_ADV_SUCCESS),this.dispatchEvent(Io.BANNER_ADV_SUCCESS)}),e.catch(e=>{Pa.logEvent(Po.BANNER_ADV_ERROR),this.dispatchEvent(Io.BANNER_ADV_ERROR)}),e})}internalShowBannerAdv(){return Do(this,void 0,void 0,function*(){})}updateBannerData(){}getBannerRect(){return null}addDisableSoundsLock(){this.soundsManager.addDisableLock(this)}removeDisalbeSoundsLock(){this.soundsManager.removeDisableLock(this)}}const Bo="GamePreloaderPageViewEvent.PROGRESS_COMPLETE";var Go;!function(e){e.LOADING_COMPLETE="GamePreloaderEvent.LOADING_COMPLETE",e.LOADING_END_ANIM_COMPLETE="GamePreloaderEvent.LOADING_END_ANIM_COMPLETE"}(Go||(Go={}));var Fo=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,o)}l((n=n.apply(e,t||[])).next())})};class Uo extends Er{constructor(){super(...arguments),this.loadManager=D(an),this.platformAdapter=D(Ma),this.advAdapter=D(Oo),this.iframeAppCommunicationManager=D(Ua),this.iframeAppManager=D(za),this.rendererManager=D(Dr),this.initLoadingGroupCoef=.05,this.prepareGameLoadingCoef=.02,this.totalProgress=0,this.lastProcessedInitLoadingGroupProgress=0,this.fakeProgressValue=0,this.fakeProgressMinIncreasePerMs=5e-6,this.fakeProgressMaxIncreasePerMs=1e-5/5,this.fakeProgressMaxLimit=.97,this.analyticsTrackedProgressDeltaThreshold=.1,this.lastProcessedIframeAppTotalLoadingProgress=0,this.iframeAppTotalLoadingCoef=1-(this.initLoadingGroupCoef+this.prepareGameLoadingCoef)}onActivatorStart(e){super.onActivatorStart(e);rs().getState().advAdapter.isPrerollAllowed&&this.advAdapter.checkIfInterstitialAdvAvailable(!1)&&this.advAdapter.showInterstitialAdv(),this.initLoadingGroup=this.loadManager.getGroup(sr.INIT),this.initLoadingGroup.getAllItems().length>0?(this.eventListenerHelper.addEventListener(this.initLoadingGroup,Ri,this.onInitLoadingGroupProgress),this.onInitLoadingGroupProgress()):this.processInitLoadingGroupProgress(1),this.eventListenerHelper.addEventListener(this.activator,Bo,this.onViewProgressComplete),D(In,"prepareGame").execute().then(()=>{this.prepareGame()}),this.iframeAppCommunicationManager.addMessageCallback(Ba.CHILD_IFRAME_TO_PARENT_LOAD_PROGRESS,e=>{if(console.log("GamePreloaderPageMediator | onActivatorStart __ CHILD_IFRAME_TO_PARENT_LOAD_PROGRESS __ data: ",e),e.data.total){const t=e.data.progress/e.data.total;this.onIframeTotalLoadingProgress(t)}}),this.startFakeProgress()}onActivatorEnd(){super.onActivatorEnd(),this.stopFakeProgress()}onIframeTotalLoadingProgress(e){if(console.log("GamePreloaderPageMediator | onIframeTotalLoadingProgress _ progress: ",e),!this.lastProcessedIframeAppTotalLoadingProgress||e>this.lastProcessedIframeAppTotalLoadingProgress){const t=e-this.lastProcessedIframeAppTotalLoadingProgress,i=this.totalProgress+t*this.iframeAppTotalLoadingCoef;this.setProgress(i),this.lastProcessedIframeAppTotalLoadingProgress=e}}onInitLoadingGroupProgress(){this.processInitLoadingGroupProgress(this.initLoadingGroup.progress)}processInitLoadingGroupProgress(e){if(!this.lastProcessedInitLoadingGroupProgress||e>this.lastProcessedInitLoadingGroupProgress){const t=e-this.lastProcessedInitLoadingGroupProgress,i=this.totalProgress+t*this.initLoadingGroupCoef;this.setProgress(i),this.lastProcessedInitLoadingGroupProgress=e}}setProgress(e){console.log("FlashistAdaptation __ GamePreloaderPageMediator | setProgress _ progress: ",e),this.totalProgress=e,this.totalProgress>this.fakeProgressValue&&(this.fakeProgressValue=this.totalProgress);let t=this.analyticsTrackedProgressDeltaThreshold;if((this.analyticsLastTrackedProgress||0===this.analyticsLastTrackedProgress)&&(t=this.totalProgress-this.analyticsLastTrackedProgress),t>=this.analyticsTrackedProgressDeltaThreshold||this.totalProgress<=0||this.totalProgress>=1){let e=100*this.totalProgress;e=a.roundTo(e,10),Pa.logEvent(xa.PRELOADER_PROGRESS,e),Pa.logEvent(xa.PRELOADER_PROGRESS+"_"+e),this.analyticsLastTrackedProgress=this.totalProgress}this.commitProgressData()}commitProgressData(){console.log("GamePreloaderPageMediator | commitProgressData __ this.totalProgress: ",this.totalProgress," | this.fakeProgressValue: ",this.fakeProgressValue);let e=this.totalProgress;this.fakeProgressValue>e&&(e=this.fakeProgressValue),this.activator.loadingProgress=e}prepareGame(){return Fo(this,void 0,void 0,function*(){if(this.isPrepareStarted)return;this.isPrepareStarted=!0,yield D(Eo).execute(),this.isPrepareComplete=!0;const e=this.totalProgress+this.prepareGameLoadingCoef;this.setProgress(e)})}onViewProgressComplete(){return Fo(this,void 0,void 0,function*(){const e=rs().getState();Pa.logEvent(xa.GAME_LOADED,e.app.sessionDuration),yield En.asyncTimeout(500);const t=this.activator.endAnim();yield new T([new y(()=>Fo(this,void 0,void 0,function*(){this.globalDispatcher.dispatchEvent(Go.LOADING_COMPLETE)})),new y(()=>Fo(this,void 0,void 0,function*(){yield t,this.globalDispatcher.dispatchEvent(Go.LOADING_END_ANIM_COMPLETE)})),D(wo),D(So),new y(()=>Fo(this,void 0,void 0,function*(){Pa.logEvent(xa.GAME_START_AFTER_LOADING,e.app.sessionDuration)})),new y(()=>Fo(this,void 0,void 0,function*(){yield this.platformAdapter.waitInitPromise(),yield this.platformAdapter.gameIsReadyCallback()}))]).execute()})}stopFakeProgress(){this.fakeProgressInterval&&(clearInterval(this.fakeProgressInterval),this.fakeProgressInterval=null)}startFakeProgress(){this.stopFakeProgress(),this.fakeProgressInterval=setInterval(()=>{const e=Date.now();if(this.fakeProgressLastProcessedTime){const t=(e-this.fakeProgressLastProcessedTime)*a.getRandomFloat(this.fakeProgressMinIncreasePerMs,this.fakeProgressMaxIncreasePerMs);this.fakeProgressValue+=t,this.fakeProgressValue=Math.min(this.fakeProgressMaxLimit,this.fakeProgressValue),this.commitProgressData()}this.fakeProgressLastProcessedTime=e},1e3)}}var No=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,o)}l((n=n.apply(e,t||[])).next())})};class zo extends qr{constructor(){super(...arguments),this._loadingProgress=0,this._viewProgress=0}construction(...e){super.construction(...e),this.resizeConfig.upscaleAllowed=!0,this.logoCont=new Rn,this.contentCont.addChild(this.logoCont);const t="PreloaderLogo";ve.g.from(t)&&(this.logo=Wt.k.from(t),this.logoCont.addChild(this.logo),this.logo.pivot.set(this.logo.width/2,this.logo.height/2)),this.subtitleLabel=new Wn({nativeTextStyle:{fontFamily:da.fonts.main,fontSize:80,fill:da.colors.white,fontWeight:Xn.EXTRA_BOLD,align:Yn.CENTER}}),this.subtitleLabel.text=U("preloader.subtitle"),this.progressLabel=new Wn({autosize:!0,nativeTextStyle:{fontFamily:"Helvetica, Arial, sans-serif",fontSize:48,fill:16777215,fontWeight:Xn.SEMI_BOLD}}),this.contentCont.addChild(this.progressLabel),this.progressLabel.visible=!1,this.viewProgress=0,this.logoBgBaseRadius=100,this.logoBgCont=new Rn,this.contentCont.addChildBefore(this.logoBgCont,this.logoCont),this.logoBg=new Vt.A,this.logoBgCont.addChild(this.logoBg),this.logoBg.circle(0,0,this.logoBgBaseRadius),this.logoBg.fill(13468991),this.startAnim()}get loadingProgress(){return this._loadingProgress}set loadingProgress(e){e!==this._loadingProgress&&(this._loadingProgress=e,Yi.gsap.killTweensOf(this),Yi.gsap.to(this,{duration:.5,viewProgress:this.loadingProgress}))}startAnim(){this.logoBgCont.scale.set(0),Yi.gsap.to(this.logoBgCont.scale,{duration:1,x:1,y:1}),this.progressLabel.alpha=0,Yi.gsap.to(this.progressLabel,{duration:.25,delay:1.25,alpha:1}),this.logo.scale.set(0),Yi.gsap.to(this.logo.scale,{duration:1,delay:.25,x:1,y:1,onComplete:()=>{Yi.gsap.to(this.logo.scale,{duration:2,x:.9,y:.9,ease:Yi.Back.easeInOut,yoyo:!0,repeat:-1})}})}endAnim(){return No(this,void 0,void 0,function*(){return new Promise(e=>{Yi.gsap.killTweensOf(this.logoBgCont.scale),Yi.gsap.to(this.logoBgCont.scale,{duration:.5,x:0,y:0}),Yi.gsap.killTweensOf(this.progressLabel),Yi.gsap.to(this.progressLabel,{duration:.2,alpha:0}),Yi.gsap.killTweensOf(this.logo.scale),Yi.gsap.to(this.logo.scale,{duration:.5,delay:.1,x:0,y:0,ease:Yi.Back.easeIn,onComplete:()=>{e()}})})})}get viewProgress(){return this._viewProgress}set viewProgress(e){e!==this._viewProgress&&(this._viewProgress=e,this.commitData(),this.viewProgress>=1&&this.emit(Bo))}commitData(){super.commitData(),this.progressLabel.text=U("preloader.progress",{progress:Math.floor(100*this.viewProgress)}),this.viewProgress>0&&(this.progressLabel.visible=!0),this.arrange()}arrange(){if(super.arrange(),this.logoCont.x=Math.floor(this.contentContReversedResizeSize.width/2),this.logoCont.y=Math.floor(this.contentContReversedResizeSize.height/2),this.progressLabel.x=Math.floor((this.contentContReversedResizeSize.width-this.progressLabel.width)/2),this.progressLabel.y=Math.floor((this.contentContReversedResizeSize.height-this.progressLabel.height)/2),this.progressLabel.y+=225,this.logoBgCont){this.logoBgCont.x=this.logoCont.x,this.logoBgCont.y=this.logoCont.y;const e=Math.sqrt(Math.pow(this.contentContReversedResizeSize.width,2)+Math.pow(this.contentContReversedResizeSize.height,2));this.logoBg.width=e,this.logoBg.height=e}}}class Ho extends qn{init(){super.init(),O(zo,{activateeConstructors:[Uo]})}activateCompleteHook(){super.activateCompleteHook(),rs().change()(`pages.pageIdToViewClassMap.${$r}`,zo)}}class Vo extends Mr{}class Wo extends qn{init(){super.init(),O(Vo,{toSubstitute:Mr})}}class jo extends ls{constructor(){super(...arguments),this.storageManager=D(cs)}addListeners(){super.addListeners()}updateSaveData(){}}class Xo extends qn{init(){super.init(),O(jo,{isSingleton:!0,forceCreation:!0})}activateCompleteHook(){super.activateCompleteHook();let e=D(cs).getParam("gameSave");e&&rs().initializeWith(e)}}const Yo={tutorialStepConfigs:{configs:{}}};var Ko,qo;!function(e){e.START="TutorialStepEvent.START",e.COMPLETE="TutorialStepEvent.COMPLETE"}(Ko||(Ko={})),function(e){e.TUTORIAL_START="tutorial:start",e.TUTORIAL_COMPLETE="tutorial:complete",e.TUTORIAL_STEP_START="tutorial:stepStart",e.TUTORIAL_STEP_COMPLETE="tutorial:stepComplete"}(qo||(qo={}));class $o extends Jn{constructor(e){super(e),this.targetViewHolePadding=0,this.stepInfoToViewPadding=20}construction(e){super.construction(e),this.tutorialStepConfigsState=rs().getState(),this.containersManager=D(ks),this.stepId=e,this.stepConfig=this.tutorialStepConfigsState.tutorialStepConfigs.configs[this.stepId]}destruction(){super.destruction(),this.isActive=!1,this.updateTargetViewTimeout&&(clearTimeout(this.updateTargetViewTimeout),this.updateTargetViewTimeout=null),this.stepViewCont&&Un.childRemoveItselfFromParent(this.stepViewCont)}addListeners(){super.addListeners(),this.eventListenerHelper.addEventListener(this.globalDispatcher,Ps.POST_RESIZE,this.updateTutorialView),this.stepConfig.completeByStageDown&&this.eventListenerHelper.addEventListener(Cn.instance.stage,Dn.DOWN,this.onStageTap),this.stepConfig.globalEventToComplete&&this.eventListenerHelper.addEventListener(this.globalDispatcher,this.stepConfig.globalEventToComplete,this.onGlobalEventToComplete)}onGlobalEventToComplete(){this.processEventToComplete()}onStageTap(){this.processEventToComplete()}processEventToComplete(){this.stepConfig.minTimeToDisplayMs&&Date.now()-this.startTime<this.stepConfig.minTimeToDisplayMs||this.complete()}activate(){return this.isActive||(this.isActive=!0,Pa.logEvent(qo.TUTORIAL_STEP_START+":"+this.stepId),this.stepConfig.startAnalyticsEvent&&Pa.logEvent(this.stepConfig.startAnalyticsEvent),this.startTime=Date.now(),this.activatePromise=new Promise(e=>{this.activatePromiseResolve=e,this.createContent()})),this.dispatchEvent(Ko.START,this.stepConfig),this.activatePromise}complete(){this.isActive&&(Pa.logEvent(qo.TUTORIAL_STEP_COMPLETE+":"+this.stepConfig.id),this.stepConfig.completeAnalyticsEvent&&Pa.logEvent(this.stepConfig.completeAnalyticsEvent+":"+this.stepConfig.id),this.isActive=!1,this.activatePromiseResolve(),this.dispatchEvent(Ko.COMPLETE,this.stepConfig))}createContent(){const e=D(ks),t=e.getContainer(fa);this.targetView=e.getContainer(this.stepConfig.viewId),this.targetViewBounds=new Ht.c,this.prevTargetViewBounds=new Ht.c,this.stepViewContBounds=new Ht.c,this.stepViewCont=new Rn,t.addChild(this.stepViewCont),this.stepViewCont.interactive=!!this.stepConfig.blocking,this.stepBg=new Vt.A,this.stepViewCont.addChild(this.stepBg),this.stepBg.filters=[new Nt],this.stepBlockingHoleBg=new Vt.A,this.stepViewCont.addChild(this.stepBlockingHoleBg),this.stepBlockingHoleBg.visible=!!this.stepConfig.blockingHole,this.stepScaledCont=new Rn,this.stepViewCont.addChild(this.stepScaledCont),this.stepLabel=new Wn({valign:this.stepConfig.labelValign,autosize:!0,autosizeType:Hn.HEIGHT,maxAutosizeWidth:800,nativeTextStyle:{fontFamily:da.fonts.main,fontSize:72,fill:da.colors.white,fontWeight:Xn.BOLD,wordWrap:!0,align:this.stepConfig.labelAlign,stroke:{color:0,width:10}}}),this.stepScaledCont.addChild(this.stepLabel),this.stepConfig.textId?this.stepLabel.text=U(this.stepConfig.textId):this.stepLabel.visible=!1,this.updateTutorialView(),this.updateTargetViewTimeout=setInterval(()=>{this.updateTutorialView()},100)}updateTutorialView(){if(!this.isActive)return;if(this.targetView.getBounds(!1,this.targetViewBounds),this.prevTargetViewBounds.x===this.targetViewBounds.x&&this.prevTargetViewBounds.y===this.targetViewBounds.y&&this.prevTargetViewBounds.width===this.targetViewBounds.width&&this.prevTargetViewBounds.height===this.targetViewBounds.height)return;this.prevTargetViewBounds.x=this.targetViewBounds.x,this.prevTargetViewBounds.y=this.targetViewBounds.y,this.prevTargetViewBounds.width=this.targetViewBounds.width,this.prevTargetViewBounds.height=this.targetViewBounds.height;const e=Cn.instance.renderer.width,t=Cn.instance.renderer.height;this.stepBg.clear(),this.stepBg.lineTo(e,0),this.stepBg.lineTo(e,t),this.stepBg.lineTo(0,t),this.stepBg.lineTo(0,0),this.stepBg.fill({color:0,alpha:.85}),this.stepBg.rect(this.targetViewBounds.x-this.targetViewHolePadding,this.targetViewBounds.y-this.targetViewHolePadding,this.targetViewBounds.width+2*this.targetViewHolePadding,this.targetViewBounds.height+2*this.targetViewHolePadding),this.stepBg.cut(),this.stepBlockingHoleBg.clear(),this.stepBlockingHoleBg.lineTo(e,0),this.stepBlockingHoleBg.lineTo(e,t),this.stepBlockingHoleBg.lineTo(0,t),this.stepBlockingHoleBg.lineTo(0,0),this.stepBlockingHoleBg.fill({color:0,alpha:.01});const i=rs().getState(),n=e/i.pages.activePageContentScale.x;this.stepLabel.width=n-100,this.stepLabel.changeConfig({nativeTextStyle:{wordWrapWidth:this.stepLabel.width}}),this.stepScaledCont.scale.set(i.pages.activePageContentScale.x,i.pages.activePageContentScale.y);let s=Math.floor((e-this.stepScaledCont.width)/2),r=this.targetViewBounds.y+Math.floor((this.prevTargetViewBounds.height-this.stepScaledCont.height)/2);this.stepConfig.valign&&(this.stepConfig.valign===gn.TOP?r=this.targetViewBounds.y-this.stepScaledCont.height-this.stepInfoToViewPadding:this.stepConfig.valign===gn.BOTTOM&&(r=this.targetViewBounds.y+this.targetViewBounds.height+this.stepInfoToViewPadding)),this.stepScaledCont.x=s,this.stepScaledCont.y=r}}class Qo{constructor(){this.tutorialStepIdsToControllerClassesMap={}}addTutorialClass(e,t){this.tutorialStepIdsToControllerClassesMap[e]=t}createStepController(e){let t=this.tutorialStepIdsToControllerClassesMap[e];t||(t=$o);return D($o,e)}}const Zo="tutorialSave";class Jo extends ls{constructor(){super(...arguments),this.tutorialState=rs().getState(),this.tutorialStepCofnigsState=rs().getState(),this.tutorialStepsFactory=D(Qo),this.storageManager=D(cs),this.stepsEventListenerHelper=new u(this),this.activeStepControllers=[]}destruction(){super.destruction(),this.stepsEventListenerHelper&&(this.stepsEventListenerHelper.destruction(),this.stepsEventListenerHelper=null)}updateSaveData(){const e={tutorial:{completeStepIds:this.tutorialState.tutorial.completeStepIds.concat()}};this.storageManager.setParam(Zo,e)}startStep(e){if(!this.checkIfStepCanBeStarted(e))return;rs().push()("tutorial.activeStepIds",e);const t=this.tutorialStepsFactory.createStepController(e);return this.addStepListeners(t),this.activeStepControllers.push(t),t.activate()}processControllerComplete(e){o.removeItem(this.activeStepControllers,e),this.removeStepListeners(e);const t=this.tutorialState.tutorial.activeStepIds.indexOf(e.stepId);rs().splice()("tutorial.activeStepIds",t),e.stepConfig.completeSaveStepId&&rs().push()("tutorial.completeStepIds",e.stepConfig.completeSaveStepId),this.updateSaveData(),e.destruction()}addStepListeners(e){this.stepsEventListenerHelper.addEventListener(e,Ko.COMPLETE,()=>{this.processControllerComplete(e)})}removeStepListeners(e){this.stepsEventListenerHelper.removeAllListeners(e)}checkIfStepCanBeStarted(e){let t=!0;const i=this.tutorialStepCofnigsState.tutorialStepConfigs.configs[e];if(i||(t=!1),t&&this.checkIfStepActive(e)&&(t=!1),t&&this.checkIfStepComplete(e)&&(t=!1),t&&i.requiredCompleteStepIds)for(let e of i.requiredCompleteStepIds)if(!this.checkIfStepComplete(e)){t=!1;break}return t}checkIfStepComplete(e){let t=!1;return-1!==this.tutorialState.tutorial.completeStepIds.indexOf(e)&&(t=!0),t}checkIfStepActive(e){let t=!1;return-1!==this.tutorialState.tutorial.activeStepIds.indexOf(e)&&(t=!0),t}}class el extends ls{constructor(){super(...arguments),this.gamePageState=rs().getState(),this.gameLogicState=rs().getState(),this.tutorialManager=D(Jo)}addListeners(){super.addListeners()}}class tl extends qn{init(){super.init(),rs().initializeWith(Yo),O(el,{isSingleton:!0,forceCreation:!0})}}const il={iframeApp:{totalScore:0}};class nl{prepareHtmlConent(e,t){let i=e;if(t){const e=`\n                <script>\n                    var parentIframeData = ${JSON.stringify(t.data)};\n                <\/script>\n            `;if(t.placeholder)i.split(t.placeholder).join(e);else{const t="</head>";i.split(t).join(e+t)}}return i}}class sl{scaleIframe(e,t){if(e)if(ui.scaleElement(e,1),t.type===rl.FILL)e.width="100%",e.height="100%";else if(t.type===rl.FIT){const i=ui.getDocumentSize(),n=t.targetSizeMin.width/t.targetSizeMin.height,s=t.targetSizeMax.width/t.targetSizeMax.height,r=i.x/i.y;let a=t.targetSizeMin.width,o=t.targetSizeMin.height;if(n<=r&&r<=s){let e=1;i.x>a?e=a/i.x:i.y>o&&(e=a/i.y),a=i.x*e,o=i.y*e}else r<n?(a=t.targetSizeMin.width,o=t.targetSizeMin.height):(a=t.targetSizeMax.width,o=t.targetSizeMax.height);let l={upscaleAllowed:!0};const h=Fn.getScale(a,o,i.x,i.y,l);if(t.fitType&&t.fitType==al.SCALE_DOWN_AND_STRETCH_THE_OTHER_SIDE){Fn.getScaleSide(a,o,i.x,i.y,l)===Bn.WIDTH?o=i.y/h:a=i.x/h}const u=i.x-a*h;let c=Math.floor(u/2);const d=i.y-o*h;let p=Math.floor(d/2);switch(t.align){case fn.LEFT:c=0;break;case fn.RIGHT:c=Math.floor(u)}switch(t.valign){case gn.TOP:p=0;break;case gn.BOTTOM:p=Math.floor(d)}e.style.left=`${c}px`,e.style.top=`${p}px`,e.width=`${a}`,e.height=`${o}`,ui.scaleElement(e,h)}else if(t.type===rl.LOCK_HEIGHT){const i=ui.getDocumentSize(),n=Fn.getScale(1,t.targetSizeMin.height,i.x,i.y,{upscaleAllowed:!0});ui.scaleElement(e,n),e.width=""+i.x/n,e.height=`${t.targetSizeMin.height}`}}}var rl,al;!function(e){e.FILL="fill",e.FIT="fit",e.LOCK_WIDTH="lockWidth",e.LOCK_HEIGHT="lockHeight"}(rl||(rl={})),function(e){e.SCALE_DOWN="scaleDown",e.SCALE_DOWN_AND_STRETCH_THE_OTHER_SIDE="scaleDownAndStretchTheOtherSide"}(al||(al={}));class ol extends qn{init(){super.init(),rs().initializeWith(il),O(za,{isSingleton:!0,forceCreation:!0}),O(Ua,{isSingleton:!0,forceCreation:!0}),O(nl,{isSingleton:!0}),O(sl,{isSingleton:!0})}}const ll="interstitialBreak",hl="rewarded",ul="review",cl={advAdapter:{isPrerollAllowed:!0,banner:{shown:!1,rect:{x:0,y:0,width:0,height:0}},interstitial:{minInterval:18e4,minIntervalToAnyOtherAdv:0,midLevelMinInterval:24e4,midLevelMinAppLaunchesCount:10}}},dl={iapAdapter:{completedIapIds:[],noAdsIapIds:[],debug:{catalog:[]}}};class pl extends qn{init(){super.init(),rs().initializeWith(cl),rs().initializeWith(dl),O(Ma,{isSingleton:!0,forceCreation:!0}),O(ko,{isSingleton:!0,forceCreation:!0}),O(Oo,{isSingleton:!0,forceCreation:!0})}}var fl=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,o)}l((n=n.apply(e,t||[])).next())})};class gl extends Oo{constructor(){super(...arguments),this.platformAdapter=D(La)}internalShowInterstitialAdv(){return fl(this,void 0,void 0,function*(){return new Promise((e,t)=>{try{this.platformAdapter.sdk.adv.showFullscreenAdv({callbacks:{onClose:t=>{e(t)},onError:e=>{t(e)}}})}catch(e){t(e)}})})}internalShowRewardedAdv(){return fl(this,void 0,void 0,function*(){return new Promise((e,t)=>{{let t=!1;try{this.platformAdapter.sdk.adv.showRewardedVideo({callbacks:{onOpen:()=>{console.log("YandexAdvAdapter | internalShowRewardedAdv __ Video ad open.")},onRewarded:()=>{console.log("YandexAdvAdapter | internalShowRewardedAdv __ Rewarded!"),t=!0},onClose:()=>{console.log("YandexAdvAdapter | internalShowRewardedAdv __ Video ad closed."),e(t)},onError:t=>{console.error("YandexAdvAdapter | internalShowRewardedAdv __ Error while open video ad:",t),e(!1)}}})}catch(t){e(!1)}}})})}}var ml=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,o)}l((n=n.apply(e,t||[])).next())})};class _l extends ko{constructor(){super(...arguments),this.platformAdapter=D(La)}convertYandexIapIntoGameIap(e){return{id:e.id,title:e.title,description:e.description,priceText:e.price,priceValue:parseFloat(e.priceValue),priceCurrencyCode:e.priceCurrencyCode}}convertYandexPurchaseIntoGamePurchase(e){return{iapId:e.productID,token:e.purchaseToken}}getCatalog(){return ml(this,void 0,void 0,function*(){return new Promise(e=>{this.platformAdapter.iapSdk.getCatalog().then(t=>{console.log("YandexGamesIAPAdapter || getCatalog __ then __ products: ",t);let i=[];for(let e of t){let t=this.convertYandexIapIntoGameIap(e);i.push(t)}console.log("YandexGamesIAPAdapter || getCatalog __ then __ gameIapDataList: ",i),this.lastRetrievedCatalog=i,e(i)}).catch(t=>{console.error("YandexGamesIAPAdapter || getCatalog __ catch __ error: ",t),e(null)})})})}getUnconsumedPurchases(){return ml(this,void 0,void 0,function*(){return new Promise((e,t)=>{this.platformAdapter.iapSdk.getPurchases().then(t=>{console.log("YandexGamesIAPAdapter || getPurchases __ then __ purchases: ",t);let i=null;if(t){i=[];for(let e of t){let t=this.convertYandexPurchaseIntoGamePurchase(e);i.push(t)}}e(i)}).catch(e=>{console.error("YandexGamesIAPAdapter || getPurchases __ catch __ error: ",e),t(e)})})})}purchase(e,t){return ml(this,void 0,void 0,function*(){return new Promise((i,n)=>{this.platformAdapter.iapSdk.purchase({id:e,developerPayload:t}).then(e=>ml(this,void 0,void 0,function*(){console.log("YandexGamesIAPAdapter || purchase __ then __ purchaseData: ",e);const t=this.convertYandexPurchaseIntoGamePurchase(e);i(t)})).catch(e=>{console.error("YandexGamesIAPAdapter || purchase __ catch __ error: ",e),n(e)})})})}consume(e){return new Promise(t=>{this.platformAdapter.iapSdk.consumePurchase(e).then(()=>{console.log("YandexGamesIAPAdapter || consume __ then"),t(!0)}).catch(e=>{console.error("YandexGamesIAPAdapter || consume __ catch __ error: ",e),t(!1)})})}}class vl extends qn{init(){super.init(),O(La,{toSubstitute:Ma}),O(gl,{toSubstitute:Oo}),O(_l,{toSubstitute:ko})}}class yl extends Ma{constructor(){super(),this.yaCallbackSdk=window.yaContextCb}}var bl=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,o)}l((n=n.apply(e,t||[])).next())})};class xl extends Oo{construction(...e){super.construction(e),this.deviceState=rs().getState(),this.platformAdapter=D(yl),this.config=D(vo),this.deviceState.device.deviceType===K.DESKTOP?this.deviceConfig=this.config.desktop:this.deviceConfig=this.config.mobile,this.muteSoundsDuringAdv=!0}internalShowInterstitialAdv(){return bl(this,void 0,void 0,function*(){return new Promise((e,t)=>{this.platformAdapter.yaCallbackSdk.push(()=>{i.g.Ya.Context.AdvManager.render(Object.assign(Object.assign({},this.deviceConfig.fullscreen.yandexConfig),{onClose:()=>{console.log("YandexWebAdvPlatformAdapter | internalShowInterstitialAdv __ onClose"),e()},onRender:e=>{console.log("YandexWebAdvPlatformAdapter | internalShowInterstitialAdv __ onRender, data: ",e)},onError:e=>{console.log("YandexWebAdvPlatformAdapter | internalShowInterstitialAdv __ onError, data: ",e),t(e)}}))})})})}internalShowRewardedAdv(){return bl(this,void 0,void 0,function*(){return new Promise((e,t)=>{this.platformAdapter.yaCallbackSdk.push(()=>{i.g.Ya.Context.AdvManager.render(Object.assign(Object.assign({},this.deviceConfig.rewarded.yandexConfig),{onClose:e=>{console.log("YandexWebAdvPlatformAdapter | internalShowInterstitialAdv __ onClose, data: ",e)},onRewarded:i=>{console.log("YandexWebAdvPlatformAdapter | internalShowRewardedAdv __ Rewarded, isRewarded",i),i?e():t()},onRender:e=>{console.log("YandexWebAdvPlatformAdapter | internalShowInterstitialAdv __ onRender, data: ",e)},onError:e=>{console.log("YandexWebAdvPlatformAdapter | internalShowInterstitialAdv __ onError, data: ",e),t(e)}}))})})})}internalShowBannerAdv(){return bl(this,void 0,void 0,function*(){return new Promise((e,t)=>{this.platformAdapter.yaCallbackSdk.push(()=>{i.g.Ya.Context.AdvManager.render(Object.assign(Object.assign({},this.deviceConfig.banner.yandexConfig),{onClose:()=>{console.log("YandexWebAdvPlatformAdapter | internalShowBannerAdv __ onClose")},onRender:t=>{console.log("YandexWebAdvPlatformAdapter | internalShowBannerAdv __ onRender, data: ",t),e()},onError:e=>{console.log("YandexWebAdvPlatformAdapter | internalShowBannerAdv __ onError, data: ",e),t(e)}}))})})})}updateBannerData(){const e=this.getBannerRect();rs().change()("advAdapter.banner.rect",{x:e.x,y:e.y,width:e.width,height:e.height})}getBannerRect(){const e=new _e.M,t=document.getElementById(this.deviceConfig.banner.yandexConfig.renderTo);if(t){const i=t.getBoundingClientRect();e.x=i.left,e.y=i.top,e.width=i.width,e.height=i.height}return e}}class Tl extends qn{init(){super.init(),O(yl,{toSubstitute:Ma}),O(xl,{toSubstitute:Oo}),O(vo)}}const Sl={tutorial:{activeStepIds:[],completeStepIds:[]}},Al={tutorialStepConfigs:{configs:{}}};class El extends qn{init(){super.init(),rs().initializeWith(Sl),rs().initializeWith(Al);let e=D(cs).getParam(Zo);e&&rs().initializeWith(e),O(Qo,{isSingleton:!0}),O(Jo,{isSingleton:!0,forceCreation:!0})}}var Cl=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,o)}l((n=n.apply(e,t||[])).next())})};class wl extends Ma{internalInit(e){return Cl(this,void 0,void 0,function*(){return new Promise(e=>{this.realSdkCallbacksMap={},this.placeholderSdkCallbacksMap={appid:33992,getLoginStatusCallback:function(e){},userInfoCallback:function(e){},userProfileCallback:function(e){},registerUserCallback:function(e){},paymentFrameUrlCallback:function(e){},getAuthTokenCallback:function(e){},paymentReceivedCallback:function(e){},paymentWindowClosedCallback:function(){},userConfirmCallback:function(){},paymentFrameItem:function(e){},getGameInventoryItems:function(){},adsCallback:(...e)=>{console.log("VkPlayPlatformAdapter | adsCallback __ ...args: ",...e),this.realSdkCallbacksMap.adsCallback&&this.realSdkCallbacksMap.adsCallback.apply(this,e)}};const t={apply:(...e)=>{console.log("VkPlayPlatformAdapter | testCallbackHandler __ args: ",...e)}};new Proxy(this.placeholderSdkCallbacksMap,t);iframeApi(this.placeholderSdkCallbacksMap).then(t=>{console.log("VkPlayPlatformAdapter | internalInit __ connected to iframeApi. api: ",t),this.sdk=t,e()},e=>{console.log("ERROR! VkPlayPlatformAdapter | internalInit __ error: ",e)})})})}}var Pl,Il=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,o)}l((n=n.apply(e,t||[])).next())})};class Ml extends Oo{constructor(){super(...arguments),this.platformAdapter=D(wl)}internalShowInterstitialAdv(){return Il(this,void 0,void 0,function*(){return new Promise((e,t)=>{this.platformAdapter.realSdkCallbacksMap.adsCallback=t=>{t&&(delete this.platformAdapter.realSdkCallbacksMap.adsCallback,e(!0))},this.platformAdapter.sdk.showAds({interstitial:!0})})})}internalShowRewardedAdv(){return Il(this,void 0,void 0,function*(){return new Promise((e,t)=>{this.platformAdapter.realSdkCallbacksMap.adsCallback=t=>{t&&(delete this.platformAdapter.realSdkCallbacksMap.adsCallback,"adCompleted"===t.type?e(!0):e(!1))},this.platformAdapter.sdk.showAds({interstitial:!1})})})}}class Rl extends qn{init(){super.init(),O(wl,{toSubstitute:Ma}),O(Ml,{toSubstitute:Oo})}}!function(e){e.NONE="none",e.PORTRAIT="portrait",e.LANDSCAPE="landscape"}(Pl||(Pl={}));class Ll extends qn{init(){super.init(),console.log("GameLocalStorageModule | init"),us.storageId=`${hs}geoconflict-wrapper`}}const kl={gameExperiments:{}};class Dl extends qn{init(){super.init(),rs().initializeWith(kl)}}const Ol={iapAdapter:{noAdsIapIds:["50001","50002","50003","70001"],debug:{catalog:[{id:"10001",title:"  1",description:"",priceText:"1099 ",priceValue:1099,priceCurrencyCode:""},{id:"10002",title:"  2",description:"",priceText:"10499 ",priceValue:10499,priceCurrencyCode:""},{id:"10003",title:"  3",description:"",priceText:"10999 ",priceValue:10999,priceCurrencyCode:""},{id:"10004",title:"  4",description:"",priceText:"102999 ",priceValue:102999,priceCurrencyCode:""},{id:"10005",title:"  5",description:"",priceText:"104999 ",priceValue:104999,priceCurrencyCode:""},{id:"10006",title:"  6",description:"",priceText:"109999 ",priceValue:109999,priceCurrencyCode:""},{id:"20001",title:" ",description:"",priceText:"99 ",priceValue:99,priceCurrencyCode:""},{id:"20002",title:" ",description:"",priceText:"299 ",priceValue:299,priceCurrencyCode:""},{id:"30001",title:" ",description:"",priceText:"3099 ",priceValue:3099,priceCurrencyCode:""},{id:"30002",title:" ",description:"",priceText:"30499 ",priceValue:30499,priceCurrencyCode:""},{id:"30003",title:"-",description:"",priceText:"301499 ",priceValue:301499,priceCurrencyCode:""},{id:"40001",title:" x180",description:"",priceText:"4099 ",priceValue:4099,priceCurrencyCode:""},{id:"40002",title:" x900",description:"",priceText:"40499 ",priceValue:40499,priceCurrencyCode:""},{id:"40003",title:" x2000",description:"",priceText:"40999 ",priceValue:40999,priceCurrencyCode:""},{id:"40004",title:" x4000",description:"",priceText:"401999 ",priceValue:401999,priceCurrencyCode:""},{id:"40005",title:" x5000",description:"",priceText:"402999 ",priceValue:402999,priceCurrencyCode:""},{id:"40006",title:" x10000",description:"",priceText:"404999 ",priceValue:404999,priceCurrencyCode:""},{id:"40007",title:" x20000",description:"",priceText:"409999 ",priceValue:409999,priceCurrencyCode:""},{id:"41001",title:"  ",description:"",priceText:"41099 ",priceValue:41099,priceCurrencyCode:""},{id:"41002",title:" ",description:"",priceText:"99 ",priceValue:99,priceCurrencyCode:""},{id:"41003",title:"  ",description:"",priceText:"249 ",priceValue:249,priceCurrencyCode:""},{id:"41004",title:"  ",description:"",priceText:"499 ",priceValue:499,priceCurrencyCode:""},{id:"50001",title:"  ",description:"",priceText:"50199 ",priceValue:50199,priceCurrencyCode:""},{id:"50002",title:"  ",description:"",priceText:"50499 ",priceValue:50499,priceCurrencyCode:""},{id:"50003",title:" ",description:"",priceText:"502999 ",priceValue:502999,priceCurrencyCode:""},{id:"60001",title:"  ",description:"",priceText:"60999 ",priceValue:60999,priceCurrencyCode:""},{id:"60002",title:" ",description:"",priceText:"60999 ",priceValue:60999,priceCurrencyCode:""},{id:"70001",title:" ",description:"",priceText:"70499 ",priceValue:70499,priceCurrencyCode:""},{id:"80001",title:" ",description:"",priceText:"801499 ",priceValue:801499,priceCurrencyCode:""}]}}};class Bl extends qn{init(){super.init(),rs().initializeWith(Ol)}}var Gl=function(e,t,i,n){return new(i||(i=Promise))(function(s,r){function a(e){try{l(n.next(e))}catch(e){r(e)}}function o(e){try{l(n.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i(function(e){e(t)})).then(a,o)}l((n=n.apply(e,t||[])).next())})};class Fl extends ca{constructor(){super(...arguments),this.iframeBaseSizeMin=new zt.b(720,1280),this.iframeBaseSizeMax=new zt.b(720,1280),this.defineIframeBaseSizeOnInit=!1,this.iframeForcedOrientaton=Pl.NONE,this.iframeScaleType=rl.FILL,this.iframeScaleFitType=al.SCALE_DOWN,this.iframeAlign=fn.CENTER,this.iframeValign=gn.MIDDLE,this.minInterstitialBreakApprovesCountToActivateMarketing=2,this.askToReviewMinTimeout=42e4,this.wasAskedToReview=!1,this.askToInstallMinTimeout=3e5,this.wasAskedToInstall=!1}addModules(){switch(super.addModules(),this.addSingleModule(new pl),"yandexGames"){case ya.YANDEX_GAMES:this.addSingleModule(new vl);break;case ya.YANDEX_WEB_EN:case ya.YANDEX_WEB_RU:case ya.ANDROID:this.addSingleModule(new Tl),this.addSingleModule(new bo);break;case ya.VK_PLAY:this.addSingleModule(new Rl)}this.addSingleModule(new Ll),this.addSingleModule(new Ho),this.addSingleModule(new _o),this.addSingleModule(new El),this.addSingleModule(new _r),this.addSingleModule(new xr),this.addSingleModule(new Bl),this.addSingleModule(new tl),this.addSingleModule(new ma),this.addSingleModule(new va),this.addSingleModule(new Xo),this.addSingleModule(new Wo),this.addSingleModule(new Fa),this.addSingleModule(new ja),this.addSingleModule(new Dl),this.addSingleModule(new ol)}initApp(){const e=Object.create(null,{initApp:{get:()=>super.initApp}});return Gl(this,void 0,void 0,function*(){yield e.initApp.call(this);const t=rs().getState();Pa.logEvent(xa.APP_FRAMEWORK_INITILIZED,t.app.sessionDuration),1===t.app.appLaunchesCount?Pa.logEvent(xa.NEW_USER):Pa.logEvent(xa.RETURNED_USER),Pa.logEvent(xa.APP_LAUNCHES_COUNT_FIRST_PART+t.app.appLaunchesCount),Pa.logEvent(xa.APP_CONSEQUENT_LAUNCHES_COUNT_MAX_BREAKS_DAY1_FIRST_PART+t.app.appDaysLaunchesCount_consequent_withMaxBreaks_Day1),Pa.logEvent(xa.APP_CONSEQUENT_LAUNCHES_COUNT_MAX_BREAKS_DAY3_FIRST_PART+t.app.appDaysLaunchesCount_consequent_withMaxBreaks_Day3),Pa.logEvent(xa.APP_CONSEQUENT_LAUNCHES_COUNT_MAX_BREAKS_DAY7_FIRST_PART+t.app.appDaysLaunchesCount_consequent_withMaxBreaks_Day7),yield new In(Va.PREPARE_IFRAME_APP).execute(),this.activateIframeApp();try{this.activateExperiments()}catch(e){Pa.logErrorEvent(Oa.ERROR,e.toString())}})}activateExperiments(){return Gl(this,void 0,void 0,function*(){const e=D(Ma);yield e.waitInitPromise();const t=yield e.getExperimentFlags();if(t){const e=Object.keys(t);for(let i of e){let e=parseFloat(t[i]),n=i.split("-").join(".");rs().change()(n,e)}}})}activateIframeApp(){return Gl(this,void 0,void 0,function*(){var e,t;const i=D(Ma);yield i.waitInitPromise();try{const e=i.getPlayerAppData();if(e){let t=Object.keys(e);for(let i of t){const t=e[i];localStorage.setItem(i,t)}}}catch(e){console.error("GameFacade | activateIframeApp __ Error during using user data for local storage __ error: ",e)}const n=D(Oo),s=D(ko),r=D(Ua),a=D(Tn),o=()=>Gl(this,void 0,void 0,function*(){this.wasAskedToReview=!0;const e={id:"askToReview"};a.addDisableLock(e),g.addPauseLock(e),yield i.askToReview(),a.removeDisableLock(e),g.removePauseLock(e)}),l=e=>Gl(this,void 0,void 0,function*(){yield o(),r.sendMessageToIframe(Ba.PARENT_IFRAME_TO_CHILD_WAIT_APPROVE_RESULT,{approveId:e.approveId})});let h=0;const u=e=>Gl(this,void 0,void 0,function*(){h++,console.log("GameFacade | processInterstitialBreakApprove __ interstitialBreakApprovesCount: ",h," | data: ",e);const t=rs().getState();if(Pa.logEvent(Ta.LEVEL_START_APPROVE,t.app.sessionDuration),h>=this.minInterstitialBreakApprovesCountToActivateMarketing){let s=!0;if(!e.isMidLevel){let e=!1;if(!this.wasAskedToReview&&t.app.sessionDuration>=this.askToReviewMinTimeout){(yield i.checkIfAskToReviewAvailable())&&(e=!0)}if(e)s=!1,yield o();else{let e=!1;if(console.log("BEFORE if (!this.wasAskedToInstall) {"),!this.wasAskedToInstall&&(console.log("BEFORE if (appState.app.sessionDuration >= this.askToInstallMinTimeout) {"),t.app.sessionDuration>=this.askToInstallMinTimeout)){console.log("BEFORE const isAskToInstallAvailable: boolean = await platformAdapter.checkIfAskToInstallAvailable()");const t=yield i.checkIfAskToInstallAvailable();console.log("BEFORE if (isAskToInstallAvailable) {"),t&&(e=!0)}if(console.log("BEFORE if (canAskToInstall) {"),e){s=!1,this.wasAskedToInstall=!0;const e={id:"askToInstall"};a.addDisableLock(e),g.addPauseLock(e),console.log("BEFORE await platformAdapter.askToInstall();"),yield i.askToInstall(),a.removeDisableLock(e),g.removePauseLock(e),console.log("END ask to install")}}}if(console.log("GameFacade | processInterstitialBreakApprove __ BEFORE if (canSowAdv) { __ canSowAdv: ",s),s){let t=n.checkIfInterstitialAdvAvailable(e.isMidLevel);if(console.log("GameFacade | processInterstitialBreakApprove __ data.isMidLevel: ",e.isMidLevel," | isFullScreenAdvAvailable: ",t),t)try{yield n.showInterstitialAdv()}catch(e){console.log("GameFacade | processInterstitialBreakApprove __ error: ",e)}}}r.sendMessageToIframe(Ba.PARENT_IFRAME_TO_CHILD_WAIT_APPROVE_RESULT,{approveId:e.approveId})}),c=e=>Gl(this,void 0,void 0,function*(){let t=!1;n.checkIfRewardedAdvAvailable()&&(t=yield n.showRewardedAdv()),r.sendMessageToIframe(Ba.PARENT_IFRAME_TO_CHILD_WAIT_APPROVE_RESULT,{approveId:e.approveId,isRewarded:t})});r.addMessageCallback(Ba.CHILD_IFRAME_TO_PARENT_WAIT_APPROVE,e=>Gl(this,void 0,void 0,function*(){switch(console.log("GameFacade | CHILD_IFRAME_TO_PARENT_WAIT_APPROVE __ data: ",e),e.data.approveId){case ll:u(e.data);break;case hl:c(e.data);break;case ul:l(e.data)}})),r.addMessageCallback(Ba.CHILD_IFRAME_TO_PARENT_IAP_CHECK_IF_AVAILABLE,()=>Gl(this,void 0,void 0,function*(){const e=yield s.checkIfIapAvailable();r.sendMessageToIframe(Ba.PARENT_IFRAME_TO_CHILD_IAP_CHECK_IF_AVAILABLE_RESULT,{isIapAvailable:e})})),r.addMessageCallback(Ba.CHILD_IFRAME_TO_PARENT_IAP_GET_CATALOG,()=>Gl(this,void 0,void 0,function*(){const e=yield s.getCatalog();r.sendMessageToIframe(Ba.PARENT_IFRAME_TO_CHILD_IAP_GET_CATALOG_RESULT,e)})),r.addMessageCallback(Ba.CHILD_IFRAME_TO_PARENT_IAP_PURCHASE,e=>Gl(this,void 0,void 0,function*(){let t,i;console.log("GameFacade | CHILD_IFRAME_TO_PARENT_IAP_PURCHASE __ START __ data: ",e);try{t=yield s.purchase(e.data.iapId),console.log("GameFacade | CHILD_IFRAME_TO_PARENT_IAP_PURCHASE __ purchaseResult: ",t)}catch(e){i=e,console.log("GameFacade | CHILD_IFRAME_TO_PARENT_IAP_PURCHASE __ error: ",e)}t&&!i&&d(t),r.sendMessageToIframe(Ba.PARENT_IFRAME_TO_CHILD_IAP_PURCHASE_RESULT,{result:t,error:i})})),r.addMessageCallback(Ba.CHILD_IFRAME_TO_PARENT_IAP_CONSUME,e=>Gl(this,void 0,void 0,function*(){let t,i;console.log("GameFacade | CHILD_IFRAME_TO_PARENT_IAP_CONSUME __ START __ data: ",e);try{t=yield s.consume(e.data.consumeToken),console.log("GameFacade | CHILD_IFRAME_TO_PARENT_IAP_CONSUME __ isConsumed: ",t)}catch(e){i=e,console.log("GameFacade | CHILD_IFRAME_TO_PARENT_IAP_CONSUME __ consumeError: ",i)}r.sendMessageToIframe(Ba.PARENT_IFRAME_TO_CHILD_IAP_CONSUME_RESULT,{isConsumed:t,error:i})})),r.addMessageCallback(Ba.CHILD_IFRAME_TO_PARENT_IAP_GET_UNCONSUMED,()=>Gl(this,void 0,void 0,function*(){const e=yield s.getUnconsumedPurchases();for(let t of e)d(t);r.sendMessageToIframe(Ba.PARENT_IFRAME_TO_PARENT_IAP_GET_UNCONSUMED_RESULT,e)}));const d=e=>{if(!e)return;D(ko).addCompleteIap(e.iapId)};r.addMessageCallback(Ba.CHILD_IFRAME_TO_PARENT_SET_TOTAL_SCORE,e=>Gl(this,void 0,void 0,function*(){var t;const n=rs().getState();if((null===(t=null==n?void 0:n.iframeApp)||void 0===t?void 0:t.totalScore)&&n.iframeApp.totalScore>=e.data.score)return;rs().change()("iframeApp.totalScore",e.data.score);(yield i.checkIfLeaderboardAvailable())&&(yield i.setLeaderboardScoreWithCheck(e.data.score))})),r.addMessageCallback(Ba.CHILD_IFRAME_TO_PARENT_SET_PLAYER_APP_DATA,e=>Gl(this,void 0,void 0,function*(){const t=Object.keys(e);for(let i of t)-1!==i.indexOf(hs)&&delete e[i];i.setPlayerAppData(e.data)})),ca.instance.app.renderer.view.canvas.style["z-index"]=100;const p=rs().getState(),f=rs().getState(),g=D(za),m="childIframeWrap",_=ui.createElementFromHTMLString(`\n            <style>\n                #${m} { \n                    width: 100%;\n                    height: 100%;\n                    padding: 0;\n                    overflow: hidden;\n                }\n\n                #childIframe { \n                    border: 0; \n                    /** Outline-Border */\n                    /** outline: AntiqueWhite groove thick; */\n                    outline: AntiqueWhite solid 10px;\n                }\n            </style>\n        `);document.body.appendChild(_),this.iframeParentElement=ui.createElementFromHTMLString(`\n            <div id='${m}'>\n            </div>\n        `),document.body.appendChild(this.iframeParentElement);let v=!1;rs().getState().app.appLaunchesCount<=1&&(v=!0);const y=rs().getState();let b=0;(null===(e=null==f?void 0:f.iframeApp)||void 0===e?void 0:e.totalScore)&&(b=null===(t=null==f?void 0:f.iframeApp)||void 0===t?void 0:t.totalScore);let x,T={isDev:!1,language:p.device.mainLocale,deviceType:p.device.deviceType,totalScore:b,isNewUser:v,gameExperiments:y.gameExperiments},S=`geoconflict/iframe.html?parentAppGlobalVars=${encodeURIComponent(JSON.stringify(T))}`;if(this.defineIframeBaseSizeOnInit){const e=ui.getDocumentSize();this.iframeBaseSizeMin.x=e.x,this.iframeBaseSizeMin.y=e.y,p.device.deviceType!==K.DESKTOP&&this.iframeForcedOrientaton&&(this.iframeForcedOrientaton===Pl.LANDSCAPE&&this.iframeBaseSizeMin.x<this.iframeBaseSizeMin.y||this.iframeForcedOrientaton===Pl.PORTRAIT&&this.iframeBaseSizeMin.x>this.iframeBaseSizeMin.y)&&(this.iframeBaseSizeMin.x=e.y,this.iframeBaseSizeMin.y=e.x),this.iframeBaseSizeMax.x=this.iframeBaseSizeMin.x,this.iframeBaseSizeMax.y=this.iframeBaseSizeMin.y}x=`<iframe id="childIframe" src="${S}" frameBorder="0" style="position: absolute; top: 0; left: 0;"></iframe>`,this.iframeElement=g.createIframeApp(x,this.iframeParentElement),g.hideIframeApp();const A=D(Zn),E=()=>{g.addPauseLock(n),g.addMuteLock(n)},C=()=>{g.removePauseLock(n),g.removeMuteLock(n)};this.eventListenerHelper.addEventListener(A,Io.INTERSTITIAL_ADV_SHOW,E),this.eventListenerHelper.addEventListener(A,Io.INTERSTITIAL_ADV_SUCCESS,C),this.eventListenerHelper.addEventListener(A,Io.INTERSTITIAL_ADV_ERROR,C),this.eventListenerHelper.addEventListener(A,Io.REWARDED_ADV_SHOW,E),this.eventListenerHelper.addEventListener(A,Io.REWARDED_ADV_SUCCESS,C),this.eventListenerHelper.addEventListener(A,Io.REWARDED_ADV_ERROR,C),this.eventListenerHelper.addEventListener(A,vn.ENABLED_CHANGE,()=>{a.enabled?g.removeMuteLock(a):g.addMuteLock(a)}),window.onerror=(e,t,i,n,s)=>{var r=n?"\ncolumn: "+n:"";const a="event: "+e+"source: "+t+"\nline: "+i+(r+=s?"\nerror: "+s:"");return Pa.logErrorEvent(Oa.ERROR,a),!1},window.addEventListener("unhandledrejection",e=>{var t,i;let n="Unhandled rejection:\npromise: "+e.promise+",\nreason: "+e.reason;(null===(t=e.reason)||void 0===t?void 0:t.stack)&&(n+=",\nstack: "+(null===(i=e.reason)||void 0===i?void 0:i.stack)),n+="\n).",Pa.logErrorEvent(Oa.ERROR,n)}),this.onPreloaderLoadingComplete(),this.onPreloaderLoadingEndAnimComplete()})}addListeners(){super.addListeners();const e=D(Zn);this.eventListenerHelper.addEventListener(e,as()("advAdapter.banner.rect"),this.onWindowResize),this.eventListenerHelper.addEventListener(e,as()("app.totalUsageDuration"),this.onDurationChange),this.eventListenerHelper.addEventListener(e,Ko.COMPLETE,e=>{switch("yandexGames"){case ya.YANDEX_WEB_EN:case ya.YANDEX_WEB_RU:e.completeAnalyticsEvent}}),this.eventListenerHelper.addEventListener(e,Go.LOADING_COMPLETE,this.onPreloaderLoadingComplete),this.eventListenerHelper.addEventListener(e,Go.LOADING_END_ANIM_COMPLETE,this.onPreloaderLoadingEndAnimComplete)}onPreloaderLoadingComplete(){D(Oo).setLastTimeShownValuesToCurrentTime();D(za).showIframeApp(),this.onWindowResize(),setTimeout(()=>{this.onWindowResize()},5e3)}onPreloaderLoadingEndAnimComplete(){this.rendererManager.hideView(),this.onWindowResize()}onWindowResize(){super.onWindowResize();D(sl).scaleIframe(this.iframeElement,{type:this.iframeScaleType,fitType:this.iframeScaleFitType,targetSizeMin:{width:this.iframeBaseSizeMin.x,height:this.iframeBaseSizeMin.y},targetSizeMax:{width:this.iframeBaseSizeMax.x,height:this.iframeBaseSizeMax.y},align:this.iframeAlign,valign:this.iframeValign})}processScaleFill(){}processScaleFit(){}onDurationChange(){const e=rs().getState();let t=5*_s,i=Math.floor(e.app.sessionDuration/t)*t;(!this.lastProcessedSessionDuration&&0!==this.lastProcessedSessionDuration||i>this.lastProcessedSessionDuration)&&(this.lastProcessedSessionDuration=i,Pa.logEvent(xa.SESSION_DURATION_FIRST_PART+i));let n=Math.floor(e.app.totalUsageDuration/t)*t;(!this.lastProcessedTotalUsageDuration&&0!==this.lastProcessedTotalUsageDuration||n>this.lastProcessedTotalUsageDuration)&&(this.lastProcessedTotalUsageDuration=n,Pa.logEvent(xa.TOTAL_USAGE_DURATION_FIRST_PART+n))}}{let e=s.clone(ka.analytics);e.buildId="0.0.0-geoconflictWrapper.4",Pa.init(e)}Pa.logEvent(xa.GAME_OPEN);const Ul=[Promise.resolve()];if("yandexGames"===ya.YANDEX_GAMES){const e=(()=>new Promise(e=>{var t=document.getElementsByTagName("script")[0],i=document.createElement("script");i.src="/sdk.js",i.async=!0,t.parentNode.insertBefore(i,t),i.onload=()=>{e()}}))();Ul.push(e)}if("yandexGames"===ya.VK_PLAY){const e=`//vkplay.ru/app/${33992}/static/mailru.core.js`,t=(()=>new Promise(t=>{var i=document.getElementsByTagName("script")[0],n=document.createElement("script");n.src=e,n.async=!0,i.parentNode.insertBefore(n,i),n.onload=()=>{t()}}))();Ul.push(t)}Promise.all(Ul).then(()=>{ca.init({debug:!1,FacadeClass:Fl})})})()})();